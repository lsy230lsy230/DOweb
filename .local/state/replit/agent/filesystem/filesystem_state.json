{"file_contents":{"README.md":{"content":"# DanceOffice - ëŒ„ìŠ¤ìŠ¤í¬ì¸  ëŒ€íšŒ ê´€ë¦¬ ì‹œìŠ¤í…œ\n\nëŒ„ìŠ¤ìŠ¤ì½”ì–´ì™€ ìì²´ ê°œë°œ ì‹œìŠ¤í…œì„ í†µí•©í•œ ëŒ„ìŠ¤ìŠ¤í¬ì¸  ëŒ€íšŒ ê´€ë¦¬ ë° ê²°ê³¼ ì œê³µ ì›¹ì‚¬ì´íŠ¸ì…ë‹ˆë‹¤.\n\n## ğŸ¯ ì£¼ìš” ê¸°ëŠ¥\n\n### ğŸ“… í†µí•© ìŠ¤ì¼€ì¤„ëŸ¬ ì‹œìŠ¤í…œ\n- ëŒ„ìŠ¤ìŠ¤ì½”ì–´ì™€ ìì²´ ì‹œìŠ¤í…œ ê²°ê³¼ í†µí•© ê´€ë¦¬\n- ëŒ€íšŒ ìƒíƒœ ìë™ ê´€ë¦¬ (upcoming, ongoing, completed)\n- JSON ê¸°ë°˜ ìœ ì—°í•œ ëŒ€íšŒ ì •ë³´ ì €ì¥\n\n### ğŸ  ë©”ì¸í˜ì´ì§€ ì¹´ë“œ ë‰´ìŠ¤\n- ë‹¤ê°€ì˜¤ëŠ” ëŒ€íšŒ ì¹´ë“œ (ìµœëŒ€ 3ê°œ)\n- ìµœê·¼ ì™„ë£Œëœ ëŒ€íšŒ ê²°ê³¼ ì¹´ë“œ (ìµœëŒ€ 2ê°œ)\n- ì§ê´€ì ì¸ ë„¤ë¹„ê²Œì´ì…˜ìœ¼ë¡œ ë°”ë¡œ ê²°ê³¼ í™•ì¸\n\n### ğŸ“Š ì¢…í•©ê²°ê³¼ í˜ì´ì§€\n- **ì£¼ê°„ í˜„í™©**: ì§€ë‚œì£¼, ì´ë²ˆì£¼, ë‹¤ìŒì£¼ ëŒ€íšŒ êµ¬ë¶„ í‘œì‹œ\n- **ì—°ë„ë³„ ëª©ë¡**: ê³¼ê±° ëŒ€íšŒ ë‚´ì—­ì„ ì—°ë„ë³„ë¡œ í™•ì¸\n- **íƒ€ì„ë¼ì¸ í˜•íƒœ**: ì‹œê°„ìˆœ ì •ë ¬ë¡œ ëŒ€íšŒ ì´ë ¥ ê´€ë¦¬\n\n### ğŸ¨ ë°˜ì‘í˜• UI/UX\n- **PC ë²„ì „**: ì¢Œì¸¡ ë„¤ë¹„ê²Œì´ì…˜ + ë©”ì¸ ì½˜í…ì¸  + ìš°ì¸¡ ê´‘ê³ \n- **ëª¨ë°”ì¼ ë²„ì „**: ìƒë‹¨ í—¤ë” + ë©”ì¸ ì½˜í…ì¸  + í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜\n- **ì¼ê´€ëœ ë””ìì¸**: ëª¨ë“  í˜ì´ì§€ì—ì„œ í†µì¼ëœ ì‚¬ìš©ì ê²½í—˜\n\n## ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ\n\n- **Backend**: PHP 7.4+\n- **Frontend**: HTML5, CSS3, JavaScript\n- **Database**: JSON íŒŒì¼ ê¸°ë°˜\n- **Integration**: ëŒ„ìŠ¤ìŠ¤ì½”ì–´ ì‹œìŠ¤í…œ ì—°ë™\n- **Responsive**: CSS Grid & Flexbox\n\n## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°\n\n```\nY:/\nâ”œâ”€â”€ index.php              # ë©”ì¸ í˜ì´ì§€\nâ”œâ”€â”€ assets/                # CSS, ì´ë¯¸ì§€, ë¡œê³ \nâ”œâ”€â”€ data/                  # ë°ì´í„° íŒŒì¼\nâ”‚   â”œâ”€â”€ scheduler.php      # ìŠ¤ì¼€ì¤„ëŸ¬ ì‹œìŠ¤í…œ\nâ”‚   â”œâ”€â”€ competitions.json  # ëŒ€íšŒ ì •ë³´ (ì˜ˆì‹œ)\nâ”‚   â”œâ”€â”€ notice.txt         # ê³µì§€ì‚¬í•­\nâ”‚   â””â”€â”€ schedule.txt       # ì¼ì •\nâ”œâ”€â”€ results/               # ê²½ê¸° ê²°ê³¼ (ê³µê°œ)\nâ”‚   â”œâ”€â”€ index.php          # ê²°ê³¼ ë©”ì¸ í˜ì´ì§€\nâ”‚   â””â”€â”€ results/           # ê²°ê³¼ íŒŒì¼ë“¤\nâ”œâ”€â”€ comprehensive/         # ì¢…í•©ê²°ê³¼ í˜ì´ì§€\nâ”‚   â””â”€â”€ index.php          # ì¢…í•©ê²°ê³¼ ë©”ì¸\nâ”œâ”€â”€ notice/                # ê³µì§€ì‚¬í•­ (ê³µê°œ)\nâ”œâ”€â”€ manage/                # ê´€ë¦¬ì í˜ì´ì§€\nâ”œâ”€â”€ comp/                  # ì±„ì  ì‹œìŠ¤í…œ (ë¹„ê³µê°œ)\nâ”œâ”€â”€ recall/                # ë¦¬ì½œ ì‹œìŠ¤í…œ\nâ”œâ”€â”€ 04_scripts/            # ìœ í‹¸ë¦¬í‹° ìŠ¤í¬ë¦½íŠ¸\nâ”œâ”€â”€ 05_documents/          # ë¬¸ì„œ íŒŒì¼\nâ”œâ”€â”€ robots.txt             # ê²€ìƒ‰ì—”ì§„ ì„¤ì •\nâ””â”€â”€ sitemap.xml            # ì‚¬ì´íŠ¸ë§µ\n```\n\n## ğŸš€ ì„¤ì¹˜ ë° ì„¤ì •\n\n### 1. ì›¹ì„œë²„ ì„¤ì •\n- PHP 7.4 ì´ìƒ\n- ì›¹ ë£¨íŠ¸ë¥¼ í”„ë¡œì íŠ¸ í´ë”ë¡œ ì„¤ì •\n\n### 2. ê¶Œí•œ ì„¤ì •\n```bash\nchmod 755 data/\nchmod 644 data/*.json\nchmod 755 comp/\n```\n\n### 3. ëŒ€íšŒ ë°ì´í„° ì„¤ì •\n`data/competitions.json` íŒŒì¼ì— ëŒ€íšŒ ì •ë³´ë¥¼ ì¶”ê°€í•˜ì„¸ìš”:\n\n```json\n{\n    \"id\": \"comp_2025_001\",\n    \"title\": \"ëŒ€íšŒëª…\",\n    \"subtitle\": \"ë¶€ì œëª©\",\n    \"date\": \"2025-09-14\",\n    \"place\": \"ì¥ì†Œ\",\n    \"status\": \"upcoming\",\n    \"dancescore_id\": \"ds_2025_001\",\n    \"our_system_id\": \"comp_2025_001\",\n    \"results_url\": \"/results/results/\"\n}\n```\n\n## ğŸ“± ì‚¬ìš©ë²•\n\n### ë©”ì¸í˜ì´ì§€\n- ë‹¤ê°€ì˜¤ëŠ” ëŒ€íšŒ ì¹´ë“œì—ì„œ \"ëŒ€íšŒ ì •ë³´\" í´ë¦­\n- ìµœê·¼ ëŒ€íšŒ ì¹´ë“œì—ì„œ \"ê²°ê³¼ ë³´ê¸°\" í´ë¦­\n\n### ì¢…í•©ê²°ê³¼ í˜ì´ì§€\n- ì£¼ê°„ í˜„í™©ì—ì„œ ê° ì£¼ë³„ ëŒ€íšŒ í™•ì¸\n- ì—°ë„ë³„ ëª©ë¡ì—ì„œ ê³¼ê±° ëŒ€íšŒ ë‚´ì—­ ê²€ìƒ‰\n\n### ê´€ë¦¬ì ê¸°ëŠ¥\n- `/manage/` ê²½ë¡œì—ì„œ ëŒ€íšŒ ê´€ë¦¬\n- ìŠ¤ì¼€ì¤„ëŸ¬ ì‹œìŠ¤í…œì„ í†µí•œ ëŒ€íšŒ ì¶”ê°€/ìˆ˜ì •\n\n## ğŸ”§ ê°œë°œ ì •ë³´\n\n### ëŒ„ìŠ¤ìŠ¤ì½”ì–´ ì—°ë™\n- ê¸°ì¡´ ê²°ê³¼ íŒŒì¼ í˜•ì‹ ê·¸ëŒ€ë¡œ ìœ ì§€\n- `results/results/` í´ë”ì˜ HTML/PDF íŒŒì¼ í™œìš©\n- ëŒ„ìŠ¤ìŠ¤ì½”ì–´ ê²°ê³¼ í˜•ì‹ì— ë§ì¶° í‘œì‹œ\n\n### ìì²´ ì‹œìŠ¤í…œ í†µí•©\n- `comp/` í´ë”ì˜ ì±„ì  ì‹œìŠ¤í…œ ë³´í˜¸\n- ìƒˆë¡œìš´ ìŠ¤ì¼€ì¤„ëŸ¬ë¡œ ëŒ€íšŒ ê´€ë¦¬\n- ë‘ ì‹œìŠ¤í…œì˜ ê²°ê³¼ë¥¼ í†µí•© ì¸í„°í˜ì´ìŠ¤ë¡œ ì œê³µ\n\n## ğŸ“„ ë¼ì´ì„ ìŠ¤\n\nì´ í”„ë¡œì íŠ¸ëŠ” ëŒ„ìŠ¤ìŠ¤í¬ì¸  ëŒ€íšŒ ê´€ë¦¬ ëª©ì ìœ¼ë¡œ ê°œë°œë˜ì—ˆìŠµë‹ˆë‹¤.\n\n## ğŸ‘¨â€ğŸ’» ê°œë°œì\n\n- **ê°œë°œ**: Seyoung Lee\n- **ì‹œìŠ¤í…œ**: DanceOffice\n- **ì—°ë™**: ëŒ„ìŠ¤ìŠ¤ì½”ì–´ + ìì²´ ê°œë°œ ì‹œìŠ¤í…œ\n\n## ğŸ”— ê´€ë ¨ ë§í¬\n\n- [ëŒ„ìŠ¤ìŠ¤ì½”ì–´](http://www.dancescorelive.net)\n- [DanceOffice](https://www.danceoffice.net)\n\n---\n\n**Â© 2025 DanceOffice | Powered by Seyoung Lee**\n","size_bytes":4259},"index.php":{"content":"<?php\nsession_start();\n\n// ë‹¤êµ­ì–´ ì‹œìŠ¤í…œ ë¡œë“œ\nrequire_once __DIR__ . '/lang/Language.php';\n$lang = Language::getInstance();\n\n// NoticeManager ë¡œë“œ\nrequire_once __DIR__ . '/data/NoticeManager.php';\n\n$base_ads_dir = __DIR__ . \"/data/\";\nfunction read_banner($pos) {\n    $img_web = \"/data/$pos.jpg\";\n    $img_file = __DIR__ . \"/data/$pos.jpg\";\n    $link_file = __DIR__ . \"/data/$pos.link\";\n    $link = file_exists($link_file) ? trim(file_get_contents($link_file)) : \"\";\n    if (file_exists($img_file)) {\n        if ($link) return \"<a href='$link' target='_blank'><img src='$img_web' alt='{$pos} ê´‘ê³ '></a>\";\n        else return \"<img src='$img_web' alt='{$pos} ê´‘ê³ '>\";\n    }\n    return \"\";\n}\n\n// ê³µì§€ì‚¬í•­ ë¡œë“œ (ë°ì´í„°ë² ì´ìŠ¤ ê¸°ë°˜)\ntry {\n    $noticeManager = new NoticeManager();\n    $recent_notices = $noticeManager->getRecentNotices(3);\n} catch (Exception $e) {\n    $recent_notices = [];\n    error_log(\"ê³µì§€ì‚¬í•­ ë¡œë“œ ì‹¤íŒ¨: \" . $e->getMessage());\n}\n\n// ì¼ì • ë¯¸ë¦¬ë³´ê¸° (ê¸°ì¡´ íŒŒì¼ ê¸°ë°˜)\n$schedule_file = __DIR__ . \"/data/schedule.txt\";\n$schedule_preview = file_exists($schedule_file) ? nl2br(htmlspecialchars(file_get_contents($schedule_file))) : t('no_schedule');\n\n// ëŒ€íšŒ ìŠ¤ì¼€ì¤„ëŸ¬ ë¡œë“œ\nrequire_once __DIR__ . '/data/scheduler.php';\n$scheduler = new CompetitionScheduler();\n\n// ë‹¤ê°€ì˜¤ëŠ” ëŒ€íšŒ (ìµœëŒ€ 3ê°œ)\n$upcoming_competitions = $scheduler->getUpcomingCompetitions(3);\n\n// ìµœê·¼ ê²°ê³¼ ëŒ€íšŒ (ëŒ€íšŒ ì „ë‚ ë¶€í„° 7ì¼ê°„)\n$recent_results_competitions = $scheduler->getRecentResultsCompetitions();\n\n// ìµœê·¼ ì™„ë£Œëœ ëŒ€íšŒ (ìµœëŒ€ 2ê°œ) - ê¸°ì¡´ í†µê³„ìš©\n$recent_competitions = $scheduler->getRecentCompetitions(2);\n?>\n<!DOCTYPE html>\n<html lang=\"<?= $lang->getCurrentLang() ?>\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title><?= t('site_title') ?></title>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <link rel=\"stylesheet\" href=\"/assets/style.css\">\n    <link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0\" rel=\"stylesheet\">\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        body {\n            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\n            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);\n            color: #e2e8f0;\n            overflow-x: hidden;\n        }\n\n        /* ìƒˆë¡œìš´ ëŒ€ì‹œë³´ë“œ ë ˆì´ì•„ì›ƒ */\n        .dashboard-container {\n            display: flex;\n            min-height: 100vh;\n        }\n\n        /* ì‚¬ì´ë“œë°” */\n        .sidebar {\n            width: 280px;\n            background: rgba(15, 23, 42, 0.8);\n            backdrop-filter: blur(20px);\n            border-right: 1px solid rgba(59, 130, 246, 0.2);\n            padding: 24px 20px;\n            position: fixed;\n            height: 100vh;\n            z-index: 100;\n            overflow-y: auto;\n        }\n\n        .sidebar-logo {\n            display: flex;\n            align-items: center;\n            gap: 12px;\n            margin-bottom: 40px;\n            padding: 16px;\n            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);\n            border-radius: 16px;\n            color: white;\n        }\n\n        .sidebar-logo img {\n            width: 32px;\n            height: 32px;\n        }\n\n        .sidebar-logo h1 {\n            font-size: 18px;\n            font-weight: 700;\n        }\n\n        .sidebar-nav {\n            list-style: none;\n        }\n\n        .sidebar-nav li {\n            margin-bottom: 8px;\n        }\n\n        .sidebar-nav a {\n            display: flex;\n            align-items: center;\n            gap: 12px;\n            padding: 12px 16px;\n            color: #94a3b8;\n            text-decoration: none;\n            border-radius: 12px;\n            transition: all 0.3s ease;\n            font-weight: 500;\n        }\n\n        .sidebar-nav a:hover,\n        .sidebar-nav a.active {\n            background: rgba(59, 130, 246, 0.1);\n            color: #3b82f6;\n            transform: translateX(4px);\n        }\n\n        .sidebar-nav .material-symbols-rounded {\n            font-size: 20px;\n        }\n\n        /* ì–¸ì–´ ì„ íƒ */\n        .language-selector {\n            margin-top: 32px;\n            padding-top: 24px;\n            border-top: 1px solid rgba(59, 130, 246, 0.2);\n        }\n\n        .language-dropdown {\n            position: relative;\n        }\n\n        .language-toggle {\n            display: flex;\n            align-items: center;\n            gap: 8px;\n            padding: 12px 16px;\n            background: rgba(59, 130, 246, 0.1);\n            border: 1px solid rgba(59, 130, 246, 0.2);\n            border-radius: 12px;\n            color: #94a3b8;\n            cursor: pointer;\n            transition: all 0.3s ease;\n            width: 100%;\n            text-align: left;\n        }\n\n        .language-toggle:hover {\n            background: rgba(59, 130, 246, 0.2);\n            color: #3b82f6;\n        }\n\n        .language-menu {\n            position: absolute;\n            bottom: 100%;\n            left: 0;\n            right: 0;\n            background: rgba(15, 23, 42, 0.95);\n            backdrop-filter: blur(20px);\n            border: 1px solid rgba(59, 130, 246, 0.2);\n            border-radius: 12px;\n            margin-bottom: 8px;\n            opacity: 0;\n            visibility: hidden;\n            transform: translateY(10px);\n            transition: all 0.3s ease;\n            z-index: 1000;\n        }\n\n        .language-menu.active {\n            opacity: 1;\n            visibility: visible;\n            transform: translateY(0);\n        }\n\n        .language-option {\n            display: flex;\n            align-items: center;\n            gap: 8px;\n            padding: 12px 16px;\n            color: #94a3b8;\n            text-decoration: none;\n            transition: all 0.3s ease;\n            border-radius: 8px;\n            margin: 4px;\n        }\n\n        .language-option:hover {\n            background: rgba(59, 130, 246, 0.1);\n            color: #3b82f6;\n        }\n\n        .language-option.current {\n            background: rgba(59, 130, 246, 0.2);\n            color: #3b82f6;\n        }\n\n        /* ë©”ì¸ ì½˜í…ì¸  */\n        .main-content {\n            flex: 1;\n            margin-left: 280px;\n            padding: 24px;\n        }\n\n        /* íˆì–´ë¡œ ì„¹ì…˜ */\n        .hero-section {\n            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);\n            border-radius: 24px;\n            padding: 48px;\n            margin-bottom: 32px;\n            position: relative;\n            overflow: hidden;\n            border: 1px solid rgba(59, 130, 246, 0.2);\n        }\n\n        .hero-section::before {\n            content: '';\n            position: absolute;\n            top: 0;\n            left: 0;\n            right: 0;\n            bottom: 0;\n            background: radial-gradient(circle at 30% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%);\n            pointer-events: none;\n        }\n\n        .hero-content {\n            position: relative;\n            z-index: 2;\n        }\n\n        .hero-title {\n            font-size: 48px;\n            font-weight: 700;\n            margin-bottom: 16px;\n            background: linear-gradient(135deg, #ffffff 0%, #94a3b8 100%);\n            -webkit-background-clip: text;\n            -webkit-text-fill-color: transparent;\n            background-clip: text;\n        }\n\n        .hero-subtitle {\n            font-size: 20px;\n            color: #64748b;\n            margin-bottom: 32px;\n            max-width: 600px;\n        }\n\n        .hero-stats {\n            display: flex;\n            gap: 32px;\n        }\n\n        .stat-item {\n            text-align: center;\n        }\n\n        .stat-number {\n            font-size: 32px;\n            font-weight: 700;\n            color: #3b82f6;\n            display: block;\n        }\n\n        .stat-label {\n            font-size: 14px;\n            color: #64748b;\n            margin-top: 4px;\n        }\n\n        /* ëŒ€ì‹œë³´ë“œ ê·¸ë¦¬ë“œ */\n        .dashboard-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));\n            gap: 24px;\n            margin-bottom: 32px;\n        }\n\n        /* ìœ„ì ¯ ì¹´ë“œ */\n        .widget-card {\n            background: rgba(30, 41, 59, 0.6);\n            backdrop-filter: blur(20px);\n            border: 1px solid rgba(59, 130, 246, 0.2);\n            border-radius: 20px;\n            padding: 24px;\n            transition: all 0.3s ease;\n        }\n\n        .widget-card:hover {\n            transform: translateY(-4px);\n            box-shadow: 0 20px 40px rgba(59, 130, 246, 0.1);\n            border-color: rgba(59, 130, 246, 0.4);\n        }\n\n        .widget-header {\n            display: flex;\n            align-items: center;\n            justify-content: between;\n            margin-bottom: 20px;\n        }\n\n        .widget-title {\n            font-size: 18px;\n            font-weight: 600;\n            color: #f1f5f9;\n            display: flex;\n            align-items: center;\n            gap: 8px;\n        }\n\n        .widget-icon {\n            color: #3b82f6;\n            font-size: 24px;\n        }\n\n        .widget-action {\n            color: #3b82f6;\n            text-decoration: none;\n            font-size: 14px;\n            font-weight: 500;\n            transition: color 0.3s ease;\n        }\n\n        .widget-action:hover {\n            color: #60a5fa;\n        }\n\n        /* ëŒ€íšŒ ì¹´ë“œ */\n        .competition-item {\n            background: rgba(15, 23, 42, 0.6);\n            border-radius: 16px;\n            padding: 20px;\n            margin-bottom: 16px;\n            border: 1px solid rgba(59, 130, 246, 0.1);\n            transition: all 0.3s ease;\n        }\n\n        .competition-item:hover {\n            background: rgba(59, 130, 246, 0.05);\n            border-color: rgba(59, 130, 246, 0.3);\n        }\n\n        /* Recent Results ìŠ¤íƒ€ì¼ */\n        .recent-result-item {\n            background: rgba(15, 23, 42, 0.6);\n            border: 1px solid rgba(59, 130, 246, 0.1);\n            border-radius: 12px;\n            padding: 20px;\n            margin-bottom: 16px;\n        }\n\n        .result-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: flex-start;\n            margin-bottom: 16px;\n        }\n\n        .result-info h3.result-title {\n            color: #f1f5f9;\n            font-size: 16px;\n            font-weight: 600;\n            margin: 0 0 8px 0;\n        }\n\n        .result-meta {\n            display: flex;\n            gap: 12px;\n            font-size: 13px;\n            color: #94a3b8;\n        }\n\n        .result-date {\n            background: rgba(59, 130, 246, 0.1);\n            color: #3b82f6;\n            padding: 3px 8px;\n            border-radius: 8px;\n        }\n\n        .result-location {\n            background: rgba(100, 116, 139, 0.1);\n            color: #64748b;\n            padding: 3px 8px;\n            border-radius: 8px;\n        }\n\n        .result-actions {\n            display: flex;\n            gap: 8px;\n        }\n\n        .result-btn {\n            display: flex;\n            align-items: center;\n            gap: 6px;\n            padding: 8px 16px;\n            border-radius: 8px;\n            text-decoration: none;\n            font-size: 13px;\n            font-weight: 500;\n            transition: all 0.3s ease;\n        }\n\n        .result-btn .material-symbols-rounded {\n            font-size: 16px;\n        }\n\n        .btn-results {\n            background: rgba(34, 197, 94, 0.1);\n            color: #22c55e;\n            border: 1px solid rgba(34, 197, 94, 0.2);\n        }\n\n        .btn-results:hover {\n            background: rgba(34, 197, 94, 0.2);\n            border-color: rgba(34, 197, 94, 0.3);\n        }\n\n        .btn-live {\n            background: rgba(239, 68, 68, 0.1);\n            color: #ef4444;\n            border: 1px solid rgba(239, 68, 68, 0.2);\n        }\n\n        .btn-live:hover {\n            background: rgba(239, 68, 68, 0.2);\n            border-color: rgba(239, 68, 68, 0.3);\n        }\n\n        .comp-header {\n            display: flex;\n            justify-content: between;\n            align-items: center;\n            margin-bottom: 12px;\n        }\n\n        .comp-title {\n            font-size: 16px;\n            font-weight: 600;\n            color: #f1f5f9;\n        }\n\n        .comp-status {\n            padding: 4px 12px;\n            border-radius: 20px;\n            font-size: 12px;\n            font-weight: 500;\n        }\n\n        .status-upcoming {\n            background: rgba(34, 197, 94, 0.1);\n            color: #22c55e;\n            border: 1px solid rgba(34, 197, 94, 0.2);\n        }\n\n        .status-completed {\n            background: rgba(100, 116, 139, 0.1);\n            color: #64748b;\n            border: 1px solid rgba(100, 116, 139, 0.2);\n        }\n\n        .comp-details {\n            color: #94a3b8;\n            font-size: 14px;\n            line-height: 1.5;\n        }\n\n        .comp-meta {\n            display: flex;\n            gap: 16px;\n            margin-top: 12px;\n        }\n\n        .meta-item {\n            display: flex;\n            align-items: center;\n            gap: 4px;\n            font-size: 12px;\n            color: #64748b;\n        }\n\n        .meta-item .material-symbols-rounded {\n            font-size: 16px;\n        }\n\n        /* ì•¡ì…˜ ë²„íŠ¼ */\n        .action-buttons {\n            display: flex;\n            gap: 12px;\n            margin-top: 24px;\n        }\n\n        .btn {\n            padding: 12px 24px;\n            border-radius: 12px;\n            text-decoration: none;\n            font-weight: 500;\n            font-size: 14px;\n            transition: all 0.3s ease;\n            display: inline-flex;\n            align-items: center;\n            gap: 8px;\n        }\n\n        .btn-primary {\n            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);\n            color: white;\n            border: 1px solid rgba(59, 130, 246, 0.2);\n        }\n\n        .btn-primary:hover {\n            transform: translateY(-2px);\n            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);\n        }\n\n        .btn-secondary {\n            background: rgba(59, 130, 246, 0.1);\n            color: #3b82f6;\n            border: 1px solid rgba(59, 130, 246, 0.2);\n        }\n\n        .btn-secondary:hover {\n            background: rgba(59, 130, 246, 0.2);\n        }\n\n        /* ëª¨ë°”ì¼ ëŒ€ì‘ */\n        @media (max-width: 768px) {\n            .sidebar {\n                width: 100%;\n                height: auto;\n                position: relative;\n                padding: 16px;\n            }\n\n            .main-content {\n                margin-left: 0;\n                padding: 16px;\n            }\n\n            .dashboard-container {\n                flex-direction: column;\n            }\n\n            .hero-title {\n                font-size: 32px;\n            }\n\n            .hero-section {\n                padding: 32px 24px;\n            }\n\n            .dashboard-grid {\n                grid-template-columns: 1fr;\n                gap: 16px;\n            }\n\n            .hero-stats {\n                flex-direction: column;\n                gap: 16px;\n                text-align: center;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"dashboard-container\">\n        <!-- ì‚¬ì´ë“œë°” -->\n        <nav class=\"sidebar\">\n            <div class=\"sidebar-logo\">\n                <img src=\"/assets/danceoffice-logo.png\" alt=\"DanceOffice\">\n                <h1>DanceOffice</h1>\n            </div>\n            \n            <ul class=\"sidebar-nav\">\n                <li><a href=\"/\" class=\"active\">\n                    <span class=\"material-symbols-rounded\">dashboard</span>\n                    <?= t('nav_dashboard') ?>\n                </a></li>\n                <li><a href=\"/competitions.php\">\n                    <span class=\"material-symbols-rounded\">event</span>\n                    <?= t('nav_competitions') ?>\n                </a></li>\n                <li><a href=\"/results.php\">\n                    <span class=\"material-symbols-rounded\">trophy</span>\n                    <?= t('nav_results') ?>\n                </a></li>\n                <li><a href=\"/manage/\">\n                    <span class=\"material-symbols-rounded\">settings</span>\n                    <?= t('nav_management') ?>\n                </a></li>\n                <li><a href=\"/notice/\">\n                    <span class=\"material-symbols-rounded\">notifications</span>\n                    <?= t('nav_notices') ?>\n                </a></li>\n            </ul>\n\n            <!-- ì–¸ì–´ ì„ íƒê¸° -->\n            <div class=\"language-selector\">\n                <div class=\"language-dropdown\">\n                    <div class=\"language-toggle\" onclick=\"toggleLanguageMenu()\">\n                        <span><?= $lang->getLangFlag() ?></span>\n                        <span><?= $lang->getLangName() ?></span>\n                        <span class=\"material-symbols-rounded\" style=\"margin-left: auto;\">expand_more</span>\n                    </div>\n                    <div class=\"language-menu\" id=\"languageMenu\">\n                        <?php foreach ($lang->getAvailableLanguages() as $code => $info): ?>\n                            <a href=\"<?= $lang->getLanguageUrl($code) ?>\" \n                               class=\"language-option <?= $code === $lang->getCurrentLang() ? 'current' : '' ?>\">\n                                <span><?= $info['flag'] ?></span>\n                                <span><?= $info['name'] ?></span>\n                            </a>\n                        <?php endforeach; ?>\n                    </div>\n                </div>\n            </div>\n        </nav>\n\n        <!-- ë©”ì¸ ì½˜í…ì¸  -->\n        <main class=\"main-content\">\n            <!-- íˆì–´ë¡œ ì„¹ì…˜ -->\n            <section class=\"hero-section\">\n                <div class=\"hero-content\">\n                    <h1 class=\"hero-title\"><?= t('hero_title') ?></h1>\n                    <p class=\"hero-subtitle\">\n                        <?= t('hero_subtitle') ?>\n                        <br><?= t('hero_description') ?>\n                    </p>\n                    \n                    <div class=\"hero-stats\">\n                        <div class=\"stat-item\">\n                            <span class=\"stat-number\"><?= count($upcoming_competitions) + count($recent_competitions) ?></span>\n                            <span class=\"stat-label\"><?= t('stat_total_competitions') ?></span>\n                        </div>\n                        <div class=\"stat-item\">\n                            <span class=\"stat-number\"><?= count($upcoming_competitions) ?></span>\n                            <span class=\"stat-label\"><?= t('stat_upcoming_events') ?></span>\n                        </div>\n                        <div class=\"stat-item\">\n                            <span class=\"stat-number\"><?= count($recent_competitions) ?></span>\n                            <span class=\"stat-label\"><?= t('stat_completed') ?></span>\n                        </div>\n                    </div>\n                </div>\n            </section>\n\n            <!-- ëŒ€ì‹œë³´ë“œ ê·¸ë¦¬ë“œ -->\n            <div class=\"dashboard-grid\">\n                <!-- ë‹¤ê°€ì˜¤ëŠ” ëŒ€íšŒ ìœ„ì ¯ -->\n                <div class=\"widget-card\">\n                    <div class=\"widget-header\">\n                        <h2 class=\"widget-title\">\n                            <span class=\"material-symbols-rounded widget-icon\">upcoming</span>\n                            <?= t('widget_upcoming_competitions') ?>\n                        </h2>\n                        <a href=\"/comp/\" class=\"widget-action\"><?= t('action_view_all') ?></a>\n                    </div>\n                    \n                    <div class=\"widget-content\">\n                        <?php if (!empty($upcoming_competitions)): ?>\n                            <?php foreach ($upcoming_competitions as $comp): ?>\n                                <a href=\"/competition.php?id=<?= urlencode($comp['id']) ?>\" style=\"text-decoration: none; color: inherit;\">\n                                    <div class=\"competition-item\">\n                                        <div class=\"comp-header\">\n                                            <h3 class=\"comp-title\"><?= htmlspecialchars($comp['name']) ?></h3>\n                                            <span class=\"comp-status status-upcoming\"><?= t('status_upcoming') ?></span>\n                                        </div>\n                                        <div class=\"comp-details\">\n                                            <?= htmlspecialchars($comp['description']) ?>\n                                        </div>\n                                        <div class=\"comp-meta\">\n                                            <div class=\"meta-item\">\n                                                <span class=\"material-symbols-rounded\">schedule</span>\n                                                <?= $lang->formatDate($comp['date']) ?>\n                                            </div>\n                                            <div class=\"meta-item\">\n                                                <span class=\"material-symbols-rounded\">location_on</span>\n                                                <?= htmlspecialchars($comp['location']) ?>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </a>\n                            <?php endforeach; ?>\n                        <?php else: ?>\n                            <p style=\"color: #64748b; text-align: center; padding: 20px;\">\n                                <?= t('no_upcoming_competitions') ?>\n                            </p>\n                        <?php endif; ?>\n                    </div>\n                </div>\n\n                <!-- ìµœê·¼ ê²°ê³¼ ìœ„ì ¯ -->\n                <div class=\"widget-card\">\n                    <div class=\"widget-header\">\n                        <h2 class=\"widget-title\">\n                            <span class=\"material-symbols-rounded widget-icon\">history</span>\n                            <?= t('widget_recent_results') ?>\n                        </h2>\n                        <a href=\"/results.php\" class=\"widget-action\"><?= t('action_view_all') ?></a>\n                    </div>\n                    \n                    <div class=\"widget-content\">\n                        <?php if (!empty($recent_results_competitions)): ?>\n                            <?php foreach ($recent_results_competitions as $comp): ?>\n                                <div class=\"recent-result-item\">\n                                    <div class=\"result-header\">\n                                        <div class=\"result-info\">\n                                            <h3 class=\"result-title\"><?= htmlspecialchars($comp['name'] ?? $comp['title']) ?></h3>\n                                            <div class=\"result-meta\">\n                                                <span class=\"result-date\"><?= $lang->formatDate($comp['date']) ?></span>\n                                                <span class=\"result-location\"><?= htmlspecialchars($comp['location'] ?? $comp['place']) ?></span>\n                                            </div>\n                                        </div>\n                                        <span class=\"comp-status status-<?= $comp['status'] ?>\"><?= t('status_' . $comp['status']) ?></span>\n                                    </div>\n                                    \n                                    <div class=\"result-actions\">\n                                        <a href=\"/competition.php?id=<?= urlencode($comp['id']) ?>&page=results\" class=\"result-btn btn-results\">\n                                            <span class=\"material-symbols-rounded\">trophy</span>\n                                            ì¢…í•©ê²°ê³¼\n                                        </a>\n                                        <a href=\"/competition.php?id=<?= urlencode($comp['id']) ?>&page=live\" class=\"result-btn btn-live\">\n                                            <span class=\"material-symbols-rounded\">live_tv</span>\n                                            ì‹¤ì‹œê°„ ê²°ê³¼\n                                        </a>\n                                    </div>\n                                </div>\n                            <?php endforeach; ?>\n                        <?php else: ?>\n                            <p style=\"color: #64748b; text-align: center; padding: 20px;\">\n                                ìµœê·¼ 7ì¼ê°„ ì™„ë£Œëœ ëŒ€íšŒê°€ ì—†ìŠµë‹ˆë‹¤\n                            </p>\n                        <?php endif; ?>\n                    </div>\n                </div>\n\n                <!-- ê³µì§€ì‚¬í•­ ìœ„ì ¯ -->\n                <div class=\"widget-card\">\n                    <div class=\"widget-header\">\n                        <h2 class=\"widget-title\">\n                            <span class=\"material-symbols-rounded widget-icon\">campaign</span>\n                            <?= t('widget_announcements') ?>\n                        </h2>\n                        <a href=\"/manage/\" class=\"widget-action\"><?= t('action_manage') ?></a>\n                    </div>\n                    \n                    <div class=\"widget-content\">\n                        <?php if (!empty($recent_notices)): ?>\n                            <?php foreach ($recent_notices as $notice): ?>\n                                <div class=\"notice-item\" style=\"margin-bottom: 16px; padding-bottom: 16px; border-bottom: 1px solid rgba(59, 130, 246, 0.1);\">\n                                    <div style=\"display: flex; align-items: flex-start; gap: 8px; margin-bottom: 8px;\">\n                                        <?php if ($notice['is_pinned']): ?>\n                                            <span class=\"material-symbols-rounded\" style=\"color: #f59e0b; font-size: 16px; margin-top: 2px;\">push_pin</span>\n                                        <?php endif; ?>\n                                        <div style=\"flex: 1;\">\n                                            <h4 style=\"color: #f1f5f9; font-size: 14px; font-weight: 600; margin: 0 0 4px 0; line-height: 1.4;\">\n                                                <?= htmlspecialchars($notice['title']) ?>\n                                            </h4>\n                                            <p style=\"color: #94a3b8; font-size: 12px; margin: 0 0 8px 0;\">\n                                                <?= date('Y-m-d', strtotime($notice['created_at'])) ?>\n                                            </p>\n                                        </div>\n                                    </div>\n                                    \n                                    <div style=\"color: #e2e8f0; font-size: 13px; line-height: 1.5;\">\n                                        <?php \n                                        $content = htmlspecialchars($notice['content']);\n                                        if (strlen($content) > 100) {\n                                            echo substr($content, 0, 100) . '...';\n                                        } else {\n                                            echo nl2br($content);\n                                        }\n                                        ?>\n                                    </div>\n                                    \n                                    <?php if ($notice['image_path']): ?>\n                                        <div style=\"margin-top: 8px;\">\n                                            <img src=\"/<?= $notice['image_path'] ?>\" alt=\"<?= htmlspecialchars($notice['title']) ?>\" \n                                                 style=\"max-width: 100%; height: auto; border-radius: 6px; max-height: 120px;\">\n                                        </div>\n                                    <?php endif; ?>\n                                </div>\n                            <?php endforeach; ?>\n                            \n                            <div style=\"text-align: center; margin-top: 16px;\">\n                                <a href=\"/manage/\" style=\"color: #3b82f6; text-decoration: none; font-size: 12px; display: inline-flex; align-items: center; gap: 4px;\">\n                                    <span class=\"material-symbols-rounded\" style=\"font-size: 14px;\">visibility</span>\n                                    <?= t('view_all_notices') ?>\n                                </a>\n                            </div>\n                        <?php else: ?>\n                            <div style=\"text-align: center; color: #64748b; padding: 20px;\">\n                                <span class=\"material-symbols-rounded\" style=\"font-size: 32px; margin-bottom: 8px; display: block; opacity: 0.5;\">campaign</span>\n                                <?= t('no_notices') ?>\n                            </div>\n                        <?php endif; ?>\n                    </div>\n                </div>\n\n                <!-- ì¼ì • ìœ„ì ¯ -->\n                <div class=\"widget-card\">\n                    <div class=\"widget-header\">\n                        <h2 class=\"widget-title\">\n                            <span class=\"material-symbols-rounded widget-icon\">calendar_month</span>\n                            <?= t('widget_schedule') ?>\n                        </h2>\n                        <a href=\"/manage/\" class=\"widget-action\"><?= t('action_edit') ?></a>\n                    </div>\n                    \n                    <div class=\"widget-content\">\n                        <div style=\"color: #94a3b8; line-height: 1.6; font-size: 14px;\">\n                            <?= $schedule_preview ?>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <!-- ì•¡ì…˜ ë²„íŠ¼ -->\n            <div class=\"action-buttons\">\n                <a href=\"/comp/\" class=\"btn btn-primary\">\n                    <span class=\"material-symbols-rounded\">add</span>\n                    <?= t('action_new_competition') ?>\n                </a>\n                <a href=\"/results/\" class=\"btn btn-secondary\">\n                    <span class=\"material-symbols-rounded\">visibility</span>\n                    <?= t('action_view_results') ?>\n                </a>\n                <a href=\"/manage/\" class=\"btn btn-secondary\">\n                    <span class=\"material-symbols-rounded\">tune</span>\n                    <?= t('action_settings') ?>\n                </a>\n            </div>\n        </main>\n    </div>\n\n    <script>\n        function toggleLanguageMenu() {\n            const menu = document.getElementById('languageMenu');\n            menu.classList.toggle('active');\n        }\n\n        // ì–¸ì–´ ë©”ë‰´ ì™¸ë¶€ í´ë¦­ì‹œ ë‹«ê¸°\n        document.addEventListener('click', function(event) {\n            const dropdown = document.querySelector('.language-dropdown');\n            const menu = document.getElementById('languageMenu');\n            \n            if (!dropdown.contains(event.target)) {\n                menu.classList.remove('active');\n            }\n        });\n    </script>\n</body>\n</html>","size_bytes":31404},"04_scripts/logo.py":{"content":"from PIL import Image, ImageDraw, ImageFont\n\n# ìº”ë²„ìŠ¤ ìƒì„±\nimg = Image.new('RGB', (220, 48), color='#222')\ndraw = ImageDraw.Draw(img)\n\n# í°íŠ¸ ê²½ë¡œ (ìœˆë„ìš°: 'arialbd.ttf', ë§¥: 'Arial Bold', ë˜ëŠ” NotoSansKR-Bold)\nfont_path = 'arialbd.ttf'  # ì‹œìŠ¤í…œì— ë”°ë¼ ë³€ê²½\nfont = ImageFont.truetype(font_path, 32)\n\n# \"Dance\" ê·¸ë¦°\ndraw.text((18, 6), \"Dance\", font=font, fill='#03C75A')\n\n# \"office\" í°ìƒ‰\ndraw.text((120, 6), \"office\", font=font, fill='#FFFFFF')\n\n# ì €ì¥\nimg.save('danceoffice-logo.png')","size_bytes":514},"04_scripts/sync_recall.py":{"content":"import os\nimport time\nimport shutil\nimport re\n\nsrc_web = r\"C:\\dancescore\\Web\"\ndst_web = r\"Y:\\results\"\nsrc_recall_file = r\"C:\\dancescore\\Recall\\index.php\"\ndst_recall_file = r\"Y:\\Recall\\index.php\"\nCHECK_INTERVAL = 2\n\ndef replace_content(content):\n    # 1. Tagë¥¼ ë“±ë²ˆí˜¸ë¡œ ì¹˜í™˜\n    content = re.sub(r\"\\btag\\b\", \"ë“±ë²ˆí˜¸\", content, flags=re.IGNORECASE)\n    # 2. í…ìŠ¤íŠ¸ í…Œì´ë¸” í—¤ë”ì— ë“±ìœ„ ì¶”ê°€ (Recall index.phpê°€ í…ìŠ¤íŠ¸ í…Œì´ë¸”ì¸ ê²½ìš°)\n    content = re.sub(r\"^(ë“±ë²ˆí˜¸\\s+\\S+\\s+\\S+)\", r\"ë“±ìœ„\\t\\1\", content, flags=re.MULTILINE)\n    # 3. HTML í…Œì´ë¸” í—¤ë”ì— ë“±ìœ„ ì¶”ê°€ (Recall index.phpê°€ HTML í…Œì´ë¸”ì¸ ê²½ìš°)\n    content = re.sub(r\"(<th[^>]*?>\\s*)</th>\", r\"\\1ë“±ìœ„</th>\", content, count=1, flags=re.IGNORECASE)\n    # 4. ê²½ê¸° ì§„ì¶œ ì¹˜í™˜\n    content = re.sub(r\"Recalled\\s+(\\d+)\\s+Couples\\s+to\\s+Item\\s+(\\d+)\", r\"\\1ì»¤í”Œì´ \\2ë²ˆ ì´ë²¤íŠ¸ë¡œ ì§„ì¶œí•©ë‹ˆë‹¤.\", content)\n    content = re.sub(r\"Recalled\\s+(\\d+)\\s+Couples\\s+to\\s+(\\d+)\", r\"\\1ì»¤í”Œì´ \\2ë²ˆ ì´ë²¤íŠ¸ë¡œ ì§„ì¶œí•©ë‹ˆë‹¤.\", content)\n    # 5. ê¸°íƒ€ ë¼ë²¨ ì¹˜í™˜\n    content = re.sub(r\"Adjudicators\", \"ì‹¬ì‚¬ìœ„ì›\", content)\n    content = re.sub(r\"Marks\", \"ë“ì \", content)\n    content = re.sub(r\"Description\", \"ë¶€ë¬¸\", content)\n    # 6. Results Copyright of ì‚­ì œ\n    content = re.sub(r\"Results Copyright of\", \"\", content, flags=re.IGNORECASE)\n    # 7. DanceSportLive ë¬¸êµ¬/ë§í¬ ì‚­ì œ\n    content = re.sub(r'<a[^>]*?>\\s*DanceSportLive[^<]*</a>', '', content, flags=re.IGNORECASE)\n    content = re.sub(r'DanceSportLive', '', content, flags=re.IGNORECASE)\n    # 8. ë¶ˆí•„ìš”í•œ ë¬¸êµ¬/ë§í¬/ì €ì‘ê¶Œ ì œê±°\n    content = re.sub(r'<a[^>]*?>\\s*DanceScore Scrutineering Software\\s*</a>', '', content, flags=re.IGNORECASE)\n    content = re.sub(r'DanceScore Scrutineering Software', '', content, flags=re.IGNORECASE)\n    content = re.sub(r'<a[^>]*?>\\s*DanceScore\\s*</a>', '', content, flags=re.IGNORECASE)\n    content = re.sub(r'<a[^>]*?>\\s*DanceSportLive\\.net\\s*</a>', '', content, flags=re.IGNORECASE)\n    content = re.sub(r'Â©\\s*DanceScore\\s*-\\s*DanceSportLive\\.net\\s*V7-5-00', '', content, flags=re.IGNORECASE)\n    content = re.sub(r'DanceScore\\s*-\\s*DanceSportLive\\.net\\s*V7-5-00', '', content, flags=re.IGNORECASE)\n    content = re.sub(r'DanceScoreLive\\.net', '', content, flags=re.IGNORECASE)\n    # 9. \"Â© - V7-5-00\" ì‚­ì œ\n    content = re.sub(r'Â©\\s*-\\s*V7-5-00', '', content, flags=re.IGNORECASE)\n    # 10. Home ë§í¬ ë³€ê²½\n    content = re.sub(r\"<a\\s+href=[\\'\\\"]?(\\.\\./)?index\\.html[\\'\\\"]?\\s*>Home\\s*</a>\",\n                     r'<a href=\"https://www.danceoffice.net/results/\">Home</a>', content, flags=re.IGNORECASE)\n    content = re.sub(r\"<a\\s+href=[\\'\\\"]?(\\.\\./)?index\\.php[\\'\\\"]?\\s*>Home\\s*</a>\",\n                     r'<a href=\"https://www.danceoffice.net/results/\">Home</a>', content, flags=re.IGNORECASE)\n    content = re.sub(r\"<a\\s+href=[\\'\\\"]?.*?home.*?[\\'\\\"]?\\s*>Home\\s*</a>\",\n                     r'<a href=\"https://www.danceoffice.net/results/\">Home</a>', content, flags=re.IGNORECASE)\n    return content\n\ndef convert_and_copy(src_file, dst_file):\n    try:\n        with open(src_file, \"rb\") as f:\n            raw = f.read()\n        # ì¸ì½”ë”© ìë™ ê°ì§€ ë° ë³€í™˜\n        if raw.startswith(b'\\xff\\xfe'):\n            text = raw.decode('utf-16le', errors='ignore')\n        elif raw.startswith(b'\\xfe\\xff'):\n            text = raw.decode('utf-16be', errors='ignore')\n        elif raw.startswith(b'\\xef\\xbb\\xbf'):\n            text = raw.decode('utf-8-sig', errors='ignore')\n        else:\n            try:\n                text = raw.decode('utf-8')\n            except:\n                try:\n                    text = raw.decode('euc-kr')\n                except:\n                    text = raw.decode('cp949', errors='ignore')\n        new_content = replace_content(text)\n        ensure_dir_exists(dst_file)\n        with open(dst_file, \"w\", encoding=\"utf-8\") as f:\n            f.write(new_content)\n        shutil.copystat(src_file, dst_file)  # mtime ë§ì¶¤\n        print(f\"[ì¹˜í™˜/ë³µì‚¬] {src_file} â†’ {dst_file}\")\n    except Exception as e:\n        print(f\"[ì¹˜í™˜/ë³µì‚¬ ì‹¤íŒ¨] {src_file} â†’ {dst_file}: {e}\")\n\ndef copy_file_with_rules(src_file, dst_file, rel_dir, fname):\n    ext = os.path.splitext(fname)[1].lower()\n    # ì„ì‹œ íŒŒì¼(.tmp)ì€ ê±´ë„ˆëœ€\n    if fname.lower().endswith('.tmp'):\n        print(f\"[ê±´ë„ˆëœ€] {src_file} (ì„ì‹œ íŒŒì¼)\")\n        return\n    # results index.phpëŠ” ê±´ë„ˆëœ€(ìœ ì§€)\n    if rel_dir == '.' and fname == \"index.php\":\n        print(f\"[ê±´ë„ˆëœ€] {src_file} (index.phpëŠ” ìœ ì§€)\")\n        return\n    # í…ìŠ¤íŠ¸ íŒŒì¼ì€ ì¹˜í™˜ ë³µì‚¬\n    if ext in [\".html\", \".htm\", \".txt\", \".php\"]:\n        convert_and_copy(src_file, dst_file)\n    else:\n        ensure_dir_exists(dst_file)\n        try:\n            shutil.copy2(src_file, dst_file)\n            shutil.copystat(src_file, dst_file)  # mtime ë§ì¶¤\n            print(f\"[ì¼ë°˜ë³µì‚¬] {src_file} â†’ {dst_file}\")\n        except Exception as e:\n            print(f\"[ë³µì‚¬ ì‹¤íŒ¨] {src_file} â†’ {dst_file}: {e}\")\n\ndef ensure_dir_exists(path):\n    dirname = os.path.dirname(path)\n    if dirname and not os.path.exists(dirname):\n        os.makedirs(dirname, exist_ok=True)\n\ndef scan_files(base_dir):\n    file_map = {}\n    for root, dirs, files in os.walk(base_dir):\n        for fname in files:\n            # ì„ì‹œ íŒŒì¼(.tmp)ì€ ì œì™¸\n            if fname.lower().endswith('.tmp'):\n                continue\n            fpath = os.path.join(root, fname)\n            try:\n                mtime = os.path.getmtime(fpath)\n                rel_dir = os.path.relpath(root, base_dir)\n                rel_path = os.path.join(rel_dir, fname) if rel_dir != \".\" else fname\n                file_map[rel_path] = (mtime, os.path.getsize(fpath))\n            except Exception:\n                pass\n    return file_map\n\ndef sync_web_folder(prev_web_files):\n    curr_web_files = scan_files(src_web)\n    for rel_path, (mtime, size) in curr_web_files.items():\n        src_file = os.path.join(src_web, rel_path)\n        dst_file = os.path.join(dst_web, rel_path)\n        rel_dir = os.path.dirname(rel_path)\n        fname = os.path.basename(rel_path)\n        # ìƒˆ íŒŒì¼/ë³€ê²½ íŒŒì¼ë§Œ ë³µì‚¬\n        if (rel_path not in prev_web_files or\n            prev_web_files[rel_path] != (mtime, size)):\n            copy_file_with_rules(src_file, dst_file, rel_dir, fname)\n    return curr_web_files\n\ndef sync_recall_index(prev_recall_mtime):\n    # Recall index.phpëŠ” í•­ìƒ ì¹˜í™˜ ë³µì‚¬\n    if os.path.exists(src_recall_file):\n        recall_mtime = os.path.getmtime(src_recall_file)\n        if prev_recall_mtime != recall_mtime:\n            convert_and_copy(src_recall_file, dst_recall_file)\n        return recall_mtime\n    else:\n        print(f\"[Recall index.php ì—†ìŒ] {src_recall_file}\")\n        return prev_recall_mtime\n\ndef main():\n    print(\"ì‹¤ì‹œê°„ Web/Recall í´ë” ê°ì‹œ + íŠ¸ë¦¬ìœ ì§€ ë³µì‚¬ ì‹œì‘...\")\n    prev_web_files = scan_files(src_web)\n    prev_recall_mtime = None\n    while True:\n        prev_web_files = sync_web_folder(prev_web_files)\n        prev_recall_mtime = sync_recall_index(prev_recall_mtime)\n        time.sleep(CHECK_INTERVAL)\n\nif __name__ == \"__main__\":\n    main()","size_bytes":7209},"assets/contest.css":{"content":"/* í”„ë¦¬ìŠ¤íƒ€ì¼ ì±„ì  ì‹œìŠ¤í…œ ìŠ¤íƒ€ì¼ */\ninput[type=\"text\"], input[type=\"password\"], select, textarea {\n    background: #1E2126;\n    color: #F5F7FA;\n    border: 1px solid #31343a;\n    border-radius: 10px;\n    padding: 0.6em 0.8em;\n    font-size: 1em;\n    transition: border-color 0.2s, box-shadow 0.2s;\n}\n\ninput[type=\"text\"]:focus, input[type=\"password\"]:focus, select:focus, textarea:focus {\n    outline: none;\n    border-color: #03C75A;\n    box-shadow: 0 0 0 2px rgba(3,199,90,0.2);\n}\n\ntable {\n    width: 100%;\n    border-collapse: collapse;\n    margin: 1em 0;\n}\n\nth, td {\n    padding: 0.7em 0.5em;\n    border-bottom: 1px solid #31343a;\n    text-align: left;\n}\n\nth {\n    background: #181B20;\n    color: #03C75A;\n    font-weight: 700;\n}\n\ntd {\n    color: #F5F7FA;\n}\n\ntr:last-child td {\n    border-bottom: none;\n}\n\n/* ìˆ«ì ì •ë ¬ */\ntd[style*=\"text-align:right\"] {\n    text-align: right !important;\n}\n\n/* ë°°ì§€ ìŠ¤íƒ€ì¼ */\n.badge {\n    display: inline-block;\n    padding: 0.2em 0.6em;\n    border-radius: 8px;\n    background: #2a2d31;\n    font-size: 0.9em;\n    color: #cfe8da;\n    font-weight: 500;\n}\n\n/* ëª¨ë‹¬ íŒ¨ë„ */\n.modal {\n    position: fixed;\n    inset: 0;\n    background: rgba(0,0,0,0.55);\n    display: none;\n    align-items: center;\n    justify-content: center;\n    z-index: 1000;\n}\n\n.modal .panel {\n    background: #1E2126;\n    border: 1px solid #31343a;\n    border-radius: 12px;\n    padding: 1.5em;\n    width: min(520px, 95vw);\n    box-shadow: 0 6px 28px rgba(0,0,0,0.35);\n}\n\n/* ì ìˆ˜ ì„ íƒ ê·¸ë¦¬ë“œ */\n.grid {\n    display: grid;\n    grid-template-columns: repeat(5, 1fr);\n    gap: 8px;\n    margin: 1em 0;\n}\n\n.grid button {\n    padding: 0.6em;\n    border-radius: 10px;\n    border: 1px solid #31343a;\n    background: #222;\n    color: #F5F7FA;\n    cursor: pointer;\n    transition: background 0.15s, color 0.15s, box-shadow 0.15s;\n    font-size: 0.95em;\n}\n\n.grid button:hover {\n    background: #262a30;\n    box-shadow: 0 2px 8px rgba(3,199,90,0.18);\n}\n\n.grid button.active {\n    background: #03C75A;\n    color: #222;\n    font-weight: 700;\n    box-shadow: 0 2px 8px rgba(3,199,90,0.3);\n}\n\n/* ì œì¶œëœ í–‰ í•˜ì´ë¼ì´íŠ¸ */\n.tr-submitted {\n    background: #1f2a22 !important;\n}\n\n/* ìë™ ì €ì¥ ì¸ë””ì¼€ì´í„° */\n#autosave-ind {\n    display: none;\n    margin-top: 0.8em;\n    color: #03C75A;\n    font-size: 0.95em;\n    text-align: center;\n    align-items: center;\n    gap: 0.4em;\n    justify-content: center;\n}\n\n#autosave-ind .material-symbols-rounded {\n    font-size: 1.2em;\n    vertical-align: middle;\n}\n\n/* ë°˜ì‘í˜• */\n@media (max-width: 700px) {\n    .grid {\n        grid-template-columns: repeat(3, 1fr);\n    }\n    \n    .modal .panel {\n        padding: 1em;\n        margin: 1em;\n    }\n    \n    table {\n        font-size: 0.9em;\n    }\n    \n    th, td {\n        padding: 0.5em 0.3em;\n    }\n}\n\n@media (max-width: 480px) {\n    .grid {\n        grid-template-columns: repeat(2, 1fr);\n    }\n    \n    table {\n        font-size: 0.8em;\n    }\n}","size_bytes":2963},"assets/style.css":{"content":"@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap');\n@import url('https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded');\n\n/* ========================================\n   ê¸°ë³¸ ì„¤ì •\n======================================== */\nhtml, body {\n    width: 100vw;\n    min-width: 100vw;\n    max-width: 100vw;\n    height: 100%;\n    min-height: 100vh;\n    overflow-x: hidden;\n}\nbody {\n    font-family: 'Noto Sans KR', 'Inter', 'Arial', sans-serif;\n    background: #181B20;\n    margin: 0;\n    padding: 0;\n    color: #F5F7FA;\n    font-size: 14px;\n    line-height: 1.5;\n}\n\n/* ========================================\n   í—¤ë”\n======================================== */\n.main-header {\n    background: #1a1d21;\n    color: #fff;\n    padding: 0 0 1.2em 0;\n    text-align: center;\n    box-shadow: 0 2px 14px rgba(0,0,0,0.19);\n    border-bottom: 2px solid #03C75A;\n}\n.logo-nav {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 0.7em;\n}\n.main-logo {\n    height: 70px;\n    margin-top: 1.2em;\n    border-radius: 16px;\n    box-shadow: 0 2px 10px rgba(3,199,90,0.08);\n}\n.main-nav {\n    display: flex;\n    gap: 1.2em;\n    margin: 0.5em 0;\n    justify-content: center;\n    flex-wrap: wrap;\n}\n.main-nav a {\n    color: #fff;\n    background: transparent;\n    text-decoration: none;\n    font-weight: 600;\n    font-size: 14px;\n    padding: 10px 20px;\n    border-radius: 16px;\n    transition: background 0.2s, color 0.2s;\n    min-width: 0;\n    white-space: nowrap;\n}\n.main-nav a:hover, .main-nav a.active {\n    background: #03C75A;\n    color: #222;\n}\n\n/* ========================================\n   ê´‘ê³  ì˜ì—­\n======================================== */\n.ad-top {text-align:center; margin-bottom:1em;}\n.ad-side {position:fixed; top:100px; width:160px;}\n.ad-left {left:0;}\n.ad-right {right:0;}\n.ad-bottom {text-align:center; margin-top:2em;}\n@media (max-width: 900px) {\n    .ad-side {display:none;}\n}\n\n/* ========================================\n   ë©”ì¸ ì˜ì—­ (PC)\n======================================== */\nmain {\n    max-width: 1200px;\n    margin: 20px auto;\n    background: #222;\n    padding: 25px;\n    border-radius: 15px;\n    box-shadow: 0 8px 25px rgba(0,0,0,0.15);\n    width: 100%;\n    box-sizing: border-box;\n    font-size: 14px;\n}\n\n/* ========================================\n   ì¹´ë“œí˜• ì •ë³´ ì„¹ì…˜\n======================================== */\n.info-section {\n    margin-bottom: 2em;\n}\n.info-cards {\n    display: flex;\n    gap: 2em;\n    flex-wrap: wrap;\n    justify-content: center;\n}\n.info-card {\n    background: #181B20;\n    border-radius: 15px;\n    box-shadow: 0 4px 12px rgba(3,199,90,0.08);\n    padding: 20px;\n    width: 320px;\n    min-width: 280px;\n    max-width: 360px;\n    display: flex;\n    flex-direction: column;\n    align-items: flex-start;\n    margin-bottom: 15px;\n    position: relative;\n    font-size: 14px;\n}\n.card-icon {\n    font-family: 'Material Symbols Rounded';\n    font-size: 36px;\n    color: #00BFAE;\n    position: absolute;\n    top: 15px;\n    right: 15px;\n    opacity: 0.21;\n    pointer-events: none;\n}\n.info-card h2 {\n    font-size: 18px;\n    color: #03C75A;\n    margin-bottom: 15px;\n    margin-top: 5px;\n    font-weight: 700;\n}\n.notice-preview, .schedule-preview {\n    background: #222;\n    border-radius: 12px;\n    padding: 15px;\n    margin-bottom: 15px;\n    font-size: 13px;\n    color: #F5F7FA;\n    border: 1px solid #31343a;\n    box-shadow: 0 4px 12px rgba(3,199,90,0.08);\n    min-height: 80px;\n    line-height: 1.4;\n}\n.notice-preview strong, .schedule-preview strong {\n    color: #03C75A;\n    font-weight: 700;\n}\n.notice-preview a, .schedule-preview a {\n    color: #00BFAE;\n    text-decoration: underline;\n    word-break: break-all;\n}\n.notice-preview a:hover, .schedule-preview a:hover {\n    color: #03C75A;\n    text-decoration: underline;\n}\n\n/* ========================================\n   ê²½ê¸° ê²°ê³¼ ì„¹ì…˜\n======================================== */\n.results-section {\n    background: #1E2126;\n    box-shadow: 0 4px 12px rgba(3,199,90,0.08);\n    border-radius: 15px;\n    padding: 25px;\n    margin-bottom: 20px;\n    text-align: center;\n    font-size: 14px;\n}\n.results-section h2 {\n    font-size: 20px;\n    color: #03C75A;\n    margin-bottom: 20px;\n    font-weight: 700;\n    display: flex;\n    align-items: center;\n    gap: 12px;\n    justify-content: center;\n}\n.results-cta {\n    margin-top: 0.8em;\n}\n\n/* ========================================\n   ê´‘ê³  ë° ì´ë²¤íŠ¸ ì„¹ì…˜\n======================================== */\n.ad-section {\n    background: #1E2126;\n    box-shadow: 0 4px 12px rgba(3,199,90,0.08);\n    border-radius: 15px;\n    padding: 25px;\n    margin-bottom: 20px;\n    text-align: center;\n}\n.ad-section h2 {\n    font-size: 18px;\n    color: #00BFAE;\n    margin-bottom: 20px;\n    font-weight: 700;\n    display: flex;\n    align-items: center;\n    gap: 12px;\n    justify-content: center;\n}\n.ad-main {\n    margin-top: 1em;\n}\n\n/* ========================================\n   ë²„íŠ¼\n======================================== */\na.button {\n    display: inline-block;\n    background: linear-gradient(90deg, #03C75A 70%, #00BFAE 100%);\n    color: #222;\n    padding: 12px 24px;\n    border-radius: 20px;\n    font-weight: bold;\n    text-decoration: none;\n    font-size: 13px;\n    margin-top: 10px;\n    box-shadow: 0 4px 12px rgba(3,199,90,0.15);\n    transition: background 0.2s, box-shadow 0.2s, color 0.2s;\n    border: none;\n    white-space: nowrap;\n    word-break: normal;\n    min-width: 120px;\n    text-align: center;\n}\na.button:hover {\n    background: linear-gradient(90deg, #00BFAE 60%, #03C75A 100%);\n    color: #fff;\n    box-shadow: 0 4px 12px rgba(3,199,90,0.24);\n}\n\n/* ========================================\n   í‘¸í„°\n======================================== */\n.main-footer {\n    text-align: center;\n    background: #222;\n    padding: 20px;\n    color: #03C75A;\n    font-size: 13px;\n    margin-top: 20px;\n    border-radius: 15px;\n    box-shadow: 0 4px 12px rgba(3,199,90,0.08);\n}\n\n/* ========================================\n   ì´ë¯¸ì§€\n======================================== */\nimg {\n    border-radius: 12px;\n    max-width: 100%;\n    margin-top: 0.7em;\n    box-shadow: 0 2px 8px rgba(3,199,90,0.08);\n}\n\n/* ========================================\n   ê²°ê³¼ í‘œ, ìš”ì•½ í‘œ\n======================================== */\n.summary-table,\n.score-table {\n    font-size: clamp(1em, 2.8vw, 1.2em);\n}\n\n/* ========================================\n   ëŒ€íšŒëª…/ê²°ê³¼ íƒ€ì´í‹€\n======================================== */\n.result-title,\n.comp-title {\n    font-size: clamp(1.4em, 5vw, 2em);\n    font-weight: 700;\n}\n\n/* ========================================\n   ë¨¸í‹°ë¦¬ì–¼ ì•„ì´ì½˜\n======================================== */\n.material-symbols-rounded {\n    font-family: 'Material Symbols Rounded';\n    font-weight: normal;\n    font-style: normal;\n    font-size: 1.4em;\n    line-height: 1;\n    letter-spacing: normal;\n    text-transform: none;\n    display: inline-block;\n    white-space: nowrap;\n    direction: ltr;\n    vertical-align: middle;\n    -webkit-font-feature-settings: 'liga';\n    -webkit-font-smoothing: antialiased;\n}\n\n/* ========================================\n   ì‹¤ì‹œê°„ ê²°ê³¼ ì•ˆë‚´ ë¬¸êµ¬ ìŠ¤íƒ€ì¼\n======================================== */\n.result-desc {\n    text-align: center;\n    margin: 0.7em 0 1.2em 0;\n    font-size: clamp(1.07em, 3vw, 1.2em);\n    color: #00BFAE;\n    font-weight: 500;\n}\n\n.result-desc a {\n    color: #03C75A;\n    text-decoration: underline;\n    font-weight: bold;\n}\n\n.result-refresh {\n    margin-top: 1.3em;\n    color: #03C75A;\n    font-size: clamp(0.99em, 2.5vw, 1.1em);\n    text-align: center;\n    display: flex;\n    align-items: center;\n    gap: 0.4em;\n    justify-content: center;\n}\n\n.result-refresh .material-symbols-rounded {\n    font-size: 1.2em;\n    vertical-align: middle;\n}\n\n/* ========================================\n   ê²°ê³¼ ì—ëŸ¬ ë©”ì‹œì§€\n======================================== */\n.result-error {\n    background: #2a2d31;\n    color: #ff5e5e;\n    border-radius: 7px;\n    padding: 1.2em 1.2em;\n    margin: 1em 0;\n    font-size: clamp(1.1em, 3vw, 1.25em);\n    display: flex;\n    align-items: center;\n    gap: 0.7em;\n    font-weight: 600;\n}\n\n.result-area .material-symbols-rounded,\n.result-error .material-symbols-rounded {\n    font-size: 1.4em;\n    vertical-align: middle;\n}\n\n/* ========================================\n   ëª¨ë°”ì¼ ì™„ì „ ë¶„ë¦¬ ë ˆì´ì•„ì›ƒ ë° ë©”ë‰´ ê°œì„ \n======================================== */\n@media (max-width: 700px) {\n    html, body {\n        width: 100vw;\n        min-width: 100vw;\n        max-width: 100vw;\n        overflow-x: hidden;\n    }\n    body {\n        font-size: clamp(1.2em, 4vw, 1.7em);\n        line-height: 1.7;\n        background: #181B20;\n    }\n    main {\n        width: 100vw !important;\n        min-width: 100vw !important;\n        max-width: 100vw !important;\n        margin: 0 !important;\n        padding: 0 !important;\n        border-radius: 0 !important;\n        box-shadow: none !important;\n        background: #181B20 !important;\n    }\n    .info-section {\n        width: 100vw !important;\n        min-width: 100vw !important;\n        max-width: 100vw !important;\n        margin: 0 !important;\n        padding: 0 !important;\n        border-radius: 0 !important;\n        box-shadow: none !important;\n        background: #181B20 !important;\n    }\n    .info-cards {\n        flex-direction: column;\n        gap: 1.2em;\n        padding: 0 !important;\n        margin: 0 !important;\n        width: 100vw !important;\n        min-width: 100vw !important;\n        max-width: 100vw !important;\n    }\n    .info-card {\n        width: 100vw !important;\n        min-width: 100vw !important;\n        max-width: 100vw !important;\n        margin: 0 !important;\n        border-radius: 0 !important;\n        box-shadow: none !important;\n        padding: 1.2em 0.7em 1.2em 0.7em !important;\n        background: #181B20 !important;\n        align-items: stretch !important;\n    }\n    .main-nav {\n        gap: 0.3em !important;\n        flex-wrap: nowrap !important;\n        justify-content: space-between !important;\n        padding: 0 0.5em !important;\n    }\n    .main-nav a {\n        font-size: 1.1em !important;\n        padding: 0.4em 0.6em !important;\n        min-width: unset !important;\n        width: auto !important;\n        white-space: nowrap !important;\n        flex: 1 1 auto !important;\n    }\n    .main-footer {\n        padding-left: 0.5em;\n        padding-right: 0.5em;\n        border-radius: 0;\n        font-size: 1.1em;\n    }\n    .info-card,\n    .results-section,\n    .summary-table,\n    .score-table {\n        font-size: clamp(1.15em, 3vw, 1.3em) !important;\n    }\n    .result-title, .comp-title {\n        font-size: clamp(1.5em, 6vw, 2.4em) !important;\n    }\n    a.button {\n        font-size: clamp(1.2em, 4vw, 1.35em) !important;\n        padding: 1em 2em !important;\n        white-space: nowrap !important;\n        word-break: normal !important;\n        min-width: 120px !important;\n        text-align: center !important;\n    }\n    .info-section, .results-section, .ad-section {\n        margin-bottom: 1em !important;\n    }\n    /* ëª¨ë°”ì¼ì—ì„œ í…Œì´ë¸” ë‚´ìš© ì¢Œìš° ìŠ¤í¬ë¡¤ í—ˆìš© */\n    .score-table, .summary-table {\n        display: block;\n        overflow-x: auto;\n        white-space: nowrap;\n    }\n    /* ëª¨ë°”ì¼ì—ì„œ í° ê·¸ë¦¼/ë¡œê³  ë” ì‘ê²Œ */\n    .main-logo {\n        height: 48px;\n        margin-top: 0.7em;\n    }\n}","size_bytes":11464},"comp/README_ê²°ê³¼ëª¨ë‹ˆí„°ë§.md":{"content":"# ëŒ„ìŠ¤ìŠ¤ì½”ì–´ ê²°ê³¼ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ\n\n## ê°œìš”\nëŒ„ìŠ¤ìŠ¤ì½”ì–´ì—ì„œ ìƒì„±ë˜ëŠ” ìš”ì•½ íŒŒì¼(`ìˆ«ì.html`)ê³¼ ìƒì„¸ íŒŒì¼(`ìˆ«ì-d.html`)ì„ ìë™ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§í•˜ê³ , ë‘ íŒŒì¼ì„ í•©ì³ì„œ ì¢…í•© ê²°ê³¼ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ìŠ¤í¬ë¦°ì— í‘œì‹œí•˜ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤.\n\n## ì£¼ìš” ê¸°ëŠ¥\n- ğŸ” **ì‹¤ì‹œê°„ íŒŒì¼ ëª¨ë‹ˆí„°ë§**: ê²°ê³¼ ë””ë ‰í† ë¦¬ë¥¼ ì§€ì†ì ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§\n- ğŸ“Š **ìë™ ê²°ê³¼ ì²˜ë¦¬**: ìƒˆ íŒŒì¼ì´ ìƒì„±ë˜ë©´ ìë™ìœ¼ë¡œ ì¢…í•© ê²°ê³¼ ìƒì„±\n- ğŸ–¥ï¸ **ì „ì²´í™”ë©´ ëª¨ë‹ˆí„°ë§**: ì´ë²¤íŠ¸ ê·¸ë£¹ë³„ ëŒ€ê¸°í™”ë©´ ë° ê²°ê³¼ í‘œì‹œ\n- ğŸ“± **ì›¹ ëŒ€ì‹œë³´ë“œ**: ëª¨ë‹ˆí„°ë§ ìƒíƒœ ë° ë¡œê·¸ í™•ì¸\n- âš¡ **ìë™ ìƒˆë¡œê³ ì¹¨**: 30ì´ˆë§ˆë‹¤ ìë™ìœ¼ë¡œ ê²°ê³¼ ì—…ë°ì´íŠ¸\n- ğŸ¯ **ì´ë²¤íŠ¸ ì œì–´**: ì‹¤ì‹œê°„ìœ¼ë¡œ ì´ë²¤íŠ¸ ìƒíƒœ ë° ê²°ê³¼ ë°œí‘œ ì œì–´\n\n## íŒŒì¼ êµ¬ì¡°\n```\ncomp/\nâ”œâ”€â”€ result_monitor.php      # í•µì‹¬ ëª¨ë‹ˆí„°ë§ í´ë˜ìŠ¤\nâ”œâ”€â”€ result_dashboard.php    # ì›¹ ëŒ€ì‹œë³´ë“œ\nâ”œâ”€â”€ result_watcher.php      # ë°±ê·¸ë¼ìš´ë“œ ëª¨ë‹ˆí„°ë§ ìŠ¤í¬ë¦½íŠ¸\nâ”œâ”€â”€ monitor_control.php     # ëª¨ë‹ˆí„°ë§ ì œì–´ í˜ì´ì§€\nâ”œâ”€â”€ event_monitor_v2.php    # ì „ì²´í™”ë©´ ì´ë²¤íŠ¸ ëª¨ë‹ˆí„°ë§ (v2)\nâ”œâ”€â”€ event_upload.php        # ì´ë²¤íŠ¸ ìˆœì„œ ì—…ë¡œë“œ\nâ”œâ”€â”€ event_control_panel.php # ì´ë²¤íŠ¸ ì œì–´ íŒ¨ë„\nâ”œâ”€â”€ competition_settings.php # ëŒ€íšŒ ì„¤ì •\nâ”œâ”€â”€ start_monitoring.bat    # Windows ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸\nâ””â”€â”€ README_ê²°ê³¼ëª¨ë‹ˆí„°ë§.md  # ì´ íŒŒì¼\n```\n\n## ì„¤ì¹˜ ë° ì„¤ì •\n\n### 1. ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­\n- PHP 7.4 ì´ìƒ\n- Windows ìš´ì˜ì²´ì œ\n- ëŒ„ìŠ¤ìŠ¤ì½”ì–´ê°€ ì„¤ì¹˜ëœ í™˜ê²½\n\n### 2. ë””ë ‰í† ë¦¬ ì„¤ì •\n```php\n// result_monitor.phpì—ì„œ ê²°ê³¼ ë””ë ‰í† ë¦¬ ê²½ë¡œ ì„¤ì •\nprivate $resultsPath = \"Y:/results\";\n```\n\n### 3. ì›¹ ì„œë²„ ì„¤ì •\n- Apache ë˜ëŠ” IISì—ì„œ PHP ì‹¤í–‰ í™˜ê²½ êµ¬ì„±\n- `comp` ë””ë ‰í† ë¦¬ë¥¼ ì›¹ ë£¨íŠ¸ì— ë°°ì¹˜\n\n## ì‚¬ìš©ë²•\n\n### ë°©ë²• 1: ì›¹ ì¸í„°í˜ì´ìŠ¤ ì‚¬ìš© (ê¶Œì¥)\n\n1. **ëª¨ë‹ˆí„°ë§ ì œì–´ í˜ì´ì§€ ì ‘ì†**\n   ```\n   http://localhost/comp/monitor_control.php\n   ```\n\n2. **í…ŒìŠ¤íŠ¸ í˜ì´ì§€ë¡œ í˜„ì¬ íŒŒì¼ í™•ì¸**\n   - \"í…ŒìŠ¤íŠ¸ í˜ì´ì§€\" ë²„íŠ¼ í´ë¦­\n   - Y:/results í´ë”ì˜ ê¸°ì¡´ íŒŒì¼ë“¤ ë¶„ì„ ë° í…ŒìŠ¤íŠ¸\n\n3. **ëª¨ë‹ˆí„°ë§ ì‹œì‘**\n   - \"ëª¨ë‹ˆí„°ë§ ì‹œì‘\" ë²„íŠ¼ í´ë¦­\n   - Y:/results í´ë”ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§ ì‹œì‘\n\n4. **ì „ì²´í™”ë©´ ëª¨ë‹ˆí„°ë§**\n   - \"ì „ì²´í™”ë©´ ëª¨ë‹ˆí„°\" ë²„íŠ¼ í´ë¦­\n   - **ì„ ìˆ˜ë“¤ì´ ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ìˆëŠ” ì „ì²´í™”ë©´ ëª¨ë‹ˆí„°**\n   - ìë™ ìˆœí™˜ìœ¼ë¡œ ëª¨ë“  ê²°ê³¼ í‘œì‹œ\n   - ëŒ€ê¸°í™”ë©´, ë¡œê³  í™”ë©´, ê²°ê³¼ í™”ë©´ ì „í™˜ ê°€ëŠ¥\n\n5. **ëŒ€ì‹œë³´ë“œ ì—´ê¸°**\n   - \"ëŒ€ì‹œë³´ë“œ ì—´ê¸°\" ë²„íŠ¼ í´ë¦­\n   - ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ ìƒíƒœ ë° ê²°ê³¼ í™•ì¸\n\n6. **ì¢…í•© ê²°ê³¼ ë³´ê¸°**\n   - ëŒ€ì‹œë³´ë“œì—ì„œ \"ì „ì²´í™”ë©´\" ë²„íŠ¼ í´ë¦­\n   - ë˜ëŠ” `combined_result_ì´ë²¤íŠ¸ID.html` íŒŒì¼ ì§ì ‘ ì ‘ì†\n\n### ë°©ë²• 2: ëª…ë ¹ì¤„ ì‚¬ìš©\n\n1. **Windows ë°°ì¹˜ íŒŒì¼ ì‹¤í–‰**\n   ```cmd\n   start_monitoring.bat\n   ```\n\n2. **PHP ì§ì ‘ ì‹¤í–‰**\n   ```cmd\n   php result_watcher.php\n   ```\n\n### ë°©ë²• 3: ìˆ˜ë™ ê²°ê³¼ ì²˜ë¦¬\n\n1. **ëŒ€ì‹œë³´ë“œ ì ‘ì†**\n   ```\n   http://localhost/comp/result_dashboard.php\n   ```\n\n2. **ê²°ê³¼ ì²˜ë¦¬**\n   - \"ëª¨ë“  ê²°ê³¼ ì²˜ë¦¬\" ë²„íŠ¼ í´ë¦­\n   - ê¸°ì¡´ íŒŒì¼ë“¤ì„ ì¼ê´„ ì²˜ë¦¬\n\n## ê²°ê³¼ íŒŒì¼ í˜•ì‹\n\n### ì…ë ¥ íŒŒì¼\n- **ìš”ì•½ íŒŒì¼**: `83.html` - ìµœì¢… ìˆœìœ„ì™€ ì ìˆ˜\n- **ìƒì„¸ íŒŒì¼**: `83-d.html` - ëŒ„ìŠ¤ë³„ ìƒì„¸ ì ìˆ˜\n\n### ì¶œë ¥ íŒŒì¼\n- **ì¢…í•© ê²°ê³¼**: `combined_result_83.html` - ë‘ íŒŒì¼ì„ í•©ì¹œ ì¢…í•© ê²°ê³¼\n\n## ì¢…í•© ê²°ê³¼ í™”ë©´ íŠ¹ì§•\n\n### ğŸ“Š ìµœì¢… ìˆœìœ„ ì„¹ì…˜\n- ìˆœìœ„ë³„ ì„ ìˆ˜ ì •ë³´\n- ìµœì¢… ì ìˆ˜ í‘œì‹œ\n- 1, 2, 3ìœ„ í•˜ì´ë¼ì´íŠ¸\n\n### ğŸ’ƒ ëŒ„ìŠ¤ë³„ ìƒì„¸ ê²°ê³¼\n- Cha Cha Cha, Samba, Rumba, Paso Doble, Jive\n- ê° ëŒ„ìŠ¤ë³„ ì‹¬íŒ ì ìˆ˜\n- ëŒ„ìŠ¤ë³„ ìˆœìœ„\n\n### ğŸ‘¨â€âš–ï¸ ì‹¬íŒì§„ ì •ë³´\n- ì‹¬íŒ ì´ë¦„ê³¼ êµ­ê°€\n- ì‹¬íŒ ì½”ë“œ (A, B, C, ...)\n\n### ğŸ”„ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸\n- 30ì´ˆë§ˆë‹¤ ìë™ ìƒˆë¡œê³ ì¹¨\n- ìˆ˜ë™ ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼\n- ì „ì²´í™”ë©´ ëª¨ë“œ\n\n## ê³ ê¸‰ ì„¤ì •\n\n### ìë™ ìƒˆë¡œê³ ì¹¨ ê°„ê²© ë³€ê²½\n```javascript\n// result_dashboard.phpì—ì„œ ìˆ˜ì •\nsetInterval(refreshResults, 30000); // 30ì´ˆ -> ì›í•˜ëŠ” ì´ˆë¡œ ë³€ê²½\n```\n\n### ê²°ê³¼ ë””ë ‰í† ë¦¬ ê²½ë¡œ ë³€ê²½\n```php\n// result_monitor.phpì—ì„œ ìˆ˜ì •\npublic function __construct($resultsPath = \"ìƒˆë¡œìš´/ê²½ë¡œ\") {\n    $this->resultsPath = $resultsPath;\n}\n```\n\n### ë¡œê·¸ íŒŒì¼ ìœ„ì¹˜ ë³€ê²½\n```php\n// result_watcher.phpì—ì„œ ìˆ˜ì •\nprivate $logFile = \"ìƒˆë¡œìš´/ê²½ë¡œ/watcher.log\";\n```\n\n## ë¬¸ì œ í•´ê²°\n\n### 1. íŒŒì¼ ê¶Œí•œ ì˜¤ë¥˜\n- ê²°ê³¼ ë””ë ‰í† ë¦¬ì— ì½ê¸°/ì“°ê¸° ê¶Œí•œ í™•ì¸\n- ì›¹ ì„œë²„ ê³„ì • ê¶Œí•œ í™•ì¸\n\n### 2. PHP ì˜¤ë¥˜\n- PHP ë²„ì „ í™•ì¸ (7.4 ì´ìƒ)\n- í•„ìš”í•œ í™•ì¥ ëª¨ë“ˆ ì„¤ì¹˜ (DOM, SimpleXML)\n\n### 3. íŒŒì¼ ëª¨ë‹ˆí„°ë§ì´ ì‘ë™í•˜ì§€ ì•ŠìŒ\n- ê²°ê³¼ ë””ë ‰í† ë¦¬ ê²½ë¡œ í™•ì¸\n- íŒŒì¼ ìƒì„± ì‹œê°„ í™•ì¸\n- ë¡œê·¸ íŒŒì¼ í™•ì¸\n\n### 4. ì¢…í•© ê²°ê³¼ê°€ ìƒì„±ë˜ì§€ ì•ŠìŒ\n- ìš”ì•½ íŒŒì¼ê³¼ ìƒì„¸ íŒŒì¼ ìŒ í™•ì¸\n- HTML íŒŒì‹± ì˜¤ë¥˜ í™•ì¸\n- PHP ì˜¤ë¥˜ ë¡œê·¸ í™•ì¸\n\n## ë¡œê·¸ í™•ì¸\n\n### ëª¨ë‹ˆí„°ë§ ë¡œê·¸\n```\ncomp/watcher.log\n```\n\n### ì›¹ ì„œë²„ ì˜¤ë¥˜ ë¡œê·¸\n```\nApache: logs/error.log\nIIS: C:\\inetpub\\logs\\LogFiles\\\n```\n\n## ì§€ì› ë° ë¬¸ì˜\n\në¬¸ì œê°€ ë°œìƒí•˜ê±°ë‚˜ ì¶”ê°€ ê¸°ëŠ¥ì´ í•„ìš”í•œ ê²½ìš°:\n1. ë¡œê·¸ íŒŒì¼ í™•ì¸\n2. ì˜¤ë¥˜ ë©”ì‹œì§€ ê¸°ë¡\n3. ì‹œìŠ¤í…œ í™˜ê²½ ì •ë³´ ìˆ˜ì§‘\n\n## ì—…ë°ì´íŠ¸ ë‚´ì—­\n\n### v1.0.0 (2024-01-XX)\n- ì´ˆê¸° ë²„ì „ ë¦´ë¦¬ìŠ¤\n- ê¸°ë³¸ ëª¨ë‹ˆí„°ë§ ê¸°ëŠ¥\n- ì›¹ ëŒ€ì‹œë³´ë“œ\n- ì¢…í•© ê²°ê³¼ ìƒì„±\n\n---\n\n**ì£¼ì˜ì‚¬í•­**: ì´ ì‹œìŠ¤í…œì€ ëŒ„ìŠ¤ìŠ¤ì½”ì–´ì™€ í•¨ê»˜ ì‚¬ìš©í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. ëŒ„ìŠ¤ìŠ¤ì½”ì–´ì˜ íŒŒì¼ í˜•ì‹ì´ ë³€ê²½ë˜ë©´ íŒŒì‹± ë¡œì§ì„ ìˆ˜ì •í•´ì•¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n","size_bytes":5727},"comp/admin_event.php":{"content":"<?php\n// íŒŒì¼ ê²½ë¡œ ì„¤ì • (comp/data í´ë” ê¸°ì¤€)\n$data_dir        = __DIR__ . '/data';\n$adjudicator_file = $data_dir . '/Adjudicator.txt';\n$adjpanel_file    = $data_dir . '/AdjPanel.txt';\n$event_file       = $data_dir . '/events.txt';\n$compinfo_file    = $data_dir . '/competition_info.txt';\n\n// data í´ë”ê°€ ì—†ìœ¼ë©´ ìƒì„±\nif (!is_dir($data_dir)) {\n    mkdir($data_dir, 0777, true);\n}\n\n// ëŒ€íšŒëª…/ë‚ ì§œ ì €ì¥ ë° ë¶ˆëŸ¬ì˜¤ê¸°\n$comp_title = \"\";\n$comp_date = \"\";\nif (file_exists($compinfo_file)) {\n    $compinfo = file($compinfo_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    $comp_title = isset($compinfo[0]) ? trim($compinfo[0]) : \"\";\n    $comp_date  = isset($compinfo[1]) ? trim($compinfo[1]) : \"\";\n}\n\n// ëŒ€íšŒëª…/ë‚ ì§œ ì €ì¥ ì²˜ë¦¬\nif ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['save_compinfo'])) {\n    $comp_title = trim($_POST['comp_title']);\n    $comp_date  = trim($_POST['comp_date']);\n    file_put_contents($compinfo_file, $comp_title . \"\\n\" . $comp_date . \"\\n\");\n    $compinfo_msg = \"<div class='event-msg success'>ëŒ€íšŒëª…/ë‚ ì§œê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.</div>\";\n}\n\n// ì¢…ëª© ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°\n$events = [];\nif (file_exists($event_file)) {\n    $lines = file($event_file);\n    foreach ($lines as $line) {\n        $cols = explode(',', trim($line));\n        if (count($cols) >= 2) {\n            $events[] = ['code' => $cols[0], 'name' => $cols[1]];\n        }\n    }\n}\n\n// ì¢…ëª© ì‚­ì œ ì²˜ë¦¬\nif ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['delete_event'])) {\n    $delete_code = trim($_POST['delete_code']);\n    if ($delete_code) {\n        // í•´ë‹¹ ì¢…ëª©ì„ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ì¢…ëª©ë“¤ë¡œ íŒŒì¼ ì¬ì‘ì„±\n        $remaining_events = [];\n        foreach ($events as $ev) {\n            if ($ev['code'] !== $delete_code) {\n                $remaining_events[] = $ev['code'] . ',' . $ev['name'];\n            }\n        }\n        file_put_contents($event_file, implode(\"\\n\", $remaining_events) . \"\\n\");\n        $message = \"<div class='event-msg success'>ì¢…ëª©ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.</div>\";\n        \n        // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ì„ ìœ„í•´ ë¦¬ë‹¤ì´ë ‰íŠ¸\n        header(\"Location: admin_event.php\");\n        exit;\n    }\n}\n\n// ì¢…ëª© ì¶”ê°€ ì²˜ë¦¬\nif ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['add_event'])) {\n    $code = trim($_POST['event_code']);\n    $name = trim($_POST['event_name']);\n    if ($code && $name) {\n        // ì¤‘ë³µ ë°©ì§€: ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì½”ë“œ/ì´ë¦„ ì²´í¬\n        $is_duplicate = false;\n        foreach ($events as $ev) {\n            if ($ev['code'] === $code || $ev['name'] === $name) {\n                $is_duplicate = true;\n                break;\n            }\n        }\n        if ($is_duplicate) {\n            $message = \"<div class='event-msg error'>ì´ë¯¸ ë“±ë¡ëœ ì¢…ëª© ì½”ë“œ í˜¹ì€ ì´ë¦„ì…ë‹ˆë‹¤.</div>\";\n        } else {\n            file_put_contents($event_file, \"$code,$name\\n\", FILE_APPEND);\n            header(\"Location: admin_event.php\");\n            exit;\n        }\n    } else {\n        $message = \"<div class='event-msg error'>ì¢…ëª© ì½”ë“œì™€ ì´ë¦„ì„ ëª¨ë‘ ì…ë ¥í•˜ì„¸ìš”.</div>\";\n    }\n}\n\n// íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬\nif ($_SERVER['REQUEST_METHOD'] === 'POST') {\n    // ì‹¬ì‚¬ìœ„ì› íŒŒì¼\n    if (isset($_POST['upload_adj']) && isset($_FILES['adj_upload']) && $_FILES['adj_upload']['error'] === UPLOAD_ERR_OK) {\n        move_uploaded_file($_FILES['adj_upload']['tmp_name'], $adjudicator_file);\n        $message = \"<div class='event-msg success'>ì‹¬ì‚¬ìœ„ì› íŒŒì¼ì„ ì„±ê³µì ìœ¼ë¡œ ì—…ë¡œë“œí–ˆìŠµë‹ˆë‹¤.</div>\";\n    }\n    // íŒ¨ë„ íŒŒì¼\n    if (isset($_POST['upload_panel']) && isset($_FILES['panel_upload']) && $_FILES['panel_upload']['error'] === UPLOAD_ERR_OK) {\n        move_uploaded_file($_FILES['panel_upload']['tmp_name'], $adjpanel_file);\n        $message = \"<div class='event-msg success'>íŒ¨ë„ íŒŒì¼ì„ ì„±ê³µì ìœ¼ë¡œ ì—…ë¡œë“œí–ˆìŠµë‹ˆë‹¤.</div>\";\n    }\n}\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>ëŒ€íšŒ/ì¢…ëª© ê´€ë¦¬ - ê´€ë¦¬ì | danceoffice.net</title>\n    <link rel=\"stylesheet\" href=\"/assets/style.css\">\n    <link href=\"https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded\" rel=\"stylesheet\" />\n    <style>\n        html, body {\n            background: #23262b !important;\n            margin: 0;\n            font-family: 'Pretendard','Apple SD Gothic Neo',sans-serif;\n            font-size: 15px;\n        }\n        body {\n            min-height: 100vh;\n            padding: 0;\n        }\n        .admin-section {\n            background: #23262b;\n            border-radius: 14px;\n            padding: 1.2em 1em 1.7em 1em;\n            max-width: 630px;\n            width: 96vw;\n            margin: 3vh auto 0 auto;\n            box-shadow: 0 4px 24px rgba(0,0,0,0.11);\n            display: flex;\n            flex-direction: column;\n            align-items: stretch;\n        }\n        .admin-title {\n            font-size: 1.17em;\n            font-weight: 700;\n            color: #03C75A;\n            margin-bottom: 0.7em;\n            letter-spacing: -1px;\n            text-align: center;\n        }\n        .compinfo-form {\n            display: flex;\n            gap: 0.6em;\n            flex-wrap: wrap;\n            align-items: center;\n            margin-bottom: 1em;\n            justify-content: center;\n        }\n        .compinfo-form label {\n            color: #03C75A;\n            font-weight: 600;\n            margin-bottom: 0.1em;\n            font-size: 0.97em;\n        }\n        .compinfo-form input[type=\"text\"],\n        .compinfo-form input[type=\"date\"] {\n            padding: 0.28em 0.8em;\n            border-radius: 6px;\n            border: 1px solid #31343a;\n            background: #1E2126;\n            color: #fff;\n            font-size: 0.98em;\n            min-width: 140px;\n        }\n        .compinfo-form button {\n            background: linear-gradient(90deg,#03C75A 70%,#00BFAE 100%);\n            color: #222;\n            border: none;\n            border-radius: 20px;\n            padding: 0.39em 1em;\n            font-weight: 700;\n            font-size: 0.99em;\n            margin-left: 0.2em;\n        }\n        .compinfo-form button:hover {\n            background: linear-gradient(90deg,#00BFAE 60%,#03C75A 100%);\n            color: #fff;\n        }\n        .event-msg {\n            margin: 0.7em 0;\n            padding: 0.6em 0.7em;\n            border-radius: 8px;\n            font-size: 0.98em;\n        }\n        .event-msg.success {background:#232; color:#03C75A;}\n        .event-msg.error {background:#311; color:#ff5e5e;}\n        .event-table {\n            width: 100%;\n            background: #222;\n            border-radius: 8px;\n            border-collapse: separate;\n            border-spacing: 0 0.3em;\n            margin-bottom: 1.1em;\n        }\n        .event-table th, .event-table td {\n            padding: 0.37em 0.2em;\n            border-bottom: 1px solid #31343a;\n        }\n        .event-table th {\n            background: #181B20;\n            color: #03C75A;\n            font-size: 0.98em;\n            font-weight: 700;\n        }\n        .event-table td {\n            color: #F5F7FA;\n            font-size: 0.98em;\n        }\n        .event-table tr:last-child td {border-bottom:none;}\n        .add-event-form {\n            margin-top: 0.7em;\n            display: flex;\n            gap: 0.3em;\n            flex-wrap: wrap;\n            justify-content: center;\n        }\n        .add-event-form input[type=\"text\"] {\n            padding: 0.25em 0.7em;\n            border-radius: 6px;\n            border: 1px solid #31343a;\n            background: #1E2126;\n            color: #fff;\n            font-size: 0.97em;\n        }\n        .add-event-form button {\n            background: linear-gradient(90deg,#03C75A 70%,#00BFAE 100%);\n            color: #222;\n            border: none;\n            border-radius: 20px;\n            padding: 0.34em 1em;\n            font-weight: 700;\n            font-size: 0.97em;\n        }\n        .add-event-form button:hover {\n            background: linear-gradient(90deg,#00BFAE 60%,#03C75A 100%);\n            color: #fff;\n        }\n        .file-manage {\n            margin-top: 1.2em;\n        }\n        .file-manage label {\n            color: #00BFAE;\n            font-weight: 600;\n            font-size: 0.98em;\n        }\n        .file-manage input[type=\"file\"] {\n            margin-left: 0.4em;\n            font-size: 0.97em;\n        }\n        .file-manage button {\n            margin-left: 0.3em;\n            padding: 0.25em 0.7em;\n            font-size: 0.97em;\n            border-radius: 10px;\n            border: none;\n            background: linear-gradient(90deg,#03C75A 70%,#00BFAE 100%);\n            color: #222;\n            font-weight: 700;\n        }\n        .file-manage button:hover {\n            background: linear-gradient(90deg,#00BFAE 60%,#03C75A 100%);\n            color: #fff;\n        }\n        .btn-judge {\n            background: #0057b7;\n            color: #fff;\n            font-weight: 700;\n            padding: 0.25em 0.7em;\n            border-radius: 12px;\n            text-decoration: none;\n            margin: 0 0.09em;\n            display: inline-block;\n            font-size: 0.97em;\n            transition: background 0.14s;\n            border: none;\n        }\n        .btn-judge:hover {\n            background: #003399;\n        }\n        .btn-result {\n            background: #03C75A;\n            color: #222;\n            font-weight: 700;\n            padding: 0.25em 0.7em;\n            border-radius: 12px;\n            text-decoration: none;\n            margin: 0 0.09em;\n            display: inline-block;\n            font-size: 0.97em;\n            border: none;\n            transition: background 0.14s;\n        }\n        .btn-result:hover {\n            background: #00BFAE;\n            color: #fff;\n        }\n        .btn-delete {\n            background: #dc3545;\n            color: #fff;\n            font-weight: 700;\n            padding: 0.25em 0.7em;\n            border-radius: 12px;\n            text-decoration: none;\n            margin: 0 0.09em;\n            display: inline-block;\n            font-size: 0.97em;\n            border: none;\n            cursor: pointer;\n            transition: background 0.14s;\n        }\n        .btn-delete:hover {\n            background: #c82333;\n        }\n        .info-tip {\n            color: #8af;\n            font-size: 0.93em;\n            margin-top: 1.1em;\n            line-height: 1.55;\n        }\n        @media (max-width: 900px) {\n            .admin-section { max-width: 99vw; padding: 0.6em 0.1em 0.6em 0.1em;}\n            .admin-title { font-size: 1em; }\n            .event-table th, .event-table td {font-size: 0.91em; padding: 0.26em 0.08em;}\n            .compinfo-form, .add-event-form {gap:0.19em;}\n            .btn-judge, .btn-result, .btn-delete, .add-event-form button, .compinfo-form button, .file-manage button {\n                font-size: 0.89em; padding: 0.19em 0.5em;\n            }\n        }\n        @media (max-width: 600px) {\n            .admin-section { padding: 0.28em 0.03em;}\n            .admin-title { font-size: 0.93em;}\n            .compinfo-form, .add-event-form { flex-direction: column; align-items: stretch;}\n            .event-table th, .event-table td { font-size: 0.89em; padding: 0.11em 0.07em;}\n            .btn-judge, .btn-result, .btn-delete, .add-event-form button, .compinfo-form button, .file-manage button {\n                font-size: 0.89em; padding: 0.14em 0.4em;\n            }\n        }\n        .main-header, .main-footer {\n            max-width: 630px;\n            margin: 0 auto;\n            color: #aaa;\n            text-align: center;\n            letter-spacing: 0.02em;\n        }\n        .main-header {\n            margin-top: 1.1em;\n            margin-bottom: 1.1em;\n        }\n        .main-logo {\n            height: 32px;\n            vertical-align: middle;\n            margin-right: 0.4em;\n        }\n        .main-nav {\n            display: inline-block;\n            margin-left: 0.6em;\n            vertical-align: middle;\n        }\n        .main-nav a {\n            color: #bbb;\n            text-decoration: none;\n            margin: 0 0.41em;\n            font-weight: 600;\n            font-size: 0.98em;\n            padding-bottom: 0.07em;\n            border-bottom: 2px solid transparent;\n            transition: color 0.12s, border-color 0.12s;\n        }\n        .main-nav a.active, .main-nav a:hover {\n            color: #03C75A;\n            border-bottom: 2px solid #03C75A;\n        }\n        .main-footer {\n            margin-top: 2em;\n            padding-bottom: 0.6em;\n            color: #888;\n            font-size: 0.92em;\n        }\n    </style>\n</head>\n<body>\n    <header class=\"main-header\">\n        <div class=\"logo-nav\">\n            <img src=\"/assets/danceoffice-logo.png\" alt=\"Danceoffice Logo\" class=\"main-logo\">\n            <nav class=\"main-nav\">\n                <a href=\"/\">í™ˆ</a>\n                <a href=\"/comp/admin_event.php\" class=\"active\">ëŒ€íšŒ/ì¢…ëª© ê´€ë¦¬</a>\n                <a href=\"/comp/admin_players.php\">ì„ ìˆ˜ ê´€ë¦¬</a>\n                <a href=\"/comp/result/result.php?event=<?= urlencode($ev['code'] ?? '') ?>\" class=\"btn-result\" target=\"_blank\">ì±„ì  ê²°ê³¼</a>\n            </nav>\n        </div>\n    </header>\n    <main>\n        <section class=\"admin-section\">\n            <div class=\"admin-title\">\n                <span class=\"material-symbols-rounded\">event</span> ëŒ€íšŒ/ì¢…ëª© ê´€ë¦¬\n            </div>\n            <?php if (isset($compinfo_msg)) echo $compinfo_msg; ?>\n            <form class=\"compinfo-form\" method=\"post\">\n                <label for=\"comp_title\">ëŒ€íšŒëª…</label>\n                <input type=\"text\" name=\"comp_title\" id=\"comp_title\" value=\"<?= htmlspecialchars($comp_title) ?>\" placeholder=\"ì˜ˆ: 2025 ì „êµ­ëŒ„ìŠ¤ê²½ì—°ëŒ€íšŒ\" required>\n                <label for=\"comp_date\">ëŒ€íšŒì¼</label>\n                <input type=\"date\" name=\"comp_date\" id=\"comp_date\" value=\"<?= htmlspecialchars($comp_date) ?>\" required>\n                <button type=\"submit\" name=\"save_compinfo\"><span class=\"material-symbols-rounded\">save</span> ì €ì¥</button>\n            </form>\n            <?php if (isset($message)) echo $message; ?>\n            <table class=\"event-table\">\n                <thead>\n                    <tr>\n                        <th>ì¢…ëª© ì½”ë“œ</th>\n                        <th>ì¢…ëª© ì´ë¦„</th>\n                        <th>í”„ë¦¬ìŠ¤íƒ€ì¼ ì±„ì </th>\n                        <th>ì±„ì  ê²°ê³¼</th>\n                        <th>ì‚­ì œ</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    <?php foreach($events as $ev): ?>\n                    <tr>\n                        <td><?= htmlspecialchars($ev['code']) ?></td>\n                        <td><?= htmlspecialchars($ev['name']) ?></td>\n                        <td>\n                            <a href=\"judge_login.php?event=<?= urlencode($ev['code']) ?>\"\n                               class=\"btn-judge\" target=\"_blank\">ğŸ­ í”„ë¦¬ìŠ¤íƒ€ì¼ ì±„ì </a>\n                        </td>\n                        <td>\n                            <a href=\"/comp/result/result.php?event=<?= urlencode($ev['code']) ?>\"\n                               class=\"btn-result\" target=\"_blank\">ì±„ì  ê²°ê³¼</a>\n                        </td>\n                        <td>\n                            <button type=\"button\" class=\"btn-delete\" onclick=\"deleteEvent('<?= htmlspecialchars($ev['code']) ?>', '<?= htmlspecialchars($ev['name']) ?>')\">\n                                <span class=\"material-symbols-rounded\">delete</span> ì‚­ì œ\n                            </button>\n                        </td>\n                    </tr>\n                    <?php endforeach; ?>\n                </tbody>\n            </table>\n            <form class=\"add-event-form\" method=\"post\">\n                <input type=\"text\" name=\"event_code\" placeholder=\"ì¢…ëª© ì½”ë“œ (ì˜ˆ: DUO2)\" required>\n                <input type=\"text\" name=\"event_name\" placeholder=\"ì¢…ëª© ì´ë¦„ (ì˜ˆ: ë“€ì˜¤ í”„ë¦¬ìŠ¤íƒ€ì¼ Class 2)\" required>\n                <button type=\"submit\" name=\"add_event\"><span class=\"material-symbols-rounded\">add</span> ì¢…ëª© ì¶”ê°€</button>\n            </form>\n            <div class=\"file-manage\">\n                <form method=\"post\" enctype=\"multipart/form-data\">\n                    <label for=\"adj_upload\">ì‹¬ì‚¬ìœ„ì› íŒŒì¼(Adjudicator.txt) ì—…ë¡œë“œ:</label>\n                    <input type=\"file\" name=\"adj_upload\" id=\"adj_upload\" accept=\".txt\">\n                    <button type=\"submit\" name=\"upload_adj\">ì—…ë¡œë“œ</button>\n                </form>\n                <form method=\"post\" enctype=\"multipart/form-data\" style=\"margin-top:1em;\">\n                    <label for=\"panel_upload\">íŒ¨ë„ íŒŒì¼(AdjPanel.txt) ì—…ë¡œë“œ:</label>\n                    <input type=\"file\" name=\"panel_upload\" id=\"panel_upload\" accept=\".txt\">\n                    <button type=\"submit\" name=\"upload_panel\">ì—…ë¡œë“œ</button>\n                </form>\n            </div>\n            <div class=\"info-tip\">\n                â€» <b>ëŒ€íšŒëª…/ì¼</b>ì€ ë°˜ë“œì‹œ ì €ì¥ í›„ ì‹¬ì‚¬ìœ„ì›/ì¢…ëª© ì±„ì ì— ë°˜ì˜ë©ë‹ˆë‹¤.<br>\n                â€» <b>ì‹¬ì‚¬ìœ„ì› ì±„ì </b> ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ í•´ë‹¹ ì¢…ëª©ì˜ ì‹¬ì‚¬ìœ„ì› ì±„ì  ì…ë ¥ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.<br>\n                â€» <b>ì±„ì  ê²°ê³¼</b> ë²„íŠ¼ì€ ì¢…ëª©ë³„ ì ìˆ˜ ì§‘ê³„ ê²°ê³¼(ì¶œë ¥/ì¸ì‡„ ê°€ëŠ¥ í‘œ)ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.<br>\n                â€» ì‹¬ì‚¬ìœ„ì›ë³„ ê°œë³„ ì§„ì…ì´ í•„ìš”í•˜ë©´ judge_score.php?event=ì´ë²¤íŠ¸ì½”ë“œ&judge=J01 ë“±ìœ¼ë¡œ ì¶”ê°€ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n            </div>\n        </section>\n    </main>\n    <footer class=\"main-footer\">\n        &copy; 2025 danceoffice.net | Powered by Seyoung Lee\n    </footer>\n\n    <!-- ì¢…ëª© ì‚­ì œìš© ìˆ¨ê²¨ì§„ í¼ -->\n    <form id=\"deleteEventForm\" method=\"post\" style=\"display: none;\">\n        <input type=\"hidden\" name=\"delete_event\" value=\"1\">\n        <input type=\"hidden\" name=\"delete_code\" id=\"deleteCode\" value=\"\">\n    </form>\n\n    <script>\n    function deleteEvent(eventCode, eventName) {\n        if (confirm(`ì¢…ëª© \"${eventName}\" (${eventCode})ì„(ë¥¼) ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\\n\\nì‚­ì œëœ ì¢…ëª©ì€ ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`)) {\n            document.getElementById('deleteCode').value = eventCode;\n            document.getElementById('deleteEventForm').submit();\n        }\n    }\n    </script>\n</body>\n</html>","size_bytes":18407},"comp/admin_players.php":{"content":"<?php\n// íŒŒì¼ ê²½ë¡œ ì„¤ì •\n$data_dir = __DIR__ . '/data';\n$event_file = $data_dir . '/events.txt';\n$event_players_dir = $data_dir . '/event_players';\n$competitor_file = $data_dir . '/Competitor_Tablet.txt';\n\n// í´ë” ì—†ìœ¼ë©´ ìƒì„±\nif (!is_dir($data_dir)) {\n    mkdir($data_dir, 0777, true);\n}\nif (!is_dir($event_players_dir)) {\n    mkdir($event_players_dir, 0777, true);\n}\n\n// ì´ë²¤íŠ¸ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°\n$events = [];\nif (file_exists($event_file)) {\n    $lines = file($event_file);\n    foreach ($lines as $line) {\n        $cols = explode(',', trim($line));\n        if (count($cols) >= 2) {\n            $events[] = [\n                'code' => $cols[0],\n                'name' => $cols[1]\n            ];\n        }\n    }\n}\n\n// ì„ íƒëœ ì´ë²¤íŠ¸ì˜ ì„ ìˆ˜ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°\n$selected_event = isset($_GET['event']) ? $_GET['event'] : (isset($events[0]) ? $events[0]['code'] : '');\n$event_players_file = $event_players_dir . \"/{$selected_event}_players.txt\";\n$event_players = [];\nif ($selected_event && file_exists($event_players_file)) {\n    $lines = file($event_players_file);\n    foreach ($lines as $line) {\n        $cols = array_map('trim', explode(',', $line));\n        if (count($cols) >= 2) {\n            $event_players[] = [\n                'number' => $cols[0],\n                'name' => $cols[1],\n                'partner' => isset($cols[2]) ? $cols[2] : ''\n            ];\n        }\n    }\n}\n\n// ì„ ìˆ˜ëª…ë‹¨ ì „ì²´ íŒŒì¼ì—ì„œ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°(ìë™ ì…ë ¥ìš©)\n$all_players = [];\nif (file_exists($competitor_file)) {\n    $lines = file($competitor_file);\n    foreach ($lines as $line) {\n        $cols = array_map('trim', explode(',', $line));\n        if (count($cols) >= 2) {\n            $number = $cols[0];\n            $name = $cols[1];\n            $partner = isset($cols[2]) ? $cols[2] : '';\n            $all_players[$number] = ['name'=>$name, 'partner'=>$partner];\n        }\n    }\n}\n\n// ì„ ìˆ˜ ì¶”ê°€ ì²˜ë¦¬\nif ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['add_player']) && $selected_event) {\n    $number = trim($_POST['player_number']);\n    $name = trim($_POST['player_name']);\n    $partner = trim($_POST['player_partner']);\n    if ($number && $name) {\n        // ì¤‘ë³µ ë“±ë²ˆí˜¸ ì²´í¬\n        $is_duplicate = false;\n        foreach ($event_players as $ep) {\n            if ($ep['number'] === $number) {\n                $is_duplicate = true;\n                break;\n            }\n        }\n        if ($is_duplicate) {\n            $message = \"<div class='event-msg error'>ì´ë¯¸ ë“±ë¡ëœ ë“±ë²ˆí˜¸ì…ë‹ˆë‹¤.</div>\";\n        } else {\n            file_put_contents($event_players_file, \"$number,$name,$partner\\n\", FILE_APPEND);\n            header(\"Location: admin_players.php?event=$selected_event\");\n            exit;\n        }\n    } else {\n        $message = \"<div class='event-msg error'>ë²ˆí˜¸ì™€ ì´ë¦„ì„ ëª¨ë‘ ì…ë ¥í•˜ì„¸ìš”.</div>\";\n    }\n}\n\n// ì„ ìˆ˜ ì‚­ì œ ì²˜ë¦¬\nif ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['delete_player']) && $selected_event) {\n    $delete_number = $_POST['delete_number'];\n    $new_players = [];\n    foreach ($event_players as $ep) {\n        if ($ep['number'] !== $delete_number) {\n            $new_players[] = $ep;\n        }\n    }\n    $fp = fopen($event_players_file, 'w');\n    foreach ($new_players as $ep) {\n        fwrite($fp, \"{$ep['number']},{$ep['name']},{$ep['partner']}\\n\");\n    }\n    fclose($fp);\n    header(\"Location: admin_players.php?event=$selected_event\");\n    exit;\n}\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>ì´ë²¤íŠ¸ë³„ ì„ ìˆ˜ ê´€ë¦¬ - ê´€ë¦¬ì | danceoffice.net</title>\n    <link rel=\"stylesheet\" href=\"/assets/style.css\">\n    <link href=\"https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded\" rel=\"stylesheet\" />\n    <style>\n        html, body {\n            background: #23262b !important;\n            margin: 0;\n            font-family: 'Pretendard','Apple SD Gothic Neo',sans-serif;\n            font-size: 15px;\n        }\n        body {\n            min-height: 100vh;\n            padding: 0;\n        }\n        .admin-section {\n            background: #23262b;\n            border-radius: 14px;\n            padding: 1.2em 1em 1.7em 1em;\n            max-width: 630px;\n            width: 96vw;\n            margin: 3vh auto 0 auto;\n            box-shadow: 0 4px 24px rgba(0,0,0,0.11);\n            display: flex;\n            flex-direction: column;\n            align-items: stretch;\n        }\n        .admin-title {\n            font-size: 1.17em;\n            font-weight: 700;\n            color: #03C75A;\n            margin-bottom: 0.7em;\n            letter-spacing: -1px;\n            text-align: center;\n        }\n        .event-select-form {\n            margin-bottom: 1.3em;\n            text-align: center;\n        }\n        .event-select-form label {\n            color: #03C75A;\n            font-weight: 600;\n            font-size: 0.98em;\n        }\n        .event-select-form select {\n            padding: 0.32em 0.8em;\n            border-radius: 8px;\n            background: #181B20;\n            color: #03C75A;\n            border: 1px solid #31343a;\n            font-size: 0.99em;\n            margin-left: 0.5em;\n        }\n        .event-table {\n            width: 100%;\n            background: #222;\n            border-radius: 8px;\n            border-collapse: separate;\n            border-spacing: 0 0.3em;\n            margin-bottom: 1.1em;\n        }\n        .event-table th, .event-table td {\n            padding: 0.37em 0.2em;\n            border-bottom: 1px solid #31343a;\n        }\n        .event-table th {\n            background: #181B20;\n            color: #03C75A;\n            font-size: 0.98em;\n            font-weight: 700;\n        }\n        .event-table td {\n            color: #F5F7FA;\n            font-size: 0.98em;\n        }\n        .event-table tr:last-child td {border-bottom:none;}\n        .add-player-form {\n            margin-top: 0.6em;\n            display: flex;\n            gap: 0.3em;\n            flex-wrap: wrap;\n            justify-content: center;\n        }\n        .add-player-form input[type=\"text\"] {\n            padding: 0.25em 0.7em;\n            border-radius: 6px;\n            border: 1px solid #31343a;\n            background: #1E2126;\n            color: #fff;\n            font-size: 0.97em;\n        }\n        .add-player-form button {\n            background: linear-gradient(90deg,#03C75A 70%,#00BFAE 100%);\n            color: #222;\n            border: none;\n            border-radius: 20px;\n            padding: 0.34em 1em;\n            font-weight: 700;\n            font-size: 0.97em;\n        }\n        .add-player-form button:hover {\n            background: linear-gradient(90deg,#00BFAE 60%,#03C75A 100%);\n            color: #fff;\n        }\n        .event-msg {\n            margin: 0.7em 0;\n            padding: 0.6em 0.7em;\n            border-radius: 8px;\n            font-size: 0.98em;\n        }\n        .event-msg.success {background:#232; color:#03C75A;}\n        .event-msg.error {background:#311; color:#ff5e5e;}\n        .delete-btn {\n            background: #ff5e5e;\n            color: #fff;\n            border: none;\n            border-radius: 12px;\n            padding: 0.21em 0.8em;\n            font-weight: 600;\n            font-size: 0.97em;\n            cursor: pointer;\n        }\n        .delete-btn:hover {\n            background: #d32f2f;\n        }\n        .main-header, .main-footer {\n            max-width: 630px;\n            margin: 0 auto;\n            color: #aaa;\n            text-align: center;\n            letter-spacing: 0.02em;\n        }\n        .main-header {\n            margin-top: 1.1em;\n            margin-bottom: 1.1em;\n        }\n        .main-logo {\n            height: 32px;\n            vertical-align: middle;\n            margin-right: 0.4em;\n        }\n        .main-nav {\n            display: inline-block;\n            margin-left: 0.6em;\n            vertical-align: middle;\n        }\n        .main-nav a {\n            color: #bbb;\n            text-decoration: none;\n            margin: 0 0.41em;\n            font-weight: 600;\n            font-size: 0.98em;\n            padding-bottom: 0.07em;\n            border-bottom: 2px solid transparent;\n            transition: color 0.12s, border-color 0.12s;\n        }\n        .main-nav a.active, .main-nav a:hover {\n            color: #03C75A;\n            border-bottom: 2px solid #03C75A;\n        }\n        .main-footer {\n            margin-top: 2em;\n            padding-bottom: 0.6em;\n            color: #888;\n            font-size: 0.92em;\n        }\n        @media (max-width: 900px) {\n            .admin-section { max-width: 99vw; padding: 0.6em 0.1em 0.6em 0.1em;}\n            .admin-title { font-size: 1em; }\n            .event-table th, .event-table td {font-size: 0.91em; padding: 0.26em 0.08em;}\n            .add-player-form {gap:0.19em;}\n            .add-player-form button, .delete-btn {font-size: 0.89em; padding: 0.19em 0.5em;}\n        }\n        @media (max-width: 600px) {\n            .admin-section { padding: 0.28em 0.03em;}\n            .admin-title { font-size: 0.93em;}\n            .add-player-form { flex-direction: column; align-items: stretch;}\n            .event-table th, .event-table td { font-size: 0.89em; padding: 0.11em 0.07em;}\n            .add-player-form button, .delete-btn {font-size: 0.89em; padding: 0.14em 0.4em;}\n        }\n    </style>\n    <script>\n        // ì„ ìˆ˜ëª… ìë™ ì…ë ¥ ê¸°ëŠ¥\n        const playerData = <?php echo json_encode($all_players); ?>;\n        function fillPlayerName() {\n            const number = document.getElementById('player_number').value.trim();\n            if (playerData[number]) {\n                document.getElementById('player_name').value = playerData[number].name;\n                document.getElementById('player_partner').value = playerData[number].partner;\n            } else {\n                document.getElementById('player_name').value = '';\n                document.getElementById('player_partner').value = '';\n            }\n        }\n    </script>\n</head>\n<body>\n    <header class=\"main-header\">\n        <div class=\"logo-nav\">\n            <img src=\"/assets/danceoffice-logo.png\" alt=\"Danceoffice Logo\" class=\"main-logo\">\n            <nav class=\"main-nav\">\n                <a href=\"/\">í™ˆ</a>\n                <a href=\"/comp/admin_event.php\">ëŒ€íšŒ/ì¢…ëª© ê´€ë¦¬</a>\n                <a href=\"/comp/admin_players.php\" class=\"active\">ì„ ìˆ˜ ì „ì²´ ê´€ë¦¬</a>\n                <a href=\"/comp/result/\">ì±„ì /ê²°ê³¼ ê´€ë¦¬</a>\n            </nav>\n        </div>\n    </header>\n    <main>\n        <section class=\"admin-section\">\n            <div class=\"admin-title\">\n                <span class=\"material-symbols-rounded\">groups</span> ì„ ìˆ˜ ê´€ë¦¬\n            </div>\n            <form class=\"event-select-form\" method=\"get\">\n                <label for=\"event_select\">ì¢…ëª© ì„ íƒ:</label>\n                <select name=\"event\" id=\"event_select\" onchange=\"this.form.submit()\">\n                    <?php foreach($events as $ev): ?>\n                        <option value=\"<?= htmlspecialchars($ev['code']) ?>\" <?= $selected_event === $ev['code'] ? 'selected' : '' ?>>\n                            <?= htmlspecialchars($ev['name']) ?>\n                        </option>\n                    <?php endforeach; ?>\n                </select>\n            </form>\n            <?php if (isset($message)) echo $message; ?>\n            <table class=\"event-table\">\n                <thead>\n                    <tr>\n                        <th>ë²ˆí˜¸</th>\n                        <th>ì´ë¦„</th>\n                        <th>ì†Œì†</th>\n                        <th>ì‚­ì œ</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    <?php foreach($event_players as $ep): ?>\n                    <tr>\n                        <td><?= htmlspecialchars($ep['number']) ?></td>\n                        <td><?= htmlspecialchars($ep['name']) ?></td>\n                        <td><?= htmlspecialchars($ep['partner']) ?></td>\n                        <td>\n                            <form method=\"post\" style=\"display:inline;\">\n                                <input type=\"hidden\" name=\"delete_number\" value=\"<?= htmlspecialchars($ep['number']) ?>\">\n                                <button type=\"submit\" name=\"delete_player\" class=\"delete-btn\">ì‚­ì œ</button>\n                            </form>\n                        </td>\n                    </tr>\n                    <?php endforeach; ?>\n                </tbody>\n            </table>\n            <?php if ($selected_event): ?>\n            <form class=\"add-player-form\" method=\"post\">\n                <input type=\"text\" name=\"player_number\" id=\"player_number\" placeholder=\"ë²ˆí˜¸ (ì˜ˆ: 43)\" required oninput=\"fillPlayerName()\">\n                <input type=\"text\" name=\"player_name\" id=\"player_name\" placeholder=\"ì´ë¦„ (ì˜ˆ: ë¬¸ì§„í˜¸)\" required>\n                <input type=\"text\" name=\"player_partner\" id=\"player_partner\" placeholder=\"íŒŒíŠ¸ë„ˆ (ì˜ˆ: ë…¸ëª…ì£¼ ë˜ëŠ” ê³µë€)\">\n                <button type=\"submit\" name=\"add_player\"><span class=\"material-symbols-rounded\">add</span> ì„ ìˆ˜ ì¶”ê°€</button>\n            </form>\n            <div style=\"margin-top:1em; color:#888; font-size:0.93em;\">\n                â€» ë“±ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ë©´ <b>Competitor_Tablet.txt</b>ì— ë“±ë¡ëœ ì„ ìˆ˜ëª…/íŒŒíŠ¸ë„ˆê°€ ìë™ìœ¼ë¡œ ì±„ì›Œì§‘ë‹ˆë‹¤.\n            </div>\n            <?php endif; ?>\n        </section>\n    </main>\n    <footer class=\"main-footer\">\n        &copy; 2025 danceoffice.net | Powered by Seyoung Lee\n    </footer>\n</body>\n</html>","size_bytes":13554},"comp/assign_admin.php":{"content":"<?php\nsession_start();\nrequire_once 'auth.php';\n\n// ì˜¤ë„ˆ ê¶Œí•œë§Œ ì ‘ê·¼ ê°€ëŠ¥\nrequirePermission('manage_users');\n\n$user = $_SESSION['user'];\n$message = '';\n$error = '';\n\n// ëŒ€íšŒ ID í™•ì¸\n$comp_id = $_GET['comp_id'] ?? '';\nif (!$comp_id) {\n    die(\"ëŒ€íšŒ IDê°€ í•„ìš”í•©ë‹ˆë‹¤.\");\n}\n\n// ëŒ€íšŒ ì •ë³´ ë¡œë“œ\n$data_dir = __DIR__ . '/data';\n$comp_path = \"$data_dir/$comp_id\";\n$info_file = \"$comp_path/info.json\";\n\nif (!file_exists($info_file)) {\n    die(\"ëŒ€íšŒ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\");\n}\n\n$comp_info = json_decode(file_get_contents($info_file), true);\nif (!$comp_info) {\n    die(\"ëŒ€íšŒ ì •ë³´ë¥¼ ì½ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\");\n}\n\n// ë‹´ë‹¹ì ë³€ê²½ ì²˜ë¦¬\nif ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['assign_admin'])) {\n    $new_admin = trim($_POST['assigned_admin'] ?? '');\n    \n    if ($new_admin) {\n        $comp_info['assigned_admin'] = $new_admin;\n        file_put_contents($info_file, json_encode($comp_info, JSON_UNESCAPED_UNICODE|JSON_PRETTY_PRINT));\n        $message = \"ë‹´ë‹¹ìê°€ '{$new_admin}'ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.\";\n    } else {\n        $error = \"ë‹´ë‹¹ìë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.\";\n    }\n}\n\n// ì‚¬ìš©ì ëª©ë¡ ë¡œë“œ\n$users = loadUsers();\n$senior_admins = array_filter($users, function($u) {\n    return $u['role'] === 'senior_admin';\n});\n\nfunction h($s) { return htmlspecialchars($s ?? ''); }\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>ë‹´ë‹¹ì ì§€ì • | danceoffice.net</title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\n    <link href=\"https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded\" rel=\"stylesheet\" />\n    <style>\n        body {\n            background: #181B20;\n            min-height: 100vh;\n            font-size: 14px;\n            line-height: 1.5;\n            margin: 0;\n            padding: 0;\n            font-family: 'Noto Sans KR', sans-serif;\n        }\n        \n        .container {\n            max-width: 600px;\n            margin: 0 auto;\n            padding: 20px;\n        }\n        \n        .header {\n            background: linear-gradient(135deg, #1a1d21 0%, #181B20 100%);\n            border-radius: 15px;\n            padding: 25px;\n            margin-bottom: 20px;\n            box-shadow: 0 8px 25px rgba(3, 199, 90, 0.15);\n            border: 2px solid #03C75A;\n            text-align: center;\n        }\n        \n        .header h1 {\n            color: #03C75A;\n            font-size: 24px;\n            margin: 0 0 10px 0;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 10px;\n        }\n        \n        .header p {\n            color: #00BFAE;\n            font-size: 16px;\n            margin: 0;\n        }\n        \n        .nav {\n            display: flex;\n            gap: 15px;\n            margin-top: 20px;\n            justify-content: center;\n        }\n        \n        .nav a {\n            color: white;\n            text-decoration: none;\n            font-weight: 600;\n            font-size: 14px;\n            padding: 10px 20px;\n            border-radius: 20px;\n            background: rgba(3, 199, 90, 0.1);\n            backdrop-filter: blur(10px);\n            transition: all 0.3s ease;\n            display: flex;\n            align-items: center;\n            gap: 5px;\n        }\n        \n        .nav a:hover {\n            background: #03C75A;\n            color: #222;\n            transform: translateY(-2px);\n        }\n        \n        .card {\n            background: #222;\n            border-radius: 15px;\n            padding: 25px;\n            margin-bottom: 20px;\n            box-shadow: 0 8px 25px rgba(3, 199, 90, 0.08);\n            border: 1px solid #31343a;\n        }\n        \n        .card h3 {\n            color: #03C75A;\n            font-size: 18px;\n            margin: 0 0 20px 0;\n            display: flex;\n            align-items: center;\n            gap: 10px;\n        }\n        \n        .comp-info {\n            background: #181B20;\n            border-radius: 8px;\n            padding: 15px;\n            margin-bottom: 20px;\n            border: 1px solid #31343a;\n        }\n        \n        .comp-info h4 {\n            color: #03C75A;\n            margin: 0 0 10px 0;\n            font-size: 16px;\n        }\n        \n        .comp-info p {\n            color: #F5F7FA;\n            margin: 5px 0;\n            font-size: 14px;\n        }\n        \n        .form-group {\n            margin-bottom: 15px;\n        }\n        \n        .form-group label {\n            display: block;\n            color: #F5F7FA;\n            font-size: 13px;\n            margin-bottom: 5px;\n            font-weight: 600;\n        }\n        \n        .form-group select {\n            width: 100%;\n            padding: 10px;\n            border: 1px solid #31343a;\n            border-radius: 8px;\n            background: #181B20;\n            color: #F5F7FA;\n            font-size: 13px;\n            box-sizing: border-box;\n            cursor: pointer;\n        }\n        \n        .form-group select option {\n            background: #181B20;\n            color: #F5F7FA;\n        }\n        \n        .btn {\n            background: linear-gradient(90deg, #03C75A 70%, #00BFAE 100%);\n            color: #222;\n            border: none;\n            padding: 10px 20px;\n            border-radius: 20px;\n            font-weight: 600;\n            font-size: 13px;\n            cursor: pointer;\n            transition: all 0.3s ease;\n        }\n        \n        .btn:hover {\n            background: linear-gradient(90deg, #00BFAE 60%, #03C75A 100%);\n            color: white;\n            transform: translateY(-2px);\n        }\n        \n        .btn-secondary {\n            background: linear-gradient(90deg, #6c757d 70%, #5a6268 100%);\n            color: white;\n        }\n        \n        .btn-secondary:hover {\n            background: linear-gradient(90deg, #5a6268 60%, #6c757d 100%);\n        }\n        \n        .message {\n            color: #03C75A;\n            background: rgba(3, 199, 90, 0.1);\n            padding: 10px;\n            border-radius: 8px;\n            margin-bottom: 15px;\n            font-size: 13px;\n        }\n        \n        .error {\n            color: #ff4444;\n            background: rgba(255, 68, 68, 0.1);\n            padding: 10px;\n            border-radius: 8px;\n            margin-bottom: 15px;\n            font-size: 13px;\n        }\n        \n        .current-assignment {\n            background: rgba(3, 199, 90, 0.1);\n            border: 1px solid #03C75A;\n            border-radius: 8px;\n            padding: 15px;\n            margin-bottom: 20px;\n        }\n        \n        .current-assignment strong {\n            color: #03C75A;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <header class=\"header\">\n            <h1>\n                <span class=\"material-symbols-rounded\">person_add</span>\n                ëŒ€íšŒ ë‹´ë‹¹ì ì§€ì •\n            </h1>\n            <p>ëŒ€íšŒì˜ ë‹´ë‹¹ ì„ ì„ê´€ë¦¬ìë¥¼ ë³€ê²½í•©ë‹ˆë‹¤</p>\n            <nav class=\"nav\">\n                <a href=\"index.php\">\n                    <span class=\"material-symbols-rounded\">sports</span>\n                    ëŒ€íšŒ ê´€ë¦¬\n                </a>\n                <a href=\"manage_users.php\">\n                    <span class=\"material-symbols-rounded\">group</span>\n                    ì‚¬ìš©ì ê´€ë¦¬\n                </a>\n                <a href=\"logout.php\">\n                    <span class=\"material-symbols-rounded\">logout</span>\n                    ë¡œê·¸ì•„ì›ƒ\n                </a>\n            </nav>\n        </header>\n        \n        <div class=\"card\">\n            <h3>\n                <span class=\"material-symbols-rounded\">info</span>\n                ëŒ€íšŒ ì •ë³´\n            </h3>\n            <div class=\"comp-info\">\n                <h4><?= h($comp_info['title']) ?></h4>\n                <p><strong>ì¼ì:</strong> <?= h($comp_info['date']) ?></p>\n                <p><strong>ì¥ì†Œ:</strong> <?= h($comp_info['place']) ?></p>\n                <p><strong>ì£¼ìµœ:</strong> <?= h($comp_info['host']) ?></p>\n            </div>\n            \n            <div class=\"current-assignment\">\n                <strong>í˜„ì¬ ë‹´ë‹¹ì:</strong> \n                <?= h($comp_info['assigned_admin'] ?? 'ë¯¸ì§€ì •') ?>\n            </div>\n            \n            <?php if ($message): ?>\n                <div class=\"message\"><?= h($message) ?></div>\n            <?php endif; ?>\n            <?php if ($error): ?>\n                <div class=\"error\"><?= h($error) ?></div>\n            <?php endif; ?>\n            \n            <form method=\"post\">\n                <div class=\"form-group\">\n                    <label for=\"assigned_admin\">ìƒˆ ë‹´ë‹¹ ì„ ì„ê´€ë¦¬ì</label>\n                    <select id=\"assigned_admin\" name=\"assigned_admin\" required>\n                        <option value=\"\">ì„ ì„ê´€ë¦¬ìë¥¼ ì„ íƒí•˜ì„¸ìš”</option>\n                        <?php foreach ($senior_admins as $admin): ?>\n                            <option value=\"<?= h($admin['username']) ?>\" \n                                    <?= ($comp_info['assigned_admin'] ?? '') === $admin['username'] ? 'selected' : '' ?>>\n                                <?= h($admin['username']) ?> (<?= getRoleDisplayName($admin['role']) ?>)\n                            </option>\n                        <?php endforeach; ?>\n                    </select>\n                </div>\n                <div style=\"display: flex; gap: 10px;\">\n                    <button type=\"submit\" name=\"assign_admin\" class=\"btn\">\n                        <span class=\"material-symbols-rounded\">save</span>\n                        ë‹´ë‹¹ì ë³€ê²½\n                    </button>\n                    <a href=\"index.php\" class=\"btn btn-secondary\">\n                        <span class=\"material-symbols-rounded\">arrow_back</span>\n                        ëŒì•„ê°€ê¸°\n                    </a>\n                </div>\n            </form>\n        </div>\n    </div>\n</body>\n</html>\n\n\n\n\n\n\n","size_bytes":9942},"comp/auth.php":{"content":"<?php\n// ì¸ì¦ ë° ê¶Œí•œ ê´€ë¦¬ ì‹œìŠ¤í…œ\n\nfunction loadUsers() {\n    $users_file = __DIR__ . '/users.txt';\n    $users = [];\n    \n    if (file_exists($users_file)) {\n        $lines = file($users_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n        foreach ($lines as $line) {\n            if (strpos($line, '#') === 0) continue; // ì£¼ì„ ë¬´ì‹œ\n            $parts = explode(',', $line);\n            if (count($parts) >= 5) {\n                $users[] = [\n                    'username' => trim($parts[0]),\n                    'password' => trim($parts[1]),\n                    'role' => trim($parts[2]),\n                    'created_by' => trim($parts[3]),\n                    'created_at' => trim($parts[4])\n                ];\n            }\n        }\n    }\n    return $users;\n}\n\nfunction saveUsers($users) {\n    $users_file = __DIR__ . '/users.txt';\n    $content = \"# ì‚¬ìš©ì ê´€ë¦¬ íŒŒì¼\\n\";\n    $content .= \"# í˜•ì‹: username,password,role,created_by,created_at\\n\";\n    $content .= \"# role: owner, senior_admin, admin\\n\";\n    $content .= \"# created_by: ì´ ì‚¬ìš©ìë¥¼ ìƒì„±í•œ ì‚¬ìš©ì (ownerëŠ” 'system')\\n\\n\";\n    \n    foreach ($users as $user) {\n        $content .= implode(',', $user) . \"\\n\";\n    }\n    \n    file_put_contents($users_file, $content);\n}\n\nfunction authenticateUser($username, $password) {\n    $users = loadUsers();\n    foreach ($users as $user) {\n        if ($user['username'] === $username && $user['password'] === $password) {\n            return $user;\n        }\n    }\n    return false;\n}\n\nfunction hasPermission($user, $permission) {\n    if (!$user) return false;\n    \n    $role_permissions = [\n        'owner' => ['create_comp', 'manage_users', 'view_all_comps', 'manage_comp'],\n        'senior_admin' => ['view_all_comps', 'manage_comp'],\n        'admin' => ['manage_content']\n    ];\n    \n    return in_array($permission, $role_permissions[$user['role']] ?? []);\n}\n\nfunction requirePermission($permission) {\n    if (!isset($_SESSION['user'])) {\n        header(\"Location: login.php\");\n        exit;\n    }\n    \n    if (!hasPermission($_SESSION['user'], $permission)) {\n        die(\"ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.\");\n    }\n}\n\nfunction getRoleDisplayName($role) {\n    $role_names = [\n        'owner' => 'ì˜¤ë„ˆ',\n        'senior_admin' => 'ì„ ì„ê´€ë¦¬ì',\n        'admin' => 'ê´€ë¦¬ì'\n    ];\n    return $role_names[$role] ?? $role;\n}\n","size_bytes":2371},"comp/auto_fullscreen.php":{"content":"<?php\n/**\n * ìë™ ì „ì²´í™”ë©´ ì§„ì… í˜ì´ì§€\n * F11 í‚¤ë¥¼ ìë™ìœ¼ë¡œ ëˆŒëŸ¬ì„œ ì „ì²´í™”ë©´ìœ¼ë¡œ ì§„ì…\n */\n\n$mode = isset($_GET['mode']) ? $_GET['mode'] : 'results';\n$event = isset($_GET['event']) ? $_GET['event'] : '';\n$auto = isset($_GET['auto']) ? $_GET['auto'] : 'true';\n\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>ìë™ ì „ì²´í™”ë©´</title>\n    <style>\n        body {\n            margin: 0;\n            padding: 0;\n            background: #000;\n            color: #fff;\n            font-family: Arial, sans-serif;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            height: 100vh;\n        }\n        \n        .loading {\n            text-align: center;\n        }\n        \n        .spinner {\n            border: 4px solid #f3f3f3;\n            border-top: 4px solid #667eea;\n            border-radius: 50%;\n            width: 50px;\n            height: 50px;\n            animation: spin 1s linear infinite;\n            margin: 0 auto 20px;\n        }\n        \n        @keyframes spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"loading\">\n        <div class=\"spinner\"></div>\n        <h2>ì „ì²´í™”ë©´ìœ¼ë¡œ ì „í™˜ ì¤‘...</h2>\n        <p>ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.</p>\n    </div>\n\n    <script>\n        // í˜ì´ì§€ ë¡œë“œ í›„ ìë™ìœ¼ë¡œ ì „ì²´í™”ë©´ ëª¨ë‹ˆí„°ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸\n        window.addEventListener('load', function() {\n            setTimeout(() => {\n                const url = `fullscreen_monitor.php?mode=${encodeURIComponent('<?php echo $mode; ?>')}&event=${encodeURIComponent('<?php echo $event; ?>')}&auto=${encodeURIComponent('<?php echo $auto; ?>')}`;\n                window.location.href = url;\n            }, 1000);\n        });\n        \n        // F11 í‚¤ ìë™ ì‹¤í–‰ (ì‚¬ìš©ì ìƒí˜¸ì‘ìš© í›„ì—ë§Œ ê°€ëŠ¥)\n        document.addEventListener('click', function() {\n            if (document.documentElement.requestFullscreen) {\n                document.documentElement.requestFullscreen();\n            } else if (document.documentElement.webkitRequestFullscreen) {\n                document.documentElement.webkitRequestFullscreen();\n            } else if (document.documentElement.mozRequestFullScreen) {\n                document.documentElement.mozRequestFullScreen();\n            } else if (document.documentElement.msRequestFullscreen) {\n                document.documentElement.msRequestFullscreen();\n            }\n        });\n    </script>\n</body>\n</html>\n\n\n\n\n","size_bytes":2675},"comp/check_result_file.php":{"content":"<?php\n/**\n * ê²°ê³¼ íŒŒì¼ ì¡´ì¬ ì—¬ë¶€ í™•ì¸ API\n */\n\n$eventId = isset($_GET['event']) ? $_GET['event'] : '';\n\nif (!$eventId) {\n    echo json_encode(['success' => false, 'message' => 'ì´ë²¤íŠ¸ IDê°€ í•„ìš”í•©ë‹ˆë‹¤.']);\n    exit;\n}\n\n// combined_result íŒŒì¼ ê²½ë¡œ ì„¤ì •\n$resultsPath = __DIR__ . \"/../results/results\";\n$combinedFile = $resultsPath . \"/combined_result_\" . $eventId . \".html\";\n\n// íŒŒì¼ ì¡´ì¬ ì—¬ë¶€ í™•ì¸\n$exists = file_exists($combinedFile) && is_readable($combinedFile);\n\n// ì¶”ê°€ ì •ë³´\n$fileInfo = [];\nif ($exists) {\n    $fileInfo = [\n        'path' => $combinedFile,\n        'size' => filesize($combinedFile),\n        'modified' => date('Y-m-d H:i:s', filemtime($combinedFile))\n    ];\n}\n\necho json_encode([\n    'success' => true,\n    'event_id' => $eventId,\n    'exists' => $exists,\n    'file_info' => $fileInfo,\n    'message' => $exists ? 'ê²°ê³¼ íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤.' : 'ê²°ê³¼ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.'\n]);\n?>\n","size_bytes":949},"comp/competition_settings.php":{"content":"<?php\n/**\n * ëŒ€íšŒ ì„¤ì • ê´€ë¦¬\n */\n\n$settingsFile = __DIR__ . '/uploads/competition_settings.json';\n\n// ê¸°ë³¸ ì„¤ì •\n$defaultSettings = [\n    'competition_title' => '2025 ê²½ê¸°ë„ì§€ì‚¬ë°° ì „êµ­ì¥ì• ì¸ëŒ„ìŠ¤ìŠ¤í¬ì¸ ì„ ìˆ˜ê¶ŒëŒ€íšŒ',\n    'competition_subtitle' => 'DanceOffice ëŒ„ìŠ¤ìŠ¤í¬ì¸  ê´€ë¦¬ ì‹œìŠ¤í…œ'\n];\n\n// ì„¤ì • ë¡œë“œ\n$settings = $defaultSettings;\nif (file_exists($settingsFile)) {\n    $loadedSettings = json_decode(file_get_contents($settingsFile), true);\n    if ($loadedSettings) {\n        $settings = array_merge($defaultSettings, $loadedSettings);\n    }\n}\n\n// ì„¤ì • ì €ì¥\nif ($_SERVER['REQUEST_METHOD'] === 'POST') {\n    $newSettings = [\n        'competition_title' => $_POST['competition_title'] ?? $defaultSettings['competition_title'],\n        'competition_subtitle' => $_POST['competition_subtitle'] ?? $defaultSettings['competition_subtitle']\n    ];\n    \n    if (file_put_contents($settingsFile, json_encode($newSettings, JSON_PRETTY_PRINT))) {\n        $message = 'ëŒ€íšŒ ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.';\n        $settings = $newSettings;\n    } else {\n        $error = 'ì„¤ì • ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';\n    }\n}\n\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>ëŒ€íšŒ ì„¤ì •</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            margin: 20px;\n            background: #f5f5f5;\n        }\n        \n        .container {\n            max-width: 800px;\n            margin: 0 auto;\n            background: white;\n            padding: 20px;\n            border-radius: 10px;\n            box-shadow: 0 0 20px rgba(0,0,0,0.1);\n        }\n        \n        .header {\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n            padding: 20px;\n            border-radius: 10px;\n            margin-bottom: 30px;\n            text-align: center;\n        }\n        \n        .header h1 {\n            margin: 0;\n            font-size: 2em;\n        }\n        \n        .form-group {\n            margin-bottom: 20px;\n        }\n        \n        .form-group label {\n            display: block;\n            margin-bottom: 5px;\n            font-weight: bold;\n            color: #333;\n        }\n        \n        .form-group input[type=\"text\"] {\n            width: 100%;\n            padding: 12px;\n            border: 1px solid #ddd;\n            border-radius: 5px;\n            font-size: 16px;\n        }\n        \n        .btn {\n            background: #007bff;\n            color: white;\n            border: none;\n            padding: 12px 20px;\n            border-radius: 5px;\n            cursor: pointer;\n            font-size: 14px;\n            transition: background 0.3s;\n        }\n        \n        .btn:hover {\n            background: #0056b3;\n        }\n        \n        .btn.success {\n            background: #28a745;\n        }\n        \n        .btn.success:hover {\n            background: #218838;\n        }\n        \n        .btn.info {\n            background: #17a2b8;\n        }\n        \n        .btn.info:hover {\n            background: #138496;\n        }\n        \n        .message {\n            padding: 15px;\n            border-radius: 5px;\n            margin-bottom: 20px;\n        }\n        \n        .message.success {\n            background: #d4edda;\n            color: #155724;\n            border: 1px solid #c3e6cb;\n        }\n        \n        .message.error {\n            background: #f8d7da;\n            color: #721c24;\n            border: 1px solid #f5c6cb;\n        }\n        \n        .preview {\n            background: #f8f9fa;\n            padding: 20px;\n            border-radius: 5px;\n            margin-top: 20px;\n            text-align: center;\n        }\n        \n        .preview h2 {\n            color: #333;\n            margin-bottom: 10px;\n        }\n        \n        .preview p {\n            color: #666;\n            margin: 0;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>ğŸ† ëŒ€íšŒ ì„¤ì •</h1>\n            <p>ëŒ€íšŒ ì œëª©ê³¼ ë¶€ì œëª©ì„ ì„¤ì •í•˜ì„¸ìš”</p>\n        </div>\n        \n        <?php if (isset($message)): ?>\n        <div class=\"message success\"><?php echo $message; ?></div>\n        <?php endif; ?>\n        \n        <?php if (isset($error)): ?>\n        <div class=\"message error\"><?php echo $error; ?></div>\n        <?php endif; ?>\n        \n        <form method=\"POST\">\n            <div class=\"form-group\">\n                <label for=\"competition_title\">ëŒ€íšŒ ì œëª©</label>\n                <input type=\"text\" id=\"competition_title\" name=\"competition_title\" \n                       value=\"<?php echo htmlspecialchars($settings['competition_title']); ?>\" required>\n            </div>\n            \n            <div class=\"form-group\">\n                <label for=\"competition_subtitle\">ëŒ€íšŒ ë¶€ì œëª©</label>\n                <input type=\"text\" id=\"competition_subtitle\" name=\"competition_subtitle\" \n                       value=\"<?php echo htmlspecialchars($settings['competition_subtitle']); ?>\">\n            </div>\n            \n            <div style=\"display: flex; gap: 15px;\">\n                <button type=\"submit\" class=\"btn success\">ğŸ’¾ ì„¤ì • ì €ì¥</button>\n                <button type=\"button\" class=\"btn info\" onclick=\"openEventMonitor()\">ğŸ–¥ï¸ ì „ì²´í™”ë©´ ë¯¸ë¦¬ë³´ê¸°</button>\n                <button type=\"button\" class=\"btn\" onclick=\"openEventUpload()\">ğŸ“ ì´ë²¤íŠ¸ ì—…ë¡œë“œ</button>\n            </div>\n        </form>\n        \n        <div class=\"preview\">\n            <h2>ë¯¸ë¦¬ë³´ê¸°</h2>\n            <h3 id=\"previewTitle\"><?php echo htmlspecialchars($settings['competition_title']); ?></h3>\n            <p id=\"previewSubtitle\"><?php echo htmlspecialchars($settings['competition_subtitle']); ?></p>\n        </div>\n    </div>\n\n    <script>\n        function openEventMonitor() {\n            window.open('event_monitor_v2.php', '_blank');\n        }\n        \n        function openEventUpload() {\n            window.open('event_upload.php', '_blank');\n        }\n        \n        // ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°\n        document.getElementById('competition_title').addEventListener('input', function() {\n            document.getElementById('previewTitle').textContent = this.value;\n        });\n        \n        document.getElementById('competition_subtitle').addEventListener('input', function() {\n            document.getElementById('previewSubtitle').textContent = this.value;\n        });\n    </script>\n</body>\n</html>\n","size_bytes":6550},"comp/create_next_round_players.php":{"content":"<?php\nheader('Content-Type: application/json');\nerror_reporting(E_ALL);\nini_set('display_errors', 1);\n\n$input = json_decode(file_get_contents('php://input'), true);\n\nif (!$input) {\n    echo json_encode(['success' => false, 'message' => 'Invalid input data']);\n    exit;\n}\n\n$comp_id = $input['comp_id'] ?? '';\n$eventNo = $input['eventNo'] ?? '';\n$players = $input['players'] ?? [];\n\nif (empty($comp_id) || empty($eventNo) || empty($players)) {\n    echo json_encode(['success' => false, 'message' => 'Missing required parameters']);\n    exit;\n}\n\n// ëŒ€íšŒ ë°ì´í„° ë””ë ‰í† ë¦¬\n$data_dir = __DIR__ . \"/data/$comp_id\";\n\n// ë””ë ‰í† ë¦¬ê°€ ì—†ìœ¼ë©´ ìƒì„±\nif (!is_dir($data_dir)) {\n    mkdir($data_dir, 0755, true);\n}\n\n// ì„ ìˆ˜ íŒŒì¼ ê²½ë¡œ\n$players_file = \"$data_dir/players_$eventNo.txt\";\n\ntry {\n    // ì„ ìˆ˜ ëª©ë¡ì„ íŒŒì¼ì— ì €ì¥\n    $content = implode(\"\\n\", $players);\n    $result = file_put_contents($players_file, $content);\n    \n    if ($result === false) {\n        throw new Exception('Failed to write players file');\n    }\n    \n    echo json_encode([\n        'success' => true, \n        'message' => \"Players file created successfully: players_$eventNo.txt\",\n        'file_path' => $players_file,\n        'player_count' => count($players)\n    ]);\n    \n} catch (Exception $e) {\n    echo json_encode([\n        'success' => false, \n        'message' => 'Error creating players file: ' . $e->getMessage()\n    ]);\n}\n?>\n\n\n\n\n\n","size_bytes":1434},"comp/dance_done_update.php":{"content":"<?php\nheader('Content-Type: application/json');\n$comp_id = $_POST['comp_id'] ?? '';\n$event_no = $_POST['event_no'] ?? '';\n$dance_code = $_POST['dance_code'] ?? '';\n$done = ($_POST['done'] ?? '') === 'true';\n\n// BOM ì œê±°\nif (substr($event_no, 0, 3) === \"\\xEF\\xBB\\xBF\") {\n    $event_no = substr($event_no, 3);\n}\n\nif (!$comp_id || !$event_no || !$dance_code) {\n    echo json_encode(['success'=>false, 'error'=>'í•„ìˆ˜ê°’ ëˆ„ë½']);\n    exit;\n}\n\n$data_dir = __DIR__ . \"/data/$comp_id\";\nif (!is_dir($data_dir)) {\n    echo json_encode(['success'=>false, 'error'=>'ëŒ€íšŒ ë””ë ‰í† ë¦¬ ì—†ìŒ']);\n    exit;\n}\n\n$file = \"$data_dir/dance_done_$event_no.json\";\n$dance_done = [];\nif (is_file($file)) {\n    $content = file_get_contents($file);\n    $dance_done = json_decode($content, true);\n    if (!is_array($dance_done)) $dance_done = [];\n}\n\n$dance_done[$dance_code] = $done;\n\nif (file_put_contents($file, json_encode($dance_done, JSON_UNESCAPED_UNICODE|JSON_PRETTY_PRINT)) === false) {\n    echo json_encode(['success'=>false, 'error'=>'íŒŒì¼ ì €ì¥ ì‹¤íŒ¨']);\n    exit;\n}\n\necho json_encode(['success'=>true]);","size_bytes":1101},"comp/dashboard.php":{"content":"<?php\n$comp_id = $_GET['comp_id'] ?? '';\n$data_dir = __DIR__ . \"/data/$comp_id\";\n$info_file = \"$data_dir/info.json\";\nif (!preg_match('/^\\d{8}-\\d+$/', $comp_id) || !is_file($info_file)) {\n    echo \"<h1>ì˜ëª»ëœ ëŒ€íšŒ ID ë˜ëŠ” ëŒ€íšŒ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</h1>\";\n    exit;\n}\n$info = json_decode(file_get_contents($info_file), true);\n\nfunction count_lines($file) {\n    if (!is_file($file)) return 0;\n    $lines = file($file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    return count($lines);\n}\n\n// ê¸°ì¡´ ë°©ì‹(ì„ ìˆ˜/ì‹¬ì‚¬ìœ„ì›/ì‹œê°„í‘œ)ì€ txt ì¤„ ìˆ˜ë¡œ ì…ˆ\n$counts = [\n    'competitor'   => count_lines(\"$data_dir/players.txt\"),\n    // events.txtëŠ” ë¼ì¸ìˆ˜ ê·¸ëŒ€ë¡œ ì‚¬ìš© (í•„ìš”ì‹œ RunOrder ê¸°ë°˜ìœ¼ë¡œ ë³€ê²½)\n    'events_txt'   => count_lines(\"$data_dir/events.txt\"),\n    'adjudicator'  => count_lines(\"$data_dir/adjudicators.txt\"),\n    'timetable'    => count_lines(\"$data_dir/timetable.txt\"),\n];\n\n// ---- RunOrder ê¸°ë°˜ 'ê²½ê¸° ì´ë²¤íŠ¸' ê°¯ìˆ˜ êµ¬í•˜ê¸° ----\n$runorder_file = \"$data_dir/RunOrder_Tablet.txt\";\n$event_count = 0;\nif (is_file($runorder_file)) {\n    $lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        if (preg_match('/^bom/', $line)) continue;\n        $cols = array_map('trim', explode(',', $line));\n        // ëŒ„ìŠ¤ 1~5 ì¤‘ í•˜ë‚˜ë¼ë„ ê°’ì´ ìˆìœ¼ë©´ ê²½ê¸° ì´ë²¤íŠ¸ë¡œ ê°„ì£¼\n        $has_dance = false;\n        for ($i=6; $i<=10; $i++) {\n            if (isset($cols[$i]) && $cols[$i] !== '') {\n                $has_dance = true;\n                break;\n            }\n        }\n        if ($has_dance) $event_count++;\n    }\n}\nfunction h($s) { return htmlspecialchars($s ?? ''); }\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title><?= h($info['title']) ?> ëŒ€ì‹œë³´ë“œ | danceoffice.net COMP</title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\n    <style>\n        body { background:#1a1a1a; font-family:sans-serif; margin:0;}\n        .dash-main { max-width:850px; margin:3vh auto 0 auto; background:#222; border-radius:18px; box-shadow:0 6px 32px #00339922; padding:2.7em 2em 2.2em 2em;}\n        h1 { color:#fff; font-size:1.35em; margin-bottom:1.4em; text-align:center;}\n        .dash-grid { display:grid; grid-template-columns: 1fr 1fr 1fr 1fr 1fr; gap:1.7em; margin-bottom:2.5em;}\n        .dash-block {\n            background:#181818; border-radius:10px; padding:1.2em 0.8em;\n            display:flex; flex-direction:column; align-items:center;\n            box-shadow:0 2px 12px #0004; cursor:pointer; transition:background 0.15s;\n            min-width:120px; min-height:112px;\n        }\n        .dash-block:hover { background:#2c2c2c;}\n        .dash-block .num { font-size:2.1em; font-weight:700; color:#03C75A; margin-bottom:0.25em;}\n        .dash-block .lbl { color:#fff; font-size:1.08em; font-weight:600; margin-bottom:0.25em;}\n        .dash-block .sub { color:#bbb; font-size:0.96em;}\n        .dash-btns { margin-top:2.5em; display:flex; gap:1.1em; justify-content:center;}\n        .dash-btn {\n            display:inline-block; background:#03C75A; color:#fff; border-radius:13px;\n            padding:0.7em 2.5em; font-weight:700; font-size:1.12em; text-decoration:none;\n            box-shadow:0 2px 8px #03c75a22; transition:background 0.13s;\n        }\n        .dash-btn:hover { background:#00BFAE;}\n        .compinfo {text-align:center; color:#bbb; margin-bottom:2.2em;}\n        .dash-icons {margin-top:2em; text-align:center;}\n        .dash-icons img {width:36px; margin:0 0.8em; opacity:0.8; transition:opacity 0.2s;}\n        .dash-icons img:hover {opacity:1;}\n        a { text-decoration:none;}\n        .goto-list {display:inline-block; margin-bottom:1.2em; color:#bbb;}\n        .goto-list:hover {color:#03C75A;}\n        footer {margin-top:2.2em;text-align:center;font-size:0.92em;color:#aaa; padding: 1em 0;}\n        @media (max-width:1050px) {\n            .dash-main {max-width:99vw;}\n            .dash-grid {grid-template-columns: 1fr 1fr 1fr;}\n        }\n        @media (max-width:700px) {\n            .dash-main {padding:1.3em 0.2em;}\n            .dash-grid {grid-template-columns: 1fr 1fr;}\n        }\n        @media (max-width:430px) {\n            .dash-grid {grid-template-columns: 1fr;}\n        }\n    </style>\n</head>\n<body>\n<div class=\"dash-main\">\n    <a href=\"index.php\" class=\"goto-list\">&lt; ëŒ€íšŒ ëª©ë¡ìœ¼ë¡œ</a>\n    <h1><?= h($info['title']) ?> <span style=\"font-size:0.8em; color:#03C75A;\">ëŒ€ì‹œë³´ë“œ</span></h1>\n    <div class=\"compinfo\">\n        <b>ì¼ì:</b> <?= h($info['date']) ?> <b>ì¥ì†Œ:</b> <?= h($info['place']) ?> <b>ì£¼ìµœ/ì£¼ê´€:</b> <?= h($info['host']) ?>\n    </div>\n    <div class=\"dash-grid\">\n        <a class=\"dash-block\" href=\"manage_competitors.php?comp_id=<?= urlencode($comp_id) ?>\">\n            <div class=\"num\"><?= $counts['competitor'] ?></div>\n            <div class=\"lbl\">Competitors</div>\n            <div class=\"sub\">ì„ ìˆ˜ ëª…ë‹¨</div>\n        </a>\n        <a class=\"dash-block\" href=\"manage_events.php?comp_id=<?= urlencode($comp_id) ?>\">\n            <div class=\"num\"><?= $event_count ?></div>\n            <div class=\"lbl\">Events</div>\n            <div class=\"sub\">ì¢…ëª©/ì´ë²¤íŠ¸</div>\n        </a>\n        <a class=\"dash-block\" href=\"manage_adjudicators.php?comp_id=<?= urlencode($comp_id) ?>\">\n            <div class=\"num\"><?= $counts['adjudicator'] ?></div>\n            <div class=\"lbl\">Adjudicators</div>\n            <div class=\"sub\">ì‹¬ì‚¬ìœ„ì›</div>\n        </a>\n        <a class=\"dash-block\" href=\"manage_timetable.php?comp_id=<?= urlencode($comp_id) ?>\">\n            <div class=\"num\"><?= $counts['timetable'] ?></div>\n            <div class=\"lbl\">Timetable</div>\n            <div class=\"sub\">ì‹œê°„í‘œ</div>\n        </a>\n        <a class=\"dash-block\" href=\"live_panel.php?comp_id=<?= urlencode($comp_id) ?>\">\n            <div class=\"num\">LIVE</div>\n            <div class=\"lbl\">Live Panel</div>\n            <div class=\"sub\">ì§„í–‰/ì‹¬ì‚¬ ì»¨íŠ¸ë¡¤</div>\n        </a>\n    </div>\n    <div class=\"dash-btns\">\n        <a class=\"dash-btn\" href=\"data_manage.php?comp_id=<?= urlencode($comp_id) ?>\">ë°ì´í„° ê´€ë¦¬</a>\n        <a class=\"dash-btn\" href=\"scoring_login.php?comp_id=<?= urlencode($comp_id) ?>\">ì‹¬ì‚¬/ì±„ì </a>\n        <a class=\"dash-btn\" href=\"#\">ê²°ê³¼ ì§‘ê³„</a>\n        <a class=\"dash-btn\" href=\"#\">ìƒì¥ ì¸ì‡„</a>\n    </div>\n    <div class=\"dash-icons\" style=\"margin-top:2.7em;\">\n        <a href=\"index.php\" title=\"í™ˆ\"><img src=\"assets/home_icon.svg\" alt=\"Home\"></a>\n        <a href=\"data_manage.php?comp_id=<?= urlencode($comp_id) ?>\" title=\"DB ê´€ë¦¬\"><img src=\"assets/db_icon.svg\" alt=\"DB\"></a>\n        <a href=\"#\" title=\"ì„¤ì •\"><img src=\"assets/settings_icon.svg\" alt=\"ì„¤ì •\"></a>\n        <a href=\"#\" title=\"ë¦¬ì…‹\"><img src=\"assets/reset_icon.svg\" alt=\"ì´ˆê¸°í™”\"></a>\n    </div>\n</div>\n<footer>\n    2025 danceoffice.net | Powered by Seyoung Lee\n</footer>\n</body>\n</html>","size_bytes":6945},"comp/data_manage.php":{"content":"<?php\n$comp_id = $_GET['comp_id'] ?? '';\n$data_dir = __DIR__ . \"/data/$comp_id\";\n$info_file = \"$data_dir/info.json\";\nif (!preg_match('/^\\d{8}-\\d+$/', $comp_id) || !is_file($info_file)) {\n    echo \"<h1>ì˜ëª»ëœ ëŒ€íšŒ ID ë˜ëŠ” ëŒ€íšŒ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</h1>\";\n    exit;\n}\n$info = json_decode(file_get_contents($info_file), true);\nfunction count_lines($file) {\n    if (!is_file($file)) return 0;\n    $lines = file($file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    return count($lines);\n}\n$counts = [\n    'competitor'   => count_lines(\"$data_dir/players.txt\"),\n    'events'       => count_lines(\"$data_dir/events.txt\"),\n    'adjudicator'  => count_lines(\"$data_dir/adjudicators.txt\"),\n    'timetable'    => count_lines(\"$data_dir/timetable.txt\"),\n];\nfunction h($s) { return htmlspecialchars($s ?? ''); }\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title><?= h($info['title']) ?> ë°ì´í„° ê´€ë¦¬ | danceoffice.net COMP</title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\n    <style>\n        body { background:#1a1a1a; font-family:sans-serif; margin:0;}\n        .mainbox { max-width:900px; margin:3vh auto 0 auto; background:#222; border-radius:18px; box-shadow:0 6px 32px #00339922; padding:2.7em 2em 2.2em 2em;}\n        h1 { color:#fff; font-size:1.25em; margin-bottom:1.4em; text-align:center;}\n        .compinfo {text-align:center; color:#bbb; margin-bottom:2.2em;}\n        .db-grid { display:grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap:1.5em; margin-bottom:2.5em;}\n        .db-block {\n            background:#181818; border-radius:10px; padding:1.3em 0.8em;\n            display:flex; flex-direction:column; align-items:center;\n            box-shadow:0 2px 12px #0004; cursor:pointer; transition:background 0.15s;\n            min-width:120px; min-height:110px;\n        }\n        .db-block:hover { background:#2c2c2c;}\n        .db-block .num { font-size:2em; font-weight:700; color:#03C75A; margin-bottom:0.2em;}\n        .db-block .lbl { color:#fff; font-size:1.05em; font-weight:600; margin-bottom:0.22em;}\n        .db-block .sub { color:#bbb; font-size:0.97em;}\n        .goto-dash {display:inline-block; margin-bottom:1.4em; color:#bbb;}\n        .goto-dash:hover {color:#03C75A;}\n        footer {margin-top:2.2em;text-align:center;font-size:0.92em;color:#aaa; padding: 1em 0;}\n        @media (max-width:1050px) {\n            .mainbox {max-width:99vw;}\n            .db-grid {grid-template-columns: 1fr 1fr;}\n        }\n        @media (max-width:700px) {\n            .mainbox {padding:1.3em 0.2em;}\n            .db-grid {grid-template-columns: 1fr;}\n        }\n    </style>\n</head>\n<body>\n<div class=\"mainbox\">\n    <a href=\"dashboard.php?comp_id=<?= urlencode($comp_id) ?>\" class=\"goto-dash\">&lt; ëŒ€ì‹œë³´ë“œë¡œ</a>\n    <h1><?= h($info['title']) ?> ë°ì´í„° ê´€ë¦¬</h1>\n    <div class=\"compinfo\">\n        <b>ì¼ì:</b> <?= h($info['date']) ?> <b>ì¥ì†Œ:</b> <?= h($info['place']) ?> <b>ì£¼ìµœ/ì£¼ê´€:</b> <?= h($info['host']) ?>\n    </div>\n    <div class=\"db-grid\">\n        <a class=\"db-block\" href=\"manage_competitors.php?comp_id=<?= urlencode($comp_id) ?>\">\n            <div class=\"num\"><?= $counts['competitor'] ?></div>\n            <div class=\"lbl\">Competitors</div>\n            <div class=\"sub\">ì„ ìˆ˜ ëª…ë‹¨ ê´€ë¦¬</div>\n        </a>\n        <a class=\"db-block\" href=\"manage_events.php?comp_id=<?= urlencode($comp_id) ?>\">\n            <div class=\"num\"><?= $counts['events'] ?></div>\n            <div class=\"lbl\">Events</div>\n            <div class=\"sub\">ì¢…ëª©/ì´ë²¤íŠ¸ ê´€ë¦¬</div>\n        </a>\n        <a class=\"db-block\" href=\"manage_adjudicators.php?comp_id=<?= urlencode($comp_id) ?>\">\n            <div class=\"num\"><?= $counts['adjudicator'] ?></div>\n            <div class=\"lbl\">Adjudicators</div>\n            <div class=\"sub\">ì‹¬ì‚¬ìœ„ì› ê´€ë¦¬</div>\n        </a>\n        <a class=\"db-block\" href=\"manage_timetable.php?comp_id=<?= urlencode($comp_id) ?>\">\n            <div class=\"num\"><?= $counts['timetable'] ?></div>\n            <div class=\"lbl\">Timetable</div>\n            <div class=\"sub\">ì‹œê°„í‘œ ê´€ë¦¬</div>\n        </a>\n    </div>\n</div>\n<footer>\n    2025 danceoffice.net | Powered by Seyoung Lee\n</footer>\n</body>\n</html>","size_bytes":4229},"comp/debug_auto_advance.php":{"content":"<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>ìë™ ì „í™˜ ë””ë²„ê¹…</title>\n    <style>\n        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }\n        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }\n        .section { margin-bottom: 30px; padding: 20px; border: 1px solid #ddd; border-radius: 5px; }\n        .success { background: #d4edda; border-color: #c3e6cb; }\n        .error { background: #f8d7da; border-color: #f5c6cb; }\n        .info { background: #d1ecf1; border-color: #bee5eb; }\n        .btn { background: #667eea; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin: 5px; }\n        .btn:hover { background: #5a6fd8; }\n        pre { background: #f8f9fa; padding: 15px; border-radius: 5px; overflow-x: auto; }\n        .log { background: #000; color: #0f0; padding: 15px; border-radius: 5px; font-family: monospace; height: 200px; overflow-y: auto; }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>ğŸ” ìë™ ì „í™˜ ë””ë²„ê¹…</h1>\n        \n        <div class=\"section info\">\n            <h2>ğŸ“‹ í˜„ì¬ ìƒíƒœ</h2>\n            <div id=\"currentStatus\">ë¡œë”© ì¤‘...</div>\n        </div>\n        \n        <div class=\"section\">\n            <h2>ğŸ¯ ì´ë²¤íŠ¸ ê·¸ë£¹ ì •ë³´</h2>\n            <div id=\"eventGroups\">ë¡œë”© ì¤‘...</div>\n        </div>\n        \n        <div class=\"section\">\n            <h2>ğŸ“ ê²°ê³¼ íŒŒì¼ í™•ì¸</h2>\n            <div id=\"resultFiles\">ë¡œë”© ì¤‘...</div>\n        </div>\n        \n        <div class=\"section\">\n            <h2>âš™ï¸ ìë™ ì „í™˜ ì„¤ì •</h2>\n            <div>\n                <button class=\"btn\" onclick=\"testAutoAdvance()\">ìë™ ì „í™˜ í…ŒìŠ¤íŠ¸</button>\n                <button class=\"btn\" onclick=\"checkResultFile()\">ê²°ê³¼ íŒŒì¼ í™•ì¸</button>\n                <button class=\"btn\" onclick=\"forceAdvance()\">ê°•ì œ ë‹¤ìŒ ê·¸ë£¹</button>\n                <button class=\"btn\" onclick=\"resetToFirst()\">ì²« ë²ˆì§¸ ê·¸ë£¹ìœ¼ë¡œ</button>\n            </div>\n        </div>\n        \n        <div class=\"section\">\n            <h2>ğŸ“ ì‹¤ì‹œê°„ ë¡œê·¸</h2>\n            <div id=\"log\" class=\"log\"></div>\n        </div>\n    </div>\n\n    <script>\n        let currentGroupIndex = 0;\n        let events = [];\n        let eventGroups = {};\n        let autoAdvanceEnabled = true;\n        let autoAdvanceTime = 5000;\n        \n        // ë¡œê·¸ í•¨ìˆ˜\n        function log(message) {\n            const logDiv = document.getElementById('log');\n            const timestamp = new Date().toLocaleTimeString();\n            logDiv.innerHTML += `[${timestamp}] ${message}\\n`;\n            logDiv.scrollTop = logDiv.scrollHeight;\n            console.log(message);\n        }\n        \n        // ì´ë²¤íŠ¸ ë¡œë“œ\n        async function loadEvents() {\n            try {\n                log('ì´ë²¤íŠ¸ ë¡œë“œ ì‹œì‘...');\n                const response = await fetch('get_event_schedule.php');\n                const data = await response.json();\n                \n                if (data.success) {\n                    events = data.events;\n                    eventGroups = groupEvents(events);\n                    log(`ì´ë²¤íŠ¸ ë¡œë“œ ì™„ë£Œ: ${events.length}ê°œ ì´ë²¤íŠ¸, ${Object.keys(eventGroups).length}ê°œ ê·¸ë£¹`);\n                    updateDisplay();\n                } else {\n                    log('ì´ë²¤íŠ¸ ë¡œë“œ ì‹¤íŒ¨: ' + data.message);\n                }\n            } catch (error) {\n                log('ì´ë²¤íŠ¸ ë¡œë“œ ì˜¤ë¥˜: ' + error.message);\n            }\n        }\n        \n        // ì´ë²¤íŠ¸ ê·¸ë£¹í™”\n        function groupEvents(events) {\n            const groups = {};\n            events.forEach(event => {\n                const eventNumber = event.id.replace(/[^0-9]/g, '');\n                if (eventNumber && eventNumber !== '') {\n                    if (!groups[eventNumber]) {\n                        groups[eventNumber] = [];\n                    }\n                    groups[eventNumber].push(event);\n                }\n            });\n            \n            const sortedGroups = {};\n            Object.keys(groups).sort((a, b) => parseInt(a) - parseInt(b)).forEach(key => {\n                sortedGroups[key] = groups[key];\n            });\n            \n            return sortedGroups;\n        }\n        \n        // í™”ë©´ ì—…ë°ì´íŠ¸\n        function updateDisplay() {\n            // í˜„ì¬ ìƒíƒœ\n            const groupNumbers = Object.keys(eventGroups).sort((a, b) => parseInt(a) - parseInt(b));\n            const currentGroupNumber = groupNumbers[currentGroupIndex];\n            const currentGroupEvents = eventGroups[currentGroupNumber] || [];\n            \n            document.getElementById('currentStatus').innerHTML = `\n                <p><strong>í˜„ì¬ ê·¸ë£¹:</strong> ${currentGroupIndex + 1}/${groupNumbers.length} (ì´ë²¤íŠ¸ ${currentGroupNumber})</p>\n                <p><strong>ìë™ ì „í™˜:</strong> ${autoAdvanceEnabled ? 'ON' : 'OFF'}</p>\n                <p><strong>ì „í™˜ ì‹œê°„:</strong> ${autoAdvanceTime/1000}ì´ˆ</p>\n            `;\n            \n            // ì´ë²¤íŠ¸ ê·¸ë£¹ ì •ë³´\n            let groupsHtml = '';\n            groupNumbers.forEach((groupNum, index) => {\n                const groupEvents = eventGroups[groupNum];\n                const isActive = index === currentGroupIndex;\n                groupsHtml += `\n                    <div style=\"margin: 10px 0; padding: 10px; border: 1px solid #ddd; border-radius: 5px; ${isActive ? 'background: #e7f3ff;' : ''}\">\n                        <strong>ì´ë²¤íŠ¸ ${groupNum} ${isActive ? '(í˜„ì¬)' : ''}</strong>\n                        <ul>\n                            ${groupEvents.map(event => `\n                                <li>${event.id}: ${event.name} (ê²°ê³¼ë°œí‘œ: ${event.show_result ? 'ON' : 'OFF'})</li>\n                            `).join('')}\n                        </ul>\n                    </div>\n                `;\n            });\n            document.getElementById('eventGroups').innerHTML = groupsHtml;\n            \n            // ê²°ê³¼ íŒŒì¼ í™•ì¸\n            checkResultFiles();\n        }\n        \n        // ê²°ê³¼ íŒŒì¼ í™•ì¸\n        async function checkResultFiles() {\n            const groupNumbers = Object.keys(eventGroups).sort((a, b) => parseInt(a) - parseInt(b));\n            const currentGroupNumber = groupNumbers[currentGroupIndex];\n            const currentGroupEvents = eventGroups[currentGroupNumber] || [];\n            \n            let resultHtml = '';\n            for (const event of currentGroupEvents) {\n                try {\n                    const response = await fetch(`check_result_file.php?event=${event.id}`);\n                    const data = await response.json();\n                    resultHtml += `\n                        <p><strong>${event.id}:</strong> \n                            ${data.exists ? 'âœ… ê²°ê³¼ íŒŒì¼ ì¡´ì¬' : 'âŒ ê²°ê³¼ íŒŒì¼ ì—†ìŒ'}\n                            ${data.file_info ? ` (í¬ê¸°: ${data.file_info.size}bytes)` : ''}\n                        </p>\n                    `;\n                } catch (error) {\n                    resultHtml += `<p><strong>${event.id}:</strong> âŒ í™•ì¸ ì˜¤ë¥˜</p>`;\n                }\n            }\n            document.getElementById('resultFiles').innerHTML = resultHtml || '<p>í˜„ì¬ ê·¸ë£¹ì— ì´ë²¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';\n        }\n        \n        // ìë™ ì „í™˜ í…ŒìŠ¤íŠ¸\n        async function testAutoAdvance() {\n            log('ìë™ ì „í™˜ í…ŒìŠ¤íŠ¸ ì‹œì‘...');\n            const groupNumbers = Object.keys(eventGroups).sort((a, b) => parseInt(a) - parseInt(b));\n            const currentGroupNumber = groupNumbers[currentGroupIndex];\n            const currentGroupEvents = eventGroups[currentGroupNumber] || [];\n            \n            log(`í˜„ì¬ ê·¸ë£¹ ${currentGroupNumber}: ${currentGroupEvents.length}ê°œ ì´ë²¤íŠ¸ í™•ì¸ ì¤‘...`);\n            \n            let foundResult = false;\n            for (const event of currentGroupEvents) {\n                log(`ê²°ê³¼ íŒŒì¼ í™•ì¸ ì¤‘: ${event.id}`);\n                \n                try {\n                    const response = await fetch(`check_result_file.php?event=${event.id}`);\n                    const data = await response.json();\n                    \n                    if (data.exists) {\n                        log(`âœ… ê²°ê³¼ íŒŒì¼ ë°œê²¬: ${event.id}`);\n                        foundResult = true;\n                        break;\n                    } else {\n                        log(`âŒ ê²°ê³¼ íŒŒì¼ ì—†ìŒ: ${event.id}`);\n                    }\n                } catch (error) {\n                    log(`ê²°ê³¼ íŒŒì¼ í™•ì¸ ì˜¤ë¥˜ (${event.id}): ${error.message}`);\n                }\n            }\n            \n            if (foundResult) {\n                log(`ìë™ ì „í™˜ ì‹œë®¬ë ˆì´ì…˜: ${autoAdvanceTime/1000}ì´ˆ í›„ ë‹¤ìŒ ê·¸ë£¹ìœ¼ë¡œ...`);\n                \n                setTimeout(() => {\n                    if (currentGroupIndex < groupNumbers.length - 1) {\n                        currentGroupIndex++;\n                        log(`ìë™ ì „í™˜ ì™„ë£Œ: ì´ë²¤íŠ¸ ${groupNumbers[currentGroupIndex]}ë¡œ ì´ë™`);\n                        updateDisplay();\n                    } else {\n                        log('ëª¨ë“  ì´ë²¤íŠ¸ ì™„ë£Œ');\n                    }\n                }, autoAdvanceTime);\n            } else {\n                log('í˜„ì¬ ê·¸ë£¹ì— ê²°ê³¼ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.');\n            }\n        }\n        \n        // ê²°ê³¼ íŒŒì¼ í™•ì¸\n        function checkResultFile() {\n            log('ê²°ê³¼ íŒŒì¼ í™•ì¸ ì¤‘...');\n            checkResultFiles();\n        }\n        \n        // ê°•ì œ ë‹¤ìŒ ê·¸ë£¹\n        function forceAdvance() {\n            const groupNumbers = Object.keys(eventGroups).sort((a, b) => parseInt(a) - parseInt(b));\n            if (currentGroupIndex < groupNumbers.length - 1) {\n                currentGroupIndex++;\n                log(`ê°•ì œ ë‹¤ìŒ ê·¸ë£¹: ì´ë²¤íŠ¸ ${groupNumbers[currentGroupIndex]}ë¡œ ì´ë™`);\n                updateDisplay();\n            } else {\n                log('ë§ˆì§€ë§‰ ê·¸ë£¹ì…ë‹ˆë‹¤.');\n            }\n        }\n        \n        // ì²« ë²ˆì§¸ ê·¸ë£¹ìœ¼ë¡œ\n        function resetToFirst() {\n            currentGroupIndex = 0;\n            log('ì²« ë²ˆì§¸ ê·¸ë£¹ìœ¼ë¡œ ë¦¬ì…‹');\n            updateDisplay();\n        }\n        \n        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹œì‘\n        document.addEventListener('DOMContentLoaded', function() {\n            log('ë””ë²„ê¹… í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ');\n            loadEvents();\n        });\n    </script>\n</body>\n</html>\n","size_bytes":10706},"comp/debug_event_data.php":{"content":"<?php\n/**\n * ì´ë²¤íŠ¸ ë°ì´í„° ë””ë²„ê¹… API\n */\n\nheader('Content-Type: application/json');\n\n// ì´ë²¤íŠ¸ ìˆœì„œ íŒŒì¼ ê²½ë¡œ\n$eventFile = __DIR__ . '/uploads/event_schedule.txt';\n$statusFile = __DIR__ . '/uploads/event_status.json';\n\n$events = [];\n$debugInfo = [];\n\nif (file_exists($eventFile)) {\n    $lines = file($eventFile, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    $debugInfo['file_exists'] = true;\n    $debugInfo['file_lines'] = count($lines);\n    \n    // ìƒíƒœ ë¡œë“œ\n    $status = [];\n    if (file_exists($statusFile)) {\n        $status = json_decode(file_get_contents($statusFile), true) ?: [];\n    }\n    \n    foreach ($lines as $lineNum => $line) {\n        $parts = explode(',', $line);\n        $debugInfo['line_' . ($lineNum + 1)] = [\n            'raw' => $line,\n            'parts' => $parts,\n            'part_count' => count($parts)\n        ];\n        \n        if (count($parts) >= 3) {\n            $eventId = trim($parts[0]);\n            $showResult = trim($parts[2]) === '1';\n            \n            $events[] = [\n                'id' => $eventId,\n                'name' => trim($parts[1]),\n                'show_result' => isset($status[$eventId]) ? $status[$eventId] : $showResult\n            ];\n        }\n    }\n} else {\n    $debugInfo['file_exists'] = false;\n}\n\n// ê·¸ë£¹í™” í…ŒìŠ¤íŠ¸\n$groupedEvents = [];\nforeach ($events as $event) {\n    $eventNumber = preg_replace('/[^0-9]/', '', $event['id']);\n    if ($eventNumber && $eventNumber !== '') {\n        if (!isset($groupedEvents[$eventNumber])) {\n            $groupedEvents[$eventNumber] = [];\n        }\n        $groupedEvents[$eventNumber][] = $event;\n    }\n}\n\n// ìˆ«ì ìˆœìœ¼ë¡œ ì •ë ¬\nksort($groupedEvents, SORT_NUMERIC);\n\necho json_encode([\n    'success' => true,\n    'events' => $events,\n    'grouped_events' => $groupedEvents,\n    'debug_info' => $debugInfo,\n    'total_events' => count($events),\n    'total_groups' => count($groupedEvents)\n], JSON_PRETTY_PRINT | JSON_UNESCAPED_UNICODE);\n?>\n\n\n\n\n","size_bytes":1988},"comp/debug_events.php":{"content":"<?php\n/**\n * ì´ë²¤íŠ¸ ê·¸ë£¹í™” ë””ë²„ê¹… í˜ì´ì§€\n */\n\n// í…ŒìŠ¤íŠ¸ìš© ì´ë²¤íŠ¸ ë°ì´í„°\n$testEvents = [\n    ['id' => '1A', 'name' => 'ì§€ì  ë¼í‹´', 'show_result' => true],\n    ['id' => '1B', 'name' => 'ì‹œê° ë¼í‹´', 'show_result' => false],\n    ['id' => '1C', 'name' => 'ì²­ê° ë¼í‹´', 'show_result' => true],\n    ['id' => '2A', 'name' => 'ì§€ì  ìŠ¤íƒ ë”ë“œ', 'show_result' => true],\n    ['id' => '2B', 'name' => 'ì‹œê° ìŠ¤íƒ ë”ë“œ', 'show_result' => false],\n    ['id' => '2C', 'name' => 'ì²­ê° ìŠ¤íƒ ë”ë“œ', 'show_result' => true],\n    ['id' => '3A', 'name' => 'ì§€ì  ì™ˆì¸ ', 'show_result' => true],\n    ['id' => '3B', 'name' => 'ì‹œê° ì™ˆì¸ ', 'show_result' => false],\n    ['id' => '3C', 'name' => 'ì²­ê° ì™ˆì¸ ', 'show_result' => true],\n];\n\n// ê·¸ë£¹í™” í•¨ìˆ˜\nfunction groupEvents($events) {\n    $groups = [];\n    \n    foreach ($events as $event) {\n        // ì´ë²¤íŠ¸ IDì—ì„œ ìˆ«ì ë¶€ë¶„ ì¶”ì¶œ (ì˜ˆ: 1A -> 1, 2B -> 2)\n        $eventNumber = preg_replace('/[^0-9]/', '', $event['id']);\n        \n        if ($eventNumber && $eventNumber !== '') {\n            if (!isset($groups[$eventNumber])) {\n                $groups[$eventNumber] = [];\n            }\n            $groups[$eventNumber][] = $event;\n        }\n    }\n    \n    // ìˆ«ì ìˆœìœ¼ë¡œ ì •ë ¬\n    ksort($groups, SORT_NUMERIC);\n    \n    return $groups;\n}\n\n$groupedEvents = groupEvents($testEvents);\n\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>ì´ë²¤íŠ¸ ê·¸ë£¹í™” ë””ë²„ê¹…</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            margin: 20px;\n            background: #f5f5f5;\n        }\n        \n        .container {\n            max-width: 1200px;\n            margin: 0 auto;\n            background: white;\n            padding: 20px;\n            border-radius: 10px;\n            box-shadow: 0 0 20px rgba(0,0,0,0.1);\n        }\n        \n        .header {\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n            padding: 20px;\n            border-radius: 10px;\n            margin-bottom: 30px;\n            text-align: center;\n        }\n        \n        .section {\n            margin-bottom: 30px;\n            padding: 20px;\n            border: 1px solid #ddd;\n            border-radius: 10px;\n        }\n        \n        .section h3 {\n            color: #333;\n            margin-bottom: 15px;\n        }\n        \n        .event-group {\n            margin-bottom: 20px;\n            padding: 15px;\n            background: #f8f9fa;\n            border-radius: 5px;\n            text-align: center;\n        }\n        \n        .group-title {\n            font-size: 1.5em;\n            font-weight: bold;\n            color: #667eea;\n            margin-bottom: 10px;\n            text-align: center;\n        }\n        \n        .event-item {\n            padding: 5px 0;\n            border-bottom: 1px solid #eee;\n            text-align: center;\n        }\n        \n        .event-item:last-child {\n            border-bottom: none;\n        }\n        \n        .event-name {\n            color: #666;\n            font-weight: 500;\n        }\n        \n        .status-badge {\n            padding: 2px 6px;\n            border-radius: 3px;\n            font-size: 12px;\n            margin-left: 10px;\n        }\n        \n        .status-show {\n            background: #d4edda;\n            color: #155724;\n        }\n        \n        .status-hide {\n            background: #f8d7da;\n            color: #721c24;\n        }\n        \n        .json-output {\n            background: #f8f9fa;\n            padding: 15px;\n            border-radius: 5px;\n            font-family: monospace;\n            white-space: pre-wrap;\n            overflow-x: auto;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>ğŸ” ì´ë²¤íŠ¸ ê·¸ë£¹í™” ë””ë²„ê¹…</h1>\n            <p>ì´ë²¤íŠ¸ê°€ ì˜¬ë°”ë¥´ê²Œ ê·¸ë£¹í™”ë˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”</p>\n        </div>\n        \n        <div class=\"section\">\n            <h3>ğŸ“‹ ì›ë³¸ ì´ë²¤íŠ¸ ë°ì´í„°</h3>\n            <div class=\"json-output\"><?php echo json_encode($testEvents, JSON_PRETTY_PRINT | JSON_UNESCAPED_UNICODE); ?></div>\n        </div>\n        \n        <div class=\"section\">\n            <h3>ğŸ¯ ê·¸ë£¹í™”ëœ ì´ë²¤íŠ¸</h3>\n            <?php foreach ($groupedEvents as $groupNumber => $groupEvents): ?>\n            <div class=\"event-group\">\n                <div class=\"group-title\">ì´ë²¤íŠ¸ <?php echo $groupNumber; ?> (<?php echo count($groupEvents); ?>ê°œ)</div>\n                <?php foreach ($groupEvents as $event): ?>\n                <div class=\"event-item\">\n                    <span class=\"event-name\"><?php echo htmlspecialchars($event['name']); ?></span>\n                    <span class=\"status-badge <?php echo $event['show_result'] ? 'status-show' : 'status-hide'; ?>\">\n                        <?php echo $event['show_result'] ? 'ë°œí‘œ' : 'ëŒ€ê¸°'; ?>\n                    </span>\n                </div>\n                <?php endforeach; ?>\n            </div>\n            <?php endforeach; ?>\n        </div>\n        \n        <div class=\"section\">\n            <h3>ğŸ“Š ê·¸ë£¹í™” ê²°ê³¼ JSON</h3>\n            <div class=\"json-output\"><?php echo json_encode($groupedEvents, JSON_PRETTY_PRINT | JSON_UNESCAPED_UNICODE); ?></div>\n        </div>\n        \n        <div class=\"section\">\n            <h3>ğŸ§ª í…ŒìŠ¤íŠ¸ ë§í¬</h3>\n            <p>\n                <a href=\"event_monitor_v2.php\" target=\"_blank\" style=\"color: #007bff; text-decoration: none; font-weight: bold;\">\n                    ğŸ“º ê·¸ë£¹ ëª¨ë‹ˆí„°ë§ í…ŒìŠ¤íŠ¸\n                </a>\n            </p>\n        </div>\n    </div>\n</body>\n</html>\n","size_bytes":5766},"comp/debug_path.php":{"content":"<?php\n/**\n * ê²½ë¡œ ë””ë²„ê¹… íŒŒì¼\n */\n\necho \"<h1>ğŸ” ê²½ë¡œ ë””ë²„ê¹…</h1>\";\n\n// ë‹¤ì–‘í•œ ê²½ë¡œ í˜•ì‹ í…ŒìŠ¤íŠ¸\n$paths = [\n    \"Y:/results/results\",\n    \"Y:\\\\results\\\\results\", \n    \"Y:/results/results/\",\n    \"Y:\\\\results\\\\results\\\\\",\n    \"Y:/results\",\n    \"Y:\\\\results\"\n];\n\necho \"<h2>ğŸ“ ê²½ë¡œ í…ŒìŠ¤íŠ¸</h2>\";\n\nforeach ($paths as $path) {\n    echo \"<div style='border: 1px solid #ddd; padding: 10px; margin: 5px;'>\";\n    echo \"<strong>ê²½ë¡œ:</strong> \" . $path . \"<br>\";\n    echo \"<strong>í´ë” ì¡´ì¬:</strong> \" . (is_dir($path) ? \"âœ… YES\" : \"âŒ NO\") . \"<br>\";\n    echo \"<strong>ì½ê¸° ê°€ëŠ¥:</strong> \" . (is_readable($path) ? \"âœ… YES\" : \"âŒ NO\") . \"<br>\";\n    \n    if (is_dir($path)) {\n        $files = glob($path . \"/*.html\");\n        echo \"<strong>HTML íŒŒì¼ ìˆ˜:</strong> \" . count($files) . \"<br>\";\n        \n        if (count($files) > 0) {\n            echo \"<strong>íŒŒì¼ ëª©ë¡ (ì²˜ìŒ 5ê°œ):</strong><br>\";\n            for ($i = 0; $i < min(5, count($files)); $i++) {\n                echo \"- \" . basename($files[$i]) . \"<br>\";\n            }\n        }\n    }\n    echo \"</div>\";\n}\n\n// í˜„ì¬ ì‘ì—… ë””ë ‰í† ë¦¬ í™•ì¸\necho \"<h2>ğŸ“‚ í˜„ì¬ ì‘ì—… ë””ë ‰í† ë¦¬</h2>\";\necho \"<strong>getcwd():</strong> \" . getcwd() . \"<br>\";\necho \"<strong>__DIR__:</strong> \" . __DIR__ . \"<br>\";\n\n// ìƒëŒ€ ê²½ë¡œ í…ŒìŠ¤íŠ¸\n$relativePath = __DIR__ . \"/../results/results\";\necho \"<h2>ğŸ”— ìƒëŒ€ ê²½ë¡œ í…ŒìŠ¤íŠ¸</h2>\";\necho \"<strong>ìƒëŒ€ ê²½ë¡œ:</strong> \" . $relativePath . \"<br>\";\necho \"<strong>í´ë” ì¡´ì¬:</strong> \" . (is_dir($relativePath) ? \"âœ… YES\" : \"âŒ NO\") . \"<br>\";\necho \"<strong>ì½ê¸° ê°€ëŠ¥:</strong> \" . (is_readable($relativePath) ? \"âœ… YES\" : \"âŒ NO\") . \"<br>\";\n\nif (is_dir($relativePath)) {\n    $files = glob($relativePath . \"/*.html\");\n    echo \"<strong>HTML íŒŒì¼ ìˆ˜:</strong> \" . count($files) . \"<br>\";\n}\n\n// ë“œë¼ì´ë¸Œ í™•ì¸\necho \"<h2>ğŸ’¾ ë“œë¼ì´ë¸Œ í™•ì¸</h2>\";\n$drives = ['Y:', 'C:', 'D:'];\nforeach ($drives as $drive) {\n    echo \"<strong>{$drive} ë“œë¼ì´ë¸Œ:</strong> \" . (is_dir($drive) ? \"âœ… ì¡´ì¬\" : \"âŒ ì—†ìŒ\") . \"<br>\";\n}\n?>\n\n\n\n\n","size_bytes":2094},"comp/debug_router.php":{"content":"<?php\n/**\n * ë””ë²„ê·¸ìš© ë¼ìš°í„° - ë‹¨ê³„ë³„ í…ŒìŠ¤íŠ¸\n */\n\n// session_start(); // ì„ì‹œë¡œ ì£¼ì„ ì²˜ë¦¬\n\n// HTML ì´ìŠ¤ì¼€ì´í”„ í•¨ìˆ˜\nfunction h($s) {\n    return htmlspecialchars($s ?? '');\n}\n\n$comp_id = $_GET['comp_id'] ?? '';\n$event_no = $_GET['event_no'] ?? '';\n$lang = $_GET['lang'] ?? 'ko';\n\necho \"<h1>Debug Router Test</h1>\";\necho \"<p>Comp ID: \" . h($comp_id) . \"</p>\";\necho \"<p>Event No: \" . h($event_no) . \"</p>\";\necho \"<p>Language: \" . h($lang) . \"</p>\";\n\n// Step 1: functions.php í¬í•¨\necho \"<h2>Step 1: Including functions.php</h2>\";\nrequire_once __DIR__ . '/scoring/shared/functions.php';\necho \"<p style='color: green;'>âœ“ functions.php included successfully!</p>\";\n\n// Step 2: ì´ë²¤íŠ¸ ë°ì´í„° ë¡œë“œ\necho \"<h2>Step 2: Loading event data</h2>\";\ntry {\n    $event_data = loadEventData($comp_id, $event_no);\n    if ($event_data) {\n        echo \"<p style='color: green;'>âœ“ Event Data Loaded: \" . h($event_data['name']) . \"</p>\";\n    } else {\n        echo \"<p style='color: red;'>âœ— Failed to load event data.</p>\";\n        die();\n    }\n} catch (Exception $e) {\n    echo \"<p style='color: red;'>âœ— Error loading event data: \" . h($e->getMessage()) . \"</p>\";\n    die();\n}\n\n// Step 3: ì„ ìˆ˜ ë°ì´í„° ë¡œë“œ\necho \"<h2>Step 3: Loading players data</h2>\";\ntry {\n    $players = loadPlayersData($comp_id, $event_no);\n    if ($players) {\n        echo \"<p style='color: green;'>âœ“ Players Data Loaded: \" . count($players) . \" players</p>\";\n    } else {\n        echo \"<p style='color: red;'>âœ— Failed to load players data.</p>\";\n        die();\n    }\n} catch (Exception $e) {\n    echo \"<p style='color: red;'>âœ— Error loading players data: \" . h($e->getMessage()) . \"</p>\";\n    die();\n}\n\n// Step 4: ëŒ„ìŠ¤ ë§¤í•‘ ë¡œë“œ\necho \"<h2>Step 4: Loading dance mapping</h2>\";\ntry {\n    $dance_mapping = loadDanceMapping($comp_id);\n    echo \"<p style='color: green;'>âœ“ Dance mapping loaded: \" . count($dance_mapping) . \" dances</p>\";\n} catch (Exception $e) {\n    echo \"<p style='color: red;'>âœ— Error loading dance mapping: \" . h($e->getMessage()) . \"</p>\";\n    die();\n}\n\n// Step 5: ë¼ìš´ë“œ ì •ë³´ ë¡œë“œ\necho \"<h2>Step 5: Loading round info</h2>\";\ntry {\n    $round_info = loadRoundInfo($comp_id);\n    echo \"<p style='color: green;'>âœ“ Round info loaded</p>\";\n} catch (Exception $e) {\n    echo \"<p style='color: red;'>âœ— Error loading round info: \" . h($e->getMessage()) . \"</p>\";\n    die();\n}\n\n// Step 6: ê²°ìŠ¹ì „ ì—¬ë¶€ í™•ì¸\necho \"<h2>Step 6: Checking if final round</h2>\";\ntry {\n    $is_final = isFinalRound($event_no, $round_info, $event_data);\n    echo \"<p style='color: green;'>âœ“ Is final round: \" . ($is_final ? 'TRUE' : 'FALSE') . \"</p>\";\n} catch (Exception $e) {\n    echo \"<p style='color: red;'>âœ— Error checking final round: \" . h($e->getMessage()) . \"</p>\";\n    die();\n}\n\n// Step 7: ì–¸ì–´ í…ìŠ¤íŠ¸ ë¡œë“œ\necho \"<h2>Step 7: Loading language texts</h2>\";\ntry {\n    $t = getLanguageTexts($lang);\n    echo \"<p style='color: green;'>âœ“ Language texts loaded</p>\";\n} catch (Exception $e) {\n    echo \"<p style='color: red;'>âœ— Error loading language texts: \" . h($e->getMessage()) . \"</p>\";\n    die();\n}\n\n// Step 8: ì‹¬ì‚¬ ë°©ì‹ ê²°ì •\necho \"<h2>Step 8: Determining scoring type</h2>\";\n$scoring_type = 'multievent_final'; // ê¸°ë³¸ê°’\n\n$scoring_type_mapping = [\n    '8' => 'multievent_final',\n    '9' => 'multievent_preliminary',\n    '10' => 'freestyle',\n    '11' => 'formation',\n    '12' => 'multievent_final_only'\n];\n\nif (isset($scoring_type_mapping[$event_no])) {\n    $scoring_type = $scoring_type_mapping[$event_no];\n} elseif ($is_final || $event_no === '8') {\n    $scoring_type = 'multievent_final';\n}\n\necho \"<p style='color: green;'>âœ“ Scoring type determined: \" . h($scoring_type) . \"</p>\";\n\n// Step 9: ì‹¬ì‚¬ íŒŒì¼ ì¡´ì¬ í™•ì¸\necho \"<h2>Step 9: Checking scoring file</h2>\";\n$scoring_file = __DIR__ . \"/scoring/types/{$scoring_type}.php\";\necho \"<p>File path: \" . h($scoring_file) . \"</p>\";\nif (file_exists($scoring_file)) {\n    echo \"<p style='color: green;'>âœ“ Scoring file exists</p>\";\n} else {\n    echo \"<p style='color: red;'>âœ— Scoring file does not exist!</p>\";\n    die();\n}\n\necho \"<h2 style='color: green;'>All steps completed successfully!</h2>\";\necho \"<p>Now you can try the full router: <a href='judge_scoring_router.php?comp_id=\" . h($comp_id) . \"&event_no=\" . h($event_no) . \"&lang=\" . h($lang) . \"'>judge_scoring_router.php</a></p>\";\n?>\n","size_bytes":4395},"comp/debug_router2.php":{"content":"<?php\n/**\n * ë””ë²„ê·¸ìš© ë¼ìš°í„° - ë‹¨ê³„ë³„ í…ŒìŠ¤íŠ¸ (ìˆ˜ì •ëœ ë²„ì „)\n */\n\necho \"<h1>Debug Router Test</h1>\";\n\n$comp_id = $_GET['comp_id'] ?? '';\n$event_no = $_GET['event_no'] ?? '';\n$lang = $_GET['lang'] ?? 'ko';\n\necho \"<p>Comp ID: \" . htmlspecialchars($comp_id) . \"</p>\";\necho \"<p>Event No: \" . htmlspecialchars($event_no) . \"</p>\";\necho \"<p>Language: \" . htmlspecialchars($lang) . \"</p>\";\n\n// Step 1: functions.php í¬í•¨\necho \"<h2>Step 1: Including functions.php</h2>\";\nrequire_once __DIR__ . '/scoring/shared/functions.php';\necho \"<p style='color: green;'>âœ“ functions.php included successfully!</p>\";\n\n// Step 2: ì´ë²¤íŠ¸ ë°ì´í„° ë¡œë“œ\necho \"<h2>Step 2: Loading event data</h2>\";\n$event_data = loadEventData($comp_id, $event_no);\nif ($event_data) {\n    echo \"<p style='color: green;'>âœ“ Event Data Loaded: \" . htmlspecialchars($event_data['name']) . \"</p>\";\n} else {\n    echo \"<p style='color: red;'>âœ— Failed to load event data.</p>\";\n    die();\n}\n\n// Step 3: ì„ ìˆ˜ ë°ì´í„° ë¡œë“œ\necho \"<h2>Step 3: Loading players data</h2>\";\n$players = loadPlayersData($comp_id, $event_no);\nif ($players) {\n    echo \"<p style='color: green;'>âœ“ Players Data Loaded: \" . count($players) . \" players</p>\";\n} else {\n    echo \"<p style='color: red;'>âœ— Failed to load players data.</p>\";\n    die();\n}\n\n// Step 4: ëŒ„ìŠ¤ ë§¤í•‘ ë¡œë“œ\necho \"<h2>Step 4: Loading dance mapping</h2>\";\n$dance_mapping = loadDanceMapping($comp_id);\necho \"<p style='color: green;'>âœ“ Dance mapping loaded: \" . count($dance_mapping) . \" dances</p>\";\n\n// Step 5: ë¼ìš´ë“œ ì •ë³´ ë¡œë“œ\necho \"<h2>Step 5: Loading round info</h2>\";\n$round_info = loadRoundInfo($comp_id);\necho \"<p style='color: green;'>âœ“ Round info loaded</p>\";\n\n// Step 6: ê²°ìŠ¹ì „ ì—¬ë¶€ í™•ì¸\necho \"<h2>Step 6: Checking if final round</h2>\";\n$is_final = isFinalRound($event_no, $round_info, $event_data);\necho \"<p style='color: green;'>âœ“ Is final round: \" . ($is_final ? 'TRUE' : 'FALSE') . \"</p>\";\n\n// Step 7: ì–¸ì–´ í…ìŠ¤íŠ¸ ë¡œë“œ\necho \"<h2>Step 7: Loading language texts</h2>\";\n$t = getLanguageTexts($lang);\necho \"<p style='color: green;'>âœ“ Language texts loaded</p>\";\n\n// Step 8: ì‹¬ì‚¬ ë°©ì‹ ê²°ì •\necho \"<h2>Step 8: Determining scoring type</h2>\";\n$scoring_type = 'multievent_final'; // ê¸°ë³¸ê°’\n\n$scoring_type_mapping = [\n    '8' => 'multievent_final',\n    '9' => 'multievent_preliminary',\n    '10' => 'freestyle',\n    '11' => 'formation',\n    '12' => 'multievent_final_only'\n];\n\nif (isset($scoring_type_mapping[$event_no])) {\n    $scoring_type = $scoring_type_mapping[$event_no];\n} elseif ($is_final || $event_no === '8') {\n    $scoring_type = 'multievent_final';\n}\n\necho \"<p style='color: green;'>âœ“ Scoring type determined: \" . htmlspecialchars($scoring_type) . \"</p>\";\n\n// Step 9: ì‹¬ì‚¬ íŒŒì¼ ì¡´ì¬ í™•ì¸\necho \"<h2>Step 9: Checking scoring file</h2>\";\n$scoring_file = __DIR__ . \"/scoring/types/{$scoring_type}.php\";\necho \"<p>File path: \" . htmlspecialchars($scoring_file) . \"</p>\";\nif (file_exists($scoring_file)) {\n    echo \"<p style='color: green;'>âœ“ Scoring file exists</p>\";\n} else {\n    echo \"<p style='color: red;'>âœ— Scoring file does not exist!</p>\";\n    die();\n}\n\necho \"<h2 style='color: green;'>All steps completed successfully!</h2>\";\necho \"<p>Now you can try the full router: <a href='judge_scoring_router.php?comp_id=\" . htmlspecialchars($comp_id) . \"&event_no=\" . htmlspecialchars($event_no) . \"&lang=\" . htmlspecialchars($lang) . \"'>judge_scoring_router.php</a></p>\";\n?>\n\n\n\n\n\n\n","size_bytes":3473},"comp/debug_simple.php":{"content":"<?php\necho \"<h1>Debug Simple Test</h1>\";\n\necho \"<p>Step 1: Starting...</p>\";\n\necho \"<p>Step 2: Including functions.php...</p>\";\nrequire_once __DIR__ . '/scoring/shared/functions.php';\n\necho \"<p>Step 3: functions.php included successfully!</p>\";\n\necho \"<p>Step 4: Testing basic functions...</p>\";\n\n$comp_id = '20250907-001';\n$event_no = '8';\n\necho \"<p>Step 5: Loading event data...</p>\";\n$event_data = loadEventData($comp_id, $event_no);\necho \"<p>Event data loaded: \" . (isset($event_data['name']) ? $event_data['name'] : 'No name') . \"</p>\";\n\necho \"<p>Step 6: Loading players data...</p>\";\n$players = loadPlayersData($comp_id, $event_no);\necho \"<p>Players loaded: \" . count($players) . \" players</p>\";\n\necho \"<p style='color: green; font-weight: bold;'>All tests completed successfully!</p>\";\n?>\n\n\n\n\n\n\n","size_bytes":802},"comp/debug_test.php":{"content":"<?php\necho \"PHP is working!<br>\";\necho \"Current time: \" . date('Y-m-d H:i:s') . \"<br>\";\n\n// ì„¸ì…˜ í…ŒìŠ¤íŠ¸\nsession_start();\necho \"Session started successfully<br>\";\n\n// GET íŒŒë¼ë¯¸í„° í…ŒìŠ¤íŠ¸\n$comp_id = $_GET['comp_id'] ?? '';\n$event_no = $_GET['event_no'] ?? '';\necho \"comp_id: \" . htmlspecialchars($comp_id) . \"<br>\";\necho \"event_no: \" . htmlspecialchars($event_no) . \"<br>\";\n\n// íŒŒì¼ ì¡´ì¬ í…ŒìŠ¤íŠ¸\n$data_dir = __DIR__ . \"/data/$comp_id\";\necho \"Data directory: \" . $data_dir . \"<br>\";\necho \"Directory exists: \" . (is_dir($data_dir) ? 'YES' : 'NO') . \"<br>\";\n\nif (is_dir($data_dir)) {\n    $files = scandir($data_dir);\n    echo \"Files in directory: \" . implode(', ', $files) . \"<br>\";\n}\n\necho \"Test completed successfully!<br>\";\n?>","size_bytes":742},"comp/detail_numbers_manager.php":{"content":"<?php\n// ì„¸ë¶€ë²ˆí˜¸ ê´€ë¦¬ ì‹œìŠ¤í…œ\n\nfunction loadDetailNumbers($comp_id) {\n    $data_dir = __DIR__ . \"/data/$comp_id\";\n    $detail_file = \"$data_dir/detail_numbers.json\";\n    \n    if (file_exists($detail_file)) {\n        $data = json_decode(file_get_contents($detail_file), true);\n        return $data ?: [];\n    }\n    \n    return [];\n}\n\nfunction saveDetailNumbers($comp_id, $detail_numbers) {\n    $data_dir = __DIR__ . \"/data/$comp_id\";\n    if (!is_dir($data_dir)) {\n        mkdir($data_dir, 0777, true);\n    }\n    \n    $detail_file = \"$data_dir/detail_numbers.json\";\n    file_put_contents($detail_file, json_encode($detail_numbers, JSON_UNESCAPED_UNICODE|JSON_PRETTY_PRINT));\n}\n\nfunction generateDetailNumbers($events) {\n    $detail_numbers = [];\n    $group_counters = [];\n    \n    foreach ($events as $idx => $event) {\n        $raw_no = $event['raw_no'];\n        $group_no = preg_replace('/[^0-9]/', '', $raw_no); // ìˆ«ìë§Œ ì¶”ì¶œ\n        \n        if (!isset($group_counters[$group_no])) {\n            $group_counters[$group_no] = 0;\n        }\n        $group_counters[$group_no]++;\n        \n        $detail_numbers[] = [\n            'event_idx' => $idx,\n            'raw_no' => $raw_no,\n            'group_no' => $group_no,\n            'detail_no' => $group_no . '-' . $group_counters[$group_no],\n            'name' => $event['name'],\n            'dances' => $event['dances']\n        ];\n    }\n    \n    return $detail_numbers;\n}\n\nfunction getDetailNumber($comp_id, $raw_no, $name = '') {\n    $detail_numbers = loadDetailNumbers($comp_id);\n    \n    foreach ($detail_numbers as $detail) {\n        if ($detail['raw_no'] === $raw_no && ($name === '' || $detail['name'] === $name)) {\n            return $detail['detail_no'];\n        }\n    }\n    \n    return $raw_no; // ì„¸ë¶€ë²ˆí˜¸ê°€ ì—†ìœ¼ë©´ ì›ë³¸ ë²ˆí˜¸ ë°˜í™˜\n}\n\nfunction updateDetailNumber($comp_id, $raw_no, $name, $new_detail_no) {\n    $detail_numbers = loadDetailNumbers($comp_id);\n    \n    foreach ($detail_numbers as &$detail) {\n        if ($detail['raw_no'] === $raw_no && $detail['name'] === $name) {\n            $detail['detail_no'] = $new_detail_no;\n            saveDetailNumbers($comp_id, $detail_numbers);\n            return true;\n        }\n    }\n    \n    return false;\n}\n\nfunction getEventByDetailNumber($comp_id, $detail_no) {\n    $detail_numbers = loadDetailNumbers($comp_id);\n    \n    foreach ($detail_numbers as $detail) {\n        if ($detail['detail_no'] === $detail_no) {\n            return $detail;\n        }\n    }\n    \n    return null;\n}\n\nfunction getPlayersByDetailNumber($comp_id, $detail_no) {\n    $players_file = __DIR__ . \"/data/$comp_id/players_{$detail_no}.txt\";\n    if (file_exists($players_file)) {\n        $lines = file($players_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n        return array_filter(array_map('trim', $lines));\n    }\n    \n    return [];\n}\n\nfunction savePlayersByDetailNumber($comp_id, $detail_no, $players) {\n    $data_dir = __DIR__ . \"/data/$comp_id\";\n    if (!is_dir($data_dir)) {\n        mkdir($data_dir, 0777, true);\n    }\n    \n    $players_file = \"$data_dir/players_{$detail_no}.txt\";\n    $content = implode(\"\\n\", $players);\n    \n    return file_put_contents($players_file, $content) !== false;\n}\n?>\n","size_bytes":3224},"comp/event_control.php":{"content":"<?php\n/**\n * ì´ë²¤íŠ¸ ì œì–´ í™”ë©´ (ê´€ë¦¬ììš©)\n */\n\nrequire_once 'event_schedule_manager.php';\nrequire_once 'result_monitor.php';\n\n$scheduleManager = new EventScheduleManager();\n$monitor = new ResultMonitor();\n\n$currentEvent = isset($_GET['event']) ? $_GET['event'] : '';\n$action = isset($_GET['action']) ? $_GET['action'] : '';\n\n// ì•¡ì…˜ ì²˜ë¦¬\nif ($action === 'update_visibility') {\n    $eventId = $_POST['event_id'] ?? '';\n    $showResult = $_POST['show_result'] === 'true';\n    $scheduleManager->updateEventVisibility($eventId, $showResult);\n    echo json_encode(['success' => true]);\n    exit;\n}\n\n$schedule = $scheduleManager->getSchedule();\n$pairs = $monitor->findResultPairs();\n\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>ì´ë²¤íŠ¸ ì œì–´</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            margin: 20px;\n            background: #f5f5f5;\n        }\n        \n        .container {\n            max-width: 1400px;\n            margin: 0 auto;\n            background: white;\n            padding: 20px;\n            border-radius: 10px;\n            box-shadow: 0 0 20px rgba(0,0,0,0.1);\n        }\n        \n        .header {\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n            padding: 20px;\n            border-radius: 10px;\n            margin-bottom: 30px;\n            text-align: center;\n        }\n        \n        .header h1 {\n            margin: 0;\n            font-size: 2em;\n        }\n        \n        .controls {\n            display: flex;\n            gap: 15px;\n            margin-bottom: 30px;\n            flex-wrap: wrap;\n        }\n        \n        .btn {\n            background: #007bff;\n            color: white;\n            border: none;\n            padding: 12px 20px;\n            border-radius: 5px;\n            cursor: pointer;\n            font-size: 14px;\n            transition: background 0.3s;\n        }\n        \n        .btn:hover {\n            background: #0056b3;\n        }\n        \n        .btn.success {\n            background: #28a745;\n        }\n        \n        .btn.success:hover {\n            background: #218838;\n        }\n        \n        .btn.danger {\n            background: #dc3545;\n        }\n        \n        .btn.danger:hover {\n            background: #c82333;\n        }\n        \n        .btn.info {\n            background: #17a2b8;\n        }\n        \n        .btn.info:hover {\n            background: #138496;\n        }\n        \n        .schedule-table {\n            width: 100%;\n            border-collapse: collapse;\n            margin-bottom: 30px;\n        }\n        \n        .schedule-table th,\n        .schedule-table td {\n            padding: 12px;\n            text-align: left;\n            border: 1px solid #ddd;\n        }\n        \n        .schedule-table th {\n            background: #f8f9fa;\n            font-weight: bold;\n            color: #333;\n        }\n        \n        .schedule-table tr:nth-child(even) {\n            background: #f8f9fa;\n        }\n        \n        .schedule-table tr:hover {\n            background: #e9ecef;\n        }\n        \n        .status-badge {\n            padding: 4px 8px;\n            border-radius: 4px;\n            font-size: 12px;\n            font-weight: bold;\n        }\n        \n        .status-show {\n            background: #d4edda;\n            color: #155724;\n        }\n        \n        .status-hide {\n            background: #f8d7da;\n            color: #721c24;\n        }\n        \n        .toggle-switch {\n            position: relative;\n            display: inline-block;\n            width: 60px;\n            height: 34px;\n        }\n        \n        .toggle-switch input {\n            opacity: 0;\n            width: 0;\n            height: 0;\n        }\n        \n        .slider {\n            position: absolute;\n            cursor: pointer;\n            top: 0;\n            left: 0;\n            right: 0;\n            bottom: 0;\n            background-color: #ccc;\n            transition: .4s;\n            border-radius: 34px;\n        }\n        \n        .slider:before {\n            position: absolute;\n            content: \"\";\n            height: 26px;\n            width: 26px;\n            left: 4px;\n            bottom: 4px;\n            background-color: white;\n            transition: .4s;\n            border-radius: 50%;\n        }\n        \n        input:checked + .slider {\n            background-color: #2196F3;\n        }\n        \n        input:checked + .slider:before {\n            transform: translateX(26px);\n        }\n        \n        .current-event {\n            background: #fff3cd !important;\n            border-left: 4px solid #ffc107;\n        }\n        \n        .status-panel {\n            background: #e9ecef;\n            padding: 15px;\n            border-radius: 5px;\n            margin-bottom: 20px;\n        }\n        \n        .status-item {\n            display: inline-block;\n            margin-right: 20px;\n            font-weight: bold;\n        }\n        \n        .status-value {\n            color: #007bff;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>ğŸ¯ ì´ë²¤íŠ¸ ì œì–´ ì‹œìŠ¤í…œ</h1>\n            <p>ëŒ€íšŒ ìˆœì„œ ê´€ë¦¬ ë° ê²°ê³¼ í‘œì‹œ ì œì–´</p>\n        </div>\n        \n        <div class=\"status-panel\">\n            <div class=\"status-item\">\n                ì´ ì´ë²¤íŠ¸: <span class=\"status-value\"><?php echo count($schedule); ?></span>\n            </div>\n            <div class=\"status-item\">\n                ê²°ê³¼ íŒŒì¼: <span class=\"status-value\"><?php echo count($pairs); ?></span>\n            </div>\n            <div class=\"status-item\">\n                í˜„ì¬ ì´ë²¤íŠ¸: <span class=\"status-value\"><?php echo $currentEvent ?: 'ì„ íƒ ì•ˆë¨'; ?></span>\n            </div>\n        </div>\n        \n        <div class=\"controls\">\n            <button class=\"btn success\" onclick=\"openFullscreen()\">ğŸ–¥ï¸ ì „ì²´í™”ë©´ ì—´ê¸°</button>\n            <button class=\"btn info\" onclick=\"openWaitingScreen()\">â³ ëŒ€ê¸°í™”ë©´ ì—´ê¸°</button>\n            <button class=\"btn\" onclick=\"openDashboard()\">ğŸ“Š ëŒ€ì‹œë³´ë“œ ì—´ê¸°</button>\n            <button class=\"btn\" onclick=\"refreshPage()\">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>\n            <button class=\"btn danger\" onclick=\"resetAllVisibility()\">ğŸ”„ ëª¨ë“  í‘œì‹œ ì´ˆê¸°í™”</button>\n        </div>\n        \n        <h2>ğŸ“‹ ëŒ€íšŒ ìˆœì„œ ë° í‘œì‹œ ì„¤ì •</h2>\n        <table class=\"schedule-table\">\n            <thead>\n                <tr>\n                    <th>ìˆœì„œ</th>\n                    <th>ì´ë²¤íŠ¸ ID</th>\n                    <th>ì´ë²¤íŠ¸ëª…</th>\n                    <th>ê²°ê³¼ í‘œì‹œ</th>\n                    <th>ìƒíƒœ</th>\n                    <th>ì•¡ì…˜</th>\n                </tr>\n            </thead>\n            <tbody>\n                <?php foreach ($schedule as $index => $event): ?>\n                <tr class=\"<?php echo $event['event_id'] === $currentEvent ? 'current-event' : ''; ?>\">\n                    <td><?php echo $index + 1; ?></td>\n                    <td><strong><?php echo htmlspecialchars($event['event_id']); ?></strong></td>\n                    <td><?php echo htmlspecialchars($event['event_name']); ?></td>\n                    <td>\n                        <label class=\"toggle-switch\">\n                            <input type=\"checkbox\" \n                                   <?php echo $event['show_result'] ? 'checked' : ''; ?>\n                                   onchange=\"updateVisibility('<?php echo $event['event_id']; ?>', this.checked)\">\n                            <span class=\"slider\"></span>\n                        </label>\n                    </td>\n                    <td>\n                        <span class=\"status-badge <?php echo $event['show_result'] ? 'status-show' : 'status-hide'; ?>\">\n                            <?php echo $event['show_result'] ? 'í‘œì‹œ' : 'ìˆ¨ê¹€'; ?>\n                        </span>\n                    </td>\n                    <td>\n                        <button class=\"btn\" onclick=\"setCurrentEvent('<?php echo $event['event_id']; ?>')\">\n                            ì„ íƒ\n                        </button>\n                        <button class=\"btn info\" onclick=\"openEventResult('<?php echo $event['event_id']; ?>')\">\n                            ê²°ê³¼ë³´ê¸°\n                        </button>\n                    </td>\n                </tr>\n                <?php endforeach; ?>\n            </tbody>\n        </table>\n    </div>\n\n    <script>\n        function updateVisibility(eventId, showResult) {\n            fetch('event_control.php?action=update_visibility', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/x-www-form-urlencoded',\n                },\n                body: `event_id=${eventId}&show_result=${showResult}`\n            })\n            .then(response => response.json())\n            .then(data => {\n                if (data.success) {\n                    location.reload();\n                } else {\n                    alert('ì—…ë°ì´íŠ¸ ì‹¤íŒ¨');\n                }\n            })\n            .catch(error => {\n                console.error('Error:', error);\n                alert('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n            });\n        }\n        \n        function setCurrentEvent(eventId) {\n            window.location.href = `event_control.php?event=${eventId}`;\n        }\n        \n        function openFullscreen() {\n            const currentEvent = '<?php echo $currentEvent; ?>';\n            if (currentEvent) {\n                window.open(`simple_fullscreen.php?event=${currentEvent}&mode=results`, '_blank');\n            } else {\n                window.open('simple_fullscreen.php', '_blank');\n            }\n        }\n        \n        function openWaitingScreen() {\n            const currentEvent = '<?php echo $currentEvent; ?>';\n            if (currentEvent) {\n                window.open(`simple_fullscreen.php?event=${currentEvent}&mode=waiting`, '_blank');\n            } else {\n                window.open('simple_fullscreen.php?mode=waiting', '_blank');\n            }\n        }\n        \n        function openDashboard() {\n            window.open('result_dashboard.php', '_blank');\n        }\n        \n        function openEventResult(eventId) {\n            window.open(`combined_result_${eventId}.html`, '_blank');\n        }\n        \n        function refreshPage() {\n            location.reload();\n        }\n        \n        function resetAllVisibility() {\n            if (confirm('ëª¨ë“  ì´ë²¤íŠ¸ì˜ í‘œì‹œ ì„¤ì •ì„ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {\n                // ëª¨ë“  ì´ë²¤íŠ¸ë¥¼ í‘œì‹œë¡œ ì„¤ì •\n                const checkboxes = document.querySelectorAll('input[type=\"checkbox\"]');\n                checkboxes.forEach(checkbox => {\n                    if (!checkbox.checked) {\n                        checkbox.checked = true;\n                        updateVisibility(checkbox.getAttribute('onchange').match(/'([^']+)'/)[1], true);\n                    }\n                });\n            }\n        }\n        \n        // ìë™ ìƒˆë¡œê³ ì¹¨ (30ì´ˆë§ˆë‹¤)\n        setInterval(refreshPage, 30000);\n    </script>\n</body>\n</html>\n\n\n\n\n","size_bytes":11255},"comp/event_control_panel.php":{"content":"<?php\n/**\n * ì´ë²¤íŠ¸ ì œì–´ íŒ¨ë„\n * ì‹¤ì‹œê°„ìœ¼ë¡œ ì´ë²¤íŠ¸ ìƒíƒœë¥¼ ì œì–´í•˜ê³  ëª¨ë‹ˆí„°ë§\n */\n\n$action = isset($_GET['action']) ? $_GET['action'] : '';\n\nif ($action === 'update_status') {\n    $eventId = $_POST['event_id'] ?? '';\n    $showResult = $_POST['show_result'] === 'true';\n    \n    if ($eventId) {\n        $statusFile = __DIR__ . '/uploads/event_status.json';\n        $status = [];\n        \n        if (file_exists($statusFile)) {\n            $status = json_decode(file_get_contents($statusFile), true) ?: [];\n        }\n        \n        $status[$eventId] = $showResult;\n        \n        if (file_put_contents($statusFile, json_encode($status, JSON_PRETTY_PRINT))) {\n            echo json_encode(['success' => true]);\n        } else {\n            echo json_encode(['success' => false, 'message' => 'íŒŒì¼ ì €ì¥ ì‹¤íŒ¨']);\n        }\n    } else {\n        echo json_encode(['success' => false, 'message' => 'ì´ë²¤íŠ¸ ID í•„ìš”']);\n    }\n    exit;\n}\n\n// ì´ë²¤íŠ¸ ë°ì´í„° ë¡œë“œ\n$eventFile = __DIR__ . '/uploads/event_schedule.txt';\n$statusFile = __DIR__ . '/uploads/event_status.json';\n\n$events = [];\n$status = [];\n\nif (file_exists($eventFile)) {\n    $lines = file($eventFile, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        $parts = explode(',', $line);\n        if (count($parts) >= 3) {\n            $events[] = [\n                'id' => trim($parts[0]),\n                'name' => trim($parts[1]),\n                'show_result' => trim($parts[2]) === '1'\n            ];\n        }\n    }\n}\n\nif (file_exists($statusFile)) {\n    $status = json_decode(file_get_contents($statusFile), true) ?: [];\n}\n\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>ì´ë²¤íŠ¸ ì œì–´ íŒ¨ë„</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            margin: 20px;\n            background: #f5f5f5;\n        }\n        \n        .container {\n            max-width: 1400px;\n            margin: 0 auto;\n            background: white;\n            padding: 20px;\n            border-radius: 10px;\n            box-shadow: 0 0 20px rgba(0,0,0,0.1);\n        }\n        \n        .header {\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n            padding: 20px;\n            border-radius: 10px;\n            margin-bottom: 30px;\n            text-align: center;\n        }\n        \n        .header h1 {\n            margin: 0;\n            font-size: 2em;\n        }\n        \n        .controls {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n            gap: 15px;\n            margin-bottom: 30px;\n        }\n        \n        .btn {\n            background: #007bff;\n            color: white;\n            border: none;\n            padding: 15px 20px;\n            border-radius: 8px;\n            cursor: pointer;\n            font-size: 14px;\n            font-weight: 500;\n            transition: all 0.3s;\n            text-align: center;\n            min-height: 50px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n        }\n        \n        .btn:hover {\n            background: #0056b3;\n            transform: translateY(-2px);\n            box-shadow: 0 4px 12px rgba(0,123,255,0.3);\n        }\n        \n        .btn.success {\n            background: #28a745;\n        }\n        \n        .btn.success:hover {\n            background: #218838;\n        }\n        \n        .btn.info {\n            background: #17a2b8;\n        }\n        \n        .btn.info:hover {\n            background: #138496;\n        }\n        \n        .btn.danger {\n            background: #dc3545;\n        }\n        \n        .btn.danger:hover {\n            background: #c82333;\n        }\n        \n        .event-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\n            gap: 20px;\n            margin-bottom: 30px;\n        }\n        \n        .event-card {\n            border: 1px solid #ddd;\n            border-radius: 10px;\n            padding: 20px;\n            background: white;\n            transition: transform 0.3s, box-shadow 0.3s;\n        }\n        \n        .event-card:hover {\n            transform: translateY(-2px);\n            box-shadow: 0 4px 15px rgba(0,0,0,0.1);\n        }\n        \n        .event-card.current {\n            border-color: #667eea;\n            background: linear-gradient(135deg, #f8f9ff 0%, #e8f0ff 100%);\n        }\n        \n        .event-id {\n            font-size: 1.2em;\n            font-weight: bold;\n            color: #667eea;\n            margin-bottom: 10px;\n        }\n        \n        .event-name {\n            font-size: 1.1em;\n            color: #333;\n            margin-bottom: 15px;\n            line-height: 1.4;\n        }\n        \n        .event-controls {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n        \n        .toggle-switch {\n            position: relative;\n            display: inline-block;\n            width: 60px;\n            height: 34px;\n        }\n        \n        .toggle-switch input {\n            opacity: 0;\n            width: 0;\n            height: 0;\n        }\n        \n        .slider {\n            position: absolute;\n            cursor: pointer;\n            top: 0;\n            left: 0;\n            right: 0;\n            bottom: 0;\n            background-color: #ccc;\n            transition: .4s;\n            border-radius: 34px;\n        }\n        \n        .slider:before {\n            position: absolute;\n            content: \"\";\n            height: 26px;\n            width: 26px;\n            left: 4px;\n            bottom: 4px;\n            background-color: white;\n            transition: .4s;\n            border-radius: 50%;\n        }\n        \n        input:checked + .slider {\n            background-color: #2196F3;\n        }\n        \n        input:checked + .slider:before {\n            transform: translateX(26px);\n        }\n        \n        .status-badge {\n            padding: 6px 12px;\n            border-radius: 20px;\n            font-size: 12px;\n            font-weight: bold;\n        }\n        \n        .status-show {\n            background: #d4edda;\n            color: #155724;\n        }\n        \n        .status-hide {\n            background: #f8d7da;\n            color: #721c24;\n        }\n        \n        .status-panel {\n            background: #e9ecef;\n            padding: 15px;\n            border-radius: 5px;\n            margin-bottom: 20px;\n        }\n        \n        .status-item {\n            display: inline-block;\n            margin-right: 20px;\n            font-weight: bold;\n        }\n        \n        .status-value {\n            color: #007bff;\n        }\n        \n        .current-event {\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n            padding: 20px;\n            border-radius: 10px;\n            margin-bottom: 20px;\n            text-align: center;\n        }\n        \n        .current-event h2 {\n            margin: 0 0 10px 0;\n            font-size: 1.5em;\n        }\n        \n        .current-event p {\n            margin: 0;\n            opacity: 0.9;\n        }\n        \n        /* ë°˜ì‘í˜• ë””ìì¸ */\n        @media (max-width: 768px) {\n            .controls {\n                grid-template-columns: 1fr;\n                gap: 10px;\n            }\n            \n            .btn {\n                padding: 12px 15px;\n                font-size: 13px;\n                min-height: 45px;\n            }\n            \n            .container {\n                margin: 10px;\n                padding: 15px;\n            }\n            \n            .event-grid {\n                grid-template-columns: 1fr;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>ğŸ¯ ì´ë²¤íŠ¸ ì œì–´ íŒ¨ë„</h1>\n            <p>ì‹¤ì‹œê°„ìœ¼ë¡œ ì´ë²¤íŠ¸ ìƒíƒœë¥¼ ì œì–´í•˜ê³  ëª¨ë‹ˆí„°ë§í•˜ì„¸ìš”</p>\n        </div>\n        \n        <div class=\"status-panel\">\n            <div class=\"status-item\">\n                ì´ ì´ë²¤íŠ¸: <span class=\"status-value\"><?php echo count($events); ?></span>\n            </div>\n            <div class=\"status-item\">\n                ê²°ê³¼ ë°œí‘œ ì˜ˆì •: <span class=\"status-value\" id=\"showCount\">-</span>\n            </div>\n            <div class=\"status-item\">\n                ê²°ê³¼ ë°œí‘œ ì•ˆí•¨: <span class=\"status-value\" id=\"hideCount\">-</span>\n            </div>\n        </div>\n        \n        <div class=\"controls\">\n            <button class=\"btn success\" onclick=\"openFullscreenMonitor()\">ğŸ–¥ï¸ ì „ì²´í™”ë©´ ëª¨ë‹ˆí„°ë§</button>\n            <button class=\"btn info\" onclick=\"openEventUpload()\">ğŸ“ ì´ë²¤íŠ¸ ì—…ë¡œë“œ</button>\n            <button class=\"btn\" onclick=\"openResultMonitoring()\">ğŸ” ê²°ê³¼ ëª¨ë‹ˆí„°ë§</button>\n            <button class=\"btn\" onclick=\"openResultDashboard()\">ğŸ“Š ê²°ê³¼ ëŒ€ì‹œë³´ë“œ</button>\n            <button class=\"btn\" onclick=\"openResultGenerator()\">âš™ï¸ ê²°ê³¼ ìƒì„±ê¸°</button>\n            <button class=\"btn\" onclick=\"refreshPage()\">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>\n            <button class=\"btn danger\" onclick=\"resetAllStatus()\">ğŸ”„ ëª¨ë“  ìƒíƒœ ì´ˆê¸°í™”</button>\n        </div>\n        \n        <div class=\"current-event\" id=\"currentEventInfo\">\n            <h2>í˜„ì¬ ì´ë²¤íŠ¸</h2>\n            <p id=\"currentEventText\">ì´ë²¤íŠ¸ë¥¼ ì„ íƒí•˜ì„¸ìš”</p>\n        </div>\n        \n        <h3>ğŸ“‹ ì´ë²¤íŠ¸ ëª©ë¡</h3>\n        <div class=\"event-grid\" id=\"eventGrid\">\n            <?php foreach ($events as $index => $event): ?>\n            <div class=\"event-card\" data-event-id=\"<?php echo htmlspecialchars($event['id']); ?>\" data-event-index=\"<?php echo $index; ?>\">\n                <div class=\"event-id\"><?php echo htmlspecialchars($event['id']); ?></div>\n                <div class=\"event-name\"><?php echo htmlspecialchars($event['name']); ?></div>\n                <div class=\"event-controls\">\n                    <label class=\"toggle-switch\">\n                        <input type=\"checkbox\" \n                               <?php echo (isset($status[$event['id']]) && $status[$event['id']]) ? 'checked' : ''; ?>\n                               onchange=\"updateEventStatus('<?php echo $event['id']; ?>', this.checked)\">\n                        <span class=\"slider\"></span>\n                    </label>\n                    <span class=\"status-badge <?php echo (isset($status[$event['id']]) && $status[$event['id']]) ? 'status-show' : 'status-hide'; ?>\">\n                        <?php echo (isset($status[$event['id']]) && $status[$event['id']]) ? 'ë°œí‘œ' : 'ëŒ€ê¸°' ?>\n                    </span>\n                </div>\n            </div>\n            <?php endforeach; ?>\n        </div>\n    </div>\n\n    <script>\n        let currentEventIndex = 0;\n        let events = <?php echo json_encode($events); ?>;\n        \n        function updateEventStatus(eventId, showResult) {\n            fetch('event_control_panel.php?action=update_status', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/x-www-form-urlencoded',\n                },\n                body: `event_id=${eventId}&show_result=${showResult}`\n            })\n            .then(response => response.json())\n            .then(data => {\n                if (data.success) {\n                    // ìƒíƒœ ë°°ì§€ ì—…ë°ì´íŠ¸\n                    const eventCard = document.querySelector(`[data-event-id=\"${eventId}\"]`);\n                    const statusBadge = eventCard.querySelector('.status-badge');\n                    \n                    if (showResult) {\n                        statusBadge.textContent = 'ë°œí‘œ';\n                        statusBadge.className = 'status-badge status-show';\n                    } else {\n                        statusBadge.textContent = 'ëŒ€ê¸°';\n                        statusBadge.className = 'status-badge status-hide';\n                    }\n                    \n                    updateStatusCounts();\n                } else {\n                    alert('ìƒíƒœ ì—…ë°ì´íŠ¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + (data.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));\n                }\n            })\n            .catch(error => {\n                console.error('Error:', error);\n                alert('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n            });\n        }\n        \n        function updateStatusCounts() {\n            const showCount = document.querySelectorAll('.status-badge.status-show').length;\n            const hideCount = document.querySelectorAll('.status-badge.status-hide').length;\n            \n            document.getElementById('showCount').textContent = showCount;\n            document.getElementById('hideCount').textContent = hideCount;\n        }\n        \n        function setCurrentEvent(eventIndex) {\n            currentEventIndex = eventIndex;\n            \n            // ëª¨ë“  ì¹´ë“œì—ì„œ current í´ë˜ìŠ¤ ì œê±°\n            document.querySelectorAll('.event-card').forEach(card => {\n                card.classList.remove('current');\n            });\n            \n            // í˜„ì¬ ì´ë²¤íŠ¸ ì¹´ë“œì— current í´ë˜ìŠ¤ ì¶”ê°€\n            const currentCard = document.querySelector(`[data-event-index=\"${eventIndex}\"]`);\n            if (currentCard) {\n                currentCard.classList.add('current');\n            }\n            \n            // í˜„ì¬ ì´ë²¤íŠ¸ ì •ë³´ ì—…ë°ì´íŠ¸\n            if (events[eventIndex]) {\n                const event = events[eventIndex];\n                document.getElementById('currentEventText').textContent = \n                    `${event.id}: ${event.name}`;\n            }\n        }\n        \n        function openFullscreenMonitor() {\n            window.open('event_monitor_v2.php', '_blank');\n        }\n        \n        function openEventUpload() {\n            window.open('event_upload.php', '_blank');\n        }\n        \n        function openResultMonitoring() {\n            window.open('monitor_control.php', '_blank');\n        }\n        \n        function openResultDashboard() {\n            window.open('result_dashboard.php', '_blank');\n        }\n        \n        function openResultGenerator() {\n            window.open('test_results.php', '_blank');\n        }\n        \n        function refreshPage() {\n            location.reload();\n        }\n        \n        function resetAllStatus() {\n            if (confirm('ëª¨ë“  ì´ë²¤íŠ¸ì˜ ìƒíƒœë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {\n                const checkboxes = document.querySelectorAll('input[type=\"checkbox\"]');\n                checkboxes.forEach(checkbox => {\n                    checkbox.checked = false;\n                    updateEventStatus(checkbox.getAttribute('onchange').match(/'([^']+)'/)[1], false);\n                });\n            }\n        }\n        \n        // ì´ë²¤íŠ¸ ì¹´ë“œ í´ë¦­ìœ¼ë¡œ í˜„ì¬ ì´ë²¤íŠ¸ ì„¤ì •\n        document.querySelectorAll('.event-card').forEach(card => {\n            card.addEventListener('click', function() {\n                const eventIndex = parseInt(this.getAttribute('data-event-index'));\n                setCurrentEvent(eventIndex);\n            });\n        });\n        \n        // ì´ˆê¸°í™”\n        document.addEventListener('DOMContentLoaded', function() {\n            updateStatusCounts();\n            setCurrentEvent(0);\n            \n            // 30ì´ˆë§ˆë‹¤ ìë™ ìƒˆë¡œê³ ì¹¨\n            setInterval(refreshPage, 30000);\n        });\n    </script>\n</body>\n</html>\n","size_bytes":15590},"comp/event_group_manager.php":{"content":"<?php\n/**\n * ì´ë²¤íŠ¸ ê·¸ë£¹ ê´€ë¦¬ í´ë˜ìŠ¤\n */\n\nclass EventGroupManager {\n    \n    /**\n     * ì´ë²¤íŠ¸ë¥¼ ê·¸ë£¹ë³„ë¡œ ë¶„ë¥˜\n     */\n    public static function groupEvents($events) {\n        $groups = [];\n        \n        foreach ($events as $event) {\n            // ì´ë²¤íŠ¸ IDì—ì„œ ìˆ«ì ë¶€ë¶„ ì¶”ì¶œ (ì˜ˆ: 1A -> 1, 2B -> 2)\n            $eventNumber = preg_replace('/[^0-9]/', '', $event['id']);\n            \n            if (!isset($groups[$eventNumber])) {\n                $groups[$eventNumber] = [];\n            }\n            \n            $groups[$eventNumber][] = $event;\n        }\n        \n        // ìˆ«ì ìˆœìœ¼ë¡œ ì •ë ¬\n        ksort($groups);\n        \n        return $groups;\n    }\n    \n    /**\n     * íŠ¹ì • ê·¸ë£¹ì˜ ì´ë²¤íŠ¸ë“¤ ë°˜í™˜\n     */\n    public static function getGroupEvents($events, $groupNumber) {\n        $groupEvents = [];\n        \n        foreach ($events as $event) {\n            $eventNumber = preg_replace('/[^0-9]/', '', $event['id']);\n            if ($eventNumber == $groupNumber) {\n                $groupEvents[] = $event;\n            }\n        }\n        \n        return $groupEvents;\n    }\n    \n    /**\n     * ê·¸ë£¹ë³„ ì´ë²¤íŠ¸ ìˆ˜ ë°˜í™˜\n     */\n    public static function getGroupCount($events) {\n        $groups = self::groupEvents($events);\n        return count($groups);\n    }\n    \n    /**\n     * í˜„ì¬ ê·¸ë£¹ ì¸ë±ìŠ¤ ê³„ì‚°\n     */\n    public static function getCurrentGroupIndex($events, $currentEventId) {\n        $currentEventNumber = preg_replace('/[^0-9]/', '', $currentEventId);\n        $groups = self::groupEvents($events);\n        $groupNumbers = array_keys($groups);\n        \n        return array_search($currentEventNumber, $groupNumbers);\n    }\n}\n?>\n\n\n\n\n","size_bytes":1724},"comp/event_monitor.php":{"content":"<?php\n/**\n * ì´ë²¤íŠ¸ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ\n * ì—…ë¡œë“œëœ ì´ë²¤íŠ¸ ìˆœì„œì— ë”°ë¥¸ ëŒ€ê¸°í™”ë©´ ë° ê²°ê³¼ í‘œì‹œ\n */\n\n$currentEventIndex = isset($_GET['event']) ? (int)$_GET['event'] : 0;\n$mode = isset($_GET['mode']) ? $_GET['mode'] : 'waiting';\n\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>ì´ë²¤íŠ¸ ëª¨ë‹ˆí„°ë§</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n        \n        html, body {\n            width: 100%;\n            height: 100%;\n            overflow: hidden;\n        }\n        \n        body {\n            font-family: 'Arial', sans-serif;\n            background: #000;\n            color: #fff;\n        }\n        \n        .screen {\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100vw;\n            height: 100vh;\n            display: none;\n        }\n        \n        .screen.active {\n            display: block;\n        }\n        \n        /* ëŒ€ê¸°í™”ë©´ */\n        .waiting-screen {\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            text-align: center;\n            animation: pulse 2s infinite;\n        }\n        \n        .waiting-screen h1 {\n            font-size: 4em;\n            margin-bottom: 30px;\n            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);\n        }\n        \n        .event-info {\n            background: rgba(255,255,255,0.1);\n            padding: 30px;\n            border-radius: 15px;\n            margin: 20px 0;\n            backdrop-filter: blur(10px);\n            min-width: 600px;\n        }\n        \n        .event-name {\n            font-size: 2.5em;\n            margin-bottom: 15px;\n            font-weight: bold;\n        }\n        \n        .event-id {\n            font-size: 1.5em;\n            opacity: 0.8;\n        }\n        \n        .event-status {\n            margin-top: 20px;\n            font-size: 1.2em;\n        }\n        \n        .status-waiting {\n            color: #ffeb3b;\n        }\n        \n        .status-ready {\n            color: #4caf50;\n        }\n        \n        .next-events {\n            margin-top: 30px;\n            font-size: 1.2em;\n            opacity: 0.7;\n        }\n        \n        .next-events h3 {\n            margin-bottom: 15px;\n            font-size: 1.5em;\n        }\n        \n        .next-event-list {\n            display: flex;\n            flex-wrap: wrap;\n            gap: 15px;\n            justify-content: center;\n        }\n        \n        .next-event-item {\n            background: rgba(255,255,255,0.1);\n            padding: 10px 15px;\n            border-radius: 8px;\n            font-size: 0.9em;\n        }\n        \n        /* ê²°ê³¼ í™”ë©´ */\n        .results-screen {\n            background: #f5f5f5;\n            color: #333;\n        }\n        \n        .results-content {\n            width: 100%;\n            height: 100%;\n            border: none;\n            display: block;\n        }\n        \n        /* ì œì–´ íŒ¨ë„ */\n        .control-panel {\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            z-index: 1000;\n            background: rgba(0,0,0,0.8);\n            padding: 15px;\n            border-radius: 10px;\n            display: flex;\n            gap: 10px;\n            opacity: 0;\n            transition: opacity 0.3s;\n        }\n        \n        .control-panel:hover {\n            opacity: 1;\n        }\n        \n        .control-btn {\n            background: #667eea;\n            color: white;\n            border: none;\n            padding: 10px 15px;\n            border-radius: 5px;\n            cursor: pointer;\n            font-size: 14px;\n            transition: background 0.3s;\n        }\n        \n        .control-btn:hover {\n            background: #5a6fd8;\n        }\n        \n        .control-btn.active {\n            background: #28a745;\n        }\n        \n        .control-btn.danger {\n            background: #dc3545;\n        }\n        \n        /* ìƒíƒœ í‘œì‹œ */\n        .status-bar {\n            position: fixed;\n            bottom: 20px;\n            left: 20px;\n            background: rgba(0,0,0,0.8);\n            color: white;\n            padding: 10px 15px;\n            border-radius: 5px;\n            font-size: 14px;\n        }\n        \n        /* ì§„í–‰ë¥  í‘œì‹œ */\n        .progress-bar {\n            position: fixed;\n            bottom: 0;\n            left: 0;\n            width: 100%;\n            height: 4px;\n            background: rgba(255,255,255,0.2);\n        }\n        \n        .progress-fill {\n            height: 100%;\n            background: linear-gradient(90deg, #667eea, #764ba2);\n            transition: width 0.3s ease;\n        }\n        \n        /* ì• ë‹ˆë©”ì´ì…˜ */\n        @keyframes pulse {\n            0% { transform: scale(1); }\n            50% { transform: scale(1.05); }\n            100% { transform: scale(1); }\n        }\n        \n        @keyframes fadeIn {\n            from { opacity: 0; transform: translateY(20px); }\n            to { opacity: 1; transform: translateY(0); }\n        }\n        \n        .fade-in {\n            animation: fadeIn 0.5s ease-in-out;\n        }\n        \n        /* ë°˜ì‘í˜• */\n        @media (max-width: 768px) {\n            .waiting-screen h1 { font-size: 2.5em; }\n            .event-name { font-size: 1.8em; }\n            .event-id { font-size: 1.2em; }\n            .event-info { min-width: 90%; }\n        }\n    </style>\n</head>\n<body>\n    <!-- ëŒ€ê¸°í™”ë©´ -->\n    <div id=\"waitingScreen\" class=\"screen waiting-screen\">\n        <h1>ğŸ† ëŒ„ìŠ¤ìŠ¤í¬ì¸  ëŒ€íšŒ</h1>\n        \n        <div class=\"event-info\" id=\"eventInfo\">\n            <div class=\"event-name\" id=\"currentEventName\">ì´ë²¤íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>\n            <div class=\"event-id\" id=\"currentEventId\">ì´ë²¤íŠ¸ ID: -</div>\n            <div class=\"event-status\" id=\"eventStatus\">\n                <span class=\"status-waiting\">ê²°ê³¼ ëŒ€ê¸° ì¤‘...</span>\n            </div>\n        </div>\n        \n        <div class=\"next-events\" id=\"nextEvents\">\n            <h3>ë‹¤ìŒ ì´ë²¤íŠ¸</h3>\n            <div class=\"next-event-list\" id=\"nextEventList\">\n                <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->\n            </div>\n        </div>\n    </div>\n    \n    <!-- ê²°ê³¼ í™”ë©´ -->\n    <div id=\"resultsScreen\" class=\"screen results-screen\">\n        <iframe src=\"\" class=\"results-content\" id=\"resultFrame\"></iframe>\n    </div>\n    \n    <!-- ì œì–´ íŒ¨ë„ -->\n    <div class=\"control-panel\" id=\"controlPanel\">\n        <button class=\"control-btn\" onclick=\"showMode('waiting')\">â³ ëŒ€ê¸°í™”ë©´</button>\n        <button class=\"control-btn\" onclick=\"showMode('results')\">ğŸ“Š ê²°ê³¼</button>\n        <button class=\"control-btn\" onclick=\"previousEvent()\">â¬…ï¸ ì´ì „</button>\n        <button class=\"control-btn\" onclick=\"nextEvent()\">ë‹¤ìŒ â¡ï¸</button>\n        <button class=\"control-btn\" onclick=\"checkResult()\">ğŸ” ê²°ê³¼í™•ì¸</button>\n        <button class=\"control-btn danger\" onclick=\"exitFullscreen()\">âŒ ì¢…ë£Œ</button>\n    </div>\n    \n    <!-- ìƒíƒœ í‘œì‹œ -->\n    <div class=\"status-bar\" id=\"statusBar\">\n        í˜„ì¬ ì´ë²¤íŠ¸: <span id=\"currentEventIndex\"><?php echo $currentEventIndex; ?></span> | \n        ëª¨ë“œ: <span id=\"currentMode\"><?php echo $mode; ?></span> | \n        ì´ ì´ë²¤íŠ¸: <span id=\"totalEvents\">-</span>\n    </div>\n    \n    <!-- ì§„í–‰ë¥  í‘œì‹œ -->\n    <div class=\"progress-bar\">\n        <div class=\"progress-fill\" id=\"progressFill\" style=\"width: 0%\"></div>\n    </div>\n\n    <script>\n        let currentEventIndex = <?php echo $currentEventIndex; ?>;\n        let currentMode = '<?php echo $mode; ?>';\n        let events = [];\n        let resultCheckInterval;\n        \n        // ì´ë²¤íŠ¸ ë°ì´í„° ë¡œë“œ\n        async function loadEvents() {\n            try {\n                const response = await fetch('get_event_schedule.php');\n                const data = await response.json();\n                \n                if (data.success) {\n                    events = data.events;\n                    document.getElementById('totalEvents').textContent = events.length;\n                    updateCurrentEvent();\n                    updateNextEvents();\n                } else {\n                    console.error('ì´ë²¤íŠ¸ ë¡œë“œ ì‹¤íŒ¨:', data.message);\n                }\n            } catch (error) {\n                console.error('ì´ë²¤íŠ¸ ë¡œë“œ ì˜¤ë¥˜:', error);\n            }\n        }\n        \n        // í˜„ì¬ ì´ë²¤íŠ¸ ì—…ë°ì´íŠ¸\n        function updateCurrentEvent() {\n            if (events.length > 0 && currentEventIndex < events.length) {\n                const event = events[currentEventIndex];\n                document.getElementById('currentEventName').textContent = event.name;\n                document.getElementById('currentEventId').textContent = `ì´ë²¤íŠ¸ ID: ${event.id}`;\n                document.getElementById('currentEventIndex').textContent = currentEventIndex + 1;\n                \n                // ìƒíƒœ ì—…ë°ì´íŠ¸\n                const statusElement = document.getElementById('eventStatus');\n                if (event.show_result) {\n                    statusElement.innerHTML = '<span class=\"status-ready\">ê²°ê³¼ ë°œí‘œ ì˜ˆì •</span>';\n                } else {\n                    statusElement.innerHTML = '<span class=\"status-waiting\">ê²°ê³¼ ë°œí‘œ ì•ˆí•¨</span>';\n                }\n            }\n        }\n        \n        // ë‹¤ìŒ ì´ë²¤íŠ¸ë“¤ ì—…ë°ì´íŠ¸\n        function updateNextEvents() {\n            const nextEventList = document.getElementById('nextEventList');\n            nextEventList.innerHTML = '';\n            \n            // ë‹¤ìŒ 3ê°œ ì´ë²¤íŠ¸ í‘œì‹œ\n            for (let i = 1; i <= 3; i++) {\n                const nextIndex = currentEventIndex + i;\n                if (nextIndex < events.length) {\n                    const event = events[nextIndex];\n                    const eventItem = document.createElement('div');\n                    eventItem.className = 'next-event-item';\n                    eventItem.textContent = `${event.id}: ${event.name}`;\n                    nextEventList.appendChild(eventItem);\n                }\n            }\n        }\n        \n        // ëª¨ë“œ ì „í™˜\n        function showMode(mode) {\n            document.querySelectorAll('.screen').forEach(screen => {\n                screen.classList.remove('active');\n            });\n            \n            currentMode = mode;\n            document.getElementById('currentMode').textContent = mode;\n            \n            switch(mode) {\n                case 'waiting':\n                    document.getElementById('waitingScreen').classList.add('active');\n                    break;\n                case 'results':\n                    document.getElementById('resultsScreen').classList.add('active');\n                    loadCurrentResult();\n                    break;\n            }\n        }\n        \n        // í˜„ì¬ ê²°ê³¼ ë¡œë“œ\n        function loadCurrentResult() {\n            if (events.length > 0 && currentEventIndex < events.length) {\n                const event = events[currentEventIndex];\n                const iframe = document.getElementById('resultFrame');\n                iframe.src = `combined_result_${event.id}.html`;\n            }\n        }\n        \n        // ì´ì „ ì´ë²¤íŠ¸\n        function previousEvent() {\n            if (currentEventIndex > 0) {\n                currentEventIndex--;\n                updateCurrentEvent();\n                updateNextEvents();\n                showMode('waiting');\n            }\n        }\n        \n        // ë‹¤ìŒ ì´ë²¤íŠ¸\n        function nextEvent() {\n            if (currentEventIndex < events.length - 1) {\n                currentEventIndex++;\n                updateCurrentEvent();\n                updateNextEvents();\n                showMode('waiting');\n            }\n        }\n        \n        // ê²°ê³¼ í™•ì¸\n        function checkResult() {\n            if (events.length > 0 && currentEventIndex < events.length) {\n                const event = events[currentEventIndex];\n                if (event.show_result) {\n                    showMode('results');\n                } else {\n                    alert('ì´ ì´ë²¤íŠ¸ëŠ” ê²°ê³¼ ë°œí‘œê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');\n                }\n            }\n        }\n        \n        // ê²°ê³¼ íŒŒì¼ ì¡´ì¬ ì—¬ë¶€ í™•ì¸\n        async function checkResultFile() {\n            if (events.length > 0 && currentEventIndex < events.length) {\n                const event = events[currentEventIndex];\n                \n                try {\n                    const response = await fetch(`check_result_file.php?event=${event.id}`);\n                    const data = await response.json();\n                    \n                    if (data.exists && event.show_result) {\n                        showMode('results');\n                        startProgress();\n                    }\n                } catch (error) {\n                    console.error('ê²°ê³¼ íŒŒì¼ í™•ì¸ ì˜¤ë¥˜:', error);\n                }\n            }\n        }\n        \n        // ì§„í–‰ë¥  ì‹œì‘\n        function startProgress() {\n            let progress = 0;\n            const duration = 10000; // 10ì´ˆ\n            const increment = 100 / (duration / 100);\n            \n            const progressInterval = setInterval(() => {\n                progress += increment;\n                document.getElementById('progressFill').style.width = progress + '%';\n                \n                if (progress >= 100) {\n                    clearInterval(progressInterval);\n                    nextEvent();\n                }\n            }, 100);\n        }\n        \n        // ì „ì²´í™”ë©´ ì¢…ë£Œ\n        function exitFullscreen() {\n            if (document.exitFullscreen) {\n                document.exitFullscreen();\n            } else if (document.webkitExitFullscreen) {\n                document.webkitExitFullscreen();\n            } else if (document.mozCancelFullScreen) {\n                document.mozCancelFullScreen();\n            } else if (document.msExitFullscreen) {\n                document.msExitFullscreen();\n            }\n        }\n        \n        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤\n        document.addEventListener('keydown', function(e) {\n            switch(e.key) {\n                case 'F11':\n                    e.preventDefault();\n                    if (!document.fullscreenElement) {\n                        document.documentElement.requestFullscreen();\n                    } else {\n                        exitFullscreen();\n                    }\n                    break;\n                case 'ArrowLeft':\n                    previousEvent();\n                    break;\n                case 'ArrowRight':\n                    nextEvent();\n                    break;\n                case ' ':\n                    e.preventDefault();\n                    checkResult();\n                    break;\n                case '1':\n                    showMode('waiting');\n                    break;\n                case '2':\n                    showMode('results');\n                    break;\n                case 'Escape':\n                    exitFullscreen();\n                    break;\n            }\n        });\n        \n        // ì´ˆê¸°í™”\n        document.addEventListener('DOMContentLoaded', function() {\n            loadEvents();\n            showMode(currentMode);\n            \n            // 3ì´ˆ í›„ ì œì–´ íŒ¨ë„ ìˆ¨ê¸°ê¸°\n            setTimeout(() => {\n                document.getElementById('controlPanel').style.opacity = '0';\n            }, 3000);\n            \n            // 5ì´ˆë§ˆë‹¤ ê²°ê³¼ íŒŒì¼ í™•ì¸\n            resultCheckInterval = setInterval(checkResultFile, 5000);\n        });\n        \n        // ë§ˆìš°ìŠ¤ ì›€ì§ì„ ê°ì§€ë¡œ ì œì–´ íŒ¨ë„ í‘œì‹œ\n        let mouseTimer;\n        document.addEventListener('mousemove', function() {\n            document.getElementById('controlPanel').style.opacity = '1';\n            clearTimeout(mouseTimer);\n            mouseTimer = setTimeout(() => {\n                document.getElementById('controlPanel').style.opacity = '0';\n            }, 3000);\n        });\n    </script>\n</body>\n</html>\n\n\n\n\n","size_bytes":16295},"comp/event_monitor_v2.php":{"content":"<?php\n/**\n * ì´ë²¤íŠ¸ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ v2\n * ê·¸ë£¹ë³„ ì´ë²¤íŠ¸ í‘œì‹œ ë° ëŒ€íšŒ ì œëª© ì„¤ì •\n */\n\nrequire_once 'event_group_manager.php';\n\n$currentGroupIndex = isset($_GET['group']) ? (int)$_GET['group'] : 0;\n$mode = isset($_GET['mode']) ? $_GET['mode'] : 'waiting';\n\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>ì´ë²¤íŠ¸ ëª¨ë‹ˆí„°ë§ v2</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n        \n        html, body {\n            width: 100%;\n            height: 100%;\n            overflow: hidden;\n        }\n        \n        body {\n            font-family: 'Arial', sans-serif;\n            background: #000;\n            color: #fff;\n        }\n        \n        .screen {\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100vw;\n            height: 100vh;\n            display: none;\n        }\n        \n        .screen.active {\n            display: block;\n        }\n        \n        /* ëŒ€ê¸°í™”ë©´ */\n        .waiting-screen {\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            text-align: center;\n            padding: 20px;\n        }\n        \n        .competition-title {\n            font-size: 4em;\n            margin-bottom: 20px;\n            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);\n            font-weight: bold;\n        }\n        \n        .competition-subtitle {\n            font-size: 2em;\n            margin-bottom: 50px;\n            opacity: 0.9;\n        }\n        \n        .event-group {\n            background: rgba(255,255,255,0.1);\n            padding: 40px;\n            border-radius: 20px;\n            backdrop-filter: blur(10px);\n            min-width: 600px;\n            max-width: 800px;\n            text-align: center;\n            margin: 0 auto;\n            box-shadow: 0 8px 32px rgba(0,0,0,0.3);\n        }\n        \n        .group-title {\n            font-size: 3.5em;\n            margin-bottom: 30px;\n            font-weight: bold;\n            color: #ffeb3b;\n            text-align: center;\n        }\n        \n        .event-list {\n            list-style: none;\n            padding: 0;\n            text-align: center;\n        }\n        \n        .event-item {\n            font-size: 2.5em;\n            margin-bottom: 25px;\n            padding: 20px 0;\n            border-bottom: 1px solid rgba(255,255,255,0.2);\n            text-align: center;\n        }\n        \n        .event-item:last-child {\n            border-bottom: none;\n        }\n        \n        .event-name {\n            color: #fff;\n            font-weight: 500;\n            display: block;\n            text-align: center;\n        }\n        \n        .next-groups {\n            margin-top: 40px;\n            font-size: 1.8em;\n            opacity: 0.7;\n            text-align: center;\n            width: 100%;\n        }\n        \n        .next-groups h3 {\n            margin-bottom: 20px;\n            font-size: 2.2em;\n        }\n        \n        .next-group-list {\n            display: flex;\n            flex-wrap: wrap;\n            gap: 15px;\n            justify-content: center;\n            align-items: center;\n        }\n        \n        .next-group-item {\n            background: rgba(255,255,255,0.1);\n            padding: 15px 25px;\n            border-radius: 10px;\n            font-size: 1.4em;\n            text-align: center;\n        }\n        \n        /* ê²°ê³¼ í™”ë©´ */\n        .results-screen {\n            background: #f5f5f5;\n            color: #333;\n            overflow: hidden;\n        }\n        \n        .results-content {\n            width: 100%;\n            height: 100%;\n            border: none;\n            display: block;\n            transform: scale(0.8);\n            transform-origin: top left;\n            overflow: hidden;\n        }\n        \n        /* ê²°ê³¼ í™”ë©´ ì „ì²´í™”ë©´ ìµœì í™” */\n        .results-screen.fullscreen-optimized .results-content {\n            transform: scale(0.7);\n            width: 142.86%; /* 100 / 0.7 */\n            height: 142.86%; /* 100 / 0.7 */\n        }\n        \n        /* ì œì–´ íŒ¨ë„ */\n        .control-panel {\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            z-index: 1000;\n            background: rgba(0,0,0,0.8);\n            padding: 15px;\n            border-radius: 10px;\n            display: flex;\n            gap: 10px;\n            opacity: 0;\n            transition: opacity 0.3s;\n        }\n        \n        .control-panel:hover {\n            opacity: 1;\n        }\n        \n        .control-btn {\n            background: #667eea;\n            color: white;\n            border: none;\n            padding: 10px 15px;\n            border-radius: 5px;\n            cursor: pointer;\n            font-size: 14px;\n            transition: background 0.3s;\n        }\n        \n        .control-btn:hover {\n            background: #5a6fd8;\n        }\n        \n        .control-btn.active {\n            background: #28a745;\n        }\n        \n        .control-btn.danger {\n            background: #dc3545;\n        }\n        \n        /* ìƒíƒœ í‘œì‹œ */\n        .status-bar {\n            position: fixed;\n            bottom: 20px;\n            left: 20px;\n            background: rgba(0,0,0,0.8);\n            color: white;\n            padding: 10px 15px;\n            border-radius: 5px;\n            font-size: 14px;\n            transition: opacity 0.3s;\n        }\n        \n        .status-bar.hidden {\n            opacity: 0;\n            pointer-events: none;\n        }\n        \n        /* ë°˜ì‘í˜• */\n        @media (max-width: 768px) {\n            .competition-title { font-size: 2.5em; }\n            .competition-subtitle { font-size: 1.5em; }\n            .group-title { font-size: 2.5em; }\n            .event-item { font-size: 1.8em; }\n            .next-groups { font-size: 1.4em; }\n            .next-groups h3 { font-size: 1.8em; }\n            .next-group-item { font-size: 1.2em; }\n            .event-group { \n                min-width: 90%; \n                max-width: 95%;\n                padding: 20px; \n                text-align: center;\n                margin: 0 auto;\n            }\n            .event-list {\n                text-align: center;\n            }\n            .event-name {\n                text-align: center;\n            }\n            .next-groups {\n                text-align: center;\n            }\n            .next-group-list {\n                justify-content: center;\n            }\n        }\n    </style>\n</head>\n<body>\n    <!-- ëŒ€ê¸°í™”ë©´ -->\n    <div id=\"waitingScreen\" class=\"screen waiting-screen\">\n        <div class=\"competition-title\" id=\"competitionTitle\">ëŒ€íšŒ ì œëª©ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>\n        <div class=\"competition-subtitle\" id=\"competitionSubtitle\">ë¶€ì œëª©ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>\n        \n        <div class=\"event-group\" id=\"eventGroup\">\n            <div class=\"group-title\" id=\"groupTitle\">ì´ë²¤íŠ¸ ê·¸ë£¹ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>\n            <ul class=\"event-list\" id=\"eventList\">\n                <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->\n            </ul>\n        </div>\n        \n        <div class=\"next-groups\" id=\"nextGroups\">\n            <h3>ë‹¤ìŒ ì´ë²¤íŠ¸ ê·¸ë£¹</h3>\n            <div class=\"next-group-list\" id=\"nextGroupList\">\n                <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->\n            </div>\n        </div>\n    </div>\n    \n    <!-- ê²°ê³¼ í™”ë©´ -->\n    <div id=\"resultsScreen\" class=\"screen results-screen\">\n        <iframe src=\"\" class=\"results-content\" id=\"resultFrame\"></iframe>\n    </div>\n    \n    <!-- ì œì–´ íŒ¨ë„ -->\n    <div class=\"control-panel\" id=\"controlPanel\">\n        <button class=\"control-btn\" onclick=\"showMode('waiting')\">â³ ëŒ€ê¸°í™”ë©´</button>\n        <button class=\"control-btn\" onclick=\"showMode('results')\">ğŸ“Š ê²°ê³¼</button>\n        <button class=\"control-btn\" onclick=\"previousGroup()\">â¬…ï¸ ì´ì „ ê·¸ë£¹</button>\n        <button class=\"control-btn\" onclick=\"nextGroup()\">ë‹¤ìŒ ê·¸ë£¹ â¡ï¸</button>\n        <button class=\"control-btn\" onclick=\"checkResult()\">ğŸ” ê²°ê³¼í™•ì¸</button>\n        <button class=\"control-btn\" onclick=\"toggleResultScale()\">ğŸ” í¬ê¸°ì¡°ì ˆ</button>\n        <button class=\"control-btn\" onclick=\"toggleAutoAdvance()\">âš¡ ìë™ì „í™˜</button>\n        <button class=\"control-btn\" onclick=\"toggleStatusBar()\">ğŸ“Š ìƒíƒœë°”</button>\n        <button class=\"control-btn\" onclick=\"hideControlPanel()\">ğŸ‘ï¸ ìˆ¨ê¸°ê¸°</button>\n        <button class=\"control-btn danger\" onclick=\"exitFullscreen()\">âŒ ì¢…ë£Œ</button>\n    </div>\n    \n    <!-- ìƒíƒœ í‘œì‹œ -->\n    <div class=\"status-bar\" id=\"statusBar\">\n        í˜„ì¬ ê·¸ë£¹: <span id=\"currentGroupIndex\"><?php echo $currentGroupIndex; ?></span> | \n        ëª¨ë“œ: <span id=\"currentMode\"><?php echo $mode; ?></span> | \n        ì´ ê·¸ë£¹: <span id=\"totalGroups\">-</span> | \n        ìë™ì „í™˜: <span id=\"autoAdvanceStatus\">ON</span> | \n        ë‹¨ì¶•í‚¤: S(í¬ê¸°ì¡°ì ˆ) F11(ì „ì²´í™”ë©´) A(ìë™ì „í™˜) B(ìƒíƒœë°”) H(ìˆ¨ê¸°ê¸°)\n    </div>\n\n    <script>\n        let currentGroupIndex = <?php echo $currentGroupIndex; ?>;\n        let currentMode = '<?php echo $mode; ?>';\n        let events = [];\n        let eventGroups = [];\n        let competitionSettings = {};\n        let autoAdvanceTime = 5000; // ìë™ ì „í™˜ ì‹œê°„ (ë°€ë¦¬ì´ˆ)\n        let autoAdvanceEnabled = true; // ìë™ ì „í™˜ í™œì„±í™” ìƒíƒœ\n        let isAdvancing = false; // ìë™ ì „í™˜ ì¤‘ì¸ì§€ í™•ì¸\n        let isFullscreen = false; // ì „ì²´í™”ë©´ ìƒíƒœ\n        let statusBarHidden = false; // ìƒíƒœ í‘œì‹œë°” ìˆ¨ê¹€ ìƒíƒœ\n        let advanceTimer = null; // ìë™ ì „í™˜ íƒ€ì´ë¨¸\n        let monitoringInterval = null; // ëª¨ë‹ˆí„°ë§ ì¸í„°ë²Œ\n        \n        // ëŒ€íšŒ ì„¤ì • ë¡œë“œ\n        async function loadCompetitionSettings() {\n            try {\n                const response = await fetch('get_competition_settings.php');\n                const data = await response.json();\n                \n                if (data.success) {\n                    competitionSettings = data.settings;\n                    document.getElementById('competitionTitle').textContent = competitionSettings.competition_title;\n                    document.getElementById('competitionSubtitle').textContent = competitionSettings.competition_subtitle;\n                }\n            } catch (error) {\n                console.error('ëŒ€íšŒ ì„¤ì • ë¡œë“œ ì˜¤ë¥˜:', error);\n            }\n        }\n        \n        // ì´ë²¤íŠ¸ ë°ì´í„° ë¡œë“œ\n        async function loadEvents() {\n            try {\n                const response = await fetch('get_event_schedule.php');\n                const data = await response.json();\n                \n                if (data.success) {\n                    events = data.events;\n                    console.log('ë¡œë“œëœ ì´ë²¤íŠ¸:', events);\n                    eventGroups = groupEvents(events);\n                    console.log('ê·¸ë£¹í™”ëœ ì´ë²¤íŠ¸:', eventGroups);\n                    document.getElementById('totalGroups').textContent = Object.keys(eventGroups).length;\n                    updateCurrentGroup();\n                    updateNextGroups();\n                } else {\n                    console.error('ì´ë²¤íŠ¸ ë¡œë“œ ì‹¤íŒ¨:', data.message);\n                }\n            } catch (error) {\n                console.error('ì´ë²¤íŠ¸ ë¡œë“œ ì˜¤ë¥˜:', error);\n            }\n        }\n        \n        // ì´ë²¤íŠ¸ë¥¼ ê·¸ë£¹ë³„ë¡œ ë¶„ë¥˜\n        function groupEvents(events) {\n            const groups = {};\n            \n            events.forEach(event => {\n                // ì´ë²¤íŠ¸ IDì—ì„œ ìˆ«ì ë¶€ë¶„ ì¶”ì¶œ (ì˜ˆ: 1A -> 1, 2B -> 2)\n                const eventNumber = event.id.replace(/[^0-9]/g, '');\n                \n                if (eventNumber && eventNumber !== '') {\n                    if (!groups[eventNumber]) {\n                        groups[eventNumber] = [];\n                    }\n                    groups[eventNumber].push(event);\n                }\n            });\n            \n            // ìˆ«ì ìˆœìœ¼ë¡œ ì •ë ¬\n            const sortedGroups = {};\n            Object.keys(groups).sort((a, b) => parseInt(a) - parseInt(b)).forEach(key => {\n                sortedGroups[key] = groups[key];\n            });\n            \n            return sortedGroups;\n        }\n        \n        // í˜„ì¬ ê·¸ë£¹ ì—…ë°ì´íŠ¸\n        function updateCurrentGroup() {\n            const groupNumbers = Object.keys(eventGroups).sort((a, b) => parseInt(a) - parseInt(b));\n            \n            if (groupNumbers.length > 0 && currentGroupIndex < groupNumbers.length) {\n                const currentGroupNumber = groupNumbers[currentGroupIndex];\n                const currentGroupEvents = eventGroups[currentGroupNumber];\n                \n                document.getElementById('groupTitle').textContent = `ì´ë²¤íŠ¸ ${currentGroupNumber}`;\n                document.getElementById('currentGroupIndex').textContent = currentGroupIndex + 1;\n                \n                // ì´ë²¤íŠ¸ ëª©ë¡ ì—…ë°ì´íŠ¸\n                const eventList = document.getElementById('eventList');\n                eventList.innerHTML = '';\n                \n                currentGroupEvents.forEach(event => {\n                    const eventItem = document.createElement('li');\n                    eventItem.className = 'event-item';\n                    eventItem.innerHTML = `\n                        <span class=\"event-name\">${event.name}</span>\n                    `;\n                    eventList.appendChild(eventItem);\n                });\n            }\n        }\n        \n        // ë‹¤ìŒ ê·¸ë£¹ë“¤ ì—…ë°ì´íŠ¸\n        function updateNextGroups() {\n            const nextGroupList = document.getElementById('nextGroupList');\n            nextGroupList.innerHTML = '';\n            \n            const groupNumbers = Object.keys(eventGroups).sort((a, b) => parseInt(a) - parseInt(b));\n            \n            // ë‹¤ìŒ 3ê°œ ê·¸ë£¹ í‘œì‹œ\n            for (let i = 1; i <= 3; i++) {\n                const nextIndex = currentGroupIndex + i;\n                if (nextIndex < groupNumbers.length) {\n                    const groupNumber = groupNumbers[nextIndex];\n                    const groupEvents = eventGroups[groupNumber];\n                    \n                    const groupItem = document.createElement('div');\n                    groupItem.className = 'next-group-item';\n                    groupItem.textContent = `ì´ë²¤íŠ¸ ${groupNumber} (${groupEvents.length}ê°œ)`;\n                    nextGroupList.appendChild(groupItem);\n                }\n            }\n        }\n        \n        // ëª¨ë“œ ì „í™˜\n        function showMode(mode) {\n            document.querySelectorAll('.screen').forEach(screen => {\n                screen.classList.remove('active');\n            });\n            \n            currentMode = mode;\n            document.getElementById('currentMode').textContent = mode;\n            \n            switch(mode) {\n                case 'waiting':\n                    document.getElementById('waitingScreen').classList.add('active');\n                    break;\n                case 'results':\n                    document.getElementById('resultsScreen').classList.add('active');\n                    loadCurrentResult();\n                    break;\n            }\n        }\n        \n        // í˜„ì¬ ê²°ê³¼ ë¡œë“œ\n        function loadCurrentResult() {\n            const groupNumbers = Object.keys(eventGroups).sort((a, b) => parseInt(a) - parseInt(b));\n            \n            if (groupNumbers.length > 0 && currentGroupIndex < groupNumbers.length) {\n                const currentGroupNumber = groupNumbers[currentGroupIndex];\n                const currentGroupEvents = eventGroups[currentGroupNumber];\n                \n                // ì²« ë²ˆì§¸ ì´ë²¤íŠ¸ì˜ ê²°ê³¼ ë¡œë“œ\n                if (currentGroupEvents.length > 0) {\n                    const firstEvent = currentGroupEvents[0];\n                    const iframe = document.getElementById('resultFrame');\n                    iframe.src = `combined_result_${firstEvent.id}.html`;\n                }\n            }\n        }\n        \n        // ì´ì „ ê·¸ë£¹\n        function previousGroup() {\n            const groupNumbers = Object.keys(eventGroups).sort((a, b) => parseInt(a) - parseInt(b));\n            \n            if (currentGroupIndex > 0) {\n                // ê¸°ì¡´ íƒ€ì´ë¨¸ ì·¨ì†Œ\n                if (advanceTimer) {\n                    clearTimeout(advanceTimer);\n                    advanceTimer = null;\n                }\n                \n                // ê¸°ì¡´ ëª¨ë‹ˆí„°ë§ ì™„ì „ ì¤‘ë‹¨\n                stopResultFileMonitoring();\n                \n                currentGroupIndex--;\n                updateCurrentGroup();\n                updateNextGroups();\n                showMode('waiting');\n                isAdvancing = false; // ìˆ˜ë™ ì „í™˜ ì‹œì—ë„ í”Œë˜ê·¸ ë¦¬ì…‹\n                \n                // ì ì‹œ ëŒ€ê¸° í›„ ìƒˆë¡œìš´ ì´ë²¤íŠ¸ ëª¨ë‹ˆí„°ë§ ì‹œì‘\n                setTimeout(() => {\n                    startResultFileMonitoring();\n                }, 1000);\n            }\n        }\n        \n        // ë‹¤ìŒ ê·¸ë£¹\n        function nextGroup() {\n            const groupNumbers = Object.keys(eventGroups).sort((a, b) => parseInt(a) - parseInt(b));\n            \n            if (currentGroupIndex < groupNumbers.length - 1) {\n                // ê¸°ì¡´ íƒ€ì´ë¨¸ ì·¨ì†Œ\n                if (advanceTimer) {\n                    clearTimeout(advanceTimer);\n                    advanceTimer = null;\n                }\n                \n                // ê¸°ì¡´ ëª¨ë‹ˆí„°ë§ ì™„ì „ ì¤‘ë‹¨\n                stopResultFileMonitoring();\n                \n                currentGroupIndex++;\n                updateCurrentGroup();\n                updateNextGroups();\n                showMode('waiting');\n                isAdvancing = false; // ìˆ˜ë™ ì „í™˜ ì‹œì—ë„ í”Œë˜ê·¸ ë¦¬ì…‹\n                \n                // ì ì‹œ ëŒ€ê¸° í›„ ìƒˆë¡œìš´ ì´ë²¤íŠ¸ ëª¨ë‹ˆí„°ë§ ì‹œì‘\n                setTimeout(() => {\n                    startResultFileMonitoring();\n                }, 1000);\n            }\n        }\n        \n        // ê²°ê³¼ í™•ì¸\n        function checkResult() {\n            const groupNumbers = Object.keys(eventGroups).sort((a, b) => parseInt(a) - parseInt(b));\n            \n            if (groupNumbers.length > 0 && currentGroupIndex < groupNumbers.length) {\n                const currentGroupNumber = groupNumbers[currentGroupIndex];\n                const currentGroupEvents = eventGroups[currentGroupNumber];\n                \n                // ê·¸ë£¹ ë‚´ì—ì„œ ê²°ê³¼ ë°œí‘œê°€ ì„¤ì •ëœ ì´ë²¤íŠ¸ê°€ ìˆëŠ”ì§€ í™•ì¸\n                const hasResultEvent = currentGroupEvents.some(event => event.show_result);\n                \n                if (hasResultEvent) {\n                    showMode('results');\n                } else {\n                    alert('ì´ ê·¸ë£¹ì—ëŠ” ê²°ê³¼ ë°œí‘œê°€ ì„¤ì •ëœ ì´ë²¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.');\n                }\n            }\n        }\n        \n        // ì „ì²´í™”ë©´ ì¢…ë£Œ\n        function exitFullscreen() {\n            if (document.exitFullscreen) {\n                document.exitFullscreen();\n            } else if (document.webkitExitFullscreen) {\n                document.webkitExitFullscreen();\n            } else if (document.mozCancelFullScreen) {\n                document.mozCancelFullScreen();\n            } else if (document.msExitFullscreen) {\n                document.msExitFullscreen();\n            }\n        }\n        \n        // ê²°ê³¼ í™”ë©´ í¬ê¸° ì¡°ì ˆ\n        function toggleResultScale() {\n            const resultsScreen = document.getElementById('resultsScreen');\n            const resultFrame = document.getElementById('resultFrame');\n            \n            if (resultsScreen.classList.contains('fullscreen-optimized')) {\n                // ì¼ë°˜ í¬ê¸°ë¡œ ë³µì›\n                resultsScreen.classList.remove('fullscreen-optimized');\n                resultFrame.style.transform = 'scale(0.8)';\n                resultFrame.style.width = '100%';\n                resultFrame.style.height = '100%';\n            } else {\n                // ì „ì²´í™”ë©´ ìµœì í™”\n                resultsScreen.classList.add('fullscreen-optimized');\n                resultFrame.style.transform = 'scale(0.7)';\n                resultFrame.style.width = '142.86%';\n                resultFrame.style.height = '142.86%';\n            }\n        }\n        \n        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤\n        document.addEventListener('keydown', function(e) {\n            switch(e.key) {\n                case 'F11':\n                    e.preventDefault();\n                    if (!document.fullscreenElement) {\n                        document.documentElement.requestFullscreen();\n                    } else {\n                        exitFullscreen();\n                    }\n                    break;\n                case 'ArrowLeft':\n                    previousGroup();\n                    break;\n                case 'ArrowRight':\n                    nextGroup();\n                    break;\n                case ' ':\n                    e.preventDefault();\n                    checkResult();\n                    break;\n                case '1':\n                    showMode('waiting');\n                    break;\n                case '2':\n                    showMode('results');\n                    break;\n                case 'S':\n                    toggleResultScale();\n                    break;\n                case 'A':\n                case 'a':\n                    toggleAutoAdvance();\n                    break;\n                case 'H':\n                case 'h':\n                    hideControlPanel();\n                    break;\n                case 'B':\n                case 'b':\n                    toggleStatusBar();\n                    break;\n                case 'Escape':\n                    exitFullscreen();\n                    break;\n            }\n        });\n        \n        // ê²°ê³¼ íŒŒì¼ ìë™ í™•ì¸\n        async function checkResultFileAndShow() {\n            if (events.length > 0 && currentGroupIndex >= 0 && currentGroupIndex < Object.keys(eventGroups).length) {\n                const groupNumbers = Object.keys(eventGroups).sort((a, b) => parseInt(a) - parseInt(b));\n                const currentGroupNumber = groupNumbers[currentGroupIndex];\n                const currentGroupEvents = eventGroups[currentGroupNumber];\n                \n                // í˜„ì¬ ê·¸ë£¹ì´ ì˜¬ë°”ë¥¸ì§€ í™•ì¸\n                if (!currentGroupEvents) {\n                    console.log('âŒ í˜„ì¬ ê·¸ë£¹ ì´ë²¤íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤:', currentGroupNumber);\n                    return;\n                }\n                \n                console.log(`ì´ë²¤íŠ¸ ${currentGroupNumber} í™•ì¸ ì¤‘... (${currentGroupEvents.length}ê°œ ì´ë²¤íŠ¸)`);\n                \n                // ê·¸ë£¹ ë‚´ì˜ ëª¨ë“  ì´ë²¤íŠ¸ì— ëŒ€í•´ combined_result íŒŒì¼ í™•ì¸\n                let hasAnyResult = false;\n                \n                for (const event of currentGroupEvents) {\n                    try {\n                        const response = await fetch(`check_result_file.php?event=${event.id}`);\n                        const data = await response.json();\n                        \n                        if (data.exists) {\n                            hasAnyResult = true;\n                            console.log(`âœ… ê²°ê³¼ íŒŒì¼ ë°œê²¬: ${event.id}`);\n                            break; // í•˜ë‚˜ë¼ë„ ì°¾ìœ¼ë©´ ì¤‘ë‹¨\n                        } else {\n                            console.log(`âŒ ê²°ê³¼ íŒŒì¼ ì—†ìŒ: ${event.id}`);\n                        }\n                    } catch (error) {\n                        console.error(`ê²°ê³¼ íŒŒì¼ í™•ì¸ ì˜¤ë¥˜ (${event.id}):`, error);\n                    }\n                }\n                \n                // ê²°ê³¼ íŒŒì¼ì´ ìˆìœ¼ë©´ ìë™ìœ¼ë¡œ ë‹¤ìŒ ì´ë²¤íŠ¸ë¡œ ì „í™˜ (ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€)\n                if (hasAnyResult && autoAdvanceEnabled && !isAdvancing) {\n                    isAdvancing = true;\n                    console.log(`ì´ë²¤íŠ¸ ${currentGroupNumber}ì—ì„œ ê²°ê³¼ íŒŒì¼ ë°œê²¬! ${autoAdvanceTime/1000}ì´ˆ í›„ ë‹¤ìŒ ì´ë²¤íŠ¸ë¡œ ì „í™˜í•©ë‹ˆë‹¤...`);\n                    \n                    // ê¸°ì¡´ íƒ€ì´ë¨¸ê°€ ìˆìœ¼ë©´ ì·¨ì†Œ\n                    if (advanceTimer) {\n                        clearTimeout(advanceTimer);\n                    }\n                    \n                    advanceTimer = setTimeout(() => {\n                        autoAdvanceToNextEvent();\n                        isAdvancing = false; // ì „í™˜ ì™„ë£Œ í›„ í”Œë˜ê·¸ ë¦¬ì…‹\n                        advanceTimer = null; // íƒ€ì´ë¨¸ ë¦¬ì…‹\n                    }, autoAdvanceTime);\n                } else if (!hasAnyResult) {\n                    console.log(`ì´ë²¤íŠ¸ ${currentGroupNumber}ì— ê²°ê³¼ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤. ëŒ€ê¸° ì¤‘...`);\n                } else if (isAdvancing) {\n                    console.log(`ì´ë²¤íŠ¸ ${currentGroupNumber}ì—ì„œ ê²°ê³¼ íŒŒì¼ ë°œê²¬í–ˆì§€ë§Œ ì´ë¯¸ ì „í™˜ ì¤‘ì…ë‹ˆë‹¤.`);\n                }\n            }\n        }\n        \n        // ìë™ìœ¼ë¡œ ë‹¤ìŒ ì´ë²¤íŠ¸ë¡œ ì „í™˜\n        function autoAdvanceToNextEvent() {\n            const groupNumbers = Object.keys(eventGroups).sort((a, b) => parseInt(a) - parseInt(b));\n            \n            if (currentGroupIndex < groupNumbers.length - 1) {\n                console.log('ìë™ìœ¼ë¡œ ë‹¤ìŒ ì´ë²¤íŠ¸ë¡œ ì „í™˜í•©ë‹ˆë‹¤...');\n                \n                // ê¸°ì¡´ ëª¨ë‹ˆí„°ë§ ì™„ì „ ì¤‘ë‹¨\n                stopResultFileMonitoring();\n                \n                // ê¸°ì¡´ íƒ€ì´ë¨¸ë„ ì·¨ì†Œ\n                if (advanceTimer) {\n                    clearTimeout(advanceTimer);\n                    advanceTimer = null;\n                }\n                \n                currentGroupIndex++;\n                updateCurrentGroup();\n                updateNextGroups();\n                showMode('waiting');\n                \n                // ë‹¤ìŒ ì´ë²¤íŠ¸ ê·¸ë£¹ ì •ë³´ í‘œì‹œ\n                const nextGroupNumber = groupNumbers[currentGroupIndex];\n                console.log(`ì´ì œ ì´ë²¤íŠ¸ ${nextGroupNumber}ë¥¼ ëª¨ë‹ˆí„°ë§í•©ë‹ˆë‹¤.`);\n                \n                // ì „í™˜ ì™„ë£Œ í›„ í”Œë˜ê·¸ ë¦¬ì…‹\n                isAdvancing = false;\n                \n                // ì ì‹œ ëŒ€ê¸° í›„ ìƒˆë¡œìš´ ì´ë²¤íŠ¸ ëª¨ë‹ˆí„°ë§ ì‹œì‘\n                setTimeout(() => {\n                    startResultFileMonitoring();\n                }, 1000);\n            } else {\n                console.log('ëª¨ë“  ì´ë²¤íŠ¸ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');\n                // ëª¨ë“  ì´ë²¤íŠ¸ ì™„ë£Œ ì‹œ ëŒ€ê¸°í™”ë©´ìœ¼ë¡œ\n                showMode('waiting');\n                isAdvancing = false;\n                advanceTimer = null;\n                // ëª¨ë‹ˆí„°ë§ ì¤‘ë‹¨\n                stopResultFileMonitoring();\n            }\n        }\n        \n        // ìë™ ì „í™˜ í† ê¸€\n        function toggleAutoAdvance() {\n            autoAdvanceEnabled = !autoAdvanceEnabled;\n            const button = event.target;\n            \n            if (autoAdvanceEnabled) {\n                button.textContent = 'âš¡ ìë™ì „í™˜ ON';\n                button.style.background = '#28a745';\n                document.getElementById('autoAdvanceStatus').textContent = 'ON';\n                console.log('ìë™ ì „í™˜ì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');\n            } else {\n                button.textContent = 'âš¡ ìë™ì „í™˜ OFF';\n                button.style.background = '#dc3545';\n                document.getElementById('autoAdvanceStatus').textContent = 'OFF';\n                console.log('ìë™ ì „í™˜ì´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');\n            }\n        }\n        \n        // ì œì–´ íŒ¨ë„ ìˆ¨ê¸°ê¸°\n        function hideControlPanel() {\n            document.getElementById('controlPanel').style.opacity = '0';\n            console.log('ì œì–´ íŒ¨ë„ì´ ìˆ¨ê²¨ì¡ŒìŠµë‹ˆë‹¤.');\n        }\n        \n        // ìƒíƒœ í‘œì‹œë°” í† ê¸€\n        function toggleStatusBar() {\n            const statusBar = document.getElementById('statusBar');\n            statusBarHidden = !statusBarHidden;\n            \n            if (statusBarHidden) {\n                statusBar.classList.add('hidden');\n                console.log('ìƒíƒœ í‘œì‹œë°”ê°€ ìˆ¨ê²¨ì¡ŒìŠµë‹ˆë‹¤.');\n            } else {\n                statusBar.classList.remove('hidden');\n                console.log('ìƒíƒœ í‘œì‹œë°”ê°€ í‘œì‹œë˜ì—ˆìŠµë‹ˆë‹¤.');\n            }\n        }\n        \n        // ê²°ê³¼ íŒŒì¼ ëª¨ë‹ˆí„°ë§ ì‹œì‘\n        function startResultFileMonitoring() {\n            // ê¸°ì¡´ ì¸í„°ë²Œì´ ìˆìœ¼ë©´ ì¤‘ë‹¨\n            if (monitoringInterval) {\n                clearInterval(monitoringInterval);\n                console.log('ê¸°ì¡´ ëª¨ë‹ˆí„°ë§ ì¤‘ë‹¨ë¨');\n            }\n            // 5ì´ˆë§ˆë‹¤ ê²°ê³¼ íŒŒì¼ í™•ì¸\n            monitoringInterval = setInterval(checkResultFileAndShow, 5000);\n            console.log('ìƒˆë¡œìš´ ëª¨ë‹ˆí„°ë§ ì‹œì‘ë¨ - ì´ë²¤íŠ¸', Object.keys(eventGroups).sort((a, b) => parseInt(a) - parseInt(b))[currentGroupIndex]);\n        }\n        \n        // ê²°ê³¼ íŒŒì¼ ëª¨ë‹ˆí„°ë§ ì¤‘ë‹¨\n        function stopResultFileMonitoring() {\n            if (monitoringInterval) {\n                clearInterval(monitoringInterval);\n                monitoringInterval = null;\n                console.log('ëª¨ë‹ˆí„°ë§ ì¤‘ë‹¨ë¨');\n            }\n        }\n        \n        // ì´ˆê¸°í™”\n        document.addEventListener('DOMContentLoaded', function() {\n            loadCompetitionSettings();\n            loadEvents();\n            showMode(currentMode);\n            \n            // ê²°ê³¼ íŒŒì¼ ìë™ ëª¨ë‹ˆí„°ë§ ì‹œì‘\n            startResultFileMonitoring();\n            \n            // 3ì´ˆ í›„ ì œì–´ íŒ¨ë„ ìˆ¨ê¸°ê¸°\n            setTimeout(() => {\n                document.getElementById('controlPanel').style.opacity = '0';\n            }, 3000);\n        });\n        \n        // ë§ˆìš°ìŠ¤ ì›€ì§ì„ ê°ì§€ë¡œ ì œì–´ íŒ¨ë„ í‘œì‹œ (ì „ì²´í™”ë©´ ëª¨ë“œì—ì„œë§Œ)\n        let mouseTimer;\n        let isMouseMoving = false;\n        \n        document.addEventListener('mousemove', function() {\n            if (isFullscreen) {\n                document.getElementById('controlPanel').style.opacity = '1';\n                clearTimeout(mouseTimer);\n                mouseTimer = setTimeout(() => {\n                    document.getElementById('controlPanel').style.opacity = '0';\n                }, 3000);\n            }\n        });\n        \n        // ì „ì²´í™”ë©´ ìƒíƒœ ì—…ë°ì´íŠ¸\n        function updateFullscreenStatus() {\n            isFullscreen = !!(document.fullscreenElement || \n                            document.webkitFullscreenElement || \n                            document.mozFullScreenElement || \n                            document.msFullscreenElement);\n        }\n        \n        // ì „ì²´í™”ë©´ ì§„ì… ì‹œ ì œì–´ íŒ¨ë„ê³¼ ìƒíƒœ í‘œì‹œë°” ìˆ¨ê¸°ê¸°\n        document.addEventListener('fullscreenchange', function() {\n            updateFullscreenStatus();\n            if (isFullscreen) {\n                setTimeout(() => {\n                    document.getElementById('controlPanel').style.opacity = '0';\n                    document.getElementById('statusBar').classList.add('hidden');\n                    statusBarHidden = true;\n                }, 2000);\n            } else {\n                document.getElementById('controlPanel').style.opacity = '1';\n                document.getElementById('statusBar').classList.remove('hidden');\n                statusBarHidden = false;\n            }\n        });\n        \n        document.addEventListener('webkitfullscreenchange', updateFullscreenStatus);\n        document.addEventListener('mozfullscreenchange', updateFullscreenStatus);\n        document.addEventListener('MSFullscreenChange', updateFullscreenStatus);\n    </script>\n</body>\n</html>\n\n","size_bytes":32026},"comp/event_schedule_editor.php":{"content":"<?php\n/**\n * ì´ë²¤íŠ¸ ìˆœì„œ í¸ì§‘ê¸°\n */\n\nrequire_once 'event_schedule_manager.php';\n\n$scheduleManager = new EventScheduleManager();\n$action = isset($_GET['action']) ? $_GET['action'] : '';\n\n// ì•¡ì…˜ ì²˜ë¦¬\nif ($action === 'add_event') {\n    $eventId = $_POST['event_id'] ?? '';\n    $eventName = $_POST['event_name'] ?? '';\n    $showResult = $_POST['show_result'] === 'true';\n    \n    if ($eventId && $eventName) {\n        // ìƒˆ ì´ë²¤íŠ¸ ì¶”ê°€ ë¡œì§\n        echo json_encode(['success' => true, 'message' => 'ì´ë²¤íŠ¸ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.']);\n    } else {\n        echo json_encode(['success' => false, 'message' => 'í•„ìˆ˜ ì •ë³´ê°€ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤.']);\n    }\n    exit;\n}\n\nif ($action === 'delete_event') {\n    $eventId = $_POST['event_id'] ?? '';\n    // ì´ë²¤íŠ¸ ì‚­ì œ ë¡œì§\n    echo json_encode(['success' => true, 'message' => 'ì´ë²¤íŠ¸ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.']);\n    exit;\n}\n\nif ($action === 'reorder_events') {\n    $newOrder = $_POST['event_order'] ?? [];\n    // ì´ë²¤íŠ¸ ìˆœì„œ ì¬ì •ë ¬ ë¡œì§\n    echo json_encode(['success' => true, 'message' => 'ìˆœì„œê°€ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.']);\n    exit;\n}\n\n$schedule = $scheduleManager->getSchedule();\n\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>ì´ë²¤íŠ¸ ìˆœì„œ í¸ì§‘ê¸°</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            margin: 20px;\n            background: #f5f5f5;\n        }\n        \n        .container {\n            max-width: 1200px;\n            margin: 0 auto;\n            background: white;\n            padding: 20px;\n            border-radius: 10px;\n            box-shadow: 0 0 20px rgba(0,0,0,0.1);\n        }\n        \n        .header {\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n            padding: 20px;\n            border-radius: 10px;\n            margin-bottom: 30px;\n            text-align: center;\n        }\n        \n        .header h1 {\n            margin: 0;\n            font-size: 2em;\n        }\n        \n        .controls {\n            display: flex;\n            gap: 15px;\n            margin-bottom: 30px;\n            flex-wrap: wrap;\n        }\n        \n        .btn {\n            background: #007bff;\n            color: white;\n            border: none;\n            padding: 12px 20px;\n            border-radius: 5px;\n            cursor: pointer;\n            font-size: 14px;\n            transition: background 0.3s;\n        }\n        \n        .btn:hover {\n            background: #0056b3;\n        }\n        \n        .btn.success {\n            background: #28a745;\n        }\n        \n        .btn.success:hover {\n            background: #218838;\n        }\n        \n        .btn.danger {\n            background: #dc3545;\n        }\n        \n        .btn.danger:hover {\n            background: #c82333;\n        }\n        \n        .btn.info {\n            background: #17a2b8;\n        }\n        \n        .btn.info:hover {\n            background: #138496;\n        }\n        \n        .event-list {\n            border: 1px solid #ddd;\n            border-radius: 5px;\n            overflow: hidden;\n        }\n        \n        .event-item {\n            display: flex;\n            align-items: center;\n            padding: 15px;\n            border-bottom: 1px solid #eee;\n            background: white;\n            transition: background 0.3s;\n        }\n        \n        .event-item:hover {\n            background: #f8f9fa;\n        }\n        \n        .event-item:last-child {\n            border-bottom: none;\n        }\n        \n        .event-order {\n            width: 50px;\n            text-align: center;\n            font-weight: bold;\n            color: #667eea;\n        }\n        \n        .event-id {\n            width: 100px;\n            font-weight: bold;\n            color: #333;\n        }\n        \n        .event-name {\n            flex: 1;\n            margin: 0 15px;\n            color: #555;\n        }\n        \n        .event-controls {\n            display: flex;\n            gap: 10px;\n            align-items: center;\n        }\n        \n        .drag-handle {\n            cursor: move;\n            color: #999;\n            font-size: 18px;\n        }\n        \n        .toggle-switch {\n            position: relative;\n            display: inline-block;\n            width: 50px;\n            height: 24px;\n        }\n        \n        .toggle-switch input {\n            opacity: 0;\n            width: 0;\n            height: 0;\n        }\n        \n        .slider {\n            position: absolute;\n            cursor: pointer;\n            top: 0;\n            left: 0;\n            right: 0;\n            bottom: 0;\n            background-color: #ccc;\n            transition: .4s;\n            border-radius: 24px;\n        }\n        \n        .slider:before {\n            position: absolute;\n            content: \"\";\n            height: 18px;\n            width: 18px;\n            left: 3px;\n            bottom: 3px;\n            background-color: white;\n            transition: .4s;\n            border-radius: 50%;\n        }\n        \n        input:checked + .slider {\n            background-color: #2196F3;\n        }\n        \n        input:checked + .slider:before {\n            transform: translateX(26px);\n        }\n        \n        .add-event-form {\n            background: #f8f9fa;\n            padding: 20px;\n            border-radius: 5px;\n            margin-bottom: 20px;\n        }\n        \n        .form-group {\n            margin-bottom: 15px;\n        }\n        \n        .form-group label {\n            display: block;\n            margin-bottom: 5px;\n            font-weight: bold;\n            color: #333;\n        }\n        \n        .form-group input {\n            width: 100%;\n            padding: 8px 12px;\n            border: 1px solid #ddd;\n            border-radius: 4px;\n            font-size: 14px;\n        }\n        \n        .form-row {\n            display: flex;\n            gap: 15px;\n        }\n        \n        .form-row .form-group {\n            flex: 1;\n        }\n        \n        .status-badge {\n            padding: 4px 8px;\n            border-radius: 4px;\n            font-size: 12px;\n            font-weight: bold;\n        }\n        \n        .status-show {\n            background: #d4edda;\n            color: #155724;\n        }\n        \n        .status-hide {\n            background: #f8d7da;\n            color: #721c24;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>ğŸ“‹ ì´ë²¤íŠ¸ ìˆœì„œ í¸ì§‘ê¸°</h1>\n            <p>ëŒ€íšŒ ìˆœì„œë¥¼ ì¶”ê°€, ìˆ˜ì •, ì‚­ì œí•˜ê³  í‘œì‹œ ì—¬ë¶€ë¥¼ ì„¤ì •í•˜ì„¸ìš”</p>\n        </div>\n        \n        <div class=\"controls\">\n            <button class=\"btn success\" onclick=\"openEventControl()\">ğŸ¯ ì´ë²¤íŠ¸ ì œì–´</button>\n            <button class=\"btn info\" onclick=\"openSmartFullscreen()\">ğŸ“º ìŠ¤ë§ˆíŠ¸ ì „ì²´í™”ë©´</button>\n            <button class=\"btn\" onclick=\"refreshPage()\">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>\n            <button class=\"btn danger\" onclick=\"resetAllVisibility()\">ğŸ”„ ëª¨ë“  í‘œì‹œ ì´ˆê¸°í™”</button>\n        </div>\n        \n        <!-- ìƒˆ ì´ë²¤íŠ¸ ì¶”ê°€ í¼ -->\n        <div class=\"add-event-form\">\n            <h3>â• ìƒˆ ì´ë²¤íŠ¸ ì¶”ê°€</h3>\n            <form id=\"addEventForm\">\n                <div class=\"form-row\">\n                    <div class=\"form-group\">\n                        <label for=\"newEventId\">ì´ë²¤íŠ¸ ID</label>\n                        <input type=\"text\" id=\"newEventId\" placeholder=\"ì˜ˆ: 26A\" required>\n                    </div>\n                    <div class=\"form-group\">\n                        <label for=\"newEventName\">ì´ë²¤íŠ¸ëª…</label>\n                        <input type=\"text\" id=\"newEventName\" placeholder=\"ì˜ˆ: 26. ì²­ê° ìŠ¤íƒ ë”ë“œ ì™ˆì¸ \" required>\n                    </div>\n                    <div class=\"form-group\">\n                        <label for=\"newShowResult\">ê²°ê³¼ í‘œì‹œ</label>\n                        <label class=\"toggle-switch\">\n                            <input type=\"checkbox\" id=\"newShowResult\" checked>\n                            <span class=\"slider\"></span>\n                        </label>\n                    </div>\n                </div>\n                <button type=\"submit\" class=\"btn success\">â• ì´ë²¤íŠ¸ ì¶”ê°€</button>\n            </form>\n        </div>\n        \n        <!-- ì´ë²¤íŠ¸ ëª©ë¡ -->\n        <h3>ğŸ“‹ í˜„ì¬ ì´ë²¤íŠ¸ ìˆœì„œ</h3>\n        <div class=\"event-list\" id=\"eventList\">\n            <?php foreach ($schedule as $index => $event): ?>\n            <div class=\"event-item\" data-event-id=\"<?php echo htmlspecialchars($event['event_id']); ?>\">\n                <div class=\"drag-handle\">â‹®â‹®</div>\n                <div class=\"event-order\"><?php echo $index + 1; ?></div>\n                <div class=\"event-id\"><?php echo htmlspecialchars($event['event_id']); ?></div>\n                <div class=\"event-name\"><?php echo htmlspecialchars($event['event_name']); ?></div>\n                <div class=\"event-controls\">\n                    <label class=\"toggle-switch\">\n                        <input type=\"checkbox\" \n                               <?php echo $event['show_result'] ? 'checked' : ''; ?>\n                               onchange=\"updateVisibility('<?php echo $event['event_id']; ?>', this.checked)\">\n                        <span class=\"slider\"></span>\n                    </label>\n                    <span class=\"status-badge <?php echo $event['show_result'] ? 'status-show' : 'status-hide'; ?>\">\n                        <?php echo $event['show_result'] ? 'í‘œì‹œ' : 'ìˆ¨ê¹€'; ?>\n                    </span>\n                    <button class=\"btn danger\" onclick=\"deleteEvent('<?php echo $event['event_id']; ?>')\" style=\"padding: 5px 10px; font-size: 12px;\">\n                        ì‚­ì œ\n                    </button>\n                </div>\n            </div>\n            <?php endforeach; ?>\n        </div>\n    </div>\n\n    <script>\n        // ìƒˆ ì´ë²¤íŠ¸ ì¶”ê°€\n        document.getElementById('addEventForm').addEventListener('submit', function(e) {\n            e.preventDefault();\n            \n            const eventId = document.getElementById('newEventId').value;\n            const eventName = document.getElementById('newEventName').value;\n            const showResult = document.getElementById('newShowResult').checked;\n            \n            if (eventId && eventName) {\n                addEvent(eventId, eventName, showResult);\n            }\n        });\n        \n        function addEvent(eventId, eventName, showResult) {\n            // ì‹¤ì œë¡œëŠ” ì„œë²„ì— ì „ì†¡í•˜ì—¬ ì²˜ë¦¬\n            const eventList = document.getElementById('eventList');\n            const newEvent = document.createElement('div');\n            newEvent.className = 'event-item';\n            newEvent.setAttribute('data-event-id', eventId);\n            newEvent.innerHTML = `\n                <div class=\"drag-handle\">â‹®â‹®</div>\n                <div class=\"event-order\">${eventList.children.length + 1}</div>\n                <div class=\"event-id\">${eventId}</div>\n                <div class=\"event-name\">${eventName}</div>\n                <div class=\"event-controls\">\n                    <label class=\"toggle-switch\">\n                        <input type=\"checkbox\" ${showResult ? 'checked' : ''} onchange=\"updateVisibility('${eventId}', this.checked)\">\n                        <span class=\"slider\"></span>\n                    </label>\n                    <span class=\"status-badge ${showResult ? 'status-show' : 'status-hide'}\">\n                        ${showResult ? 'í‘œì‹œ' : 'ìˆ¨ê¹€'}\n                    </span>\n                    <button class=\"btn danger\" onclick=\"deleteEvent('${eventId}')\" style=\"padding: 5px 10px; font-size: 12px;\">\n                        ì‚­ì œ\n                    </button>\n                </div>\n            `;\n            eventList.appendChild(newEvent);\n            \n            // í¼ ì´ˆê¸°í™”\n            document.getElementById('newEventId').value = '';\n            document.getElementById('newEventName').value = '';\n            document.getElementById('newShowResult').checked = true;\n        }\n        \n        function updateVisibility(eventId, showResult) {\n            // ì‹¤ì œë¡œëŠ” ì„œë²„ì— ì „ì†¡í•˜ì—¬ ì²˜ë¦¬\n            console.log(`ì´ë²¤íŠ¸ ${eventId} í‘œì‹œ ì—¬ë¶€: ${showResult}`);\n        }\n        \n        function deleteEvent(eventId) {\n            if (confirm(`ì´ë²¤íŠ¸ ${eventId}ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {\n                const eventItem = document.querySelector(`[data-event-id=\"${eventId}\"]`);\n                if (eventItem) {\n                    eventItem.remove();\n                    updateEventOrder();\n                }\n            }\n        }\n        \n        function updateEventOrder() {\n            const eventItems = document.querySelectorAll('.event-item');\n            eventItems.forEach((item, index) => {\n                const orderElement = item.querySelector('.event-order');\n                orderElement.textContent = index + 1;\n            });\n        }\n        \n        function openEventControl() {\n            window.open('event_control.php', '_blank');\n        }\n        \n        function openSmartFullscreen() {\n            window.open('smart_fullscreen.php', '_blank');\n        }\n        \n        function refreshPage() {\n            location.reload();\n        }\n        \n        function resetAllVisibility() {\n            if (confirm('ëª¨ë“  ì´ë²¤íŠ¸ì˜ í‘œì‹œ ì„¤ì •ì„ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {\n                const checkboxes = document.querySelectorAll('input[type=\"checkbox\"]');\n                checkboxes.forEach(checkbox => {\n                    checkbox.checked = true;\n                    updateVisibility(checkbox.getAttribute('onchange').match(/'([^']+)'/)[1], true);\n                });\n            }\n        }\n        \n        // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ê¸°ëŠ¥ (ê°„ë‹¨í•œ ë²„ì „)\n        let draggedElement = null;\n        \n        document.querySelectorAll('.event-item').forEach(item => {\n            item.draggable = true;\n            \n            item.addEventListener('dragstart', function(e) {\n                draggedElement = this;\n                e.dataTransfer.effectAllowed = 'move';\n            });\n            \n            item.addEventListener('dragover', function(e) {\n                e.preventDefault();\n                e.dataTransfer.dropEffect = 'move';\n            });\n            \n            item.addEventListener('drop', function(e) {\n                e.preventDefault();\n                if (draggedElement && draggedElement !== this) {\n                    const parent = this.parentNode;\n                    const nextSibling = this.nextSibling;\n                    parent.insertBefore(draggedElement, nextSibling);\n                    updateEventOrder();\n                }\n            });\n        });\n    </script>\n</body>\n</html>\n\n\n\n\n","size_bytes":14921},"comp/event_schedule_manager.php":{"content":"<?php\n/**\n * ëŒ€íšŒ ìˆœì„œ ë° ì´ë²¤íŠ¸ ê´€ë¦¬ í´ë˜ìŠ¤\n */\n\nclass EventScheduleManager {\n    private $scheduleFile;\n    private $schedule;\n    \n    public function __construct($scheduleFile = __DIR__ . \"/event_schedule.txt\") {\n        $this->scheduleFile = $scheduleFile;\n        $this->loadSchedule();\n    }\n    \n    /**\n     * ìŠ¤ì¼€ì¤„ íŒŒì¼ ë¡œë“œ\n     */\n    private function loadSchedule() {\n        $this->schedule = [];\n        \n        if (file_exists($this->scheduleFile)) {\n            $lines = file($this->scheduleFile, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n            \n            foreach ($lines as $line) {\n                $parts = explode(',', $line, 3);\n                if (count($parts) >= 3) {\n                    $this->schedule[] = [\n                        'event_id' => trim($parts[0]),\n                        'event_name' => trim($parts[1]),\n                        'show_result' => trim($parts[2]) === 'true'\n                    ];\n                }\n            }\n        }\n    }\n    \n    /**\n     * ì „ì²´ ìŠ¤ì¼€ì¤„ ë°˜í™˜\n     */\n    public function getSchedule() {\n        return $this->schedule;\n    }\n    \n    /**\n     * í˜„ì¬ ì´ë²¤íŠ¸ ì •ë³´ ë°˜í™˜\n     */\n    public function getCurrentEvent($eventId) {\n        foreach ($this->schedule as $event) {\n            if ($event['event_id'] === $eventId) {\n                return $event;\n            }\n        }\n        return null;\n    }\n    \n    /**\n     * ë‹¤ìŒ ì´ë²¤íŠ¸ ì •ë³´ ë°˜í™˜\n     */\n    public function getNextEvent($currentEventId) {\n        $currentIndex = -1;\n        foreach ($this->schedule as $index => $event) {\n            if ($event['event_id'] === $currentEventId) {\n                $currentIndex = $index;\n                break;\n            }\n        }\n        \n        if ($currentIndex >= 0 && $currentIndex < count($this->schedule) - 1) {\n            return $this->schedule[$currentIndex + 1];\n        }\n        \n        return null;\n    }\n    \n    /**\n     * ì´ì „ ì´ë²¤íŠ¸ ì •ë³´ ë°˜í™˜\n     */\n    public function getPreviousEvent($currentEventId) {\n        $currentIndex = -1;\n        foreach ($this->schedule as $index => $event) {\n            if ($event['event_id'] === $currentEventId) {\n                $currentIndex = $index;\n                break;\n            }\n        }\n        \n        if ($currentIndex > 0) {\n            return $this->schedule[$currentIndex - 1];\n        }\n        \n        return null;\n    }\n    \n    /**\n     * ì´ë²¤íŠ¸ í‘œì‹œ ì—¬ë¶€ ì—…ë°ì´íŠ¸\n     */\n    public function updateEventVisibility($eventId, $showResult) {\n        foreach ($this->schedule as &$event) {\n            if ($event['event_id'] === $eventId) {\n                $event['show_result'] = $showResult;\n                break;\n            }\n        }\n        \n        $this->saveSchedule();\n    }\n    \n    /**\n     * ìŠ¤ì¼€ì¤„ íŒŒì¼ ì €ì¥\n     */\n    private function saveSchedule() {\n        $lines = [];\n        foreach ($this->schedule as $event) {\n            $lines[] = $event['event_id'] . ',' . $event['event_name'] . ',' . ($event['show_result'] ? 'true' : 'false');\n        }\n        \n        file_put_contents($this->scheduleFile, implode(\"\\n\", $lines));\n    }\n    \n    /**\n     * í˜„ì¬ ì§„í–‰ ì¤‘ì¸ ì´ë²¤íŠ¸ ì¸ë±ìŠ¤ ë°˜í™˜\n     */\n    public function getCurrentEventIndex($eventId) {\n        foreach ($this->schedule as $index => $event) {\n            if ($event['event_id'] === $eventId) {\n                return $index;\n            }\n        }\n        return 0;\n    }\n    \n    /**\n     * ì „ì²´ ì´ë²¤íŠ¸ ìˆ˜ ë°˜í™˜\n     */\n    public function getTotalEvents() {\n        return count($this->schedule);\n    }\n}\n?>\n\n\n\n\n","size_bytes":3666},"comp/event_upload.php":{"content":"<?php\n/**\n * ì´ë²¤íŠ¸ ìˆœì„œ ì—…ë¡œë“œ ë° ê´€ë¦¬ ì‹œìŠ¤í…œ\n */\n\n$message = '';\n$error = '';\n\nif ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_FILES['event_file'])) {\n    $uploadDir = __DIR__ . '/uploads/';\n    if (!is_dir($uploadDir)) {\n        mkdir($uploadDir, 0755, true);\n    }\n    \n    $uploadFile = $uploadDir . 'event_schedule.txt';\n    \n    // íŒŒì¼ í˜•ì‹ ê²€ì¦\n    $tempFile = $_FILES['event_file']['tmp_name'];\n    $lines = file($tempFile, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    $validFormat = true;\n    $errorLines = [];\n    \n    foreach ($lines as $lineNum => $line) {\n        $parts = explode(',', $line);\n        if (count($parts) < 3) {\n            $validFormat = false;\n            $errorLines[] = $lineNum + 1;\n        } else {\n            $gabu = trim($parts[2]);\n            if ($gabu !== '0' && $gabu !== '1') {\n                $validFormat = false;\n                $errorLines[] = $lineNum + 1;\n            }\n        }\n    }\n    \n    if (!$validFormat) {\n        $error = 'íŒŒì¼ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. ' . implode(', ', $errorLines) . 'ë²ˆì§¸ ì¤„ì„ í™•ì¸í•´ì£¼ì„¸ìš”.';\n    } else {\n        if (move_uploaded_file($tempFile, $uploadFile)) {\n            $message = 'ì´ë²¤íŠ¸ ìˆœì„œê°€ ì„±ê³µì ìœ¼ë¡œ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤. (ì´ ' . count($lines) . 'ê°œ ì´ë²¤íŠ¸)';\n        } else {\n            $error = 'íŒŒì¼ ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';\n        }\n    }\n}\n\n// í˜„ì¬ ì´ë²¤íŠ¸ ìˆœì„œ íŒŒì¼ ì½ê¸°\n$eventFile = __DIR__ . '/uploads/event_schedule.txt';\n$events = [];\n\nif (file_exists($eventFile)) {\n    $lines = file($eventFile, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        $parts = explode(',', $line);\n        if (count($parts) >= 3) {\n            $events[] = [\n                'id' => trim($parts[0]),\n                'name' => trim($parts[1]),\n                'show_result' => trim($parts[2]) === '1' // 1ì´ë©´ true, 0ì´ë©´ false\n            ];\n        }\n    }\n}\n\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>ì´ë²¤íŠ¸ ìˆœì„œ ì—…ë¡œë“œ</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            margin: 20px;\n            background: #f5f5f5;\n        }\n        \n        .container {\n            max-width: 1200px;\n            margin: 0 auto;\n            background: white;\n            padding: 20px;\n            border-radius: 10px;\n            box-shadow: 0 0 20px rgba(0,0,0,0.1);\n        }\n        \n        .header {\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n            padding: 20px;\n            border-radius: 10px;\n            margin-bottom: 30px;\n            text-align: center;\n        }\n        \n        .header h1 {\n            margin: 0;\n            font-size: 2em;\n        }\n        \n        .upload-section {\n            background: #f8f9fa;\n            padding: 20px;\n            border-radius: 10px;\n            margin-bottom: 30px;\n        }\n        \n        .form-group {\n            margin-bottom: 15px;\n        }\n        \n        .form-group label {\n            display: block;\n            margin-bottom: 5px;\n            font-weight: bold;\n            color: #333;\n        }\n        \n        .form-group input[type=\"file\"] {\n            width: 100%;\n            padding: 10px;\n            border: 2px dashed #ddd;\n            border-radius: 5px;\n            background: white;\n        }\n        \n        .btn {\n            background: #007bff;\n            color: white;\n            border: none;\n            padding: 12px 20px;\n            border-radius: 5px;\n            cursor: pointer;\n            font-size: 14px;\n            transition: background 0.3s;\n        }\n        \n        .btn:hover {\n            background: #0056b3;\n        }\n        \n        .btn.success {\n            background: #28a745;\n        }\n        \n        .btn.success:hover {\n            background: #218838;\n        }\n        \n        .btn.info {\n            background: #17a2b8;\n        }\n        \n        .btn.info:hover {\n            background: #138496;\n        }\n        \n        .btn.danger {\n            background: #dc3545;\n        }\n        \n        .btn.danger:hover {\n            background: #c82333;\n        }\n        \n        .event-list {\n            border: 1px solid #ddd;\n            border-radius: 5px;\n            overflow: hidden;\n        }\n        \n        .event-item {\n            display: flex;\n            align-items: center;\n            padding: 15px;\n            border-bottom: 1px solid #eee;\n            background: white;\n            transition: background 0.3s;\n        }\n        \n        .event-item:hover {\n            background: #f8f9fa;\n        }\n        \n        .event-item:last-child {\n            border-bottom: none;\n        }\n        \n        .event-id {\n            width: 80px;\n            font-weight: bold;\n            color: #667eea;\n        }\n        \n        .event-name {\n            flex: 1;\n            margin: 0 15px;\n            color: #333;\n        }\n        \n        .event-controls {\n            display: flex;\n            gap: 10px;\n            align-items: center;\n        }\n        \n        .toggle-switch {\n            position: relative;\n            display: inline-block;\n            width: 50px;\n            height: 24px;\n        }\n        \n        .toggle-switch input {\n            opacity: 0;\n            width: 0;\n            height: 0;\n        }\n        \n        .slider {\n            position: absolute;\n            cursor: pointer;\n            top: 0;\n            left: 0;\n            right: 0;\n            bottom: 0;\n            background-color: #ccc;\n            transition: .4s;\n            border-radius: 24px;\n        }\n        \n        .slider:before {\n            position: absolute;\n            content: \"\";\n            height: 18px;\n            width: 18px;\n            left: 3px;\n            bottom: 3px;\n            background-color: white;\n            transition: .4s;\n            border-radius: 50%;\n        }\n        \n        input:checked + .slider {\n            background-color: #2196F3;\n        }\n        \n        input:checked + .slider:before {\n            transform: translateX(26px);\n        }\n        \n        .status-badge {\n            padding: 4px 8px;\n            border-radius: 4px;\n            font-size: 12px;\n            font-weight: bold;\n        }\n        \n        .status-show {\n            background: #d4edda;\n            color: #155724;\n        }\n        \n        .status-hide {\n            background: #f8d7da;\n            color: #721c24;\n        }\n        \n        .message {\n            padding: 15px;\n            border-radius: 5px;\n            margin-bottom: 20px;\n        }\n        \n        .message.success {\n            background: #d4edda;\n            color: #155724;\n            border: 1px solid #c3e6cb;\n        }\n        \n        .message.error {\n            background: #f8d7da;\n            color: #721c24;\n            border: 1px solid #f5c6cb;\n        }\n        \n        .file-format {\n            background: #e9ecef;\n            padding: 15px;\n            border-radius: 5px;\n            margin-bottom: 20px;\n            font-family: monospace;\n        }\n        \n        .controls {\n            display: flex;\n            gap: 15px;\n            margin-bottom: 30px;\n            flex-wrap: wrap;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>ğŸ“‹ ì´ë²¤íŠ¸ ìˆœì„œ ì—…ë¡œë“œ ë° ê´€ë¦¬</h1>\n            <p>ëŒ€íšŒ ìˆœì„œë¥¼ ì—…ë¡œë“œí•˜ê³  ì‹¤ì‹œê°„ìœ¼ë¡œ ê²°ê³¼ ë°œí‘œë¥¼ ì œì–´í•˜ì„¸ìš”</p>\n        </div>\n        \n        <?php if ($message): ?>\n        <div class=\"message success\"><?php echo $message; ?></div>\n        <?php endif; ?>\n        \n        <?php if ($error): ?>\n        <div class=\"message error\"><?php echo $error; ?></div>\n        <?php endif; ?>\n        \n        <div class=\"controls\">\n            <button class=\"btn success\" onclick=\"openFullscreenMonitor()\">ğŸ–¥ï¸ ì „ì²´í™”ë©´ ëª¨ë‹ˆí„°ë§</button>\n            <button class=\"btn info\" onclick=\"openEventControl()\">ğŸ¯ ì´ë²¤íŠ¸ ì œì–´</button>\n            <button class=\"btn\" onclick=\"refreshPage()\">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>\n        </div>\n        \n        <!-- íŒŒì¼ ì—…ë¡œë“œ ì„¹ì…˜ -->\n        <div class=\"upload-section\">\n            <h3>ğŸ“ ì´ë²¤íŠ¸ ìˆœì„œ íŒŒì¼ ì—…ë¡œë“œ</h3>\n            <p>í…ìŠ¤íŠ¸ íŒŒì¼ í˜•ì‹: <code>ì´ë²¤íŠ¸ë²ˆí˜¸,ì´ë²¤íŠ¸ëª…,ê°€ë¶€</code></p>\n            \n            <div class=\"file-format\">\n                <strong>íŒŒì¼ í˜•ì‹ ì˜ˆì‹œ:</strong><br>\n                1A,ì§€ì  ë¼í‹´,1<br>\n                1B,ì‹œê° ë¼í‹´,0<br>\n                1C,ì²­ê° ë¼í‹´,1<br>\n                2A,ì§€ì  ìŠ¤íƒ ë”ë“œ,1<br>\n                2B,ì‹œê° ìŠ¤íƒ ë”ë“œ,0<br><br>\n                <strong>ê°€ë¶€ ì„¤ëª…:</strong><br>\n                1 = ê²°ê³¼ ë°œí‘œí•¨, 0 = ê²°ê³¼ ë°œí‘œ ì•ˆí•¨\n            </div>\n            \n            <form method=\"POST\" enctype=\"multipart/form-data\">\n                <div class=\"form-group\">\n                    <label for=\"event_file\">ì´ë²¤íŠ¸ ìˆœì„œ íŒŒì¼ ì„ íƒ</label>\n                    <input type=\"file\" id=\"event_file\" name=\"event_file\" accept=\".txt\" required>\n                </div>\n                <div style=\"display: flex; gap: 10px; align-items: center;\">\n                    <button type=\"submit\" class=\"btn success\">ğŸ“¤ íŒŒì¼ ì—…ë¡œë“œ</button>\n                    <a href=\"sample_event_schedule.txt\" download class=\"btn info\">ğŸ“¥ ìƒ˜í”Œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ</a>\n                </div>\n            </form>\n        </div>\n        \n        <!-- í˜„ì¬ ì´ë²¤íŠ¸ ëª©ë¡ -->\n        <?php if (!empty($events)): ?>\n        <h3>ğŸ“‹ í˜„ì¬ ì´ë²¤íŠ¸ ìˆœì„œ (ì´ <?php echo count($events); ?>ê°œ)</h3>\n        <div class=\"event-list\" id=\"eventList\">\n            <?php foreach ($events as $index => $event): ?>\n            <div class=\"event-item\" data-event-id=\"<?php echo htmlspecialchars($event['id']); ?>\">\n                <div class=\"event-id\"><?php echo htmlspecialchars($event['id']); ?></div>\n                <div class=\"event-name\"><?php echo htmlspecialchars($event['name']); ?></div>\n                <div class=\"event-controls\">\n                    <label class=\"toggle-switch\">\n                        <input type=\"checkbox\" \n                               <?php echo $event['show_result'] ? 'checked' : ''; ?>\n                               onchange=\"updateEventStatus('<?php echo $event['id']; ?>', this.checked)\">\n                        <span class=\"slider\"></span>\n                    </label>\n                    <span class=\"status-badge <?php echo $event['show_result'] ? 'status-show' : 'status-hide'; ?>\">\n                        <?php echo $event['show_result'] ? 'ë°œí‘œ' : 'ëŒ€ê¸°' ?>\n                    </span>\n                </div>\n            </div>\n            <?php endforeach; ?>\n        </div>\n        <?php else: ?>\n        <div class=\"message error\">\n            ì´ë²¤íŠ¸ ìˆœì„œ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤. ìœ„ì—ì„œ íŒŒì¼ì„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.\n        </div>\n        <?php endif; ?>\n    </div>\n\n    <script>\n        function updateEventStatus(eventId, showResult) {\n            // AJAXë¡œ ì„œë²„ì— ìƒíƒœ ì—…ë°ì´íŠ¸ ìš”ì²­\n            fetch('update_event_status.php', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/x-www-form-urlencoded',\n                },\n                body: `event_id=${eventId}&show_result=${showResult}`\n            })\n            .then(response => response.json())\n            .then(data => {\n                if (data.success) {\n                    // ìƒíƒœ ë°°ì§€ ì—…ë°ì´íŠ¸\n                    const eventItem = document.querySelector(`[data-event-id=\"${eventId}\"]`);\n                    const statusBadge = eventItem.querySelector('.status-badge');\n                    if (showResult) {\n                        statusBadge.textContent = 'ë°œí‘œ';\n                        statusBadge.className = 'status-badge status-show';\n                    } else {\n                        statusBadge.textContent = 'ëŒ€ê¸°';\n                        statusBadge.className = 'status-badge status-hide';\n                    }\n                } else {\n                    alert('ìƒíƒœ ì—…ë°ì´íŠ¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n                }\n            })\n            .catch(error => {\n                console.error('Error:', error);\n                alert('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n            });\n        }\n        \n        function openFullscreenMonitor() {\n            window.open('event_monitor_v2.php', '_blank');\n        }\n        \n        function openEventControl() {\n            window.open('event_control_panel.php', '_blank');\n        }\n        \n        function refreshPage() {\n            location.reload();\n        }\n    </script>\n</body>\n</html>\n","size_bytes":12953},"comp/export_excel.php":{"content":"<?php\n$comp_id = $_GET['comp'] ?? $_GET['comp_id'] ?? '';\n$data_dir = __DIR__ . \"/data/$comp_id\";\n$info_file = \"$data_dir/info.json\";\n$runorder_file = \"$data_dir/RunOrder_Tablet.txt\";\n$dance_file = \"$data_dir/DanceName.txt\";\n\n// ëŒ€íšŒ ì •ë³´ ë¡œë“œ\nif (!preg_match('/^\\d{8}-\\d+$/', $comp_id) || !is_file($info_file)) {\n    die('ì˜ëª»ëœ ëŒ€íšŒ ID ë˜ëŠ” ëŒ€íšŒ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.');\n}\n$info = json_decode(file_get_contents($info_file), true);\n\n// ëŒ„ìŠ¤ ë²ˆí˜¸ => í’€ë„¤ì„ ë§¤í•‘\n$dance_types = [];\nif (file_exists($dance_file)) {\n    $lines = file($dance_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        if (preg_match('/^bom/', $line)) continue;\n        $cols = array_map('trim', explode(',', $line));\n        if (isset($cols[0]) && $cols[0] && isset($cols[1]) && $cols[1]) {\n            $dance_types[$cols[0]] = $cols[1]; // ë²ˆí˜¸ => í’€ë„¤ì„\n        }\n    }\n}\n\n// RunOrder_Tablet.txt íŒŒì¼ ì½ê¸°\n$lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n$events = [];\n\nforeach ($lines as $line) {\n    $cols = explode(',', $line);\n    if (count($cols) >= 15) {\n        // ëŒ„ìŠ¤ ë°ì´í„°ëŠ” 6-10ë²ˆì§¸ ì»¬ëŸ¼ì— ìˆìŒ (ì¸ë±ìŠ¤ 5-9)\n        $dance_data = [];\n        for ($i = 5; $i <= 9; $i++) {\n            if (isset($cols[$i]) && trim($cols[$i]) !== '') {\n                $dance_data[] = trim($cols[$i]);\n            }\n        }\n        \n        $events[] = [\n            'no' => trim($cols[0]),\n            'desc' => trim($cols[1]),\n            'roundtype' => trim($cols[2]),\n            'roundnum' => trim($cols[3]),\n            'dances' => implode(' ', $dance_data), // 6-10ë²ˆì§¸ ì»¬ëŸ¼ì˜ ëŒ„ìŠ¤ ë°ì´í„°\n            'panel' => trim($cols[10]),\n            'time' => trim($cols[11]),\n            'detail_no' => trim($cols[13]),\n            'extra_time' => intval($cols[14] ?? 0)\n        ];\n    }\n}\n\n// ì´ë²¤íŠ¸ ê·¸ë£¹í™” ë° ì‹œê°„ ê³„ì‚° (manage_timetable.phpì™€ ë™ì¼í•œ ë¡œì§)\n$raw_no_groups = [];\nforeach ($events as $event) {\n    $raw_no = $event['no'];\n    if (!isset($raw_no_groups[$raw_no])) {\n        $raw_no_groups[$raw_no] = [];\n    }\n    \n    // ëŒ„ìŠ¤ íŒŒì‹±\n    $dance_numbers = explode(' ', $event['dances']);\n    $dance_count = 0;\n    $dance_list = [];\n    \n    foreach ($dance_numbers as $dance_num) {\n        $dance_num = trim($dance_num);\n        if ($dance_num && $dance_num !== '0' && $dance_num !== '?' && $dance_num !== 'None' && $dance_num !== '-') {\n            $dance_count++;\n            if (isset($dance_types[$dance_num])) {\n                $dance_list[] = $dance_types[$dance_num];\n            }\n        }\n    }\n    \n    $event['dance_count'] = $dance_count;\n    $event['dance_list'] = implode(', ', $dance_list);\n    $raw_no_groups[$raw_no][] = $event;\n}\n\n// manage_timetable.phpì™€ ë™ì¼í•œ ì´ë²¤íŠ¸ ë°°ì—´ ìƒì„± (ìˆœë²ˆ ìˆœì„œë¡œ ì •ë ¬)\n$events_for_timetable = [];\n$sorted_raw_nos = array_keys($raw_no_groups);\nsort($sorted_raw_nos, SORT_NUMERIC);\n\nforeach ($sorted_raw_nos as $raw_no) {\n    $group = $raw_no_groups[$raw_no];\n    if (count($group) > 0) {\n        // ëŒ„ìŠ¤ ìˆ˜ê°€ ê°€ì¥ ë§ì€ ì´ë²¤íŠ¸ ì°¾ê¸°\n        $max_dance_count = 0;\n        $selected_event = null;\n        \n        foreach ($group as $event) {\n            if ($event['dance_count'] > $max_dance_count) {\n                $max_dance_count = $event['dance_count'];\n                $selected_event = $event;\n            }\n        }\n        \n        if ($selected_event) {\n            $base_time = 1.5; // ê¸°ë³¸ ì‹œê°„ (ë¶„)\n            $duration = $base_time * $max_dance_count;\n            $extra_time = $selected_event['extra_time'];\n            $total_duration = $duration + $extra_time;\n            \n            $events_for_timetable[] = [\n                'no' => $selected_event['no'],\n                'desc' => $selected_event['desc'],\n                'round' => 'Final', // ê¸°ë³¸ê°’\n                'dances' => $selected_event['dance_list'],\n                'duration' => $total_duration,\n                'detail_no' => $selected_event['detail_no'],\n                'extra_time' => $extra_time,\n                'group_events' => $group\n            ];\n        }\n    }\n}\n\n// íŠ¹ë³„ ì´ë²¤íŠ¸ ë¡œë“œ\n$special_events = [];\n$special_events_file = \"$data_dir/special_events.json\";\nif (file_exists($special_events_file)) {\n    $special_events = json_decode(file_get_contents($special_events_file), true) ?? [];\n}\n\n// ì‹œê°„í‘œ ê³„ì‚° (manage_timetable.phpì™€ ë™ì¼í•œ ë¡œì§)\n$rows = [];\n$current_time = 9 * 60; // 09:00 ì‹œì‘ (ë¶„ ë‹¨ìœ„)\n\nforeach ($events_for_timetable as $event) {\n    $start_time = sprintf('%02d:%02d', floor($current_time / 60), $current_time % 60);\n    $end_time = sprintf('%02d:%02d', floor(($current_time + $event['duration']) / 60), ($current_time + $event['duration']) % 60);\n    \n    // ë©€í‹°ì´ë²¤íŠ¸ ì²˜ë¦¬: ê° ì„¸ë¶€ë²ˆí˜¸ë³„ë¡œ ë³„ë„ í–‰ ìƒì„±\n    if (count($event['group_events']) > 1) {\n        // ë©€í‹°ì´ë²¤íŠ¸: ê° ì„¸ë¶€ë²ˆí˜¸ë³„ë¡œ í–‰ ìƒì„±\n        foreach ($event['group_events'] as $group_event) {\n            if (!empty($group_event['detail_no'])) {\n                $rows[] = [\n                    'no' => $event['no'],\n                    'detail_no' => $group_event['detail_no'],\n                    'desc' => $group_event['desc'],\n                    'dances' => $group_event['dance_list'],\n                    'start_time' => $start_time,\n                    'end_time' => $end_time\n                ];\n            }\n        }\n    } else {\n        // ë‹¨ì¼ ì´ë²¤íŠ¸: ì„¸ë¶€ë²ˆí˜¸ ì—†ì´ í‘œì‹œ\n        $rows[] = [\n            'no' => $event['no'],\n            'detail_no' => '',\n            'desc' => $event['desc'],\n            'dances' => $event['dances'],\n            'start_time' => $start_time,\n            'end_time' => $end_time\n        ];\n    }\n    \n    $current_time += $event['duration'];\n    \n    // íŠ¹ë³„ ì´ë²¤íŠ¸ ì²˜ë¦¬ (manage_timetable.phpì™€ ë™ì¼í•œ ë¡œì§)\n    foreach ($special_events as $special_event) {\n        if ($special_event['after_event'] == $event['no']) {\n            $special_start_time = sprintf('%02d:%02d', floor($current_time / 60), $current_time % 60);\n            $special_end_time = sprintf('%02d:%02d', floor(($current_time + $special_event['duration']) / 60), ($current_time + $special_event['duration']) % 60);\n            \n            $rows[] = [\n                'no' => '',\n                'detail_no' => '',\n                'desc' => $special_event['name'],\n                'dances' => '',\n                'start_time' => $special_start_time,\n                'end_time' => $special_end_time\n            ];\n            \n            $current_time += $special_event['duration'];\n        }\n    }\n}\n\n// CSV íŒŒì¼ ìƒì„±\n$filename = $info['title'] . '_ì‹œê°„í‘œ_' . date('Y-m-d') . '.csv';\n\n// UTF-8 BOM ì¶”ê°€ (ì—‘ì…€ì—ì„œ í•œê¸€ ê¹¨ì§ ë°©ì§€)\nheader('Content-Type: text/csv; charset=utf-8');\nheader('Content-Disposition: attachment; filename=\"' . $filename . '\"');\nheader('Cache-Control: max-age=0');\n\n// BOM ì¶œë ¥\necho \"\\xEF\\xBB\\xBF\";\n\n// CSV í—¤ë”\necho \"ìˆœë²ˆ,ì‹œì‘ì‹œê°„,ì¢…ë£Œì‹œê°„,ì„¸ë¶€ë²ˆí˜¸,ì´ë²¤íŠ¸ëª…,ëŒ„ìŠ¤\\n\";\n\n// ê°™ì€ ìˆœë²ˆê³¼ ì‹œê°„ì˜ í–‰ë“¤ì„ ê·¸ë£¹í™”í•˜ì—¬ ì¶œë ¥\n$grouped_rows = [];\nforeach ($rows as $row) {\n    $key = $row['no'] . '|' . $row['start_time'] . '|' . $row['end_time'];\n    if (!isset($grouped_rows[$key])) {\n        $grouped_rows[$key] = [\n            'no' => $row['no'],\n            'start_time' => $row['start_time'],\n            'end_time' => $row['end_time'],\n            'rows' => []\n        ];\n    }\n    $grouped_rows[$key]['rows'][] = $row;\n}\n\n// CSV ë°ì´í„° ì¶œë ¥\nforeach ($grouped_rows as $group) {\n    $first_row = true;\n    foreach ($group['rows'] as $row) {\n        if ($first_row) {\n            // ì²« ë²ˆì§¸ í–‰: ìˆœë²ˆê³¼ ì‹œê°„ í‘œì‹œ\n            echo '\"' . $row['no'] . '\",';\n            echo '\"' . $row['start_time'] . '\",';\n            echo '\"' . $row['end_time'] . '\",';\n            $first_row = false;\n        } else {\n            // ë‚˜ë¨¸ì§€ í–‰: ìˆœë²ˆê³¼ ì‹œê°„ì€ ë¹ˆ ê°’ìœ¼ë¡œ í‘œì‹œ (Excelì—ì„œ ë³‘í•© íš¨ê³¼)\n            echo '\"\",';\n            echo '\"\",';\n            echo '\"\",';\n        }\n        echo '\"' . $row['detail_no'] . '\",';\n        echo '\"' . $row['desc'] . '\",';\n        echo '\"' . $row['dances'] . '\"';\n        echo \"\\n\";\n    }\n}\n?>\n","size_bytes":8331},"comp/export_timetable.php":{"content":"<?php\n$comp_id = $_GET['comp'] ?? $_GET['comp_id'] ?? '';\n$data_dir = __DIR__ . \"/data/$comp_id\";\n$info_file = \"$data_dir/info.json\";\n$runorder_file = \"$data_dir/RunOrder_Tablet.txt\";\n$dance_file = \"$data_dir/DanceName.txt\";\n\n// ëŒ€íšŒ ì •ë³´ ë¡œë“œ\nif (!preg_match('/^\\d{8}-\\d+$/', $comp_id) || !is_file($info_file)) {\n    die('ì˜ëª»ëœ ëŒ€íšŒ ID ë˜ëŠ” ëŒ€íšŒ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.');\n}\n$info = json_decode(file_get_contents($info_file), true);\n\n// ëŒ„ìŠ¤ ë²ˆí˜¸ => í’€ë„¤ì„ ë§¤í•‘\n$dance_types = [];\nif (file_exists($dance_file)) {\n    $lines = file($dance_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        if (preg_match('/^bom/', $line)) continue;\n        $cols = array_map('trim', explode(',', $line));\n        if (isset($cols[0]) && $cols[0] && isset($cols[1]) && $cols[1]) {\n            $dance_types[$cols[0]] = $cols[1]; // ë²ˆí˜¸ => í’€ë„¤ì„\n        }\n    }\n}\n\n// RunOrder_Tablet.txt íŒŒì¼ ì½ê¸°\n$lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n$events = [];\n\nforeach ($lines as $line) {\n    $cols = explode(',', $line);\n    if (count($cols) >= 15) {\n        // ëŒ„ìŠ¤ ë°ì´í„°ëŠ” 6-10ë²ˆì§¸ ì»¬ëŸ¼ì— ìˆìŒ (ì¸ë±ìŠ¤ 5-9)\n        $dance_data = [];\n        for ($i = 5; $i <= 9; $i++) {\n            if (isset($cols[$i]) && trim($cols[$i]) !== '') {\n                $dance_data[] = trim($cols[$i]);\n            }\n        }\n        \n        $events[] = [\n            'no' => trim($cols[0]),\n            'desc' => trim($cols[1]),\n            'roundtype' => trim($cols[2]),\n            'roundnum' => trim($cols[3]),\n            'dances' => implode(' ', $dance_data), // 6-10ë²ˆì§¸ ì»¬ëŸ¼ì˜ ëŒ„ìŠ¤ ë°ì´í„°\n            'panel' => trim($cols[10]),\n            'time' => trim($cols[11]),\n            'detail_no' => trim($cols[13]),\n            'extra_time' => intval($cols[14] ?? 0)\n        ];\n    }\n}\n\n// ì´ë²¤íŠ¸ ê·¸ë£¹í™” ë° ì‹œê°„ ê³„ì‚° (manage_timetable.phpì™€ ë™ì¼í•œ ë¡œì§)\n$raw_no_groups = [];\nforeach ($events as $event) {\n    $raw_no = $event['no'];\n    if (!isset($raw_no_groups[$raw_no])) {\n        $raw_no_groups[$raw_no] = [];\n    }\n    \n    // ëŒ„ìŠ¤ íŒŒì‹±\n    $dance_numbers = explode(' ', $event['dances']);\n    $dance_count = 0;\n    $dance_list = [];\n    \n    foreach ($dance_numbers as $dance_num) {\n        $dance_num = trim($dance_num);\n        if ($dance_num && $dance_num !== '0' && $dance_num !== '?' && $dance_num !== 'None' && $dance_num !== '-') {\n            $dance_count++;\n            if (isset($dance_types[$dance_num])) {\n                $dance_list[] = $dance_types[$dance_num];\n            }\n        }\n    }\n    \n    $event['dance_count'] = $dance_count;\n    $event['dance_list'] = implode(', ', $dance_list);\n    $raw_no_groups[$raw_no][] = $event;\n}\n\n// manage_timetable.phpì™€ ë™ì¼í•œ ì´ë²¤íŠ¸ ë°°ì—´ ìƒì„± (ìˆœë²ˆ ìˆœì„œë¡œ ì •ë ¬)\n$events_for_timetable = [];\n$sorted_raw_nos = array_keys($raw_no_groups);\nsort($sorted_raw_nos, SORT_NUMERIC);\n\nforeach ($sorted_raw_nos as $raw_no) {\n    $group = $raw_no_groups[$raw_no];\n    if (count($group) > 0) {\n        // ëŒ„ìŠ¤ ìˆ˜ê°€ ê°€ì¥ ë§ì€ ì´ë²¤íŠ¸ ì°¾ê¸°\n        $max_dance_count = 0;\n        $selected_event = null;\n        \n        foreach ($group as $event) {\n            if ($event['dance_count'] > $max_dance_count) {\n                $max_dance_count = $event['dance_count'];\n                $selected_event = $event;\n            }\n        }\n        \n        if ($selected_event) {\n            $base_time = 1.5; // ê¸°ë³¸ ì‹œê°„ (ë¶„)\n            $duration = $base_time * $max_dance_count;\n            $extra_time = $selected_event['extra_time'];\n            $total_duration = $duration + $extra_time;\n            \n            $events_for_timetable[] = [\n                'no' => $selected_event['no'],\n                'desc' => $selected_event['desc'],\n                'round' => 'Final', // ê¸°ë³¸ê°’\n                'dances' => $selected_event['dance_list'],\n                'duration' => $total_duration,\n                'detail_no' => $selected_event['detail_no'],\n                'extra_time' => $extra_time,\n                'group_events' => $group\n            ];\n        }\n    }\n}\n\n// íŠ¹ë³„ ì´ë²¤íŠ¸ ë¡œë“œ\n$special_events = [];\n$special_events_file = \"$data_dir/special_events.json\";\nif (file_exists($special_events_file)) {\n    $special_events = json_decode(file_get_contents($special_events_file), true) ?? [];\n}\n\n// ì‹œê°„í‘œ ê³„ì‚° (manage_timetable.phpì™€ ë™ì¼í•œ ë¡œì§)\n$rows = [];\n$current_time = 9 * 60; // 09:00 ì‹œì‘ (ë¶„ ë‹¨ìœ„)\n\nforeach ($events_for_timetable as $event) {\n    $start_time = sprintf('%02d:%02d', floor($current_time / 60), $current_time % 60);\n    $end_time = sprintf('%02d:%02d', floor(($current_time + $event['duration']) / 60), ($current_time + $event['duration']) % 60);\n    \n    // ë©€í‹°ì´ë²¤íŠ¸ ì²˜ë¦¬: ê° ì„¸ë¶€ë²ˆí˜¸ë³„ë¡œ ë³„ë„ í–‰ ìƒì„±\n    if (count($event['group_events']) > 1) {\n        // ë©€í‹°ì´ë²¤íŠ¸: ê° ì„¸ë¶€ë²ˆí˜¸ë³„ë¡œ í–‰ ìƒì„±\n        foreach ($event['group_events'] as $group_event) {\n            if (!empty($group_event['detail_no'])) {\n                $rows[] = [\n                    'no' => $event['no'],\n                    'detail_no' => $group_event['detail_no'],\n                    'desc' => $group_event['desc'],\n                    'dances' => $group_event['dance_list'],\n                    'start_time' => $start_time,\n                    'end_time' => $end_time\n                ];\n            }\n        }\n    } else {\n        // ë‹¨ì¼ ì´ë²¤íŠ¸: ì„¸ë¶€ë²ˆí˜¸ ì—†ì´ í‘œì‹œ\n        $rows[] = [\n            'no' => $event['no'],\n            'detail_no' => '',\n            'desc' => $event['desc'],\n            'dances' => $event['dances'],\n            'start_time' => $start_time,\n            'end_time' => $end_time\n        ];\n    }\n    \n    $current_time += $event['duration'];\n    \n    // íŠ¹ë³„ ì´ë²¤íŠ¸ ì²˜ë¦¬ (manage_timetable.phpì™€ ë™ì¼í•œ ë¡œì§)\n    foreach ($special_events as $special_event) {\n        if ($special_event['after_event'] == $event['no']) {\n            $special_start_time = sprintf('%02d:%02d', floor($current_time / 60), $current_time % 60);\n            $special_end_time = sprintf('%02d:%02d', floor(($current_time + $special_event['duration']) / 60), ($current_time + $special_event['duration']) % 60);\n            \n            $rows[] = [\n                'no' => '',\n                'detail_no' => '',\n                'desc' => $special_event['name'],\n                'dances' => '',\n                'start_time' => $special_start_time,\n                'end_time' => $special_end_time\n            ];\n            \n            $current_time += $special_event['duration'];\n        }\n    }\n}\n\n// HTML to PDF ì¶œë ¥\n$filename = $info['title'] . '_ì‹œê°„í‘œ_' . date('Y-m-d') . '.html';\n\nheader('Content-Type: text/html; charset=utf-8');\nheader('Content-Disposition: attachment; filename=\"' . $filename . '\"');\nheader('Cache-Control: max-age=0');\n\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title><?= htmlspecialchars($info['title']) ?> ì‹œê°„í‘œ</title>\n    <style>\n        @page {\n            size: A4 landscape;\n            margin: 20mm;\n        }\n        \n        body {\n            font-family: 'Malgun Gothic', 'ë§‘ì€ ê³ ë”•', Arial, sans-serif;\n            font-size: 12px;\n            line-height: 1.4;\n            color: #333;\n            margin: 0;\n            padding: 0;\n        }\n        \n        .header {\n            text-align: center;\n            margin-bottom: 30px;\n            border-bottom: 3px solid #03C75A;\n            padding-bottom: 20px;\n        }\n        \n        .title {\n            font-size: 24px;\n            font-weight: bold;\n            color: #03C75A;\n            margin-bottom: 10px;\n        }\n        \n        .subtitle {\n            font-size: 16px;\n            color: #666;\n            margin-bottom: 5px;\n        }\n        \n        .info {\n            font-size: 14px;\n            color: #888;\n        }\n        \n        table {\n            width: 100%;\n            border-collapse: collapse;\n            margin-top: 20px;\n        }\n        \n        th {\n            background-color: #34495E;\n            color: white;\n            padding: 12px 8px;\n            text-align: center;\n            font-weight: bold;\n            border: 1px solid #2C3E50;\n        }\n        \n        td {\n            padding: 10px 8px;\n            border: 1px solid #BDC3C7;\n            text-align: center;\n        }\n        \n        tr:nth-child(even) {\n            background-color: #F8F9FA;\n        }\n        \n        tr:nth-child(odd) {\n            background-color: #FFFFFF;\n        }\n        \n        .no-col { width: 8%; }\n        .detail-col { width: 12%; }\n        .desc-col { width: 40%; }\n        .dance-col { width: 20%; }\n        .time-col { width: 8%; }\n        .duration-col { width: 8%; }\n        \n        .desc-col {\n            text-align: left;\n        }\n        \n        .footer {\n            margin-top: 30px;\n            text-align: center;\n            font-size: 10px;\n            color: #888;\n            border-top: 1px solid #BDC3C7;\n            padding-top: 10px;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <div class=\"title\"><?= htmlspecialchars($info['title']) ?> ì‹œê°„í‘œ</div>\n        <div class=\"subtitle\">ëŒ€íšŒì¼: <?= htmlspecialchars($info['date']) ?></div>\n        <div class=\"info\">ì¥ì†Œ: <?= htmlspecialchars($info['place']) ?> | ì£¼ìµœ/ì£¼ê´€: <?= htmlspecialchars($info['host']) ?></div>\n    </div>\n    \n    <table>\n        <thead>\n            <tr>\n                <th class=\"no-col\">ìˆœë²ˆ</th>\n                <th class=\"time-col\">ì‹œì‘ì‹œê°„</th>\n                <th class=\"time-col\">ì¢…ë£Œì‹œê°„</th>\n                <th class=\"detail-col\">ì„¸ë¶€ë²ˆí˜¸</th>\n                <th class=\"desc-col\">ì´ë²¤íŠ¸ëª…</th>\n                <th class=\"dance-col\">ëŒ„ìŠ¤</th>\n            </tr>\n        </thead>\n        <tbody>\n            <?php \n            $grouped_rows = [];\n            $current_group = null;\n            \n            // ê°™ì€ ìˆœë²ˆê³¼ ì‹œê°„ì˜ í–‰ë“¤ì„ ê·¸ë£¹í™”\n            foreach ($rows as $row) {\n                $key = $row['no'] . '|' . $row['start_time'] . '|' . $row['end_time'];\n                if (!isset($grouped_rows[$key])) {\n                    $grouped_rows[$key] = [\n                        'no' => $row['no'],\n                        'start_time' => $row['start_time'],\n                        'end_time' => $row['end_time'],\n                        'rows' => []\n                    ];\n                }\n                $grouped_rows[$key]['rows'][] = $row;\n            }\n            \n            foreach ($grouped_rows as $group): \n                $row_count = count($group['rows']);\n            ?>\n                <?php foreach ($group['rows'] as $index => $row): ?>\n                <tr>\n                    <?php if ($index === 0): ?>\n                        <td rowspan=\"<?= $row_count ?>\"><?= htmlspecialchars($row['no']) ?></td>\n                        <td rowspan=\"<?= $row_count ?>\"><?= htmlspecialchars($row['start_time']) ?></td>\n                        <td rowspan=\"<?= $row_count ?>\"><?= htmlspecialchars($row['end_time']) ?></td>\n                    <?php endif; ?>\n                    <td><?= htmlspecialchars($row['detail_no']) ?></td>\n                    <td class=\"desc-col\"><?= htmlspecialchars($row['desc']) ?></td>\n                    <td><?= htmlspecialchars($row['dances']) ?></td>\n                </tr>\n                <?php endforeach; ?>\n            <?php endforeach; ?>\n        </tbody>\n    </table>\n    \n    <div class=\"footer\">\n        <p>ìƒì„±ì¼: <?= date('Y-m-d H:i:s') ?> | danceoffice.net</p>\n    </div>\n</body>\n</html>\n","size_bytes":11797},"comp/final_aggregation_api.php":{"content":"<?php\n// JSON ì¶œë ¥ì„ ìœ„í•œ í—¤ë” ì„¤ì •\nif (!headers_sent()) {\n    header('Content-Type: application/json; charset=utf-8');\n}\n\n// ì˜¤ë¥˜ ì¶œë ¥ ë¹„í™œì„±í™” (JSON ì‘ë‹µì„ ìœ„í•´)\nerror_reporting(0);\nini_set('display_errors', 0);\nini_set('log_errors', 0);\n\n$comp_id = $_GET['comp_id'] ?? '';\n$event_no = $_GET['event_no'] ?? '';\n\nif (empty($comp_id) || empty($event_no)) {\n    echo json_encode(['error' => 'Missing parameters', 'debug' => [\n        'comp_id' => $comp_id,\n        'event_no' => $event_no,\n        'get_params' => $_GET\n    ]]);\n    exit;\n}\n\n// ì´ë²¤íŠ¸ ì •ë³´ ë¡œë“œ\n$runorder_file = \"data/{$comp_id}/RunOrder_Tablet.txt\";\nif (!file_exists($runorder_file)) {\n    echo json_encode(['error' => 'RunOrder file not found']);\n    exit;\n}\n\n$events = [];\n$lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\nforeach ($lines as $line) {\n    $parts = explode(\",\", $line);  // ì‰¼í‘œë¡œ ë¶„ë¦¬\n    if (count($parts) >= 14) {  // ì¶©ë¶„í•œ ì»¬ëŸ¼ì´ ìˆëŠ”ì§€ í™•ì¸\n        $events[] = [\n            'no' => trim($parts[0]),\n            'desc' => trim($parts[1]),\n            'round' => trim($parts[2]),\n            'detail_no' => trim($parts[11]),  // 12ë²ˆì§¸ ì»¬ëŸ¼ì´ detail_no (íŒ¨ë„)\n            'event_no' => trim($parts[13]),   // 14ë²ˆì§¸ ì»¬ëŸ¼ì´ ì´ë²¤íŠ¸ ë²ˆí˜¸ (1-1, 1-2 ë“±)\n            'dances' => array_filter(array_map('trim', array_slice($parts, 6, 5))), // 7-11ë²ˆì§¸ ì»¬ëŸ¼ì´ ëŒ„ìŠ¤\n            'panel' => trim($parts[11])  // 12ë²ˆì§¸ ì»¬ëŸ¼ì´ íŒ¨ë„\n        ];\n    }\n}\n\n// í˜„ì¬ ì´ë²¤íŠ¸ ì°¾ê¸°\n$current_event = null;\nerror_log(\"Looking for event_no: \" . $event_no);\nerror_log(\"Available events: \" . json_encode($events));\n\nforeach ($events as $event) {\n    // event_no (1-1, 1-2 ë“±) ë˜ëŠ” detail_no (SA, LA ë“±)ë¡œ ë§¤ì¹­\n    $event_key = $event['event_no'] ?: $event['detail_no'] ?: $event['no'];\n    error_log(\"Checking event_key: \" . $event_key . \" against \" . $event_no);\n    if ($event_key == $event_no) {\n        $current_event = $event;\n        error_log(\"Found matching event: \" . json_encode($event));\n        break;\n    }\n}\n\nif (!$current_event) {\n    error_log(\"Event not found for event_no: \" . $event_no);\n    echo json_encode(['error' => 'Event not found', 'debug' => [\n        'requested_event' => $event_no,\n        'requested_event_type' => gettype($event_no),\n        'available_events' => array_map(function($e) {\n            return [\n                'no' => $e['no'],\n                'detail_no' => $e['detail_no'],\n                'key' => $e['detail_no'] ? $e['detail_no'] : $e['no'],\n                'desc' => $e['desc'],\n                'round' => $e['round']\n            ];\n        }, $events)\n    ]]);\n    exit;\n}\n\n// ì„ ìˆ˜ ì •ë³´ ë¡œë“œ\n$players_file = \"data/{$comp_id}/players_{$event_no}.txt\";\n$players = [];\nif (file_exists($players_file)) {\n    $lines = file($players_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        $line = trim($line);\n        if (!empty($line)) {\n            // ì„ ìˆ˜ ë²ˆí˜¸ë§Œ ìˆëŠ” ê²½ìš°\n            $players[] = [\n                'number' => $line,\n                'male' => '',\n                'female' => ''\n            ];\n        }\n    }\n}\n\n// ì‹¬ì‚¬ìœ„ì› ì •ë³´ ë¡œë“œ\n$adjudicators_file = \"data/{$comp_id}/adjudicators.txt\";\n$adjudicators = [];\nif (file_exists($adjudicators_file)) {\n    $lines = file($adjudicators_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        $parts = explode(\",\", $line);  // ì‰¼í‘œë¡œ ë¶„ë¦¬\n        if (count($parts) >= 2) {\n            $adjudicators[] = [\n                'code' => trim($parts[0]),\n                'name' => trim($parts[1])\n            ];\n        }\n    }\n}\nerror_log(\"ì‹¬ì‚¬ìœ„ì› ìˆ˜: \" . count($adjudicators));\n\n// ëŒ„ìŠ¤ë³„ ì±„ì  ë°ì´í„° ìˆ˜ì§‘\n$dance_results = [];\n$dance_names = [\n    '6' => 'Cha Cha Cha',\n    '7' => 'Samba', \n    '8' => 'Rumba',\n    '9' => 'Paso Doble',\n    '10' => 'Jive'\n];\n\nforeach ($current_event['dances'] as $dance_code) {\n    $dance_name = $dance_names[$dance_code] ?? $dance_code;\n    $dance_results[$dance_code] = [\n        'name' => $dance_name,\n        'code' => $dance_code,\n        'judge_scores' => [],\n        'final_rankings' => []\n    ];\n    \n    // ê° ì‹¬ì‚¬ìœ„ì›ì˜ ì±„ì  íŒŒì¼ì—ì„œ ë°ì´í„° ìˆ˜ì§‘\n    foreach ($adjudicators as $judge) {\n        $score_file = \"data/{$comp_id}/{$event_no}_{$dance_code}_{$judge['code']}.adj\";\n        if (file_exists($score_file)) {\n            $content = file_get_contents($score_file);\n            $lines = explode(\"\\n\", $content);\n            \n            $judge_scores = [];\n            foreach ($lines as $line) {\n                $line = trim($line);\n                if (preg_match('/^(\\d+),(\\d+)$/', $line, $matches)) {\n                    $player_no = $matches[1];\n                    $rank = intval($matches[2]);\n                    $judge_scores[$player_no] = $rank;\n                }\n            }\n            \n            if (!empty($judge_scores)) {\n                $dance_results[$dance_code]['judge_scores'][$judge['code']] = $judge_scores;\n            }\n        }\n    }\n    \n    // ìŠ¤ì¼€ì´íŒ… ì‹œìŠ¤í…œìœ¼ë¡œ ëŒ„ìŠ¤ë³„ ìˆœìœ„ ê³„ì‚°\n    $dance_results[$dance_code]['final_rankings'] = calculateSkatingRankings(\n        $dance_results[$dance_code]['judge_scores'], \n        $players\n    );\n}\n\n// ìµœì¢… ìˆœìœ„ ê³„ì‚° (SUM of Places)\n$final_rankings = calculateFinalRankings($dance_results, $players);\n\n// ê²°ê³¼ ë°˜í™˜\n$result = [\n    'event_info' => $current_event,\n    'players' => $players,\n    'adjudicators' => $adjudicators,\n    'dance_results' => $dance_results,\n    'final_rankings' => $final_rankings,\n    'debug' => [\n        'total_events' => count($events),\n        'event_found' => $current_event ? 'yes' : 'no',\n        'players_count' => count($players),\n        'adjudicators_count' => count($adjudicators),\n        'dance_results_count' => count($dance_results)\n    ]\n];\n\nerror_log(\"Final aggregation result: \" . json_encode($result));\n\n// ê²°ê³¼ ë³´ê³ ì„œ ìƒì„±\ngenerateProfessionalReport($result, $comp_id, $event_no);\n\necho json_encode($result);\n\n// ìŠ¤ì¼€ì´íŒ… ì‹œìŠ¤í…œìœ¼ë¡œ ëŒ„ìŠ¤ë³„ ìˆœìœ„ ê³„ì‚°\nfunction calculateSkatingRankings($judge_scores, $players) {\n    $player_rankings = [];\n    \n    foreach ($players as $player) {\n        $player_no = $player['number'];\n        $rankings = [];\n        \n        // ê° ì‹¬ì‚¬ìœ„ì›ì´ ë¶€ì—¬í•œ ìˆœìœ„ ìˆ˜ì§‘\n        foreach ($judge_scores as $judge_code => $scores) {\n            if (isset($scores[$player_no])) {\n                $rankings[] = $scores[$player_no];\n            }\n        }\n        \n        if (!empty($rankings)) {\n            // ìŠ¤ì¼€ì´íŒ… ì‹œìŠ¤í…œ ê³„ì‚°\n            $skating_data = calculateSkatingData($rankings);\n            $player_rankings[$player_no] = $skating_data;\n        }\n    }\n    \n    // ìˆœìœ„ ê²°ì •\n    $ranked_players = [];\n    foreach ($player_rankings as $player_no => $data) {\n        $ranked_players[] = [\n            'player_no' => $player_no,\n            'skating_data' => $data\n        ];\n    }\n    \n    // ìŠ¤ì¼€ì´íŒ… ì‹œìŠ¤í…œ ê·œì¹™ì— ë”°ë¼ ì •ë ¬\n    usort($ranked_players, function($a, $b) {\n        $data_a = $a['skating_data'];\n        $data_b = $b['skating_data'];\n        \n        // 1ìœ„ ìˆ˜ ë¹„êµ\n        if ($data_a['place_1'] != $data_b['place_1']) {\n            return $data_b['place_1'] - $data_a['place_1'];\n        }\n        \n        // 1&2ìœ„ ìˆ˜ ë¹„êµ\n        if ($data_a['place_1_2'] != $data_b['place_1_2']) {\n            return $data_b['place_1_2'] - $data_a['place_1_2'];\n        }\n        \n        // 1to3ìœ„ ìˆ˜ ë¹„êµ\n        if ($data_a['place_1to3'] != $data_b['place_1to3']) {\n            return $data_b['place_1to3'] - $data_a['place_1to3'];\n        }\n        \n        // 1to3 í•©ê³„ ë¹„êµ (ë‚®ì€ í•©ê³„ê°€ ìš°ìœ„)\n        if ($data_a['sum_1to3'] != $data_b['sum_1to3']) {\n            return $data_a['sum_1to3'] - $data_b['sum_1to3'];\n        }\n        \n        // 1to4 ë¹„êµ\n        if ($data_a['place_1to4'] != $data_b['place_1to4']) {\n            return $data_b['place_1to4'] - $data_a['place_1to4'];\n        }\n        \n        // 1to4 í•©ê³„ ë¹„êµ\n        if ($data_a['sum_1to4'] != $data_b['sum_1to4']) {\n            return $data_a['sum_1to4'] - $data_b['sum_1to4'];\n        }\n        \n        // 1to5 ë¹„êµ\n        if ($data_a['place_1to5'] != $data_b['place_1to5']) {\n            return $data_b['place_1to5'] - $data_a['place_1to5'];\n        }\n        \n        // 1to5 í•©ê³„ ë¹„êµ\n        if ($data_a['sum_1to5'] != $data_b['sum_1to5']) {\n            return $data_a['sum_1to5'] - $data_b['sum_1to5'];\n        }\n        \n        // 1to6 ë¹„êµ\n        if ($data_a['place_1to6'] != $data_b['place_1to6']) {\n            return $data_b['place_1to6'] - $data_a['place_1to6'];\n        }\n        \n        // 1to6 í•©ê³„ ë¹„êµ\n        return $data_a['sum_1to6'] - $data_b['sum_1to6'];\n    });\n    \n    // ìµœì¢… ìˆœìœ„ ë¶€ì—¬\n    $final_rankings = [];\n    for ($i = 0; $i < count($ranked_players); $i++) {\n        $final_rankings[$ranked_players[$i]['player_no']] = $i + 1;\n    }\n    \n    return $final_rankings;\n}\n\n// ìŠ¤ì¼€ì´íŒ… ë°ì´í„° ê³„ì‚°\nfunction calculateSkatingData($rankings) {\n    $place_1 = 0;\n    $place_1_2 = 0;\n    $place_1to3 = 0;\n    $place_1to4 = 0;\n    $place_1to5 = 0;\n    $place_1to6 = 0;\n    \n    $sum_1to3 = 0;\n    $sum_1to4 = 0;\n    $sum_1to5 = 0;\n    $sum_1to6 = 0;\n    \n    foreach ($rankings as $rank) {\n        if ($rank == 1) $place_1++;\n        if ($rank <= 2) $place_1_2++;\n        if ($rank <= 3) {\n            $place_1to3++;\n            $sum_1to3 += $rank;\n        }\n        if ($rank <= 4) {\n            $place_1to4++;\n            $sum_1to4 += $rank;\n        }\n        if ($rank <= 5) {\n            $place_1to5++;\n            $sum_1to5 += $rank;\n        }\n        if ($rank <= 6) {\n            $place_1to6++;\n            $sum_1to6 += $rank;\n        }\n    }\n    \n    return [\n        'place_1' => $place_1,\n        'place_1_2' => $place_1_2,\n        'place_1to3' => $place_1to3,\n        'place_1to4' => $place_1to4,\n        'place_1to5' => $place_1to5,\n        'place_1to6' => $place_1to6,\n        'sum_1to3' => $sum_1to3,\n        'sum_1to4' => $sum_1to4,\n        'sum_1to5' => $sum_1to5,\n        'sum_1to6' => $sum_1to6\n    ];\n}\n\n// ìµœì¢… ìˆœìœ„ ê³„ì‚° (SUM of Places)\nfunction calculateFinalRankings($dance_results, $players) {\n    $player_sums = [];\n    \n    foreach ($players as $player) {\n        $player_no = $player['number'];\n        $sum = 0;\n        \n        foreach ($dance_results as $dance_code => $dance_data) {\n            if (isset($dance_data['final_rankings'][$player_no])) {\n                $sum += $dance_data['final_rankings'][$player_no];\n            }\n        }\n        \n        $player_sums[$player_no] = $sum;\n    }\n    \n    // SUM of Placesë¡œ ì •ë ¬ (ë‚®ì€ í•©ê³„ê°€ ìš°ìœ„)\n    asort($player_sums);\n    \n    // ìµœì¢… ìˆœìœ„ ë¶€ì—¬\n    $final_rankings = [];\n    $rank = 1;\n    foreach ($player_sums as $player_no => $sum) {\n        $final_rankings[] = [\n            'player_no' => $player_no,\n            'sum_of_places' => $sum,\n            'final_rank' => $rank++\n        ];\n    }\n    \n    return $final_rankings;\n}\n\n// ì „ë¬¸ì ì¸ ê²°ê³¼ ë³´ê³ ì„œ ìƒì„±\nfunction generateProfessionalReport($result, $comp_id, $event_no) {\n    $event_info = $result['event_info'];\n    $players = $result['players'];\n    $adjudicators = $result['adjudicators'];\n    $dance_results = $result['dance_results'];\n    $final_rankings = $result['final_rankings'];\n    \n    // ëŒ„ìŠ¤ ì´ë¦„ ë§¤í•‘\n    $dance_names = [\n        '2' => 'Tango',\n        '6' => 'Cha Cha Cha',\n        '7' => 'Samba', \n        '8' => 'Rumba',\n        '9' => 'Paso Doble',\n        '10' => 'Jive'\n    ];\n    \n    // HTML ë³´ê³ ì„œ ìƒì„± - DanceOffice ìŠ¤íƒ€ì¼\n    $html = '<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n<meta charset=\"UTF-8\">\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n<title>' . $event_no . '. ' . htmlspecialchars($event_info['desc']) . ' - ' . $event_info['round'] . ' | DanceOffice</title>\n<meta name=\"description\" content=\"DanceOffice - ' . $event_no . '. ' . htmlspecialchars($event_info['desc']) . ' - ' . $event_info['round'] . '\">\n\n<style>\n* { margin: 0; padding: 0; box-sizing: border-box; }\nbody { \n    font-family: \"Noto Sans KR\", \"Malgun Gothic\", sans-serif; \n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    min-height: 100vh;\n    color: #333;\n}\n.container {\n    max-width: 1200px;\n    margin: 0 auto;\n    background: white;\n    box-shadow: 0 20px 40px rgba(0,0,0,0.1);\n    border-radius: 20px;\n    overflow: hidden;\n    margin-top: 20px;\n    margin-bottom: 20px;\n}\n.header {\n    background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);\n    color: white;\n    padding: 30px;\n    text-align: center;\n    position: relative;\n}\n.header::before {\n    content: \"\";\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: url(\"data:image/svg+xml,%3Csvg width=\"60\" height=\"60\" viewBox=\"0 0 60 60\" xmlns=\"http://www.w3.org/2000/svg\"%3E%3Cg fill=\"none\" fill-rule=\"evenodd\"%3E%3Cg fill=\"%23ffffff\" fill-opacity=\"0.05\"%3E%3Ccircle cx=\"30\" cy=\"30\" r=\"2\"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\") repeat;\n}\n.header h1 {\n    font-size: 2.5em;\n    font-weight: 700;\n    margin-bottom: 10px;\n    position: relative;\n    z-index: 1;\n}\n.header .subtitle {\n    font-size: 1.2em;\n    opacity: 0.9;\n    position: relative;\n    z-index: 1;\n}\n.event-info {\n    background: #f8f9fa;\n    padding: 25px;\n    border-bottom: 3px solid #e9ecef;\n}\n.event-title {\n    font-size: 1.8em;\n    font-weight: 600;\n    color: #2c3e50;\n    margin-bottom: 15px;\n    display: flex;\n    align-items: center;\n    gap: 15px;\n}\n.event-badge {\n    background: linear-gradient(45deg, #ff6b6b, #ee5a24);\n    color: white;\n    padding: 8px 16px;\n    border-radius: 25px;\n    font-size: 0.7em;\n    font-weight: 600;\n    text-transform: uppercase;\n    letter-spacing: 1px;\n}\n.event-details {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    gap: 20px;\n    margin-top: 20px;\n}\n.detail-item {\n    background: white;\n    padding: 15px;\n    border-radius: 10px;\n    border-left: 4px solid #3498db;\n    box-shadow: 0 2px 10px rgba(0,0,0,0.05);\n}\n.detail-label {\n    font-size: 0.9em;\n    color: #7f8c8d;\n    font-weight: 500;\n    margin-bottom: 5px;\n}\n.detail-value {\n    font-size: 1.1em;\n    color: #2c3e50;\n    font-weight: 600;\n}\n.results-section {\n    padding: 30px;\n}\n.section-title {\n    font-size: 1.5em;\n    font-weight: 600;\n    color: #2c3e50;\n    margin-bottom: 25px;\n    display: flex;\n    align-items: center;\n    gap: 10px;\n}\n.section-title::before {\n    content: \"ğŸ†\";\n    font-size: 1.2em;\n}\n.results-table {\n    width: 100%;\n    border-collapse: collapse;\n    background: white;\n    border-radius: 15px;\n    overflow: hidden;\n    box-shadow: 0 10px 30px rgba(0,0,0,0.1);\n}\n.results-table th {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    padding: 20px 15px;\n    text-align: center;\n    font-weight: 600;\n    font-size: 0.9em;\n    text-transform: uppercase;\n    letter-spacing: 1px;\n}\n.results-table td {\n    padding: 20px 15px;\n    text-align: center;\n    border-bottom: 1px solid #ecf0f1;\n    font-weight: 500;\n}\n.results-table tr:nth-child(even) {\n    background: #f8f9fa;\n}\n.results-table tr:hover {\n    background: #e3f2fd;\n    transform: scale(1.01);\n    transition: all 0.2s ease;\n}\n.rank-1 { background: linear-gradient(45deg, #ffd700, #ffed4e) !important; color: #333 !important; }\n.rank-2 { background: linear-gradient(45deg, #c0c0c0, #e8e8e8) !important; color: #333 !important; }\n.rank-3 { background: linear-gradient(45deg, #cd7f32, #daa520) !important; color: white !important; }\n.player-name {\n    font-weight: 600;\n    color: #2c3e50;\n    text-align: left;\n}\n.judge-score {\n    font-weight: 600;\n    font-size: 1.1em;\n}\n.total-points {\n    font-weight: 700;\n    font-size: 1.2em;\n    color: #e74c3c;\n}\n.adjudicators-section {\n    background: #f8f9fa;\n    padding: 30px;\n    border-top: 3px solid #e9ecef;\n}\n.adjudicators-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n    gap: 15px;\n    margin-top: 20px;\n}\n.adjudicator-card {\n    background: white;\n    padding: 20px;\n    border-radius: 10px;\n    box-shadow: 0 5px 15px rgba(0,0,0,0.08);\n    display: flex;\n    align-items: center;\n    gap: 15px;\n    transition: transform 0.2s ease;\n}\n.adjudicator-card:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 8px 25px rgba(0,0,0,0.15);\n}\n.adjudicator-code {\n    background: linear-gradient(45deg, #3498db, #2980b9);\n    color: white;\n    width: 40px;\n    height: 40px;\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-weight: 700;\n    font-size: 1.1em;\n}\n.adjudicator-name {\n    font-weight: 600;\n    color: #2c3e50;\n}\n.footer {\n    background: #2c3e50;\n    color: white;\n    padding: 25px;\n    text-align: center;\n    font-size: 0.9em;\n}\n.footer a {\n    color: #3498db;\n    text-decoration: none;\n}\n.footer a:hover {\n    text-decoration: underline;\n}\n@media (max-width: 768px) {\n    .container { margin: 10px; border-radius: 15px; }\n    .header h1 { font-size: 2em; }\n    .event-details { grid-template-columns: 1fr; }\n    .results-table { font-size: 0.9em; }\n    .results-table th, .results-table td { padding: 15px 10px; }\n    .adjudicators-grid { grid-template-columns: 1fr; }\n}\n</style>\n</head>\n<body>\n<div class=\"container\">\n<div class=\"header\">\n    <h1>2025 ì„œì´ˆêµ¬ì²­ì¥ë°° ëŒ„ìŠ¤ìŠ¤í¬ì¸  ëŒ€íšŒ</h1>\n    <div class=\"subtitle\">DanceOffice Competition Management System</div>\n</div>\n<div class=\"event-info\">\n    <div class=\"event-title\">\n        <span class=\"event-badge\">' . $event_info['round'] . '</span>\n        ' . $event_no . '. ' . htmlspecialchars($event_info['desc']) . '\n    </div>\n    <div class=\"event-details\">\n        <div class=\"detail-item\">\n            <div class=\"detail-label\">ì´ë²¤íŠ¸ ë²ˆí˜¸</div>\n            <div class=\"detail-value\">' . $event_no . '</div>\n        </div>\n        <div class=\"detail-item\">\n            <div class=\"detail-label\">ë¼ìš´ë“œ</div>\n            <div class=\"detail-value\">' . $event_info['round'] . '</div>\n        </div>\n        <div class=\"detail-item\">\n            <div class=\"detail-label\">íŒ¨ë„</div>\n            <div class=\"detail-value\">' . $event_info['panel'] . '</div>\n        </div>\n        <div class=\"detail-item\">\n            <div class=\"detail-label\">ëŒ„ìŠ¤</div>\n            <div class=\"detail-value\">' . implode(', ', array_map(function($code) use ($dance_names) { return $dance_names[$code] ?? $code; }, $event_info['dances'])) . '</div>\n        </div>\n        <div class=\"detail-item\">\n            <div class=\"detail-label\">ì°¸ê°€ì ìˆ˜</div>\n            <div class=\"detail-value\">' . count($players) . 'ëª…</div>\n        </div>\n        <div class=\"detail-item\">\n            <div class=\"detail-label\">ì‹¬ì‚¬ìœ„ì› ìˆ˜</div>\n            <div class=\"detail-value\">' . count($adjudicators) . 'ëª…</div>\n        </div>\n    </div>\n</div>\n<div class=\"results-section\">\n    <div class=\"section-title\">ìµœì¢… ê²°ê³¼</div>\n    <table class=\"results-table\">';\n\n    // ê²°ê³¼ í…Œì´ë¸” í—¤ë”\n    $html .= '<thead><tr>\n<th>ìˆœìœ„</th>\n<th>ë²ˆí˜¸</th>\n<th>ì„ ìˆ˜ëª…</th>';\n\n    // ì‹¬ì‚¬ìœ„ì› ì»¬ëŸ¼ í—¤ë”\n    foreach ($adjudicators as $index => $judge) {\n        $html .= '<th>' . $judge['code'] . '</th>';\n    }\n\n    $html .= '<th>ì´ì </th></tr></thead><tbody>';\n\n    // ê²°ê³¼ í–‰ë“¤\n    foreach ($final_rankings as $index => $ranking) {\n        $player_no = $ranking['player_no'];\n        $place = $ranking['final_rank'];\n        $points = $ranking['sum_of_places'];\n        \n        // ì„ ìˆ˜ ì •ë³´ ì°¾ê¸°\n        $player_info = null;\n        foreach ($players as $player) {\n            if ($player['number'] == $player_no) {\n                $player_info = $player;\n                break;\n            }\n        }\n        \n        $player_name = $player_info ? ($player_info['male'] . ($player_info['female'] ? ' & ' . $player_info['female'] : '')) : \"ì„ ìˆ˜ \" . $player_no;\n        if (empty(trim($player_name))) {\n            $player_name = \"ì„ ìˆ˜ \" . $player_no;\n        }\n        \n        $rank_class = '';\n        if ($place == 1) $rank_class = 'rank-1';\n        elseif ($place == 2) $rank_class = 'rank-2';\n        elseif ($place == 3) $rank_class = 'rank-3';\n        \n        $html .= '<tr class=\"' . $rank_class . '\">\n<td><strong>' . $place . '</strong></td>\n<td><strong>' . $player_no . '</strong></td>\n<td class=\"player-name\">' . htmlspecialchars($player_name) . '</td>';\n\n        // ê° ì‹¬ì‚¬ìœ„ì›ì˜ ì±„ì  ê²°ê³¼\n        foreach ($adjudicators as $judge) {\n            $judge_code = $judge['code'];\n            $score = '';\n            \n            // í•´ë‹¹ ì‹¬ì‚¬ìœ„ì›ì˜ ì±„ì  ì°¾ê¸°\n            foreach ($dance_results as $dance_code => $dance_data) {\n                if (isset($dance_data['judge_scores'][$judge_code][$player_no])) {\n                    $score = $dance_data['judge_scores'][$judge_code][$player_no];\n                    break;\n                }\n            }\n            \n            $html .= '<td class=\"judge-score\">' . $score . '</td>';\n        }\n\n        $html .= '<td class=\"total-points\">' . $points . '</td></tr>';\n    }\n\n    $html .= '</tbody></table></div>';\n\n    // ì‹¬ì‚¬ìœ„ì› ì •ë³´\n    $html .= '<div class=\"adjudicators-section\">\n    <div class=\"section-title\">ì‹¬ì‚¬ìœ„ì›</div>\n    <div class=\"adjudicators-grid\">';\n\n    // ì‹¬ì‚¬ìœ„ì› ì¹´ë“œë“¤\n    foreach ($adjudicators as $judge) {\n        $html .= '<div class=\"adjudicator-card\">\n            <div class=\"adjudicator-code\">' . $judge['code'] . '</div>\n            <div class=\"adjudicator-name\">' . htmlspecialchars($judge['name']) . '</div>\n        </div>';\n    }\n\n    $html .= '</div>\n</div>\n</div>\n<div class=\"footer\">\n    <p>&copy; 2025 <a href=\"http://www.danceoffice.net\">DanceOffice</a> - Competition Management System</p>\n    <p>Generated on ' . date('Y-m-d H:i:s') . ' | <a href=\"http://www.danceoffice.net\">DanceOffice.net</a></p>\n</div>\n</body>\n</html>';\n\n    // ë³´ê³ ì„œ ì €ì¥\n    $report_dir = \"results_reports/{$comp_id}/Event_{$event_no}\";\n    if (!is_dir($report_dir)) {\n        mkdir($report_dir, 0755, true);\n    }\n    \n    $report_file = \"{$report_dir}/combined_report_{$event_no}.html\";\n    file_put_contents($report_file, $html);\n    \n    error_log(\"Professional report generated: \" . $report_file);\n}\n?>\n","size_bytes":22546},"comp/final_report_generator.js":{"content":"// ê²°ìŠ¹ì „ ê²°ê³¼ ë¦¬í¬íŠ¸ ìƒì„± í•¨ìˆ˜ë“¤\n\nfunction generateFinalReportHtml(data, eventInfo) {\n    const compInfo = window.compInfo || { title: 'ëŒ€íšŒ', date: '2025.09.13', place: 'ì¥ì†Œ' };\n    \n    return `\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <title>${eventInfo.desc} - Final Results</title>\n    <style>\n        body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background: #f5f5f5; }\n        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }\n        .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 20px; }\n        .title { font-size: 24px; font-weight: bold; color: #333; margin-bottom: 10px; }\n        .subtitle { font-size: 18px; color: #666; margin-bottom: 5px; }\n        .date { font-size: 14px; color: #888; }\n        .results-section { margin-bottom: 40px; }\n        .section-title { font-size: 20px; font-weight: bold; color: #333; margin-bottom: 15px; border-left: 4px solid #007bff; padding-left: 10px; }\n        .final-table { width: 100%; border-collapse: collapse; margin-bottom: 30px; }\n        .final-table th, .final-table td { padding: 12px; text-align: center; border: 1px solid #ddd; }\n        .final-table th { background: #333; color: white; font-weight: bold; }\n        .final-table tbody tr:nth-child(even) { background: #f8f9fa; }\n        .final-table tbody tr:hover { background: #e9ecef; }\n        .final-table th:first-child, .final-table td:first-child { background: #e9ecef; font-weight: bold; }\n        .final-table th:nth-child(2), .final-table td:nth-child(2) { text-align: left; min-width: 200px; }\n        .final-table th:last-child, .final-table td:last-child { background: #ffd700; font-weight: bold; color: #333; }\n        .dance-tabs { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }\n        .dance-tab { background: #f8f9fa; border: 1px solid #ddd; padding: 8px 16px; cursor: pointer; border-radius: 4px; }\n        .dance-tab.active { background: #007bff; color: white; }\n        .dance-details { display: none; }\n        .dance-details.active { display: block; }\n        .skating-table { width: 100%; border-collapse: collapse; font-size: 12px; }\n        .skating-table th, .skating-table td { padding: 6px; text-align: center; border: 1px solid #ddd; }\n        .skating-table th { background: #f8f9fa; font-weight: bold; }\n        .skating-table tbody tr:nth-child(even) { background: #f8f9fa; }\n        .skating-table th:first-child, .skating-table td:first-child { background: #e9ecef; font-weight: bold; }\n        .skating-table th:nth-child(2), .skating-table td:nth-child(2) { text-align: left; min-width: 150px; }\n        .skating-table th:last-child, .skating-table td:last-child { background: #ffd700; font-weight: bold; }\n        .footer { text-align: center; margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; color: #666; font-size: 12px; }\n        @media print { body { background: white; } .container { box-shadow: none; } }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <div class=\"title\">${compInfo.title}</div>\n            <div class=\"subtitle\">${eventInfo.desc} - Final Results</div>\n            <div class=\"date\">${compInfo.date} | ${compInfo.place}</div>\n        </div>\n        \n        <div class=\"results-section\">\n            <div class=\"section-title\">Final Rankings (Skating System)</div>\n            <table class=\"final-table\">\n                <thead>\n                    <tr>\n                        <th>Place</th>\n                        <th>Competitor Name(s)</th>\n                        <th>SUM of Places</th>\n                        ${Object.keys(data.dance_results).map(danceCode => {\n                            const dance = data.dance_results[danceCode];\n                            return `<th>${dance.name}</th>`;\n                        }).join('')}\n                    </tr>\n                </thead>\n                <tbody>\n                    ${data.final_rankings.map(ranking => {\n                        const player = data.players.find(p => p.number === ranking.player_no);\n                        const playerName = player ? `${player.male} / ${player.female}` : `ì„ ìˆ˜ ${ranking.player_no}`;\n                        const danceRankings = Object.keys(data.dance_results).map(danceCode => {\n                            const dance = data.dance_results[danceCode];\n                            return dance.final_rankings[ranking.player_no] || '-';\n                        });\n                        \n                        return `\n                            <tr>\n                                <td>${ranking.final_rank}</td>\n                                <td>${playerName}</td>\n                                <td>${ranking.sum_of_places}</td>\n                                ${danceRankings.map(rank => `<td>${rank}</td>`).join('')}\n                            </tr>\n                        `;\n                    }).join('')}\n                </tbody>\n            </table>\n        </div>\n        \n        <div class=\"results-section\">\n            <div class=\"section-title\">Detailed Results by Dance</div>\n            <div class=\"dance-tabs\">\n                ${Object.keys(data.dance_results).map((danceCode, index) => {\n                    const dance = data.dance_results[danceCode];\n                    return `<div class=\"dance-tab ${index === 0 ? 'active' : ''}\" onclick=\"showDanceDetails('${danceCode}')\">${dance.name}</div>`;\n                }).join('')}\n            </div>\n            \n            ${Object.keys(data.dance_results).map((danceCode, index) => {\n                const dance = data.dance_results[danceCode];\n                return `\n                    <div class=\"dance-details ${index === 0 ? 'active' : ''}\" id=\"dance-${danceCode}\">\n                        <h4>${dance.name} - Skating System Results</h4>\n                        <table class=\"skating-table\">\n                            <thead>\n                                <tr>\n                                    <th>Cpl. No.</th>\n                                    <th>Competitor Name(s)</th>\n                                    ${data.adjudicators.map(adj => `<th>${adj.code}</th>`).join('')}\n                                    <th>1</th>\n                                    <th>1&2</th>\n                                    <th>1to3</th>\n                                    <th>1to4</th>\n                                    <th>1to5</th>\n                                    <th>1to6</th>\n                                    <th>Place</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                ${data.players.map(player => {\n                                    const playerNo = player.number;\n                                    const playerName = `${player.male} / ${player.female}`;\n                                    const judgeRanks = data.adjudicators.map(adj => {\n                                        const scores = dance.judge_scores[adj.code];\n                                        return scores && scores[playerNo] ? scores[playerNo] : '-';\n                                    });\n                                    const skatingData = calculateSkatingDataForPlayer(dance.judge_scores, playerNo);\n                                    const finalRank = dance.final_rankings[playerNo] || '-';\n                                    \n                                    return `\n                                        <tr>\n                                            <td>${playerNo}</td>\n                                            <td>${playerName}</td>\n                                            ${judgeRanks.map(rank => `<td>${rank}</td>`).join('')}\n                                            <td>${skatingData.place_1}</td>\n                                            <td>${skatingData.place_1_2}</td>\n                                            <td>${skatingData.place_1to3} (${skatingData.sum_1to3})</td>\n                                            <td>${skatingData.place_1to4} (${skatingData.sum_1to4})</td>\n                                            <td>${skatingData.place_1to5} (${skatingData.sum_1to5})</td>\n                                            <td>${skatingData.place_1to6} (${skatingData.sum_1to6})</td>\n                                            <td><strong>${finalRank}</strong></td>\n                                        </tr>\n                                    `;\n                                }).join('')}\n                            </tbody>\n                        </table>\n                    </div>\n                `;\n            }).join('')}\n        </div>\n        \n        <div class=\"footer\">\n            <p>&copy; 2025 DanceOffice - Powered by Seyoung Lee</p>\n        </div>\n    </div>\n    \n    <script>\n        function showDanceDetails(danceCode) {\n            // ëª¨ë“  íƒ­ê³¼ ë‚´ìš© ë¹„í™œì„±í™”\n            document.querySelectorAll('.dance-tab').forEach(tab => tab.classList.remove('active'));\n            document.querySelectorAll('.dance-details').forEach(details => details.classList.remove('active'));\n            \n            // ì„ íƒëœ íƒ­ê³¼ ë‚´ìš© í™œì„±í™”\n            document.querySelector('[onclick=\"showDanceDetails(\\\\'' + danceCode + '\\\\')\"]').classList.add('active');\n            document.getElementById('dance-' + danceCode).classList.add('active');\n        }\n        \n        function calculateSkatingDataForPlayer(judgeScores, playerNo) {\n            const rankings = [];\n            Object.values(judgeScores).forEach(scores => {\n                if (scores[playerNo]) {\n                    rankings.push(scores[playerNo]);\n                }\n            });\n            \n            if (rankings.length === 0) {\n                return { place_1: 0, place_1_2: 0, place_1to3: 0, place_1to4: 0, place_1to5: 0, place_1to6: 0, sum_1to3: 0, sum_1to4: 0, sum_1to5: 0, sum_1to6: 0 };\n            }\n            \n            let place_1 = 0, place_1_2 = 0, place_1to3 = 0, place_1to4 = 0, place_1to5 = 0, place_1to6 = 0;\n            let sum_1to3 = 0, sum_1to4 = 0, sum_1to5 = 0, sum_1to6 = 0;\n            \n            rankings.forEach(rank => {\n                if (rank === 1) place_1++;\n                if (rank <= 2) place_1_2++;\n                if (rank <= 3) { place_1to3++; sum_1to3 += rank; }\n                if (rank <= 4) { place_1to4++; sum_1to4 += rank; }\n                if (rank <= 5) { place_1to5++; sum_1to5 += rank; }\n                if (rank <= 6) { place_1to6++; sum_1to6 += rank; }\n            });\n            \n            return { place_1, place_1_2, place_1to3, place_1to4, place_1to5, place_1to6, sum_1to3, sum_1to4, sum_1to5, sum_1to6 };\n        }\n    </script>\n</body>\n</html>\n    `;\n}\n\n\n\n\n\n","size_bytes":10923},"comp/fullscreen_monitor.php":{"content":"<?php\n/**\n * ì „ì²´í™”ë©´ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ\n * ê²°ê³¼ë¥¼ ìë™ìœ¼ë¡œ ìˆœí™˜ í‘œì‹œí•˜ê³  ëŒ€ê¸°í™”ë©´ê³¼ ì „í™˜\n */\n\nrequire_once 'result_monitor.php';\n\n$monitor = new ResultMonitor();\n$pairs = $monitor->findResultPairs();\n\n// í˜„ì¬ í‘œì‹œí•  ì´ë²¤íŠ¸ ID (URL íŒŒë¼ë¯¸í„°ë¡œ ë°›ìŒ)\n$currentEvent = isset($_GET['event']) ? $_GET['event'] : (count($pairs) > 0 ? $pairs[0]['event_id'] : '');\n$mode = isset($_GET['mode']) ? $_GET['mode'] : 'results'; // results, waiting, logo\n$autoRotate = isset($_GET['auto']) ? $_GET['auto'] : 'true';\n\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>ì „ì²´í™”ë©´ ëª¨ë‹ˆí„°ë§</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n        \n        body {\n            font-family: 'Arial', sans-serif;\n            background: #000;\n            color: #fff;\n            overflow: hidden;\n            height: 100vh;\n        }\n        \n        .monitor-container {\n            width: 100vw;\n            height: 100vh;\n            position: relative;\n            display: flex;\n            flex-direction: column;\n            overflow: hidden;\n        }\n        \n        /* ëŒ€ê¸°í™”ë©´ ìŠ¤íƒ€ì¼ */\n        .waiting-screen {\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            text-align: center;\n            animation: pulse 2s infinite;\n            width: 100vw;\n            height: 100vh;\n            position: absolute;\n            top: 0;\n            left: 0;\n        }\n        \n        .waiting-screen h1 {\n            font-size: 4em;\n            margin-bottom: 30px;\n            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);\n        }\n        \n        .waiting-screen p {\n            font-size: 2em;\n            opacity: 0.9;\n        }\n        \n        /* ë¡œê³  í™”ë©´ ìŠ¤íƒ€ì¼ */\n        .logo-screen {\n            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            text-align: center;\n            width: 100vw;\n            height: 100vh;\n            position: absolute;\n            top: 0;\n            left: 0;\n        }\n        \n        .logo-screen img {\n            max-width: 80%;\n            max-height: 60%;\n            margin-bottom: 30px;\n        }\n        \n        .logo-screen h1 {\n            font-size: 3em;\n            margin-bottom: 20px;\n        }\n        \n        .logo-screen p {\n            font-size: 1.5em;\n            opacity: 0.9;\n        }\n        \n        /* ê²°ê³¼ í™”ë©´ ìŠ¤íƒ€ì¼ */\n        .results-screen {\n            background: #f5f5f5;\n            color: #333;\n            overflow: hidden;\n            position: relative;\n            width: 100vw;\n            height: 100vh;\n        }\n        \n        .results-screen iframe {\n            width: 100vw;\n            height: 100vh;\n            border: none;\n            position: absolute;\n            top: 0;\n            left: 0;\n        }\n        \n        /* ì œì–´ íŒ¨ë„ */\n        .control-panel {\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            z-index: 1000;\n            background: rgba(0,0,0,0.8);\n            padding: 15px;\n            border-radius: 10px;\n            display: flex;\n            gap: 10px;\n            opacity: 0;\n            transition: opacity 0.3s;\n        }\n        \n        .control-panel:hover {\n            opacity: 1;\n        }\n        \n        .control-btn {\n            background: #667eea;\n            color: white;\n            border: none;\n            padding: 10px 15px;\n            border-radius: 5px;\n            cursor: pointer;\n            font-size: 14px;\n            transition: background 0.3s;\n        }\n        \n        .control-btn:hover {\n            background: #5a6fd8;\n        }\n        \n        .control-btn.active {\n            background: #28a745;\n        }\n        \n        .control-btn.danger {\n            background: #dc3545;\n        }\n        \n        /* ìƒíƒœ í‘œì‹œ */\n        .status-bar {\n            position: fixed;\n            bottom: 20px;\n            left: 20px;\n            background: rgba(0,0,0,0.8);\n            color: white;\n            padding: 10px 15px;\n            border-radius: 5px;\n            font-size: 14px;\n        }\n        \n        /* ì• ë‹ˆë©”ì´ì…˜ */\n        @keyframes pulse {\n            0% { transform: scale(1); }\n            50% { transform: scale(1.05); }\n            100% { transform: scale(1); }\n        }\n        \n        @keyframes fadeIn {\n            from { opacity: 0; transform: translateY(20px); }\n            to { opacity: 1; transform: translateY(0); }\n        }\n        \n        .fade-in {\n            animation: fadeIn 0.5s ease-in-out;\n        }\n        \n        /* ë°˜ì‘í˜• */\n        @media (max-width: 768px) {\n            .waiting-screen h1 { font-size: 2.5em; }\n            .waiting-screen p { font-size: 1.5em; }\n            .logo-screen h1 { font-size: 2em; }\n            .logo-screen p { font-size: 1.2em; }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"monitor-container\">\n        <!-- ëŒ€ê¸°í™”ë©´ -->\n        <div id=\"waitingScreen\" class=\"waiting-screen\" style=\"display: none;\">\n            <h1>ğŸ† 2025 ê²½ê¸°ë„ì§€ì‚¬ë°° ì „êµ­ì¥ì• ì¸ëŒ„ìŠ¤ìŠ¤í¬ì¸ ì„ ìˆ˜ê¶ŒëŒ€íšŒ</h1>\n            <p>ê²°ê³¼ë¥¼ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”...</p>\n        </div>\n        \n        <!-- ë¡œê³  í™”ë©´ -->\n        <div id=\"logoScreen\" class=\"logo-screen\" style=\"display: none;\">\n            <img src=\"assets/danceoffice-logo.png\" alt=\"DanceOffice ë¡œê³ \" onerror=\"this.style.display='none'\">\n            <h1>DanceOffice</h1>\n            <p>ëŒ„ìŠ¤ìŠ¤í¬ì¸  ê´€ë¦¬ ì‹œìŠ¤í…œ</p>\n        </div>\n        \n        <!-- ê²°ê³¼ í™”ë©´ -->\n        <div id=\"resultsScreen\" class=\"results-screen\">\n            <?php if ($currentEvent && $mode === 'results'): ?>\n                <iframe src=\"combined_result_<?php echo htmlspecialchars($currentEvent); ?>.html\" \n                        id=\"resultFrame\"></iframe>\n            <?php else: ?>\n                <div style=\"display: flex; justify-content: center; align-items: center; height: 100vh; font-size: 2em; color: #666;\">\n                    ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...\n                </div>\n            <?php endif; ?>\n        </div>\n    </div>\n    \n    <!-- ì œì–´ íŒ¨ë„ -->\n    <div class=\"control-panel\" id=\"controlPanel\">\n        <button class=\"control-btn\" onclick=\"showMode('waiting')\">â³ ëŒ€ê¸°í™”ë©´</button>\n        <button class=\"control-btn\" onclick=\"showMode('logo')\">ğŸ¢ ë¡œê³ </button>\n        <button class=\"control-btn\" onclick=\"showMode('results')\">ğŸ“Š ê²°ê³¼</button>\n        <button class=\"control-btn\" onclick=\"toggleAutoRotate()\">ğŸ”„ ìë™ìˆœí™˜</button>\n        <button class=\"control-btn\" onclick=\"previousEvent()\">â¬…ï¸ ì´ì „</button>\n        <button class=\"control-btn\" onclick=\"nextEvent()\">ë‹¤ìŒ â¡ï¸</button>\n        <button class=\"control-btn danger\" onclick=\"exitFullscreen()\">âŒ ì¢…ë£Œ</button>\n    </div>\n    \n    <!-- ìƒíƒœ í‘œì‹œ -->\n    <div class=\"status-bar\" id=\"statusBar\">\n        í˜„ì¬ ëª¨ë“œ: <span id=\"currentMode\"><?php echo $mode; ?></span> | \n        ì´ë²¤íŠ¸: <span id=\"currentEvent\"><?php echo $currentEvent; ?></span> | \n        ìë™ìˆœí™˜: <span id=\"autoStatus\"><?php echo $autoRotate === 'true' ? 'ON' : 'OFF'; ?></span>\n    </div>\n\n    <script>\n        let currentMode = '<?php echo $mode; ?>';\n        let currentEvent = '<?php echo $currentEvent; ?>';\n        let autoRotate = <?php echo $autoRotate === 'true' ? 'true' : 'false'; ?>;\n        let eventIndex = 0;\n        let events = <?php echo json_encode(array_column($pairs, 'event_id')); ?>;\n        let rotationInterval;\n        \n        // í˜„ì¬ ì´ë²¤íŠ¸ ì¸ë±ìŠ¤ ì°¾ê¸°\n        eventIndex = events.indexOf(currentEvent);\n        if (eventIndex === -1) eventIndex = 0;\n        \n        // ëª¨ë“œ ì „í™˜ í•¨ìˆ˜\n        function showMode(mode) {\n            // ëª¨ë“  í™”ë©´ ìˆ¨ê¸°ê¸°\n            document.getElementById('waitingScreen').style.display = 'none';\n            document.getElementById('logoScreen').style.display = 'none';\n            document.getElementById('resultsScreen').style.display = 'none';\n            \n            // ì„ íƒëœ ëª¨ë“œ í‘œì‹œ\n            currentMode = mode;\n            document.getElementById('currentMode').textContent = mode;\n            \n            switch(mode) {\n                case 'waiting':\n                    document.getElementById('waitingScreen').style.display = 'flex';\n                    break;\n                case 'logo':\n                    document.getElementById('logoScreen').style.display = 'flex';\n                    break;\n                case 'results':\n                    document.getElementById('resultsScreen').style.display = 'block';\n                    loadCurrentEvent();\n                    break;\n            }\n            \n            // ì œì–´ ë²„íŠ¼ í™œì„±í™” ìƒíƒœ ì—…ë°ì´íŠ¸\n            updateControlButtons();\n        }\n        \n        // ì´ë²¤íŠ¸ ë¡œë“œ í•¨ìˆ˜\n        function loadCurrentEvent() {\n            if (events.length > 0 && eventIndex >= 0 && eventIndex < events.length) {\n                currentEvent = events[eventIndex];\n                document.getElementById('currentEvent').textContent = currentEvent;\n                \n                const iframe = document.getElementById('resultFrame');\n                if (iframe) {\n                    iframe.src = `combined_result_${currentEvent}.html`;\n                }\n            }\n        }\n        \n        // ì´ì „ ì´ë²¤íŠ¸\n        function previousEvent() {\n            if (events.length > 0) {\n                eventIndex = (eventIndex - 1 + events.length) % events.length;\n                loadCurrentEvent();\n            }\n        }\n        \n        // ë‹¤ìŒ ì´ë²¤íŠ¸\n        function nextEvent() {\n            if (events.length > 0) {\n                eventIndex = (eventIndex + 1) % events.length;\n                loadCurrentEvent();\n            }\n        }\n        \n        // ìë™ ìˆœí™˜ í† ê¸€\n        function toggleAutoRotate() {\n            autoRotate = !autoRotate;\n            document.getElementById('autoStatus').textContent = autoRotate ? 'ON' : 'OFF';\n            \n            if (autoRotate) {\n                startAutoRotation();\n            } else {\n                stopAutoRotation();\n            }\n        }\n        \n        // ìë™ ìˆœí™˜ ì‹œì‘\n        function startAutoRotation() {\n            if (rotationInterval) clearInterval(rotationInterval);\n            \n            rotationInterval = setInterval(() => {\n                if (currentMode === 'results' && events.length > 0) {\n                    nextEvent();\n                }\n            }, 10000); // 10ì´ˆë§ˆë‹¤ ìˆœí™˜\n        }\n        \n        // ìë™ ìˆœí™˜ ì¤‘ì§€\n        function stopAutoRotation() {\n            if (rotationInterval) {\n                clearInterval(rotationInterval);\n                rotationInterval = null;\n            }\n        }\n        \n        // ì œì–´ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸\n        function updateControlButtons() {\n            const buttons = document.querySelectorAll('.control-btn');\n            buttons.forEach(btn => btn.classList.remove('active'));\n            \n            // í˜„ì¬ ëª¨ë“œ ë²„íŠ¼ í™œì„±í™”\n            const modeButtons = {\n                'waiting': buttons[0],\n                'logo': buttons[1],\n                'results': buttons[2]\n            };\n            \n            if (modeButtons[currentMode]) {\n                modeButtons[currentMode].classList.add('active');\n            }\n        }\n        \n        // ì „ì²´í™”ë©´ ì¢…ë£Œ\n        function exitFullscreen() {\n            if (document.exitFullscreen) {\n                document.exitFullscreen();\n            } else if (document.webkitExitFullscreen) {\n                document.webkitExitFullscreen();\n            } else if (document.mozCancelFullScreen) {\n                document.mozCancelFullScreen();\n            } else if (document.msExitFullscreen) {\n                document.msExitFullscreen();\n            }\n        }\n        \n        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤\n        document.addEventListener('keydown', function(e) {\n            switch(e.key) {\n                case 'F11':\n                    e.preventDefault();\n                    if (!document.fullscreenElement) {\n                        document.documentElement.requestFullscreen();\n                    } else {\n                        exitFullscreen();\n                    }\n                    break;\n                case 'ArrowLeft':\n                    previousEvent();\n                    break;\n                case 'ArrowRight':\n                    nextEvent();\n                    break;\n                case ' ':\n                    e.preventDefault();\n                    toggleAutoRotate();\n                    break;\n                case '1':\n                    showMode('waiting');\n                    break;\n                case '2':\n                    showMode('logo');\n                    break;\n                case '3':\n                    showMode('results');\n                    break;\n                case 'Escape':\n                    exitFullscreen();\n                    break;\n            }\n        });\n        \n        // ì´ˆê¸°í™”\n        document.addEventListener('DOMContentLoaded', function() {\n            showMode(currentMode);\n            \n            if (autoRotate) {\n                startAutoRotation();\n            }\n            \n            // 3ì´ˆ í›„ ì œì–´ íŒ¨ë„ ìˆ¨ê¸°ê¸°\n            setTimeout(() => {\n                document.getElementById('controlPanel').style.opacity = '0';\n            }, 3000);\n        });\n        \n        // ë§ˆìš°ìŠ¤ ì›€ì§ì„ ê°ì§€ë¡œ ì œì–´ íŒ¨ë„ í‘œì‹œ\n        let mouseTimer;\n        document.addEventListener('mousemove', function() {\n            document.getElementById('controlPanel').style.opacity = '1';\n            clearTimeout(mouseTimer);\n            mouseTimer = setTimeout(() => {\n                document.getElementById('controlPanel').style.opacity = '0';\n            }, 3000);\n        });\n    </script>\n</body>\n</html>\n","size_bytes":14400},"comp/get_competition_settings.php":{"content":"<?php\n/**\n * ëŒ€íšŒ ì„¤ì • ì¡°íšŒ API\n */\n\nheader('Content-Type: application/json');\n\n$settingsFile = __DIR__ . '/uploads/competition_settings.json';\n\n// ê¸°ë³¸ ì„¤ì •\n$defaultSettings = [\n    'competition_title' => '2025 ê²½ê¸°ë„ì§€ì‚¬ë°° ì „êµ­ì¥ì• ì¸ëŒ„ìŠ¤ìŠ¤í¬ì¸ ì„ ìˆ˜ê¶ŒëŒ€íšŒ',\n    'competition_subtitle' => 'DanceOffice ëŒ„ìŠ¤ìŠ¤í¬ì¸  ê´€ë¦¬ ì‹œìŠ¤í…œ'\n];\n\n// ì„¤ì • ë¡œë“œ\n$settings = $defaultSettings;\nif (file_exists($settingsFile)) {\n    $loadedSettings = json_decode(file_get_contents($settingsFile), true);\n    if ($loadedSettings) {\n        $settings = array_merge($defaultSettings, $loadedSettings);\n    }\n}\n\necho json_encode([\n    'success' => true,\n    'settings' => $settings\n]);\n?>\n\n\n\n\n","size_bytes":711},"comp/get_dance_done.php":{"content":"<?php\nheader('Content-Type: application/json');\nheader('Cache-Control: no-cache, must-revalidate');\n\n$comp_id = $_GET['comp_id'] ?? '';\n$event_no = $_GET['event_no'] ?? '';\n\n// BOM ì œê±°\nif (substr($event_no, 0, 3) === \"\\xEF\\xBB\\xBF\") {\n    $event_no = substr($event_no, 3);\n}\n\nif (!$comp_id || !$event_no) {\n    http_response_code(400);\n    echo json_encode(['error' => 'í•„ìˆ˜ íŒŒë¼ë¯¸í„° ëˆ„ë½']);\n    exit;\n}\n\n$data_dir = __DIR__ . \"/data/$comp_id\";\nif (!is_dir($data_dir)) {\n    http_response_code(404);\n    echo json_encode(['error' => 'ëŒ€íšŒ ë””ë ‰í† ë¦¬ ì—†ìŒ']);\n    exit;\n}\n\n$file = \"$data_dir/dance_done_$event_no.json\";\nif (!file_exists($file)) {\n    // íŒŒì¼ì´ ì—†ìœ¼ë©´ ë¹ˆ ê°ì²´ ë°˜í™˜\n    echo json_encode([]);\n    exit;\n}\n\n$content = file_get_contents($file);\nif ($content === false) {\n    http_response_code(500);\n    echo json_encode(['error' => 'íŒŒì¼ ì½ê¸° ì‹¤íŒ¨']);\n    exit;\n}\n\n$json = json_decode($content, true);\nif (json_last_error() !== JSON_ERROR_NONE) {\n    http_response_code(500);\n    echo json_encode(['error' => 'JSON íŒŒì‹± ì‹¤íŒ¨: ' . json_last_error_msg()]);\n    exit;\n}\n\necho json_encode($json ?: []);\n?>\n\n","size_bytes":1154},"comp/get_event_info.php":{"content":"<?php\nheader('Content-Type: application/json; charset=utf-8');\n$comp_id = $_GET['comp_id'] ?? '';\n\n// ì •ê·œí™”: BOM ì œê±° ë° í—ˆìš© ë¬¸ìë§Œ ìœ ì§€\n$comp_id = preg_replace('/\\x{FEFF}/u', '', $comp_id);\n$comp_id = preg_replace('/[^0-9\\-]/', '', $comp_id);\n$comp_id = trim($comp_id);\n\nif (!$comp_id) {\n    echo json_encode(['success' => false, 'error' => 'comp_id ëˆ„ë½']);\n    exit;\n}\n\nif (!preg_match('/^\\d{8}-\\d+$/', $comp_id)) {\n    echo json_encode(['success' => false, 'error' => 'ì˜ëª»ëœ ëŒ€íšŒ ID']);\n    exit;\n}\n\n$data_dir = __DIR__ . \"/data/$comp_id\";\n$event_info_file = \"$data_dir/event_info.json\";\n\n// ì´ë²¤íŠ¸ ì •ë³´ ë¡œë“œ\n$event_info = [];\nif (file_exists($event_info_file)) {\n    $content = file_get_contents($event_info_file);\n    $event_info = json_decode($content, true) ?: [];\n}\n\necho json_encode(['success' => true, 'event_info' => $event_info]);\n?>\n","size_bytes":877},"comp/get_event_schedule.php":{"content":"<?php\n/**\n * ì´ë²¤íŠ¸ ìˆœì„œ ì¡°íšŒ API\n */\n\nheader('Content-Type: application/json');\n\n// ì´ë²¤íŠ¸ ìˆœì„œ íŒŒì¼ ê²½ë¡œ\n$eventFile = __DIR__ . '/uploads/event_schedule.txt';\n$statusFile = __DIR__ . '/uploads/event_status.json';\n\n$events = [];\n\nif (file_exists($eventFile)) {\n    $lines = file($eventFile, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    \n    // ìƒíƒœ ë¡œë“œ\n    $status = [];\n    if (file_exists($statusFile)) {\n        $status = json_decode(file_get_contents($statusFile), true) ?: [];\n    }\n    \n    foreach ($lines as $line) {\n        $parts = explode(',', $line);\n        if (count($parts) >= 3) {\n            $eventId = trim($parts[0]);\n            $showResult = trim($parts[2]) === '1'; // íŒŒì¼ì—ì„œ ì½ì€ ê°’ ìš°ì„ \n            \n            $events[] = [\n                'id' => $eventId,\n                'name' => trim($parts[1]),\n                'show_result' => $showResult // íŒŒì¼ì—ì„œ ì½ì€ ê°’ ì‚¬ìš©\n            ];\n        }\n    }\n}\n\necho json_encode([\n    'success' => true,\n    'events' => $events,\n    'total' => count($events)\n]);\n?>\n","size_bytes":1084},"comp/get_event_status.php":{"content":"<?php\n/**\n * ì´ë²¤íŠ¸ ìƒíƒœ ì¡°íšŒ API\n */\n\nheader('Content-Type: application/json');\n\n$eventId = $_GET['event_id'] ?? '';\n\nif (!$eventId) {\n    echo json_encode(['success' => false, 'message' => 'ì´ë²¤íŠ¸ IDê°€ í•„ìš”í•©ë‹ˆë‹¤.']);\n    exit;\n}\n\n// ì´ë²¤íŠ¸ ìƒíƒœ íŒŒì¼ ê²½ë¡œ\n$statusFile = __DIR__ . '/uploads/event_status.json';\n\n// ìƒíƒœ ë¡œë“œ\n$status = [];\nif (file_exists($statusFile)) {\n    $status = json_decode(file_get_contents($statusFile), true) ?: [];\n}\n\n$showResult = isset($status[$eventId]) ? $status[$eventId] : false;\n\necho json_encode([\n    'success' => true,\n    'event_id' => $eventId,\n    'show_result' => $showResult,\n    'message' => $showResult ? 'ê²°ê³¼ ë°œí‘œ ì˜ˆì •' : 'ê²°ê³¼ ë°œí‘œ ì•ˆí•¨'\n]);\n?>\n\n\n\n\n","size_bytes":738},"comp/get_hits.php":{"content":"<?php\nheader('Content-Type: application/json; charset=utf-8');\n$comp_id = $_GET['comp_id'] ?? '';\n$event_no = $_GET['eventNo'] ?? '';\n\n// ì •ê·œí™”: BOM ì œê±° ë° í—ˆìš© ë¬¸ìë§Œ ìœ ì§€\n$comp_id = preg_replace('/\\x{FEFF}/u', '', $comp_id);\n$event_no = preg_replace('/\\x{FEFF}/u', '', $event_no);\n$comp_id = preg_replace('/[^0-9\\-]/', '', $comp_id);\n$event_no = preg_replace('/\\D+/', '', $event_no);\n$comp_id = trim($comp_id);\n$event_no = trim($event_no);\n\nif (!$comp_id || !$event_no) {\n    echo json_encode(['success' => false, 'error' => 'comp_id ë˜ëŠ” eventNo ëˆ„ë½']);\n    exit;\n}\n\nif (!preg_match('/^\\d{8}-\\d+$/', $comp_id)) {\n    echo json_encode(['success' => false, 'error' => 'ì˜ëª»ëœ ëŒ€íšŒ ID']);\n    exit;\n}\n\n$data_dir = __DIR__ . \"/data/$comp_id\";\n$file = \"$data_dir/players_hits_{$event_no}.json\";\n\nif (!is_file($file)) {\n    echo json_encode(['success' => false, 'error' => 'íˆíŠ¸ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤']);\n    exit;\n}\n\n$content = file_get_contents($file);\nif ($content === false) {\n    echo json_encode(['success' => false, 'error' => 'íŒŒì¼ ì½ê¸° ì‹¤íŒ¨']);\n    exit;\n}\n\n$hits = json_decode($content, true);\nif ($hits === null) {\n    echo json_encode(['success' => false, 'error' => 'JSON íŒŒì‹± ì‹¤íŒ¨']);\n    exit;\n}\n\necho json_encode(['success' => true, 'hits' => $hits]);\n?>\n","size_bytes":1306},"comp/get_judge_status.php":{"content":"<?php\nheader('Content-Type: application/json; charset=utf-8');\n\n$comp_id = $_GET['comp_id'] ?? '';\n$event_no = $_GET['event_no'] ?? '';\n\nif (!$comp_id || !$event_no) {\n    echo json_encode(['success' => false, 'error' => 'í•„ìˆ˜ ë§¤ê°œë³€ìˆ˜ ëˆ„ë½']);\n    exit;\n}\n\n$data_dir = __DIR__ . \"/data/$comp_id\";\n\n// ì´ë²¤íŠ¸ ë²ˆí˜¸ ì •ê·œí™” (í•˜ì´í”ˆ í¬í•¨ í—ˆìš©)\n$event_no = preg_replace('/[^0-9\\-]/', '', $event_no);\n\n// ì‹¬ì‚¬ìœ„ì› ëª©ë¡ ë¡œë“œ\n$adjudicator_file = \"$data_dir/adjudicators.txt\";\n$panel_map_file = \"$data_dir/panel_list.json\";\n$runorder_file = \"$data_dir/RunOrder_Tablet.txt\";\n\n$adjudicators = [];\n$panel_map = [];\n$event_panel = '';\n\n// ì‹¬ì‚¬ìœ„ì› ì •ë³´ ë¡œë“œ\nif (file_exists($adjudicator_file)) {\n    $lines = file($adjudicator_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        $cols = array_map('trim', explode(',', $line));\n        if (count($cols) >= 2) {\n            $adjudicators[$cols[0]] = [\n                'code' => $cols[0],\n                'name' => $cols[1],\n                'nation' => $cols[2] ?? ''\n            ];\n        }\n    }\n}\n\n// íŒ¨ë„ ë§¤í•‘ ë¡œë“œ\nif (file_exists($panel_map_file)) {\n    $panel_map = json_decode(file_get_contents($panel_map_file), true) ?: [];\n}\n\n// ì´ë²¤íŠ¸ì˜ íŒ¨ë„ ì •ë³´ ì°¾ê¸°\nif (file_exists($runorder_file)) {\n    $lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        $cols = array_map('trim', explode(',', $line));\n        $no = preg_replace('/\\x{FEFF}/u', '', $cols[0] ?? '');\n        $detail_no = $cols[13] ?? '';\n        \n        // ì´ë²¤íŠ¸ ë²ˆí˜¸ ë§¤ì¹­ (ì„¸ë¶€ë²ˆí˜¸ ìš°ì„ )\n        $file_event_no = !empty($detail_no) ? $detail_no : preg_replace('/\\D+/', '', $no);\n        \n        if ($file_event_no === $event_no) {\n            $event_panel = strtoupper($cols[11] ?? '');\n            break;\n        }\n    }\n}\n\n// í•´ë‹¹ íŒ¨ë„ì˜ ì‹¬ì‚¬ìœ„ì›ë“¤ ì°¾ê¸°\n$event_judges = [];\nforeach ($panel_map as $mapping) {\n    if (strtoupper($mapping['panel_code'] ?? '') === $event_panel) {\n        $judge_code = $mapping['adj_code'] ?? '';\n        if (isset($adjudicators[$judge_code])) {\n            $event_judges[] = $judge_code;\n        }\n    }\n}\n\n// ê° ì‹¬ì‚¬ìœ„ì›ì˜ ì±„ì  ìƒíƒœ í™•ì¸\n$judge_status = [];\nforeach ($event_judges as $judge_code) {\n    $status = getJudgeScoringStatus($data_dir, $event_no, $judge_code);\n    $judge_status[$judge_code] = $status;\n}\n\n// ë””ë²„ê·¸ ì •ë³´ ì¶”ê°€\nerror_log(\"get_judge_status.php Debug - Event: $event_no, Panel: $event_panel, Judges: \" . implode(',', $event_judges));\nerror_log(\"Judge status for $event_no: \" . json_encode($judge_status));\n\necho json_encode([\n    'success' => true,\n    'status' => $judge_status,\n    'event_panel' => $event_panel,\n    'event_judges' => $event_judges,\n    'debug' => [\n        'event_no' => $event_no,\n        'data_dir' => $data_dir,\n        'adjudicator_file_exists' => file_exists($adjudicator_file),\n        'panel_map_file_exists' => file_exists($panel_map_file),\n        'runorder_file_exists' => file_exists($runorder_file)\n    ]\n]);\n\nfunction getJudgeScoringStatus($data_dir, $event_no, $judge_code) {\n    // ëŒ„ìŠ¤ ëª©ë¡ ê°€ì ¸ì˜¤ê¸° (RunOrder_Tablet.txtì—ì„œ)\n    $dances = getDancesForEvent($data_dir, $event_no);\n    \n    if (empty($dances)) {\n        error_log(\"getJudgeScoringStatus: No dances found for $event_no\");\n        return ['class' => 'offline', 'text' => 'ì˜¤í”„ë¼ì¸'];\n    }\n    \n    $total_dances = count($dances);\n    $completed_dances = 0;\n    \n    // ê° ëŒ„ìŠ¤ë³„ .adj íŒŒì¼ í™•ì¸\n    foreach ($dances as $dance) {\n        $adj_file = \"$data_dir/{$event_no}_{$dance}_{$judge_code}.adj\";\n        error_log(\"Checking file: $adj_file - \" . (file_exists($adj_file) ? 'EXISTS' : 'NOT FOUND'));\n        if (file_exists($adj_file)) {\n            $completed_dances++;\n        }\n    }\n    \n    // ë””ë²„ê·¸: ìƒíƒœ ê³„ì‚° ë¡œê·¸\n    error_log(\"Judge Status Debug - Event: $event_no, Judge: $judge_code, Dances: \" . implode(',', $dances) . \", Completed: $completed_dances/$total_dances\");\n    \n    if ($completed_dances === 0) {\n        return ['class' => 'waiting', 'text' => 'ëŒ€ê¸°'];\n    } elseif ($completed_dances < $total_dances) {\n        return ['class' => 'scoring', 'text' => \"{$completed_dances}/{$total_dances}\"];\n    } else {\n        return ['class' => 'completed', 'text' => 'ì™„ë£Œ'];\n    }\n}\n\nfunction getDancesForEvent($data_dir, $event_no) {\n    // 1-1, 1-2 ì´ë²¤íŠ¸ì— ëŒ€í•œ í•˜ë“œì½”ë”©ëœ í…ŒìŠ¤íŠ¸\n    if ($event_no === '1-1') {\n        error_log(\"getDancesForEvent: Hardcoded test for 1-1, returning [2]\");\n        return [2];\n    }\n    if ($event_no === '1-2') {\n        error_log(\"getDancesForEvent: Hardcoded test for 1-2, returning [1,2]\");\n        return [1, 2];\n    }\n    \n    $runorder_file = \"$data_dir/RunOrder_Tablet.txt\";\n    \n    if (!file_exists($runorder_file)) {\n        error_log(\"getDancesForEvent: RunOrder_Tablet.txt not found\");\n        return [];\n    }\n    \n    $lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        $cols = array_map('trim', explode(',', $line));\n        $no = preg_replace('/\\x{FEFF}/u', '', $cols[0] ?? '');\n        $detail_no = $cols[13] ?? '';\n        \n        // ì´ë²¤íŠ¸ ë²ˆí˜¸ ë§¤ì¹­\n        $file_event_no = !empty($detail_no) ? $detail_no : preg_replace('/\\D+/', '', $no);\n        \n        error_log(\"getDancesForEvent: Comparing '$file_event_no' with '$event_no' (line: \" . trim($line) . \")\");\n        \n        if ($file_event_no === $event_no) {\n            $dances = [];\n            // 6-10ë²ˆì§¸ ì»¬ëŸ¼ì˜ ëŒ„ìŠ¤ ì½”ë“œ ìˆ˜ì§‘\n            for ($i = 6; $i <= 10; $i++) {\n                if (isset($cols[$i]) && is_numeric($cols[$i]) && $cols[$i] > 0) {\n                    $dances[] = $cols[$i];\n                }\n            }\n            error_log(\"getDancesForEvent: Found dances for $event_no: \" . implode(',', $dances));\n            return $dances;\n        }\n    }\n    \n    error_log(\"getDancesForEvent: No dances found for $event_no\");\n    return [];\n}\n?>\n","size_bytes":6098},"comp/get_players.php":{"content":"<?php\nheader('Content-Type: application/json');\nerror_reporting(E_ALL);\nini_set('display_errors', 1);\n\n$comp_id = $_GET['comp_id'] ?? '';\n$event_no = $_GET['event_no'] ?? '';\n\nif (empty($comp_id) || empty($event_no)) {\n    echo json_encode(['success' => false, 'message' => 'Missing parameters']);\n    exit;\n}\n\n// ëŒ€íšŒ ë°ì´í„° ë””ë ‰í† ë¦¬\n$data_dir = __DIR__ . \"/data/$comp_id\";\n$players_file = \"$data_dir/players_$event_no.txt\";\n\ntry {\n    if (!file_exists($players_file)) {\n        echo json_encode(['success' => true, 'players' => []]);\n        exit;\n    }\n    \n    // ì„ ìˆ˜ íŒŒì¼ ì½ê¸°\n    $content = file_get_contents($players_file);\n    $player_numbers = array_filter(explode(\"\\n\", $content));\n    \n    // ì„ ìˆ˜ ì´ë¦„ ì •ë³´ (ì„ì‹œë¡œ ê¸°ë³¸ê°’ ì‚¬ìš©)\n    $competitors = [];\n    \n    // ê¸°ë³¸ ì„ ìˆ˜ ì´ë¦„ ìƒì„±\n    foreach ($player_numbers as $number) {\n        $number = trim($number);\n        if (!empty($number)) {\n            $competitors[$number] = \"ì„ ìˆ˜ $number\";\n        }\n    }\n    \n    // ì„ ìˆ˜ ëª©ë¡ ìƒì„±\n    $players = [];\n    foreach ($player_numbers as $number) {\n        $number = trim($number);\n        if (!empty($number)) {\n            $players[] = [\n                'number' => $number,\n                'name' => $competitors[$number] ?? \"ì„ ìˆ˜ $number\"\n            ];\n        }\n    }\n    \n    echo json_encode(['success' => true, 'players' => $players]);\n    \n} catch (Exception $e) {\n    echo json_encode(['success' => false, 'message' => 'Error: ' . $e->getMessage()]);\n}\n?>\n","size_bytes":1525},"comp/get_round_info.php":{"content":"<?php\nheader('Content-Type: application/json; charset=utf-8');\n\n$comp_id = $_GET['comp_id'] ?? '';\n$comp_id = preg_replace('/[^\\d-]/', '', $comp_id);\n\nif (!$comp_id) {\n    echo json_encode(['success' => false, 'error' => 'comp_id ëˆ„ë½']);\n    exit;\n}\n\n$data_dir = __DIR__ . \"/data/$comp_id\";\n$round_info_file = \"$data_dir/round_info.json\";\n\nif (file_exists($round_info_file)) {\n    $content = file_get_contents($round_info_file);\n    $round_data = json_decode($content, true);\n    if (json_last_error() === JSON_ERROR_NONE && isset($round_data['round_info'])) {\n        echo json_encode(['success' => true, 'round_info' => $round_data['round_info']]);\n    } else {\n        echo json_encode(['success' => false, 'error' => 'JSON íŒŒì‹± ì˜¤ë¥˜']);\n    }\n} else {\n    echo json_encode(['success' => true, 'round_info' => []]);\n}\n?>\n","size_bytes":831},"comp/index.php":{"content":"<?php\nsession_start();\nrequire_once 'auth.php';\n\n// ì˜¤ë„ˆ ê¶Œí•œ í™•ì¸\nrequirePermission('create_comp');\n\n$user = $_SESSION['user'];\n\n// ëŒ€íšŒ ëª©ë¡ ë° ì‹ ê·œ ëŒ€íšŒ ìƒì„±\n$data_dir = __DIR__ . '/data';\nfunction load_competitions($data_dir) {\n    $comps = [];\n    if (!is_dir($data_dir)) return $comps;\n    foreach (glob($data_dir . \"/*/info.json\") as $info_file) {\n        $comp_id = basename(dirname($info_file));\n        $info = json_decode(file_get_contents($info_file), true);\n        if ($info) {\n            $info['id'] = $comp_id;\n            $comps[] = $info;\n        }\n    }\n    usort($comps, function($a, $b) {\n        return ($b['created'] ?? 0) <=> ($a['created'] ?? 0);\n    });\n    return $comps;\n}\nif ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['add_comp'])) {\n    $title = trim($_POST['title'] ?? '');\n    $date = trim($_POST['date'] ?? '');\n    $place = trim($_POST['place'] ?? '');\n    $host = trim($_POST['host'] ?? '');\n    $country = trim($_POST['country'] ?? '');\n    $assigned_admin = trim($_POST['assigned_admin'] ?? '');\n    \n    if ($title && $date && $place && $host && $country && $assigned_admin) {\n        $today = date('Ymd');\n        $seq = 1;\n        do {\n            $comp_id = sprintf(\"%s-%03d\", $today, $seq++);\n            $comp_path = \"$data_dir/$comp_id\";\n        } while (file_exists($comp_path));\n        mkdir($comp_path, 0777, true);\n        $info = [\n            'title' => $title,\n            'date' => $date,\n            'place' => $place,\n            'host' => $host,\n            'country' => $country,\n            'assigned_admin' => $assigned_admin,\n            'created' => time()\n        ];\n        file_put_contents(\"$comp_path/info.json\", json_encode($info, JSON_UNESCAPED_UNICODE|JSON_PRETTY_PRINT));\n        header(\"Location: dashboard.php?comp_id=$comp_id\");\n        exit;\n    } else {\n        $error = \"ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.\";\n    }\n}\n$comps = load_competitions($data_dir);\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>ëŒ€íšŒ í˜„í™©íŒ | danceoffice.net COMP</title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\n    <link href=\"https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded\" rel=\"stylesheet\" />\n    <style>\n        /* PC ë²„ì „ ìŠ¤íƒ€ì¼ */\n        @media (min-width: 1024px) {\n            body {\n                background: #181B20;\n                min-height: 100vh;\n                font-size: 14px;\n                line-height: 1.5;\n                margin: 0;\n                padding: 0;\n                font-family: 'Noto Sans KR', sans-serif;\n            }\n            \n            .comp-container {\n                max-width: 1200px;\n                margin: 0 auto;\n                padding: 20px;\n            }\n            \n            .comp-header {\n                background: linear-gradient(135deg, #1a1d21 0%, #181B20 100%);\n                border-radius: 15px;\n                padding: 25px;\n                margin-bottom: 20px;\n                box-shadow: 0 8px 25px rgba(3, 199, 90, 0.15);\n                border: 2px solid #03C75A;\n                position: relative;\n                overflow: hidden;\n                text-align: center;\n            }\n            \n            .comp-header::before {\n                content: '';\n                position: absolute;\n                top: -50%;\n                right: -50%;\n                width: 200%;\n                height: 200%;\n                background: radial-gradient(circle, rgba(3, 199, 90, 0.08) 0%, transparent 70%);\n                animation: float 6s ease-in-out infinite;\n            }\n            \n            @keyframes float {\n                0%, 100% { transform: translateY(0px) rotate(0deg); }\n                50% { transform: translateY(-15px) rotate(180deg); }\n            }\n            \n            .comp-title {\n                color: #03C75A;\n                font-size: 24px;\n                margin: 0 0 10px 0;\n                position: relative;\n                z-index: 2;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                gap: 10px;\n            }\n            \n            .comp-subtitle {\n                color: #00BFAE;\n                font-size: 16px;\n                margin: 0;\n                position: relative;\n                z-index: 2;\n            }\n            \n            .comp-nav {\n                display: flex;\n                gap: 15px;\n                margin-top: 20px;\n                position: relative;\n                z-index: 2;\n                justify-content: center;\n            }\n            \n            .comp-nav a {\n                color: white;\n                text-decoration: none;\n                font-weight: 600;\n                font-size: 14px;\n                padding: 10px 20px;\n                border-radius: 20px;\n                background: rgba(3, 199, 90, 0.1);\n                backdrop-filter: blur(10px);\n                transition: all 0.3s ease;\n                display: flex;\n                align-items: center;\n                gap: 5px;\n            }\n            \n            .comp-nav a:hover {\n                background: #03C75A;\n                color: #222;\n                transform: translateY(-2px);\n            }\n            \n            .newcomp-card {\n                background: #222;\n                border-radius: 15px;\n                padding: 25px;\n                margin-bottom: 20px;\n                box-shadow: 0 8px 25px rgba(3, 199, 90, 0.08);\n                border: 1px solid #31343a;\n                max-width: 500px;\n                margin-left: auto;\n                margin-right: auto;\n            }\n            \n            .newcomp-card h3 {\n                color: #03C75A;\n                font-size: 18px;\n                margin: 0 0 20px 0;\n                display: flex;\n                align-items: center;\n                gap: 10px;\n            }\n            \n            .form-group {\n                margin-bottom: 15px;\n            }\n            \n            .form-group label {\n                display: block;\n                color: #F5F7FA;\n                font-size: 13px;\n                margin-bottom: 5px;\n                font-weight: 600;\n            }\n            \n            .form-group input,\n            .form-group select {\n                width: 100%;\n                padding: 10px;\n                border: 1px solid #31343a;\n                border-radius: 8px;\n                background: #181B20;\n                color: #F5F7FA;\n                font-size: 13px;\n                box-sizing: border-box;\n            }\n            \n            .form-group select {\n                cursor: pointer;\n            }\n            \n            .form-group select option {\n                background: #181B20;\n                color: #F5F7FA;\n            }\n            \n            .btn {\n                background: linear-gradient(90deg, #03C75A 70%, #00BFAE 100%);\n                color: #222;\n                border: none;\n                padding: 12px 24px;\n                border-radius: 20px;\n                font-weight: 600;\n                font-size: 14px;\n                cursor: pointer;\n                transition: all 0.3s ease;\n                width: 100%;\n            }\n            \n            .btn:hover {\n                background: linear-gradient(90deg, #00BFAE 60%, #03C75A 100%);\n                color: white;\n                transform: translateY(-2px);\n            }\n            \n            .error {\n                color: #ff4444;\n                background: rgba(255, 68, 68, 0.1);\n                padding: 10px;\n                border-radius: 8px;\n                margin-bottom: 15px;\n                font-size: 13px;\n            }\n            \n            .comps-list {\n                background: #222;\n                border-radius: 15px;\n                padding: 25px;\n                box-shadow: 0 8px 25px rgba(3, 199, 90, 0.08);\n                border: 1px solid #31343a;\n            }\n            \n            .comps-list h3 {\n                color: #03C75A;\n                font-size: 18px;\n                margin: 0 0 20px 0;\n                display: flex;\n                align-items: center;\n                gap: 10px;\n            }\n            \n            .comps-table {\n                width: 100%;\n                border-collapse: collapse;\n                background: #181B20;\n                border-radius: 8px;\n                overflow: hidden;\n            }\n            \n            .comps-table th {\n                background: #1E2126;\n                color: #03C75A;\n                font-weight: 600;\n                font-size: 13px;\n                padding: 15px 10px;\n                text-align: center;\n                border-bottom: 1px solid #31343a;\n            }\n            \n            .comps-table td {\n                color: #F5F7FA;\n                font-size: 13px;\n                padding: 15px 10px;\n                text-align: center;\n                border-bottom: 1px solid #31343a;\n            }\n            \n            .comps-table tr:last-child td {\n                border-bottom: none;\n            }\n            \n            .dash-btn {\n                background: linear-gradient(90deg, #03C75A 70%, #00BFAE 100%);\n                color: #222;\n                text-decoration: none;\n                padding: 8px 16px;\n                border-radius: 16px;\n                font-size: 12px;\n                font-weight: 600;\n                transition: all 0.3s ease;\n                display: inline-flex;\n                align-items: center;\n                gap: 5px;\n            }\n            \n            .dash-btn:hover {\n                background: linear-gradient(90deg, #00BFAE 60%, #03C75A 100%);\n                color: white;\n                transform: translateY(-2px);\n            }\n            \n            .none-msg {\n                text-align: center;\n                color: #8A8D93;\n                font-size: 14px;\n                padding: 40px 20px;\n            }\n            \n            .comp-footer {\n                text-align: center;\n                color: #03C75A;\n                padding: 20px;\n                font-size: 12px;\n                margin-top: 20px;\n            }\n        }\n        \n        /* ëª¨ë°”ì¼ ë²„ì „ ìŠ¤íƒ€ì¼ */\n        @media (max-width: 1023px) {\n            body {\n                background: #181B20;\n                min-height: 100vh;\n                font-size: 14px;\n                line-height: 1.5;\n                margin: 0;\n                padding: 0;\n                font-family: 'Noto Sans KR', sans-serif;\n            }\n            \n            .comp-container {\n                padding: 10px;\n            }\n            \n            .comp-header {\n                background: rgba(26, 29, 33, 0.9);\n                backdrop-filter: blur(20px);\n                border-radius: 15px;\n                padding: 20px;\n                margin-bottom: 15px;\n                box-shadow: 0 8px 25px rgba(3, 199, 90, 0.15);\n                border: 2px solid #03C75A;\n                text-align: center;\n            }\n            \n            .comp-title {\n                color: #03C75A;\n                font-size: 20px;\n                margin: 0 0 8px 0;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                gap: 8px;\n            }\n            \n            .comp-subtitle {\n                color: #00BFAE;\n                font-size: 14px;\n                margin: 0;\n            }\n            \n            .comp-nav {\n                display: flex;\n                gap: 10px;\n                margin-top: 15px;\n                flex-wrap: wrap;\n                justify-content: center;\n            }\n            \n            .comp-nav a {\n                color: white;\n                text-decoration: none;\n                font-weight: 600;\n                font-size: 13px;\n                padding: 8px 16px;\n                border-radius: 16px;\n                background: rgba(3, 199, 90, 0.2);\n                backdrop-filter: blur(10px);\n                transition: all 0.3s ease;\n                display: flex;\n                align-items: center;\n                gap: 5px;\n            }\n            \n            .comp-nav a:hover {\n                background: #03C75A;\n                color: #222;\n            }\n            \n            .newcomp-card {\n                background: rgba(34, 34, 34, 0.95);\n                backdrop-filter: blur(20px);\n                border-radius: 15px;\n                padding: 20px;\n                margin-bottom: 15px;\n                box-shadow: 0 8px 25px rgba(3, 199, 90, 0.08);\n                border: 1px solid #31343a;\n            }\n            \n            .newcomp-card h3 {\n                color: #03C75A;\n                font-size: 16px;\n                margin: 0 0 15px 0;\n                display: flex;\n                align-items: center;\n                gap: 8px;\n            }\n            \n            .comps-list {\n                background: rgba(34, 34, 34, 0.95);\n                backdrop-filter: blur(20px);\n                border-radius: 15px;\n                padding: 20px;\n                box-shadow: 0 8px 25px rgba(3, 199, 90, 0.08);\n                border: 1px solid #31343a;\n            }\n            \n            .comps-list h3 {\n                color: #03C75A;\n                font-size: 16px;\n                margin: 0 0 15px 0;\n                display: flex;\n                align-items: center;\n                gap: 8px;\n            }\n            \n            .comps-table {\n                width: 100%;\n                border-collapse: collapse;\n                background: #181B20;\n                border-radius: 8px;\n                overflow: hidden;\n                font-size: 12px;\n            }\n            \n            .comps-table th {\n                background: #1E2126;\n                color: #03C75A;\n                font-weight: 600;\n                font-size: 11px;\n                padding: 12px 8px;\n                text-align: center;\n                border-bottom: 1px solid #31343a;\n            }\n            \n            .comps-table td {\n                color: #F5F7FA;\n                font-size: 11px;\n                padding: 12px 8px;\n                text-align: center;\n                border-bottom: 1px solid #31343a;\n            }\n            \n            .dash-btn {\n                background: linear-gradient(90deg, #03C75A 70%, #00BFAE 100%);\n                color: #222;\n                text-decoration: none;\n                padding: 6px 12px;\n                border-radius: 12px;\n                font-size: 10px;\n                font-weight: 600;\n                transition: all 0.3s ease;\n                display: inline-flex;\n                align-items: center;\n                gap: 4px;\n            }\n            \n            .none-msg {\n                text-align: center;\n                color: #8A8D93;\n                font-size: 13px;\n                padding: 30px 15px;\n            }\n            \n            .comp-footer {\n                text-align: center;\n                color: #03C75A;\n                padding: 15px;\n                font-size: 11px;\n                margin-top: 15px;\n            }\n        }\n        \n        /* ê³µí†µ ìŠ¤íƒ€ì¼ */\n        .material-symbols-rounded {\n            font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 24;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"comp-container\">\n        <header class=\"comp-header\">\n            <h1 class=\"comp-title\">\n                <span class=\"material-symbols-rounded\">sports</span>\n                ì˜¤ë„ˆ ëŒ€íšŒ ê´€ë¦¬ ì‹œìŠ¤í…œ\n            </h1>\n            <p class=\"comp-subtitle\">danceoffice.net - ëŒ€íšŒ ìƒì„± ë° ì„ ì„ê´€ë¦¬ì ê´€ë¦¬</p>\n            \n            <div style=\"background: rgba(3, 199, 90, 0.1); border-radius: 10px; padding: 15px; margin: 20px 0; position: relative; z-index: 2;\">\n                <strong style=\"color: #03C75A;\"><?= htmlspecialchars($user['username']) ?></strong> - <?= getRoleDisplayName($user['role']) ?>\n            </div>\n            \n            <nav class=\"comp-nav\">\n                <a href=\"/\">\n                    <span class=\"material-symbols-rounded\">home</span>\n                    ë©”ì¸ìœ¼ë¡œ\n                </a>\n                <a href=\"senior_dashboard.php\">\n                    <span class=\"material-symbols-rounded\">admin_panel_settings</span>\n                    ì„ ì„ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ\n                </a>\n                <a href=\"manage_users.php\">\n                    <span class=\"material-symbols-rounded\">group</span>\n                    ì„ ì„ê´€ë¦¬ì ê´€ë¦¬\n                </a>\n                <a href=\"manage_judges.php\">\n                    <span class=\"material-symbols-rounded\">gavel</span>\n                    ì‹¬ì‚¬ìœ„ì› ëª©ë¡\n                </a>\n                <a href=\"/manage/\">\n                    <span class=\"material-symbols-rounded\">settings</span>\n                    ê´€ë¦¬ì í˜ì´ì§€\n                </a>\n                <a href=\"/results/\">\n                    <span class=\"material-symbols-rounded\">sports_score</span>\n                    ê²½ê¸° ê²°ê³¼\n                </a>\n                <a href=\"logout.php\" style=\"background: rgba(255, 68, 68, 0.2);\">\n                    <span class=\"material-symbols-rounded\">logout</span>\n                    ë¡œê·¸ì•„ì›ƒ\n                </a>\n            </nav>\n        </header>\n        \n        <div class=\"newcomp-card\">\n            <h3>\n                <span class=\"material-symbols-rounded\">add_circle</span>\n                ìƒˆ ëŒ€íšŒ ë§Œë“¤ê¸°\n            </h3>\n            <form method=\"post\">\n                <?php if (!empty($error)): ?>\n                    <div class=\"error\"><?= $error ?></div>\n                <?php endif; ?>\n                <div class=\"form-group\">\n                    <label for=\"title\">ëŒ€íšŒëª…</label>\n                    <input type=\"text\" id=\"title\" name=\"title\" placeholder=\"ëŒ€íšŒëª…ì„ ì…ë ¥í•˜ì„¸ìš”\" required>\n                </div>\n                <div class=\"form-group\">\n                    <label for=\"date\">ì¼ì</label>\n                    <input type=\"date\" id=\"date\" name=\"date\" required>\n                </div>\n                <div class=\"form-group\">\n                    <label for=\"place\">ì¥ì†Œ</label>\n                    <input type=\"text\" id=\"place\" name=\"place\" placeholder=\"ì¥ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”\" required>\n                </div>\n                <div class=\"form-group\">\n                    <label for=\"host\">ì£¼ìµœ/ì£¼ê´€</label>\n                    <input type=\"text\" id=\"host\" name=\"host\" placeholder=\"ì£¼ìµœ/ì£¼ê´€ì„ ì…ë ¥í•˜ì„¸ìš”\" required>\n                </div>\n                <div class=\"form-group\">\n                    <label for=\"country\">ê°œìµœêµ­ê°€</label>\n                    <select id=\"country\" name=\"country\" required>\n                        <option value=\"\">êµ­ê°€ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>\n                        <option value=\"KR\">ëŒ€í•œë¯¼êµ­ (South Korea)</option>\n                        <option value=\"CN\">ì¤‘êµ­ (China)</option>\n                        <option value=\"JP\">ì¼ë³¸ (Japan)</option>\n                        <option value=\"US\">ë¯¸êµ­ (United States)</option>\n                        <option value=\"DE\">ë…ì¼ (Germany)</option>\n                        <option value=\"UK\">ì˜êµ­ (United Kingdom)</option>\n                        <option value=\"FR\">í”„ë‘ìŠ¤ (France)</option>\n                        <option value=\"IT\">ì´íƒˆë¦¬ì•„ (Italy)</option>\n                        <option value=\"RU\">ëŸ¬ì‹œì•„ (Russia)</option>\n                        <option value=\"AU\">í˜¸ì£¼ (Australia)</option>\n                        <option value=\"CA\">ìºë‚˜ë‹¤ (Canada)</option>\n                        <option value=\"SG\">ì‹±ê°€í¬ë¥´ (Singapore)</option>\n                        <option value=\"HK\">í™ì½© (Hong Kong)</option>\n                        <option value=\"TW\">ëŒ€ë§Œ (Taiwan)</option>\n                        <option value=\"TH\">íƒœêµ­ (Thailand)</option>\n                        <option value=\"MY\">ë§ë ˆì´ì‹œì•„ (Malaysia)</option>\n                        <option value=\"VN\">ë² íŠ¸ë‚¨ (Vietnam)</option>\n                        <option value=\"ID\">ì¸ë„ë„¤ì‹œì•„ (Indonesia)</option>\n                        <option value=\"PH\">í•„ë¦¬í•€ (Philippines)</option>\n                        <option value=\"IN\">ì¸ë„ (India)</option>\n                        <option value=\"BR\">ë¸Œë¼ì§ˆ (Brazil)</option>\n                        <option value=\"AR\">ì•„ë¥´í—¨í‹°ë‚˜ (Argentina)</option>\n                        <option value=\"MX\">ë©•ì‹œì½” (Mexico)</option>\n                        <option value=\"ES\">ìŠ¤í˜ì¸ (Spain)</option>\n                        <option value=\"NL\">ë„¤ëœë€ë“œ (Netherlands)</option>\n                        <option value=\"BE\">ë²¨ê¸°ì— (Belgium)</option>\n                        <option value=\"CH\">ìŠ¤ìœ„ìŠ¤ (Switzerland)</option>\n                        <option value=\"AT\">ì˜¤ìŠ¤íŠ¸ë¦¬ì•„ (Austria)</option>\n                        <option value=\"SE\">ìŠ¤ì›¨ë´ (Sweden)</option>\n                        <option value=\"NO\">ë…¸ë¥´ì›¨ì´ (Norway)</option>\n                        <option value=\"DK\">ë´ë§ˆí¬ (Denmark)</option>\n                        <option value=\"FI\">í•€ë€ë“œ (Finland)</option>\n                        <option value=\"PL\">í´ë€ë“œ (Poland)</option>\n                        <option value=\"CZ\">ì²´ì½” (Czech Republic)</option>\n                        <option value=\"OTHER\">ê¸°íƒ€ (Other)</option>\n                    </select>\n                </div>\n                <div class=\"form-group\">\n                    <label for=\"assigned_admin\">ë‹´ë‹¹ ì„ ì„ê´€ë¦¬ì</label>\n                    <select id=\"assigned_admin\" name=\"assigned_admin\" required>\n                        <option value=\"\">ì„ ì„ê´€ë¦¬ìë¥¼ ì„ íƒí•˜ì„¸ìš”</option>\n                        <?php\n                        $users = loadUsers();\n                        $senior_admins = array_filter($users, function($u) {\n                            return $u['role'] === 'senior_admin';\n                        });\n                        foreach ($senior_admins as $admin):\n                        ?>\n                            <option value=\"<?= htmlspecialchars($admin['username']) ?>\">\n                                <?= htmlspecialchars($admin['username']) ?> (<?= getRoleDisplayName($admin['role']) ?>)\n                            </option>\n                        <?php endforeach; ?>\n                    </select>\n                </div>\n                <button type=\"submit\" name=\"add_comp\" value=\"1\" class=\"btn\">\n                    <span class=\"material-symbols-rounded\">add</span>\n                    ëŒ€íšŒ ìƒì„±\n                </button>\n            </form>\n        </div>\n        \n        <div class=\"comps-list\">\n            <h3>\n                <span class=\"material-symbols-rounded\">list</span>\n                ë“±ë¡ëœ ëŒ€íšŒ ëª©ë¡\n            </h3>\n            <?php if (empty($comps)): ?>\n                <div class=\"none-msg\">ë“±ë¡ëœ ëŒ€íšŒê°€ ì—†ìŠµë‹ˆë‹¤.</div>\n            <?php else: ?>\n                <table class=\"comps-table\">\n                    <thead>\n                        <tr>\n                            <th>ëŒ€íšŒëª…</th>\n                            <th>ì¼ì</th>\n                            <th>ì¥ì†Œ</th>\n                            <th>ì£¼ìµœ</th>\n                            <th>ë‹´ë‹¹ì</th>\n                            <th>ê´€ë¦¬</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <?php foreach ($comps as $comp): ?>\n                            <tr>\n                                <td><?= htmlspecialchars($comp['title']) ?></td>\n                                <td><?= htmlspecialchars($comp['date']) ?></td>\n                                <td><?= htmlspecialchars($comp['place']) ?></td>\n                                <td><?= htmlspecialchars($comp['host']) ?></td>\n                                <td>\n                                    <span style=\"color: #03C75A; font-weight: 600;\">\n                                        <?= htmlspecialchars($comp['assigned_admin'] ?? 'ë¯¸ì§€ì •') ?>\n                                    </span>\n                                </td>\n                                <td>\n                                    <div style=\"display: flex; gap: 5px; justify-content: center; flex-wrap: wrap;\">\n                                        <a class=\"dash-btn\" href=\"dashboard.php?comp_id=<?= urlencode($comp['id']) ?>\" style=\"font-size: 11px; padding: 6px 12px;\">\n                                            <span class=\"material-symbols-rounded\">dashboard</span>\n                                            ëŒ€ì‹œë³´ë“œ\n                                        </a>\n                                        <a class=\"dash-btn\" href=\"assign_admin.php?comp_id=<?= urlencode($comp['id']) ?>\" style=\"font-size: 11px; padding: 6px 12px; background: linear-gradient(90deg, #17a2b8 70%, #138496 100%);\">\n                                            <span class=\"material-symbols-rounded\">person_add</span>\n                                            ë‹´ë‹¹ì\n                                        </a>\n                                    </div>\n                                </td>\n                            </tr>\n                        <?php endforeach; ?>\n                    </tbody>\n                </table>\n            <?php endif; ?>\n        </div>\n        \n        <footer class=\"comp-footer\">\n            &copy; 2025 danceoffice.net | Powered by Seyoung Lee\n        </footer>\n    </div>\n</body>\n</html>\n","size_bytes":25754},"comp/index_old.php":{"content":"<?php\n// ëŒ€íšŒ ëª©ë¡ ë° ì‹ ê·œ ëŒ€íšŒ ìƒì„±\n$data_dir = __DIR__ . '/data';\nfunction load_competitions($data_dir) {\n    $comps = [];\n    if (!is_dir($data_dir)) return $comps;\n    foreach (glob($data_dir . \"/*/info.json\") as $info_file) {\n        $comp_id = basename(dirname($info_file));\n        $info = json_decode(file_get_contents($info_file), true);\n        if ($info) {\n            $info['id'] = $comp_id;\n            $comps[] = $info;\n        }\n    }\n    usort($comps, function($a, $b) {\n        return ($b['created'] ?? 0) <=> ($a['created'] ?? 0);\n    });\n    return $comps;\n}\nif ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['add_comp'])) {\n    $title = trim($_POST['title'] ?? '');\n    $date = trim($_POST['date'] ?? '');\n    $place = trim($_POST['place'] ?? '');\n    $host = trim($_POST['host'] ?? '');\n    if ($title && $date && $place && $host) {\n        $today = date('Ymd');\n        $seq = 1;\n        do {\n            $comp_id = sprintf(\"%s-%03d\", $today, $seq++);\n            $comp_path = \"$data_dir/$comp_id\";\n        } while (file_exists($comp_path));\n        mkdir($comp_path, 0777, true);\n        $info = [\n            'title' => $title,\n            'date' => $date,\n            'place' => $place,\n            'host' => $host,\n            'created' => time()\n        ];\n        file_put_contents(\"$comp_path/info.json\", json_encode($info, JSON_UNESCAPED_UNICODE|JSON_PRETTY_PRINT));\n        header(\"Location: dashboard.php?comp_id=$comp_id\");\n        exit;\n    } else {\n        $error = \"ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.\";\n    }\n}\n$comps = load_competitions($data_dir);\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>ëŒ€íšŒ í˜„í™©íŒ | danceoffice.net COMP</title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\n    <style>\n        body { background:#f7fafd; font-family:sans-serif; margin:0; }\n        h1 { color:#003399; text-align:center; font-size:1.35em; margin:1.2em 0 0.8em 0;}\n        .newcomp-wrap {background:#fff; max-width:420px; margin:1.5em auto 2em auto; border-radius:13px; box-shadow:0 4px 18px #00339914; padding:1.2em 1.2em 1.2em 1.2em;}\n        .newcomp-wrap form { display:grid; gap:0.7em;}\n        input, button { padding:0.55em 0.7em; border-radius:7px; border:1px solid #bbb; font-size:1em;}\n        input {border:1px solid #bbb;}\n        button { border:none; background:#03C75A; color:#fff; font-weight:700; font-size:1em; cursor:pointer;}\n        button:hover { background:#00bfae;}\n        .error { color:#c22; margin-bottom:0.5em;}\n        .comps-list {max-width:760px; margin:0 auto 3em auto;}\n        table { width:100%; background:#fff; border-radius:12px; overflow:hidden; box-shadow:0 3px 14px #00339910;}\n        th, td { padding:0.7em 0.3em; text-align:center;}\n        th { background:#f0f4fa; color:#003399; font-weight:700;}\n        td { color:#333;}\n        tr:not(:last-child) td { border-bottom:1px solid #eee;}\n        .dash-btn { background:#003399; color:#fff; border-radius:8px; padding:0.4em 1.2em; font-size:0.98em; text-decoration:none; }\n        .dash-btn:hover { background:#023175;}\n        .none-msg {text-align:center; color:#aaa; margin:2.5em 0 2em 0;}\n        footer {margin-top:2.2em;text-align:center;font-size:0.92em;color:#aaa; padding: 1em 0;}\n        @media (max-width:700px) {\n            .comps-list {max-width:99vw;}\n            table {font-size:0.98em;}\n            .newcomp-wrap {max-width:97vw;}\n        }\n    </style>\n</head>\n<body>\n<h1>ëŒ„ìŠ¤ìŠ¤í¬ì¸  ëŒ€íšŒ í˜„í™©íŒ</h1>\n<div class=\"newcomp-wrap\">\n    <form method=\"post\">\n        <div style=\"font-weight:600; margin-bottom:0.7em; color:#03C75A;\">ìƒˆ ëŒ€íšŒ ë§Œë“¤ê¸°</div>\n        <?php if (!empty($error)): ?>\n            <div class=\"error\"><?= $error ?></div>\n        <?php endif; ?>\n        <input name=\"title\" placeholder=\"ëŒ€íšŒëª…\" required>\n        <input type=\"date\" name=\"date\" required>\n        <input name=\"place\" placeholder=\"ì¥ì†Œ\" required>\n        <input name=\"host\" placeholder=\"ì£¼ìµœ/ì£¼ê´€\" required>\n        <button type=\"submit\" name=\"add_comp\" value=\"1\">ëŒ€íšŒ ìƒì„±</button>\n    </form>\n</div>\n<div class=\"comps-list\">\n    <?php if (empty($comps)): ?>\n        <div class=\"none-msg\">ë“±ë¡ëœ ëŒ€íšŒê°€ ì—†ìŠµë‹ˆë‹¤.</div>\n    <?php else: ?>\n        <table>\n            <tr>\n                <th>ëŒ€íšŒëª…</th>\n                <th>ì¼ì</th>\n                <th>ì¥ì†Œ</th>\n                <th>ì£¼ìµœ</th>\n                <th>ê´€ë¦¬</th>\n            </tr>\n            <?php foreach ($comps as $comp): ?>\n                <tr>\n                    <td><?= htmlspecialchars($comp['title']) ?></td>\n                    <td><?= htmlspecialchars($comp['date']) ?></td>\n                    <td><?= htmlspecialchars($comp['place']) ?></td>\n                    <td><?= htmlspecialchars($comp['host']) ?></td>\n                    <td>\n                        <a class=\"dash-btn\" href=\"dashboard.php?comp_id=<?= urlencode($comp['id']) ?>\">ëŒ€ì‹œë³´ë“œ</a>\n                    </td>\n                </tr>\n            <?php endforeach; ?>\n        </table>\n    <?php endif; ?>\n</div>\n<footer>\n    2025 danceoffice.net | Powered by Seyoung Lee\n</footer>\n</body>\n</html>","size_bytes":5199},"comp/judge_dashboard.php":{"content":"<?php\nsession_start();\n\n// Check if judge is logged in (ê¸°ì¡´ í”„ë¦¬ìŠ¤íƒ€ì¼ ì‹œìŠ¤í…œ ì„¸ì…˜ í™•ì¸)\nif (!isset($_SESSION['judge_id']) || !isset($_SESSION['judge_name'])) {\n    header(\"Location: judge_login.php\");\n    exit;\n}\n\n// Load competition info from current data structure\n$data_dir = __DIR__ . \"/data\";\n$comp_info_file = \"$data_dir/competition_info.txt\";\n\nif (!file_exists($comp_info_file)) {\n    echo \"<h1>ëŒ€íšŒ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</h1>\";\n    exit;\n}\n\n// Load competition info\n$comp_info = file($comp_info_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n$info = [\n    'title' => $comp_info[0] ?? 'ëŒ€íšŒ',\n    'date' => $comp_info[1] ?? '',\n    'place' => $comp_info[2] ?? ''\n];\n\n// Load events from current data structure\n$events_file = \"$data_dir/events.txt\";\n$events = [];\n\nif (file_exists($events_file)) {\n    $lines = file($events_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        $cols = array_map('trim', explode(',', $line));\n        if (count($cols) >= 2) {\n            $events[] = [\n                'code' => $cols[0],\n                'name' => $cols[1],\n                'type' => 'freestyle' // í”„ë¦¬ìŠ¤íƒ€ì¼ ì´ë²¤íŠ¸ë¡œ ì„¤ì •\n            ];\n        }\n    }\n}\n\n// Check which events have scores\n$events_with_scores = [];\nforeach ($events as $event) {\n    $scores_file = \"$data_dir/scores/score_{$event['code']}_J{$_SESSION['judge_id']}.txt\";\n    $events_with_scores[$event['code']] = file_exists($scores_file);\n}\n\nfunction h($s) { return htmlspecialchars($s ?? ''); }\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>ì‹¬ì‚¬ìœ„ì› ëŒ€ì‹œë³´ë“œ | <?=h($info['title'])?></title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\n    <style>\n        body { \n            background: #f5f7fa; \n            font-family: sans-serif; \n            margin: 0; \n            padding: 20px;\n        }\n        .container { \n            max-width: 1200px; \n            margin: 0 auto; \n            background: #fff; \n            border-radius: 12px; \n            padding: 30px; \n            box-shadow: 0 4px 20px rgba(0,0,0,0.1);\n        }\n        .header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 30px;\n            padding-bottom: 20px;\n            border-bottom: 2px solid #e9ecef;\n        }\n        h1 { \n            color: #333; \n            margin: 0; \n            font-size: 1.8em;\n        }\n        .judge-info {\n            background: #e3f2fd;\n            padding: 10px 15px;\n            border-radius: 8px;\n            color: #1976d2;\n            font-weight: 600;\n        }\n        .logout-btn {\n            background: #dc3545;\n            color: #fff;\n            border: none;\n            padding: 8px 16px;\n            border-radius: 6px;\n            cursor: pointer;\n            text-decoration: none;\n            font-size: 14px;\n        }\n        .logout-btn:hover {\n            background: #c82333;\n        }\n        .events-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\n            gap: 20px;\n            margin-bottom: 30px;\n        }\n        .event-card {\n            background: #fff;\n            border: 2px solid #e9ecef;\n            border-radius: 10px;\n            padding: 20px;\n            transition: all 0.3s;\n            cursor: pointer;\n        }\n        .event-card:hover {\n            border-color: #667eea;\n            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.1);\n        }\n        .event-card.scored {\n            border-color: #28a745;\n            background: #f8fff9;\n        }\n        .event-card.scored:hover {\n            border-color: #1e7e34;\n        }\n        .event-title {\n            font-size: 1.2em;\n            font-weight: 700;\n            color: #333;\n            margin-bottom: 8px;\n        }\n        .event-details {\n            color: #666;\n            font-size: 0.9em;\n            margin-bottom: 15px;\n        }\n        .event-actions {\n            display: flex;\n            gap: 10px;\n        }\n        .btn {\n            padding: 8px 16px;\n            border: none;\n            border-radius: 6px;\n            cursor: pointer;\n            text-decoration: none;\n            font-size: 14px;\n            font-weight: 600;\n            transition: background 0.3s;\n        }\n        .btn-primary {\n            background: #667eea;\n            color: #fff;\n        }\n        .btn-primary:hover {\n            background: #5a6fd8;\n        }\n        .btn-success {\n            background: #28a745;\n            color: #fff;\n        }\n        .btn-success:hover {\n            background: #1e7e34;\n        }\n        .btn-info {\n            background: #17a2b8;\n            color: #fff;\n        }\n        .btn-info:hover {\n            background: #138496;\n        }\n        .status-badge {\n            display: inline-block;\n            padding: 4px 8px;\n            border-radius: 4px;\n            font-size: 12px;\n            font-weight: 600;\n            margin-bottom: 10px;\n        }\n        .status-pending {\n            background: #fff3cd;\n            color: #856404;\n        }\n        .status-completed {\n            background: #d4edda;\n            color: #155724;\n        }\n        .back-link {\n            display: inline-block;\n            margin-bottom: 20px;\n            color: #667eea;\n            text-decoration: none;\n            font-size: 14px;\n        }\n        .back-link:hover {\n            text-decoration: underline;\n        }\n        .empty-state {\n            text-align: center;\n            padding: 60px 20px;\n            color: #666;\n        }\n        .empty-state h3 {\n            margin: 0 0 10px 0;\n            color: #333;\n        }\n    </style>\n</head>\n<body>\n<div class=\"container\">\n    <div class=\"header\">\n        <div>\n            <h1>ì‹¬ì‚¬ìœ„ì› ëŒ€ì‹œë³´ë“œ</h1>\n            <div class=\"judge-info\">\n                <?=h($_SESSION['judge_name'])?> - ì‹¬ì‚¬ìœ„ì› #<?=h($_SESSION['judge_id'])?>\n            </div>\n        </div>\n        <a href=\"judge_login.php\" class=\"logout-btn\">ë¡œê·¸ì•„ì›ƒ</a>\n    </div>\n    \n    <div class=\"comp-info\" style=\"background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 30px; text-align: center;\">\n        <strong><?=h($info['title'])?></strong><br>\n        <?=h($info['date'])?> | <?=h($info['place'])?>\n    </div>\n    \n    <?php if (empty($events)): ?>\n        <div class=\"empty-state\">\n            <h3>ë“±ë¡ëœ ì´ë²¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤</h3>\n            <p>ëŒ€íšŒ ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.</p>\n        </div>\n    <?php else: ?>\n        <div class=\"events-grid\">\n            <?php foreach ($events as $event): ?>\n            <div class=\"event-card <?=$events_with_scores[$event['code']] ? 'scored' : ''?>\">\n                <div class=\"status-badge <?=$events_with_scores[$event['code']] ? 'status-completed' : 'status-pending'?>\">\n                    <?=$events_with_scores[$event['code']] ? 'ì±„ì  ì™„ë£Œ' : 'ì±„ì  ëŒ€ê¸°'?>\n                </div>\n                \n                <div class=\"event-title\"><?=h($event['name'])?></div>\n                <div class=\"event-details\">\n                    <strong>ì¢…ëª© ì½”ë“œ: <?=h($event['code'])?></strong><br>\n                    <strong>íƒ€ì…: í”„ë¦¬ìŠ¤íƒ€ì¼ ì±„ì </strong>\n                </div>\n                \n                <div class=\"event-actions\">\n                    <a href=\"judge_scoring_free.php?event=<?=h($event['code'])?>\" \n                       class=\"btn btn-primary\" \n                       target=\"_blank\">\n                        ğŸ­ í”„ë¦¬ìŠ¤íƒ€ì¼ ì±„ì \n                    </a>\n                </div>\n            </div>\n            <?php endforeach; ?>\n        </div>\n    <?php endif; ?>\n</div>\n</body>\n</html>","size_bytes":7836},"comp/judge_login.php":{"content":"<?php\nsession_start();\n$data_dir = __DIR__ . '/data';\n$adjudicator_file = $data_dir . '/Adjudicator.txt';\n\n$judges = [];\nif (file_exists($adjudicator_file)) {\n    $lines = file($adjudicator_file);\n    foreach ($lines as $line) {\n        $cols = explode(',', trim($line));\n        if (count($cols) >= 4 && !empty($cols[3]) && !empty($cols[1])) {\n            $judges[] = [\n                'id' => $cols[0],\n                'name' => $cols[1],\n                'password' => $cols[3]\n            ];\n        }\n    }\n}\n\n$login_err = \"\";\nif ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['judge_password'])) {\n    $pw = trim($_POST['judge_password']);\n    if ($pw) {\n        $found = false;\n        foreach ($judges as $j) {\n        if ($j['password'] === $pw) {\n            $_SESSION['judge_id'] = $j['id'];\n            $_SESSION['judge_name'] = $j['name'];\n            $found = true;\n            \n            // ì‹¬ì‚¬ìœ„ì› ëŒ€ì‹œë³´ë“œë¡œ ì´ë™ (ì´ë²¤íŠ¸ íŒŒë¼ë¯¸í„°ëŠ” ëŒ€ì‹œë³´ë“œì—ì„œ ì²˜ë¦¬)\n            header(\"Location: judge_dashboard.php\");\n            exit;\n        }\n        }\n        if (!$found) {\n            $login_err = \"<div class='login-msg error'>ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.</div>\";\n        }\n    } else {\n        $login_err = \"<div class='login-msg error'>ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.</div>\";\n    }\n}\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>ì‹¬ì‚¬ìœ„ì› ë¡œê·¸ì¸ | danceoffice.net</title>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <link rel=\"stylesheet\" href=\"/assets/style.css\">\n    <style>\n        html, body {\n            background: #23262b !important;\n        }\n        main {\n            min-height: 100vh;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            padding: 0;\n            background: none;\n        }\n        .login-section {\n            background: #23262b;\n            border-radius: 18px;\n            padding: 3.2em 2.4em 2.8em 2.4em;\n            max-width: 460px;\n            width: 96vw;\n            margin: 0 auto;\n            box-shadow: 0 4px 32px rgba(0,0,0,0.18);\n            display: flex;\n            flex-direction: column;\n            align-items: stretch;\n        }\n        .login-title {\n            font-size: 2.0em;\n            font-weight: 700;\n            color: #03C75A;\n            margin-bottom: 1.7em;\n            text-align: center;\n            letter-spacing: -1px;\n        }\n        .login-form {\n            display: flex;\n            flex-direction: column;\n            gap: 1.3em;\n        }\n        .login-form input[type=\"password\"] {\n            font-size: 1.25em;\n            padding: 1.2em 1.1em;\n            border-radius: 12px;\n            border: 2px solid #31343a;\n            background: #181B20;\n            color: #fff;\n            outline: none;\n        }\n        .login-form input[type=\"password\"]:focus {\n            border: 2px solid #03C75A;\n            background: #23262b;\n        }\n        .login-form button {\n            background: linear-gradient(90deg,#03C75A 70%,#00BFAE 100%);\n            color: #222;\n            border: none;\n            border-radius: 24px;\n            padding: 1.1em 0;\n            font-weight: 700;\n            font-size: 1.25em;\n            margin-top: 0.2em;\n            cursor: pointer;\n            transition: background 0.2s, color 0.2s;\n            width: 100%;\n            box-shadow: 0 2px 10px rgba(3,199,90,0.13);\n        }\n        .login-form button:hover {\n            background: linear-gradient(90deg,#00BFAE 60%,#03C75A 100%);\n            color: #fff;\n        }\n        .login-msg {\n            margin-top: 1.2em;\n            padding: 1em 1.2em;\n            border-radius: 9px;\n            font-size: 1.1em;\n            text-align: center;\n        }\n        .login-msg.error {\n            background: #311;\n            color: #ff5e5e;\n        }\n        .login-section .login-notice {\n            margin-top: 2.1em;\n            color: #bbb;\n            font-size: 1.13em;\n            line-height: 1.7;\n            text-align: center;\n        }\n\n        /* íƒœë¸”ë¦¿/ëª¨ë°”ì¼ ê°œì„  */\n        @media (max-width: 900px) {\n            .login-section {\n                max-width: 98vw;\n                width: 99vw;\n                padding: 2.2em 0.6em 2.5em 0.6em;\n                border-radius: 0;\n                box-shadow: none;\n            }\n            .login-title {\n                font-size: 1.45em;\n                margin-bottom: 1.1em;\n            }\n            .login-form input[type=\"password\"], .login-form button {\n                font-size: 1.2em;\n                padding: 1em 0.8em;\n                border-radius: 10px;\n            }\n            .login-form button {\n                border-radius: 15px;\n            }\n            .login-section .login-notice {\n                font-size: 1.03em;\n                margin-top: 1.3em;\n            }\n        }\n        @media (max-width: 600px) {\n            .login-section {\n                max-width: 100vw;\n                width: 100vw;\n                padding: 1.5em 0.2em 2em 0.2em;\n            }\n            .login-title {\n                font-size: 1.11em;\n            }\n            .login-form input[type=\"password\"], .login-form button {\n                font-size: 1em;\n                padding: 0.8em 0.5em;\n            }\n            .login-section .login-notice {\n                font-size: 0.97em;\n            }\n        }\n    </style>\n</head>\n<body>\n    <main>\n        <section class=\"login-section\">\n            <div class=\"login-title\">ì‹¬ì‚¬ìœ„ì› ë¡œê·¸ì¸</div>\n            <form class=\"login-form\" method=\"post\">\n                <input type=\"password\" name=\"judge_password\" placeholder=\"ë¹„ë°€ë²ˆí˜¸ë§Œ ì…ë ¥\" required autofocus>\n                <button type=\"submit\">ë¡œê·¸ì¸</button>\n            </form>\n            <?= $login_err ?>\n            <div class=\"login-notice\">\n                â€» ë¹„ë°€ë²ˆí˜¸ë§Œ ì…ë ¥í•˜ë©´ ì‹¬ì‚¬ìœ„ì› ì¸ì¦ì´ ë©ë‹ˆë‹¤.<br>\n                â€» ë¹„ë°€ë²ˆí˜¸ë¥¼ ìŠìœ¼ì…¨ìœ¼ë©´ ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.\n            </div>\n        </section>\n    </main>\n</body>\n</html>","size_bytes":6181},"comp/judge_logout.php":{"content":"<?php\nsession_start();\n$_SESSION = [];\nsession_destroy();\nheader(\"Location: judge_login.php\");\nexit;","size_bytes":100},"comp/judge_manager.php":{"content":"<?php\n// ì‹¬ì‚¬ìœ„ì› ê´€ë¦¬ ì‹œìŠ¤í…œ\n\nfunction loadJudges() {\n    $judges_file = __DIR__ . '/judges.txt';\n    $judges = [];\n    \n    if (file_exists($judges_file)) {\n        $lines = file($judges_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n        foreach ($lines as $line) {\n            if (strpos($line, '#') === 0) continue; // ì£¼ì„ ë¬´ì‹œ\n            $parts = explode(',', $line);\n            if (count($parts) >= 10) {\n                $judges[] = [\n                    'id' => trim($parts[0]),\n                    'name' => trim($parts[1]),\n                    'organization' => trim($parts[2]),\n                    'region' => trim($parts[3]),\n                    'phone' => trim($parts[4]),\n                    'email' => trim($parts[5]),\n                    'photo' => trim($parts[6]),\n                    'specialty' => trim($parts[7]),\n                    'created_at' => trim($parts[8]),\n                    'updated_at' => trim($parts[9])\n                ];\n            }\n        }\n    }\n    return $judges;\n}\n\nfunction saveJudges($judges) {\n    $judges_file = __DIR__ . '/judges.txt';\n    $content = \"# ì‹¬ì‚¬ìœ„ì› ì¸ëª…ì‚¬ì „\\n\";\n    $content .= \"# í˜•ì‹: id,name,organization,region,phone,email,photo,specialty,created_at,updated_at\\n\";\n    $content .= \"# id: ê³ ìœ  ì‹ë³„ì (ìë™ ìƒì„±)\\n\";\n    $content .= \"# photo: ì¦ëª…ì‚¬ì§„ íŒŒì¼ëª… (judges_photos/ í´ë”ì— ì €ì¥)\\n\\n\";\n    \n    foreach ($judges as $judge) {\n        $content .= implode(',', $judge) . \"\\n\";\n    }\n    \n    file_put_contents($judges_file, $content);\n}\n\nfunction generateJudgeId() {\n    $judges = loadJudges();\n    $max_id = 0;\n    foreach ($judges as $judge) {\n        if (preg_match('/judge(\\d+)/', $judge['id'], $matches)) {\n            $max_id = max($max_id, intval($matches[1]));\n        }\n    }\n    return 'judge' . str_pad($max_id + 1, 3, '0', STR_PAD_LEFT);\n}\n\nfunction getJudgeById($id) {\n    $judges = loadJudges();\n    foreach ($judges as $judge) {\n        if ($judge['id'] === $id) {\n            return $judge;\n        }\n    }\n    return null;\n}\n\nfunction deleteJudge($id) {\n    $judges = loadJudges();\n    $judges = array_filter($judges, function($judge) use ($id) {\n        return $judge['id'] !== $id;\n    });\n    saveJudges($judges);\n}\n\nfunction addJudge($data) {\n    $judges = loadJudges();\n    $new_judge = [\n        'id' => generateJudgeId(),\n        'name' => $data['name'],\n        'organization' => $data['organization'],\n        'region' => $data['region'],\n        'phone' => $data['phone'],\n        'email' => $data['email'],\n        'photo' => $data['photo'] ?? '',\n        'specialty' => $data['specialty'],\n        'created_at' => date('Y-m-d H:i:s'),\n        'updated_at' => date('Y-m-d H:i:s')\n    ];\n    $judges[] = $new_judge;\n    saveJudges($judges);\n    return $new_judge;\n}\n\nfunction updateJudge($id, $data) {\n    $judges = loadJudges();\n    foreach ($judges as &$judge) {\n        if ($judge['id'] === $id) {\n            $judge['name'] = $data['name'];\n            $judge['organization'] = $data['organization'];\n            $judge['region'] = $data['region'];\n            $judge['phone'] = $data['phone'];\n            $judge['email'] = $data['email'];\n            $judge['photo'] = $data['photo'] ?? $judge['photo'];\n            $judge['specialty'] = $data['specialty'];\n            $judge['updated_at'] = date('Y-m-d H:i:s');\n            break;\n        }\n    }\n    saveJudges($judges);\n}\n\nfunction getRegions() {\n    return ['ì„œìš¸', 'ë¶€ì‚°', 'ëŒ€êµ¬', 'ì¸ì²œ', 'ê´‘ì£¼', 'ëŒ€ì „', 'ìš¸ì‚°', 'ì„¸ì¢…', 'ê²½ê¸°', 'ê°•ì›', 'ì¶©ë¶', 'ì¶©ë‚¨', 'ì „ë¶', 'ì „ë‚¨', 'ê²½ë¶', 'ê²½ë‚¨', 'ì œì£¼'];\n}\n\nfunction getSpecialties() {\n    return ['ë¼í‹´', 'ëª¨ë˜', 'ìŠ¤íƒ ë‹¤ë“œ', 'ë¼ì¸ëŒ„ìŠ¤', 'í™í•©', 'ì¬ì¦ˆ', 'ë°œë ˆ', 'í˜„ëŒ€ë¬´ìš©', 'ë¯¼ì†ë¬´ìš©', 'ê¸°íƒ€'];\n}\n?>\n\n\n\n\n\n\n","size_bytes":3825},"comp/judge_panel.php":{"content":"<?php\nsession_start();\nif (!isset($_SESSION['judge_id']) || !isset($_SESSION['judge_name'])) {\n    header(\"Location: judge_login.php\");\n    exit;\n}\n\n// ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬\nif (isset($_GET['logout'])) {\n    session_destroy();\n    header(\"Location: judge_login.php\");\n    exit;\n}\n\n// ì‹¬ì‚¬ìœ„ì› ì •ë³´\n$judge_name = $_SESSION['judge_name'];\n$judge_id = $_SESSION['judge_id'];\n\n// ëŒ€íšŒ ì •ë³´ ë° ì±„ì  í˜ì´ì§€ ë“± ì¶”ê°€ ì•ˆë‚´ (í™•ì¥ ê°€ëŠ¥)\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>ì‹¬ì‚¬ìœ„ì› íŒ¨ë„ | danceoffice.net</title>\n    <link rel=\"stylesheet\" href=\"/assets/style.css\">\n    <style>\n        .panel-section {background:#23262b; border-radius:14px; padding:2em 2em 2.5em 2em; max-width:500px; margin:3em auto;}\n        .panel-title {font-size:1.3em; font-weight:700; color:#03C75A; margin-bottom:1.1em;}\n        .panel-info {color:#F5F7FA; margin-bottom:2em;}\n        .panel-nav {margin-top:2em;}\n        .panel-nav a {color:#03C75A; font-weight:700; text-decoration:none; padding:0.5em 1.2em; border-radius:18px; background:#181B20; margin-right:1em;}\n        .panel-nav a:hover {background:#00BFAE; color:#fff;}\n        .logout-btn {background:#ff5e5e; color:#fff; border:none; border-radius:20px; padding:0.5em 1.4em; font-weight:700; margin-top:2.5em;}\n        .logout-btn:hover {background:#c93;}\n    </style>\n</head>\n<body>\n    <main>\n        <section class=\"panel-section\">\n            <div class=\"panel-title\">ì‹¬ì‚¬ìœ„ì› íŒ¨ë„</div>\n            <div class=\"panel-info\">\n                <b><?= htmlspecialchars($judge_name) ?></b> ì‹¬ì‚¬ìœ„ì›ë‹˜ ì•ˆë…•í•˜ì„¸ìš”.<br>\n                (ID: <?= htmlspecialchars($judge_id) ?>)\n            </div>\n            <div>\n                <ul>\n                    <li>ì‹¬ì‚¬ ì±„ì ì€ ì•„ë˜ \"ì±„ì  í˜ì´ì§€ë¡œ ì´ë™\" ë²„íŠ¼ì„ ëˆŒëŸ¬ ì§„í–‰í•˜ì„¸ìš”.</li>\n                    <li>ëŒ€íšŒ ì¤‘ì—ëŠ” ì±„ì  ê²°ê³¼ê°€ ì‹¤ì‹œê°„ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤.</li>\n                    <li>ì±„ì ì´ ëë‚œ í›„ ë°˜ë“œì‹œ <b>ë¡œê·¸ì•„ì›ƒ</b> í•´ì£¼ì„¸ìš”.</li>\n                </ul>\n            </div>\n            <div class=\"panel-nav\">\n                <a href=\"judge_scoring.php\">ì±„ì  í˜ì´ì§€ë¡œ ì´ë™</a>\n            </div>\n            <form method=\"get\" action=\"judge_panel.php\">\n                <button type=\"submit\" name=\"logout\" value=\"1\" class=\"logout-btn\">ë¡œê·¸ì•„ì›ƒ</button>\n            </form>\n        </section>\n    </main>\n</body>\n</html>","size_bytes":2452},"comp/judge_scoring.php":{"content":"<?php\nsession_start();\n\n$comp_id = $_GET['comp_id'] ?? '';\n$event_no = $_GET['event_no'] ?? '';\n$judge_code = $_GET['judge_code'] ?? '';\n$admin_mode = $_GET['admin_mode'] ?? '';\n\n// ë””ë²„ê·¸: URL íŒŒë¼ë¯¸í„° í™•ì¸\nerror_log(\"URL Parameters: comp_id='{$comp_id}', event_no='{$event_no}', judge_code='{$judge_code}', admin_mode='{$admin_mode}'\");\n\n// Remove BOM and normalize - multiple methods\n$comp_id = preg_replace('/\\x{FEFF}/u', '', $comp_id);\n$event_no = preg_replace('/\\x{FEFF}/u', '', $event_no);\n\n// Additional BOM removal\n$comp_id = str_replace([\"\\xEF\\xBB\\xBF\", \"\\xFEFF\", \"\\uFEFF\"], '', $comp_id);\n$event_no = str_replace([\"\\xEF\\xBB\\xBF\", \"\\xFEFF\", \"\\uFEFF\"], '', $event_no);\n\n// Remove any non-printable characters\n$comp_id = preg_replace('/[\\x00-\\x1F\\x7F-\\x9F]/', '', $comp_id);\n$event_no = preg_replace('/[\\x00-\\x1F\\x7F-\\x9F]/', '', $event_no);\n\n$comp_id = preg_replace('/[^\\d-]/', '', $comp_id);\n$event_no = preg_replace('/[^0-9\\-]/', '', $event_no); // í•˜ì´í”ˆ í—ˆìš©\n\n\n// Language setting\n$lang = $_GET['lang'] ?? 'ko';\nif (!in_array($lang, ['ko', 'en', 'zh', 'ja'])) {\n    $lang = 'ko';\n}\n\n// Language texts\n$texts = [\n    'ko' => [\n        'title' => 'ì‹¬ì‚¬ìœ„ì› ì±„ì  ì‹œìŠ¤í…œ',\n        'judge_info' => 'ì‹¬ì‚¬ìœ„ì›',\n        'event_info' => 'ì´ë²¤íŠ¸ ì •ë³´',\n        'event_no' => 'ì´ë²¤íŠ¸ ë²ˆí˜¸',\n        'round' => 'ë¼ìš´ë“œ',\n        'dances' => 'ì¢…ëª©',\n        'players' => 'ì¶œì „ ì„ ìˆ˜',\n        'place' => 'ìˆœìœ„',\n        'couple' => 'ì„ ìˆ˜',\n        'submit' => 'ì œì¶œ',\n        'no_data' => 'ì´ë²¤íŠ¸ ë°ì´í„° ë˜ëŠ” ì„ ìˆ˜ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.',\n        'invalid_data' => 'ì˜ëª»ëœ ëŒ€íšŒ ID ë˜ëŠ” ì´ë²¤íŠ¸ ë²ˆí˜¸ì…ë‹ˆë‹¤.'\n    ],\n    'en' => [\n        'title' => 'Judge Scoring System',\n        'judge_info' => 'Judge',\n        'event_info' => 'Event Information',\n        'event_no' => 'Event Number',\n        'round' => 'Round',\n        'dances' => 'Dances',\n        'players' => 'Competitors',\n        'place' => 'Place',\n        'couple' => 'Couple',\n        'submit' => 'Submit',\n        'no_data' => 'Event data or player data not found.',\n        'invalid_data' => 'Invalid competition ID or event number.'\n    ],\n    'zh' => [\n        'title' => 'è¯„å§”è¯„åˆ†ç³»ç»Ÿ',\n        'judge_info' => 'è¯„å§”',\n        'event_info' => 'èµ›äº‹ä¿¡æ¯',\n        'event_no' => 'èµ›äº‹ç¼–å·',\n        'round' => 'è½®æ¬¡',\n        'dances' => 'èˆç§',\n        'players' => 'å‚èµ›é€‰æ‰‹',\n        'place' => 'åæ¬¡',\n        'couple' => 'é€‰æ‰‹',\n        'submit' => 'æäº¤',\n        'no_data' => 'æ‰¾ä¸åˆ°èµ›äº‹æ•°æ®æˆ–é€‰æ‰‹æ•°æ®ã€‚',\n        'invalid_data' => 'æ— æ•ˆçš„æ¯”èµ›IDæˆ–èµ›äº‹ç¼–å·ã€‚'\n    ],\n    'ja' => [\n        'title' => 'å¯©æŸ»å“¡æ¡ç‚¹ã‚·ã‚¹ãƒ†ãƒ ',\n        'judge_info' => 'å¯©æŸ»å“¡',\n        'event_info' => 'ã‚¤ãƒ™ãƒ³ãƒˆæƒ…å ±',\n        'event_no' => 'ã‚¤ãƒ™ãƒ³ãƒˆç•ªå·',\n        'round' => 'ãƒ©ã‚¦ãƒ³ãƒ‰',\n        'dances' => 'ç¨®ç›®',\n        'players' => 'å‡ºå ´é¸æ‰‹',\n        'place' => 'é †ä½',\n        'couple' => 'é¸æ‰‹',\n        'submit' => 'æå‡º',\n        'no_data' => 'ã‚¤ãƒ™ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ã¾ãŸã¯é¸æ‰‹ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚',\n        'invalid_data' => 'ç„¡åŠ¹ãªå¤§ä¼šIDã¾ãŸã¯ã‚¤ãƒ™ãƒ³ãƒˆç•ªå·ã§ã™ã€‚'\n    ]\n];\n\n$t = $texts[$lang];\n\n// Check if judge is logged in (admin_mode bypass)\nif ($admin_mode === '1' && $judge_code) {\n    // Admin mode: ì‹¬ì‚¬ìœ„ì› ì •ë³´ë¥¼ judge_codeë¡œ ì„¤ì •\n    $_SESSION['scoring_logged_in'] = true;\n    $_SESSION['scoring_comp_id'] = $comp_id;\n    $_SESSION['scoring_judge_id'] = $judge_code;\n    $_SESSION['scoring_judge_name'] = \"ì‹¬ì‚¬ìœ„ì› #$judge_code\";\n    $_SESSION['scoring_judge_country'] = \"ê´€ë¦¬ì\";\n} elseif (!isset($_SESSION['scoring_logged_in']) || !$_SESSION['scoring_logged_in'] || $_SESSION['scoring_comp_id'] !== $comp_id) {\n    $lang = $_GET['lang'] ?? 'ko';\n    header(\"Location: scoring_login.php?comp_id=\" . urlencode($comp_id) . \"&lang=\" . urlencode($lang));\n    exit;\n}\n\nif (!$comp_id || !$event_no) {\n    echo \"<h1>\" . $t['invalid_data'] . \"</h1>\";\n    exit;\n}\n\n// Load event data\n$data_dir = __DIR__ . \"/data/$comp_id\";\n$runorder_file = \"$data_dir/RunOrder_Tablet.txt\";\n$players_file = \"$data_dir/players_$event_no.txt\";\n$round_info_file = \"$data_dir/round_info.json\";\n$dance_name_file = \"$data_dir/DanceName.txt\";\n\n$event_data = null;\n$players = [];\n$round_info = null;\n$hits_data = null;\n$dance_mapping = [];\n\n// Load dance name mapping\nif (file_exists($dance_name_file)) {\n    $lines = file($dance_name_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        $line = preg_replace('/\\x{FEFF}/u', '', $line);\n        $cols = array_map('trim', explode(',', $line));\n        if (count($cols) >= 3 && !empty($cols[1]) && is_numeric($cols[0])) {\n            $dance_mapping[$cols[0]] = $cols[1]; // number => full name\n        }\n    }\n    error_log(\"Dance mapping loaded: \" . json_encode($dance_mapping));\n} else {\n    error_log(\"DanceName.txt file not found: \" . $dance_name_file);\n}\n\n// Fallback dance mapping if file loading fails\nif (empty($dance_mapping)) {\n    $dance_mapping = [\n        '1' => 'Waltz',\n        '2' => 'Tango', \n        '3' => 'Viennese Waltz',\n        '4' => 'Slow Foxtrot',\n        '5' => 'Quickstep',\n        '6' => 'Cha Cha Cha',\n        '7' => 'Samba',\n        '8' => 'Rumba',\n        '9' => 'Paso Doble',\n        '10' => 'Jive'\n    ];\n    error_log(\"Using fallback dance mapping: \" . json_encode($dance_mapping));\n}\n\n// Function to convert dance numbers to full names\nfunction getDanceNames($dances, $dance_mapping) {\n    $result = [];\n    foreach ($dances as $dance) {\n        $dance = trim($dance);\n        if (isset($dance_mapping[$dance])) {\n            $result[] = $dance_mapping[$dance];\n        } else {\n            $result[] = $dance; // fallback to original if not found\n        }\n    }\n    return $result;\n}\n\n// Function to load existing selected numbers from .adj files\nfunction loadExistingSelections($comp_id, $event_no, $judge_id, $dances) {\n    $data_dir = __DIR__ . \"/data/$comp_id\";\n    $selections = [];\n    \n    foreach ($dances as $dance) {\n        $adj_file = \"$data_dir/{$event_no}_{$dance}_{$judge_id}.adj\";\n        if (file_exists($adj_file)) {\n            $lines = file($adj_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n            $dance_selections = [];\n    foreach ($lines as $line) {\n                $line = preg_replace('/\\x{FEFF}/u', '', $line);\n                $line = trim($line, '\"');\n                if (!empty($line)) {\n                    $dance_selections[] = $line;\n                }\n            }\n            $selections[$dance] = $dance_selections;\n        }\n    }\n    \n    return $selections;\n}\n\n// Load event information\nif (file_exists($runorder_file)) {\n    $lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        // Remove BOM from line - multiple methods\n        $line = preg_replace('/\\x{FEFF}/u', '', $line);\n        $line = str_replace([\"\\xEF\\xBB\\xBF\", \"\\xFEFF\", \"\\uFEFF\"], '', $line);\n        $line = preg_replace('/[\\x00-\\x1F\\x7F-\\x9F]/', '', $line);\n        \n        if (preg_match('/^bom/', $line)) continue;\n        $cols = array_map('trim', explode(',', $line));\n        \n        // ì´ë²¤íŠ¸ ë²ˆí˜¸ ë§¤ì¹­ (ì„¸ë¶€ë²ˆí˜¸ ìš°ì„ )\n        $file_event_no = $cols[0] ?? '';\n        $detail_no = $cols[13] ?? ''; // 14ë²ˆì§¸ ì»¬ëŸ¼ (ì¸ë±ìŠ¤ 13)\n        \n        // ì„¸ë¶€ë²ˆí˜¸ê°€ ìˆìœ¼ë©´ ì„¸ë¶€ë²ˆí˜¸ë¡œ, ì—†ìœ¼ë©´ ê¸°ë³¸ ì´ë²¤íŠ¸ ë²ˆí˜¸ë¡œ ë§¤ì¹­\n        $match_event_no = !empty($detail_no) ? $detail_no : preg_replace('/\\D+/', '', $file_event_no);\n        \n        // ë””ë²„ê·¸: ì´ë²¤íŠ¸ ë§¤ì¹­ í™•ì¸\n        error_log(\"Matching: file_event_no='{$file_event_no}', detail_no='{$detail_no}', match_event_no='{$match_event_no}', target_event_no='{$event_no}'\");\n        \n        // ì´ë²¤íŠ¸ ë²ˆí˜¸ ë§¤ì¹­ (ë‹¤ì–‘í•œ ë°©ì‹ìœ¼ë¡œ ë§¤ì¹­)\n        $is_match = false;\n        \n        // 1. ì •í™•í•œ ë§¤ì¹­\n        if ($match_event_no === $event_no || $file_event_no === $event_no) {\n            $is_match = true;\n        }\n        \n        // 2. ì„¸ë¶€ë²ˆí˜¸ê°€ ìˆëŠ” ê²½ìš° ì„¸ë¶€ë²ˆí˜¸ë¡œ ë§¤ì¹­\n        if (!empty($detail_no) && $detail_no === $event_no) {\n            $is_match = true;\n        }\n        \n        // 3. ê¸°ë³¸ ì´ë²¤íŠ¸ ë²ˆí˜¸ë¡œ ë§¤ì¹­ (ì„¸ë¶€ë²ˆí˜¸ê°€ ì—†ëŠ” ê²½ìš°)\n        if (empty($detail_no) && preg_replace('/\\D+/', '', $file_event_no) === preg_replace('/\\D+/', '', $event_no)) {\n            $is_match = true;\n        }\n        \n        if ($is_match) {\n            $event_data = [\n                'no' => $file_event_no,\n                'detail_no' => $detail_no,\n                'name' => $cols[1],\n                'round_type' => $cols[2],\n                'round_num' => $cols[3],\n                'recall_count' => intval($cols[4] ?? 0), // 5th column (index 4) is recall count\n                'dances' => []\n            ];\n            for ($i = 6; $i <= 10; $i++) {\n                if (!empty($cols[$i])) $event_data['dances'][] = $cols[$i];\n            }\n            break;\n        }\n    }\n}\n\n// Load players - 30ë²ˆ ì´ë²¤íŠ¸ëŠ” í•˜ë“œì½”ë”©ëœ ì„ ìˆ˜ ëª©ë¡ ì‚¬ìš©\nif ($event_no === '30') {\n    error_log(\"Using hardcoded players for event 30\");\n    $players = ['11', '12', '13', '14', '15', '16', '17', '18', '19', '95', '21', '22'];\n    // ë“±ë²ˆí˜¸ ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬\n    sort($players, SORT_NUMERIC);\n    error_log(\"Hardcoded players: \" . json_encode($players));\n} else {\n    // ì„¸ë¶€ë²ˆí˜¸ê°€ ìˆìœ¼ë©´ ì„¸ë¶€ë²ˆí˜¸ íŒŒì¼ ì‚¬ìš©\n    if ($event_data && !empty($event_data['detail_no'])) {\n        $players_file = \"$data_dir/players_{$event_data['detail_no']}.txt\";\n    }\n\n    if (file_exists($players_file)) {\n        error_log(\"Loading players from: {$players_file}\");\n        $content = file_get_contents($players_file);\n        error_log(\"Raw file content: \" . $content);\n        \n        $lines = file($players_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n        error_log(\"Players file lines: \" . count($lines));\n        \n        foreach ($lines as $line) {\n            // Remove BOM from line - multiple methods\n            $line = preg_replace('/\\x{FEFF}/u', '', $line);\n            $line = str_replace([\"\\xEF\\xBB\\xBF\", \"\\xFEFF\", \"\\uFEFF\"], '', $line);\n            $line = preg_replace('/[\\x00-\\x1F\\x7F-\\x9F]/', '', $line);\n            $line = trim($line);\n            error_log(\"Processing line: '{$line}'\");\n            \n            if ($line && is_numeric($line)) {\n                $players[] = $line;\n                error_log(\"Added player: {$line}\");\n        } else {\n                error_log(\"Skipped line (not numeric): '{$line}'\");\n            }\n        }\n        // ë“±ë²ˆí˜¸ ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬\n        sort($players, SORT_NUMERIC);\n        error_log(\"Total players loaded: \" . count($players));\n        error_log(\"Players array: \" . json_encode($players));\n    } else {\n        error_log(\"Players file not found: {$players_file}\");\n    }\n}\n\n// Calculate round display from RunOrder_Tablet.txt data\nfunction calculateRoundDisplayFromRunOrder($event_data, $runorder_file) {\n    if (!file_exists($runorder_file)) {\n        return 'Final'; // Default to Final if no data\n    }\n    \n    $lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    $all_events = [];\n    \n    foreach ($lines as $line) {\n        $line = preg_replace('/\\x{FEFF}/u', '', $line);\n        $line = str_replace([\"\\xEF\\xBB\\xBF\", \"\\xFEFF\", \"\\uFEFF\"], '', $line);\n        $line = preg_replace('/[\\x00-\\x1F\\x7F-\\x9F]/', '', $line);\n        \n        if (preg_match('/^bom/', $line)) continue;\n        $cols = array_map('trim', explode(',', $line));\n        \n        // Check if it's a competition event (has dances)\n        $has_dance = false;\n        for ($i = 6; $i <= 10; $i++) {\n            if (isset($cols[$i]) && $cols[$i] !== '') {\n                $has_dance = true;\n                break;\n            }\n        }\n        \n        if ($has_dance) {\n            $all_events[] = [\n                'no' => preg_replace('/\\x{FEFF}/u', '', $cols[0]),\n                'name' => $cols[1]\n            ];\n        }\n    }\n    \n    $event_name = $event_data['name'];\n    $event_no = $event_data['no'];\n    \n    // Find all events with same name\n    $same_name_events = array_filter($all_events, function($e) use ($event_name) {\n        return $e['name'] === $event_name;\n    });\n    \n    $total_events = count($same_name_events);\n    if ($total_events <= 1) {\n        return 'Final';\n    }\n    \n    // Sort by event number to get position\n    $sorted_events = array_values($same_name_events);\n    usort($sorted_events, function($a, $b) {\n        return intval($a['no']) - intval($b['no']);\n    });\n    \n    $position = 0;\n    foreach ($sorted_events as $idx => $evt) {\n        if ($evt['no'] === $event_no) {\n            $position = $idx;\n            break;\n        }\n    }\n    \n    // Calculate round display based on position and total\n    if ($total_events === 2) {\n        return $position === 0 ? 'Semi-Final' : 'Final';\n    } else if ($total_events === 3) {\n        if ($position === 0) return 'Round 1';\n        else if ($position === 1) return 'Semi-Final';\n        else return 'Final';\n    } else if ($total_events === 4) {\n        if ($position === 0) return 'Round 1';\n        else if ($position === 1) return 'Round 2';\n        else if ($position === 2) return 'Semi-Final';\n        else return 'Final';\n    } else if ($total_events === 5) {\n        if ($position === 0) return 'Round 1';\n        else if ($position === 1) return 'Round 2';\n        else if ($position === 2) return 'Round 3';\n        else if ($position === 3) return 'Semi-Final';\n        else return 'Final';\n        } else {\n        return ($position + 1) . '/' . $total_events;\n    }\n}\n\n// Use original round info from RunOrder_Tablet.txt first\n$round_display = $event_data['round_type'] ?? '';\nif (empty($round_display)) {\n    // Fallback to calculation if no original round info\n    $round_display = calculateRoundDisplayFromRunOrder($event_data, $runorder_file);\n}\n$is_final = ($round_display === 'Final');\n\n\n\n// Load hits data if exists\n$hits_file = \"$data_dir/players_hits_$event_no.json\";\nif (file_exists($hits_file)) {\n    $hits_data = json_decode(file_get_contents($hits_file), true);\n}\n\n// Load existing selections for all dances\n$existing_selections = [];\nif ($event_data && isset($event_data['dances'])) {\n    $existing_selections = loadExistingSelections($comp_id, $event_no, $_SESSION['scoring_judge_id'], $event_data['dances']);\n}\n\n// Load saved scores\n$saved_scores = null;\n$judge_id = $_SESSION['scoring_judge_id'] ?? 'unknown';\n\n// ë””ë²„ê·¸: ì‹¬ì‚¬ìœ„ì› ID í™•ì¸\nerror_log(\"Judge ID from session: '{$judge_id}', Event: '{$event_no}'\");\n\nif ($is_final) {\n    // Load final round scores - check individual dance files for this judge\n    $adj_files = glob(\"$data_dir/{$event_no}_*.adj\");\n    \n    // Also check for files with different event numbers but same judge (for compatibility)\n    $compat_files = glob(\"$data_dir/*_*_{$judge_id}.adj\");\n    $adj_files = array_merge($adj_files, $compat_files);\n    \n    // Debug: Log found files\n    error_log(\"Found adj files: \" . implode(', ', $adj_files));\n    $final_scores = [];\n    $saved_rankings = []; // Store actual ranking data for UI restoration\n    \n    foreach ($adj_files as $file) {\n        $filename = basename($file);\n        if (preg_match('/^(\\d+)_(.+)_(\\d+)\\.adj$/', $filename, $matches)) {\n            $file_event = $matches[1];\n            $file_dance = $matches[2];\n            $file_judge_id = $matches[3];\n            \n            // Check if this is for current judge and current event (or compatible event)\n            if ($file_judge_id === $judge_id && ($file_event === $event_no || $file_event === '1')) {\n                error_log(\"Loading file: $filename for dance: $file_dance\");\n                $final_scores[$file_dance] = true; // This judge has submitted for this dance\n                \n                // Load actual ranking data for UI restoration\n                $lines = file($file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n                $rankings = [];\n                \n    foreach ($lines as $line) {\n                    $line = trim($line);\n                    if (empty($line)) continue;\n                    \n                    if (strpos($line, ',') !== false) {\n                        // New format: player,rank\n                        list($player, $rank) = explode(',', $line, 2);\n                        $player = trim($player, '\"');\n                        $rank = intval(trim($rank));\n                        if (is_numeric($player) && $rank > 0) {\n                            $rankings[$rank] = $player;\n                        }\n        } else {\n                        // Old format: just player numbers (convert to rank 1,2,3...)\n                        $player = trim($line, '\"');\n                        if (is_numeric($player)) {\n                            $rankings[count($rankings) + 1] = $player;\n                        }\n                    }\n                }\n                \n                if (!empty($rankings)) {\n                    $saved_rankings[$file_dance] = $rankings;\n                }\n            }\n        }\n    }\n    \n    if (!empty($final_scores)) {\n        $saved_scores = $final_scores;\n    }\n    \n    // Debug: Log saved rankings\n    error_log(\"Judge ID: $judge_id, Event: $event_no, Saved rankings: \" . json_encode($saved_rankings));\n} else {\n    // Load recall scores for this judge\n    $adj_files = glob(\"$data_dir/{$event_no}_*.adj\");\n    $recall_scores = [];\n    \n    // ë””ë²„ê·¸: íŒŒì¼ ê²€ìƒ‰ ì •ë³´\n    error_log(\"Recall loading: event_no='{$event_no}', judge_id='{$judge_id}', found_files=\" . count($adj_files));\n    error_log(\"Event dances: \" . json_encode($event_data['dances']));\n    \n    foreach ($adj_files as $file) {\n        $filename = basename($file);\n        error_log(\"Checking file: {$filename}\");\n        \n        if (preg_match('/^(\\d+)_(\\d+)_(\\d+)\\.adj$/', $filename, $matches)) {\n            $file_dance = $matches[2];\n            $file_judge_id = $matches[3];\n            \n            error_log(\"File match: dance='{$file_dance}', judge_id='{$file_judge_id}', target_judge='{$judge_id}'\");\n            \n            // ëŒ„ìŠ¤ ë²ˆí˜¸ë¥¼ ë¬¸ìì—´ë¡œ ë³€í™˜í•˜ì—¬ ë§¤ì¹­\n            $dance_matches = false;\n            foreach ($event_data['dances'] as $event_dance) {\n                if ($file_dance == $event_dance) { // == ì‚¬ìš©í•˜ì—¬ íƒ€ì… ë¬´ì‹œ ë¹„êµ\n                    $dance_matches = true;\n                    break;\n                }\n            }\n            \n            if ($file_judge_id === $judge_id && $dance_matches) {\n                $lines = file($file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n                $players = [];\n                \n        foreach ($lines as $line) {\n                    $line = trim($line, '\"');\n                    if ($line && is_numeric($line)) {\n                        $players[] = $line;\n                    }\n                }\n                \n                $recall_scores[(string)$file_dance] = $players;\n                error_log(\"Loaded recall scores for dance '{$file_dance}': \" . json_encode($players));\n            }\n        }\n    }\n    \n    if (!empty($recall_scores)) {\n        $saved_scores = $recall_scores;\n        error_log(\"Final saved_scores: \" . json_encode($saved_scores));\n    } else {\n        error_log(\"No recall scores found for event '{$event_no}' and judge '{$judge_id}'\");\n    }\n}\n\nif (!$event_data || empty($players)) {\n    echo \"<h1>\" . $t['no_data'] . \"</h1>\";\n    echo \"<p>comp_id: '$comp_id', event_no: '$event_no'</p>\";\n    echo \"<p>runorder_file: \" . (file_exists($runorder_file) ? 'exists' : 'not found') . \"</p>\";\n    echo \"<p>players_file: \" . (file_exists($players_file) ? 'exists' : 'not found') . \"</p>\";\n    echo \"<p>event_data: \" . ($event_data ? 'found' : 'not found') . \"</p>\";\n    echo \"<p>players count: \" . count($players) . \"</p>\";\n    if ($event_data) {\n        echo \"<p>event_data details: \" . print_r($event_data, true) . \"</p>\";\n    }\n    exit;\n}\n\nfunction h($s) { return htmlspecialchars($s ?? ''); }\n?>\n<!DOCTYPE html>\n<html lang=\"<?=h($lang)?>\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title><?=h($t['title'])?> | <?=h($event_data['name'])?></title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\n    <style>\n        body { background:#1a1a1a; font-family:sans-serif; margin:0; padding:2px;}\n        .scoring-container { max-width:100%; margin:0; background:#fff; border-radius:8px; padding:15px; box-shadow:0 2px 10px rgba(0,0,0,0.3);}\n        h1 { color:#003399; margin-bottom:20px; text-align:center;}\n        .event-info { background:#f0f4ff; padding:15px; border-radius:8px; margin-bottom:20px; text-align:center;}\n        .event-info h2 { margin:0 0 10px 0; color:#0d2c96;}\n        .event-info p { margin:5px 0; color:#333;}\n        .adjudicator-section { margin-bottom:10px;}\n        .adjudicator-header { background:#003399; color:#fff; padding:10px 15px; border-radius:6px 6px 0 0; font-weight:bold;}\n        .scoring-table { width:100%; border-collapse:collapse; background:#fff; border:1px solid #ddd;}\n        .scoring-table th, .scoring-table td { padding:12px 8px; text-align:center; border:1px solid #ddd;}\n        .scoring-table th { background:#f8f9fa; font-weight:bold; color:#333;}\n        .scoring-table tr:nth-child(even) { background:#f8f9fa;}\n        .place-input { width:60px; padding:8px; border:2px solid #ddd; border-radius:4px; text-align:center; font-size:16px; font-weight:bold;}\n        .place-input:focus { border-color:#003399; outline:none;}\n        .couple-info { text-align:left; font-weight:bold; color:#333;}\n        .submit-section { text-align:center; margin-top:30px;}\n        .submit-btn { background:#03C75A; color:#fff; border:none; padding:15px 30px; font-size:16px; font-weight:bold; border-radius:8px; cursor:pointer; margin:0 10px;}\n        .submit-btn:hover { background:#00BFAE;}\n        .clear-btn { background:#FF6B35; color:#fff; border:none; padding:15px 30px; font-size:16px; font-weight:bold; border-radius:8px; cursor:pointer; margin:0 10px;}\n        .clear-btn:hover { background:#E55A2B;}\n        .warning { background:#fff3cd; border:1px solid #ffeaa7; color:#856404; padding:10px; border-radius:4px; margin-bottom:20px;}\n        .error { background:#f8d7da; border:1px solid #f5c6cb; color:#721c24; padding:10px; border-radius:4px; margin-bottom:20px;}\n        .success { background:#d4edda; border:1px solid #c3e6cb; color:#155724; padding:10px; border-radius:4px; margin-bottom:20px;}\n        .rules-info { background:#e7f3ff; border:1px solid #b3d9ff; color:#004085; padding:15px; border-radius:6px; margin-bottom:20px;}\n        .rules-info h3 { margin:0 0 10px 0; color:#003399;}\n        .rules-info ul { margin:10px 0; padding-left:20px;}\n        .rules-info li { margin:5px 0;}\n        \n        /* Final Round Styles - Touch-based System */\n        .final-scoring-container {\n            display: flex;\n            gap: 15px;\n            padding: 15px;\n            background: #fff;\n            border: 3px solid #003399;\n            border-radius: 8px;\n            min-height: 450px;\n            box-shadow: 0 4px 12px rgba(0, 51, 153, 0.15);\n        }\n        \n        .players-column, .ranking-column {\n            flex: 1;\n            background: #f8f9fa;\n            border: 2px solid #e9ecef;\n            border-radius: 8px;\n            padding: 12px;\n            box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n            display: flex;\n            flex-direction: column;\n        }\n        \n        .players-column h3, .ranking-column h3 {\n            margin: 0 0 8px 0;\n            color: #333;\n            font-size: 16px;\n            text-align: center;\n            padding-bottom: 6px;\n            border-bottom: 2px solid #003399;\n        }\n        \n        .players-list,         .ranking-list {\n            display: flex;\n            flex-direction: column;\n            gap: 12px; /* Increased gap for better spacing */\n            flex: 1;\n            overflow-y: auto;\n            padding-left: 10px; /* Add left padding for rank labels */\n        }\n        \n        .player-item {\n            background: #003399;\n            color: #fff;\n            padding: 16px 12px; /* Reduced horizontal padding */\n            border-radius: 8px;\n            text-align: center;\n            font-size: 18px; /* Slightly smaller font */\n            font-weight: bold;\n            cursor: pointer;\n            transition: all 0.3s ease;\n            user-select: none;\n            min-height: 60px;\n            height: 60px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n        }\n        \n        .player-item:hover {\n            background: #002266;\n            transform: translateY(-2px);\n            box-shadow: 0 4px 8px rgba(0,0,0,0.2);\n        }\n        \n        .player-item.selected {\n            background: #28a745;\n            transform: scale(1.05);\n            box-shadow: 0 6px 12px rgba(40, 167, 69, 0.3);\n        }\n        \n        .player-item.assigned {\n            opacity: 0.3;\n            background: #6c757d;\n            cursor: not-allowed;\n        }\n        \n        .ranking-slot {\n            background: #fff;\n            border: 2px solid #ddd;\n            border-radius: 8px;\n            padding: 16px 12px; /* Reduced horizontal padding */\n            text-align: center;\n            cursor: pointer;\n            transition: all 0.3s ease;\n            min-height: 60px;\n            height: 60px;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n            position: relative;\n            margin-left: 20px; /* Add left margin for rank label */\n        }\n        \n        .ranking-slot::before {\n            content: attr(data-rank) \"ìœ„\";\n            position: absolute;\n            top: 50%;\n            left: -15px;\n            transform: translateY(-50%);\n            background: #003399;\n            color: #fff;\n            padding: 4px 8px;\n            border-radius: 12px;\n            font-size: 12px;\n            font-weight: bold;\n            z-index: 10;\n            white-space: nowrap;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n        }\n        \n        .ranking-slot:hover {\n            border-color: #003399;\n            background: #f8f9ff;\n        }\n        \n        .ranking-slot.assigned {\n            border-color: #28a745;\n            background: #f8fff9;\n            cursor: pointer;\n        }\n        \n        .ranking-slot.assigned:hover {\n            border-color: #dc3545;\n            background: #fff5f5;\n        }\n        \n        .ranking-slot.assigned:hover .player-assigned {\n            color: #dc3545;\n        }\n        \n        .ranking-slot.dragging {\n            opacity: 0.5;\n            transform: rotate(5deg);\n            border-color: #ffc107;\n            background: #fff3cd;\n        }\n        \n        .ranking-slot.drag-over {\n            border-color: #007bff;\n            background: #e3f2fd;\n            transform: scale(1.05);\n        }\n        \n        .player-assigned {\n            font-size: 20px;\n            font-weight: bold;\n            color: #28a745;\n            min-height: 24px;\n        }\n        \n        .final-actions {\n            text-align: center;\n            margin-top: 20px;\n            padding: 20px;\n        }\n        \n        /* Dance Progress Styles for Final Round */\n        .dance-progress-header .dance-progress {\n            display: flex;\n            justify-content: center;\n            gap: 10px;\n            flex-wrap: wrap;\n        }\n        \n        .dance-step {\n            padding: 8px 16px;\n            border-radius: 20px;\n            font-size: 14px;\n            font-weight: bold;\n            transition: all 0.3s ease;\n            cursor: pointer;\n            border: 2px solid #ddd;\n            background: #fff;\n            color: #666;\n        }\n        \n        .dance-step.current {\n            background: #003399;\n            color: #fff;\n            border-color: #003399;\n        }\n        \n        .dance-step.completed {\n            background: #28a745;\n            color: #fff;\n            border-color: #28a745;\n        }\n        \n        .dance-step.pending {\n            background: #f8f9fa;\n            color: #6c757d;\n            border-color: #dee2e6;\n        }\n        \n        .dance-step:hover:not(.pending) {\n            transform: translateY(-2px);\n            box-shadow: 0 4px 8px rgba(0,0,0,0.2);\n        }\n        \n        .btn {\n            padding: 12px 24px;\n            border: none;\n            border-radius: 6px;\n            cursor: pointer;\n            font-size: 14px;\n            font-weight: 600;\n            transition: all 0.2s;\n            margin: 5px;\n        }\n        \n        .btn-primary {\n            background: #003399;\n            color: #fff;\n        }\n        \n        .btn-primary:hover {\n            background: #002266;\n        }\n        \n        .btn-secondary {\n            background: #6c757d;\n            color: #fff;\n        }\n        \n        .btn-secondary:hover {\n            background: #545b62;\n        }\n        \n        /* Instagram Style Dance Container */\n        .dance-container { position: relative; overflow: hidden; }\n        \n        .dance-progress {\n    display: flex;\n    align-items: center;\n            margin-bottom: 20px;\n            padding: 0 20px;\n        }\n        \n        .progress-bar {\n            flex: 1;\n            height: 6px;\n            background: #e0e0e0;\n            border-radius: 3px;\n            margin-right: 15px;\n            overflow: hidden;\n        }\n        \n        .progress-fill {\n            height: 100%;\n            background: linear-gradient(90deg, #4CAF50, #2e7d32);\n            border-radius: 3px;\n            transition: width 0.3s ease;\n        }\n        \n        .progress-text {\n            font-size: 14px;\n            font-weight: bold;\n            color: #666;\n            white-space: nowrap;\n        }\n        \n        .dance-slider {\n    display: flex;\n            transition: transform 0.3s ease;\n        }\n        \n        .dance-page {\n            min-width: 100%;\n            padding: 0 20px;\n            box-sizing: border-box;\n        }\n        \n        .dance-header { \n            background:#4CAF50; \n            color:#fff; \n            padding:10px; \n            border-radius:6px; \n            margin-bottom:15px; \n            text-align:center;\n        }\n        .dance-header h3 { margin:0 0 5px 0; font-size:16px;}\n        .dance-header p { margin:0; font-size:12px; opacity:0.9;}\n        \n        /* Heat section styles */\n        .heat-section { margin-bottom:15px; padding:10px; background:#fff; border-radius:6px; border:1px solid #ddd;}\n        .heat-section h4 { margin:0 0 10px 0; color:#333; font-size:14px; text-align:center;}\n        \n        /* Players grid styles - Mobile optimized */\n        .players-grid { \n            display:grid; \n            grid-template-columns:repeat(auto-fill, minmax(60px, 1fr)); \n            gap:4px; \n            margin-bottom:15px;\n        }\n        .player-card { \n            background:#fff; \n            border:2px solid #ddd; \n            border-radius:6px; \n            padding:6px 2px; \n            text-align:center; \n            cursor:pointer; \n            transition:all 0.3s ease;\n            position:relative;\n            min-height:50px;\n            display:flex;\n            flex-direction:column;\n            justify-content:center;\n            align-items:center;\n        }\n        .player-card:hover { \n            border-color:#4CAF50; \n            transform:translateY(-2px); \n            box-shadow:0 4px 8px rgba(0,0,0,0.15);\n        }\n        .player-card.selected { \n            border-color:#4CAF50; \n            background:linear-gradient(135deg, #e8f5e8, #c8e6c9);\n            transform:scale(1.05);\n            box-shadow:0 6px 12px rgba(76, 175, 80, 0.3);\n        }\n        .player-number { \n            font-size:24px; \n            font-weight:900; \n            color:#333;\n            margin:0;\n            line-height:1;\n        }\n        .player-card.selected .player-number {\n            color:#2e7d32;\n        }\n        .recall-checkbox { \n            display:none; /* Hide checkbox, use card click instead */\n        }\n        \n        /* Recall status - Large and clear */\n        .recall-status { \n            text-align:center; \n            padding:15px; \n            background:#f0f0f0; \n            border-radius:8px; \n            font-weight:bold; \n            color:#333;\n            font-size:16px;\n            margin:15px 0;\n            border:2px solid #ddd;\n        }\n        .recall-status.complete { \n            background:linear-gradient(135deg, #d4edda, #c3e6cb); \n            color:#155724; \n            border:3px solid #28a745;\n            animation:pulse 2s infinite;\n        }\n        .recall-status.over { \n            background:linear-gradient(135deg, #f8d7da, #f5c6cb); \n            color:#721c24; \n            border:3px solid #dc3545;\n        }\n        .recall-status .selected-count {\n            font-size:24px;\n            font-weight:900;\n        }\n        \n        @keyframes pulse {\n            0% { transform: scale(1); }\n            50% { transform: scale(1.02); }\n            100% { transform: scale(1); }\n        }\n        \n        /* Drag and drop for final ranking */\n        .ranking-container { display:flex; flex-direction:column; gap:10px; margin:20px 0;}\n        .ranking-item { \n            display:flex; \n            align-items:center; \n            background:#fff; \n            border:2px solid #ddd; \n            border-radius:8px; \n            padding:15px; \n            cursor:move;\n            transition:all 0.3s ease;\n            user-select:none;\n        }\n        .ranking-item:hover { border-color:#4CAF50; transform:translateY(-2px); box-shadow:0 4px 8px rgba(0,0,0,0.1);}\n        .ranking-item.dragging { opacity:0.5; transform:rotate(5deg);}\n        .ranking-number { \n            background:#4CAF50; \n            color:#fff; \n            width:40px; \n            height:40px; \n            border-radius:50%; \n            display:flex; \n            align-items:center; \n            justify-content:center; \n            font-weight:bold; \n            margin-right:15px;\n            flex-shrink:0;\n        }\n        .ranking-player { \n            flex:1; \n            font-size:18px; \n            font-weight:bold; \n            color:#333;\n        }\n        .ranking-place-input { \n            width:60px; \n            padding:8px; \n            border:2px solid #ddd; \n            border-radius:4px; \n            text-align:center; \n            font-size:16px; \n            font-weight:bold;\n            margin-left:15px;\n        }\n        .ranking-place-input:focus { border-color:#4CAF50; outline:none;}\n        \n        /* Fixed Progress Bar for Mobile */\n        .fixed-progress {\n            position: fixed;\n            top: 0;\n            left: 0;\n            right: 0;\n            background: linear-gradient(135deg, #ff9800, #ff5722);\n            color: white;\n            padding: 12px 20px;\n            text-align: center;\n            font-size: 18px;\n            font-weight: bold;\n            z-index: 1000;\n            box-shadow: 0 2px 10px rgba(0,0,0,0.3);\n            transform: translateY(-100%);\n            transition: transform 0.3s ease;\n        }\n        .fixed-progress.show {\n            transform: translateY(0);\n        }\n        .fixed-progress.complete {\n            background: linear-gradient(135deg, #4CAF50, #2e7d32);\n        }\n        .fixed-progress.over {\n            background: linear-gradient(135deg, #f44336, #d32f2f);\n        }\n        \n        /* Add top padding to body when progress bar is shown */\n        body.progress-bar-visible {\n            padding-top: 60px;\n        }\n        \n        /* Bottom Navigation */\n        .bottom-nav {\n            position: fixed;\n            bottom: 0;\n            left: 0;\n            right: 0;\n            background: #fff;\n            border-top: 2px solid #e0e0e0;\n            padding: 10px 20px;\n            display: flex;\n            justify-content: space-around;\n    align-items: center;\n            z-index: 1000;\n            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);\n        }\n        \n        .nav-button {\n            background: #f5f5f5;\n            color: #333;\n            border: none;\n            padding: 12px 20px;\n            border-radius: 8px;\n            cursor: pointer;\n            font-size: 14px;\n            font-weight: bold;\n            transition: all 0.3s ease;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            gap: 4px;\n            min-width: 80px;\n        }\n        \n        .nav-button:hover {\n            background: #e0e0e0;\n            transform: translateY(-2px);\n        }\n        \n        .nav-button.primary {\n            background: #2196F3;\n            color: #fff;\n        }\n        \n        .nav-button.primary:hover {\n            background: #1976D2;\n        }\n        \n        .nav-icon {\n            font-size: 18px;\n        }\n        \n        .nav-text {\n            font-size: 12px;\n        }\n        \n        /* Add bottom padding to body for navigation */\n        body {\n            padding-bottom: 80px;\n        }\n        \n        /* Tablet responsive - Optimized for tablet screens */\n        @media (min-width: 769px) and (max-width: 1024px) {\n            .event-info {\n                padding: 3px !important;\n                margin-bottom: 2px !important;\n            }\n            \n            .event-info h1 {\n                font-size: 16px !important;\n                margin-bottom: 1px !important;\n            }\n            \n            .event-info p {\n                font-size: 11px !important;\n            }\n            \n            .saved-scores-info {\n                padding: 4px !important;\n                margin-bottom: 6px !important;\n            }\n            \n            .saved-scores-info h3 {\n                font-size: 12px !important;\n                margin-bottom: 2px !important;\n            }\n            \n            .dance-progress-header {\n                padding: 3px !important;\n                margin-bottom: 4px !important;\n            }\n            \n            .dance-progress-header h3 {\n                font-size: 12px !important;\n                margin-bottom: 1px !important;\n            }\n            \n            .final-scoring-container {\n                gap: 10px;\n                padding: 10px;\n                min-height: 380px;\n            }\n            \n            .players-column, .ranking-column {\n                padding: 8px;\n            }\n            \n            .players-column h3, .ranking-column h3 {\n                font-size: 14px;\n                margin-bottom: 6px;\n            }\n            \n            .players-list, .ranking-list {\n                gap: 8px;\n            }\n            \n            .player-item, .ranking-slot {\n                padding: 12px 16px;\n                font-size: 16px;\n                min-height: 50px;\n                height: 50px;\n            }\n            \n            .ranking-slot::before {\n                font-size: 10px;\n                padding: 2px 6px;\n            }\n        }\n        \n        /* Mobile responsive - Optimized for touch */\n        @media (max-width: 768px) {\n            .final-scoring-container {\n                flex-direction: row; /* ì¢Œìš° ë°°ì¹˜ ìœ ì§€ */\n                gap: 10px;\n                padding: 10px;\n                min-height: 400px;\n            }\n            \n            .players-column, .ranking-column {\n                min-height: 350px;\n                flex: 1;\n            }\n            \n            .player-item, .ranking-slot {\n                padding: 12px;\n                font-size: 16px;\n                min-height: 45px;\n                height: 45px;\n            }\n            \n            .ranking-slot::before {\n                font-size: 10px;\n                padding: 2px 6px;\n                top: 50%;\n                left: -12px;\n                transform: translateY(-50%);\n            }\n            \n            .ranking-slot {\n                margin-left: 15px; /* Smaller margin for mobile */\n            }\n            \n            .player-assigned {\n                font-size: 16px;\n            }\n            \n            .players-grid { \n                grid-template-columns:repeat(auto-fill, minmax(50px, 1fr)); \n                gap:4px;\n                margin-bottom:10px;\n            }\n            .player-card { \n                padding:4px 2px;\n                min-height:45px;\n                border-width:2px;\n            }\n            .player-number { \n                font-size:20px;\n            }\n            .dance-header h3 { \n                font-size:14px;\n            }\n            .dance-header p {\n                font-size:12px;\n            }\n            .recall-status {\n                padding:15px;\n                font-size:16px;\n                margin:15px 0;\n            }\n            .recall-status .selected-count {\n                font-size:20px;\n            }\n            .ranking-item { \n                padding:10px;\n                flex-direction:column;\n                gap:8px;\n            }\n            .ranking-number { \n                width:35px; \n                height:35px; \n                margin-right:0;\n                margin-bottom:5px;\n            }\n            .ranking-player { \n                font-size:16px;\n                text-align:center;\n            }\n            .ranking-place-input {\n                width:50px;\n                margin-left:0;\n            }\n        }\n        \n        @media (max-width: 480px) {\n            .players-grid { \n                grid-template-columns:repeat(auto-fill, minmax(55px, 1fr)); \n                gap:5px;\n            }\n            .player-card { \n                padding:5px 2px;\n                min-height:45px;\n            }\n            .player-number { \n                font-size:22px;\n            }\n            .recall-status {\n                padding:12px;\n                font-size:14px;\n            }\n            .recall-status .selected-count {\n                font-size:18px;\n            }\n        }\n    </style>\n</head>\n<body>\n<div class=\"scoring-container\">\n    <?php \n    // Use the already calculated values\n    $is_preliminary = !$is_final;\n    $recall_count = $event_data['recall_count'] ?? 0;\n    ?>\n\n    <!-- Judge Info and Recall in One Line -->\n    <div style=\"margin-bottom:15px; text-align:center; padding:10px; background:#f8f9fa; border-radius:6px;\">\n        <div style=\"display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:10px;\">\n            <div style=\"font-size:14px; font-weight:bold; color:#333;\">\n                #<?=h($_SESSION['scoring_judge_id'])?> <?=h($_SESSION['scoring_judge_name'])?>(<?=h($_SESSION['scoring_judge_country'])?>)\n            </div>\n            <?php if (!$is_final && $event_no !== '8'): ?>\n            <div style=\"font-size:16px; font-weight:bold; color:#ff9800;\">\n                Recall <span id=\"recallProgress\">0</span> / <?= $recall_count ?>\n            </div>\n            <?php endif; ?>\n        </div>\n    </div>\n    \n    \n            <div class=\"event-info\" style=\"display:flex; justify-content:space-between; align-items:center; margin-bottom:2px; padding:4px; background:#f8f9fa; border-radius:4px;\">\n        <div style=\"flex:1;\">\n            <h1 style=\"margin:0 0 2px 0; color:#333; font-size:18px; font-weight:bold;\">\n                <?php\n                // ì´ë²¤íŠ¸ ì´ë¦„ ê²°ì • ë¡œì§\n                $event_name = '';\n                \n                // 1. ì´ë²¤íŠ¸ ë°ì´í„°ì—ì„œ ì´ë¦„ ê°€ì ¸ì˜¤ê¸°\n                if (!empty($event_data['name'])) {\n                    $event_name = $event_data['name'];\n                }\n                \n                // 2. ì´ë²¤íŠ¸ ë²ˆí˜¸ë³„ ë§¤í•‘ (ìš°ì„ ìˆœìœ„ ë†’ìŒ)\n                $event_names = [\n                    '20' => 'í”„ë¡œ-ì•” ì˜¤í”ˆ ë¼í‹´',\n                    '20-1' => 'í”„ë¡œ-ì•” ì˜¤í”ˆ ë¼í‹´ 1ì¢…ëª© (R)',\n                    '20-2' => 'í”„ë¡œ-ì•” ì˜¤í”ˆ ë¼í‹´ 2ì¢…ëª© (R S)',\n                    '30' => 'í”„ë¡œí˜ì…”ë„ ë¼í‹´',\n                    '28' => 'í”„ë¡œí˜ì…”ë„ ë¼í‹´',\n                    '52' => 'í”„ë¡œí˜ì…”ë„ ë¼í‹´',\n                    '31' => 'í”„ë¡œí˜ì…”ë„ ìŠ¤íƒ ë‹¤ë“œ',\n                    '51' => 'í”„ë¡œí˜ì…”ë„ ìŠ¤íƒ ë‹¤ë“œ'\n                ];\n                \n                // ì´ë²¤íŠ¸ ë°ì´í„°ê°€ ì—†ì–´ë„ ì´ë²¤íŠ¸ ë²ˆí˜¸ë¡œ ì´ë¦„ ê²°ì •\n                if (isset($event_names[$event_no])) {\n                    $event_name = $event_names[$event_no];\n                }\n                \n                // 3. ìµœì¢… fallback\n                if (empty($event_name)) {\n                    $event_name = 'ì´ë²¤íŠ¸ ' . $event_no;\n                }\n                \n                // ë””ë²„ê·¸: ì´ë²¤íŠ¸ ì´ë¦„ ê²°ì • ê³¼ì •\n                error_log(\"Event name decision: event_no='{$event_no}', event_data_name='{$event_data['name']}', final_name='{$event_name}'\");\n                \n                echo h($event_name);\n                ?>\n            </h1>\n            <?php \n            // Use the calculated round display\n            $dance_names = getDanceNames($event_data['dances'], $dance_mapping);\n            ?>\n            <p style=\"margin:0; font-size:11px; color:#666;\">\n                <?=h($round_display)?> (<?=h(implode(',', $dance_names))?>) | <?=count($players)?> couples<?php if ($hits_data && !empty($hits_data)): ?> / <?=count($hits_data)?> heats<?php endif; ?>\n            </p>\n        </div>\n                    </div>\n        <div style=\"text-align:right; font-size:11px; color:#666;\">\n            <div style=\"font-weight:bold; color:#2e7d32;\">\n                <?php if ($saved_scores): ?>\n                    ì™„ë£Œ: <?= implode(', ', array_keys($saved_scores)) ?>\n                <?php else: ?>\n                    ì±„ì  ì „ (ì‹¬ì‚¬ìœ„ì›: <?= $judge_id ?>, ì´ë²¤íŠ¸: <?= $event_no ?>)\n                <?php endif; ?>\n                    </div>\n        </div>\n                    </div>\n\n    \n\n    <div id=\"message\"></div>\n    \n    <!-- Fixed Progress Bar for Mobile (Preliminary/Recall only) -->\n    <?php if (!$is_final && $event_no !== '8'): ?>\n    <div id=\"fixedProgress\" class=\"fixed-progress\">\n        Recall <span id=\"fixedRecallCount\">0</span> / <?= $recall_count ?>\n                    </div>\n    <?php endif; ?>\n    \n\n    <form id=\"scoringForm\">\n        <input type=\"hidden\" name=\"comp_id\" value=\"<?=h($comp_id)?>\">\n        <input type=\"hidden\" name=\"event_no\" value=\"<?=h($event_no)?>\">\n        <input type=\"hidden\" name=\"is_final\" value=\"<?= $is_final ? '1' : '0' ?>\">\n        <input type=\"hidden\" name=\"recall_count\" value=\"<?= $recall_count ?>\">\n        \n        <?php if ($is_final || $event_no === '8'): ?>\n            <!-- Final Round - Touch-based Ranking System -->\n        <div class=\"adjudicator-section\">\n            <!-- Dance Progress Header -->\n            <div class=\"dance-progress-header\" id=\"danceProgressHeader\" style=\"display:flex; justify-content:flex-end; align-items:center; background: #f8f9fa; padding: 4px; border-radius: 4px; margin-bottom: 4px;\">\n                <div style=\"display:flex; align-items:center; gap:10px;\">\n                    <div class=\"dance-progress\" id=\"danceProgress\">\n                        <!-- Dance progress will be populated by JavaScript -->\n                    </div>\n                    <div id=\"currentDanceDisplay\" style=\"font-size: 12px; font-weight: bold; color: #003399;\">\n                        <!-- Current dance will be displayed here -->\n                    </div>\n                </div>\n            </div>\n            \n            <p style=\"text-align:center; color:#666; margin:2px 0; font-size:11px;\">\n                ğŸ’¡ ë“±ë²ˆí˜¸ í„°ì¹˜ â†’ ë“±ìœ„ ë¹ˆì¹¸ í„°ì¹˜ | ğŸ”„ ìˆœìœ„ ë³€ê²½: ê¸°ì¡´ ìˆœìœ„ í„°ì¹˜/ë“œë˜ê·¸ | âŒ ì·¨ì†Œ: ë°°ì •ëœ ë“±ë²ˆí˜¸ ì¬í„°ì¹˜\n            </p>\n                \n                <div class=\"final-scoring-container\" style=\"margin-top: 0;\">\n                    <div class=\"players-column\">\n                        <h3>ì„ ìˆ˜ ëª©ë¡</h3>\n                        <div class=\"players-list\" id=\"playersList\">\n                            <?php foreach ($players as $player_no): ?>\n                            <div class=\"player-item\" data-player=\"<?=h($player_no)?>\" onclick=\"selectPlayer(this)\">\n                                <?=h($player_no)?>\n                </div>\n                <?php endforeach; ?>\n                </div>\n                    </div>\n                    \n                    <div class=\"ranking-column\">\n                        <h3>ìˆœìœ„</h3>\n                        <div class=\"ranking-list\" id=\"rankingList\">\n                            <?php for ($i = 1; $i <= count($players); $i++): ?>\n                            <div class=\"ranking-slot\" data-rank=\"<?=$i?>\" onclick=\"assignRank(this)\" \n                                 ondblclick=\"swapWithNext(this)\" \n                                 draggable=\"true\" ondragstart=\"dragStart(event)\" ondragover=\"dragOver(event)\" \n                                 ondrop=\"drop(event)\" ondragend=\"dragEnd(event)\"\n                                 onmousedown=\"handleMouseDown(event)\" onmouseup=\"handleMouseUp(event)\">\n                                <span class=\"player-assigned\" id=\"player-<?=$i?>\"></span>\n                                <input type=\"hidden\" name=\"final_ranking[<?=$i?>]\" id=\"input-<?=$i?>\" value=\"\">\n                            </div>\n                            <?php endfor; ?>\n                        </div>\n                    </div>\n                </div>\n                \n                <div class=\"final-actions\">\n                    <button type=\"button\" id=\"saveFinalScores\" class=\"btn btn-primary\">\n                        ì ìˆ˜ ì €ì¥\n                    </button>\n                    <button type=\"button\" id=\"nextFinalDance\" class=\"btn btn-secondary\" style=\"display:none;\">\n                        ë‹¤ìŒ ì¢…ëª©\n                    </button>\n                    <button type=\"button\" id=\"clearFinalScores\" class=\"btn btn-secondary\">\n                        ì´ˆê¸°í™”\n                    </button>\n                </div>\n            </div>\n            <?php else: ?>\n            <!-- Preliminary Round - Instagram Style Dance by Dance System -->\n            <div class=\"dance-container\">\n                <div class=\"dance-progress\">\n                    <div class=\"progress-bar\">\n                        <div class=\"progress-fill\" style=\"width: 0%\"></div>\n                    </div>\n                    <div class=\"progress-text\">\n                        <span class=\"current-dance\">1</span> / <?= count($event_data['dances']) ?>\n                    </div>\n                </div>\n                \n                <div class=\"dance-slider\" id=\"danceSlider\">\n                    <?php foreach ($event_data['dances'] as $dance_index => $dance): ?>\n                        <?php \n                        // Direct dance name mapping\n                        $dance_names = [\n                            '1' => 'Waltz',\n                            '2' => 'Tango', \n                            '3' => 'Viennese Waltz',\n                            '4' => 'Slow Foxtrot',\n                            '5' => 'Quickstep',\n                            '6' => 'Cha Cha Cha',\n                            '7' => 'Samba',\n                            '8' => 'Rumba',\n                            '9' => 'Paso Doble',\n                            '10' => 'Jive'\n                        ];\n                        $dance_display = isset($dance_names[$dance]) ? $dance_names[$dance] : $dance;\n                        error_log(\"Dance: $dance, Dance display: $dance_display\");\n                        ?>\n                        <div class=\"dance-page\" data-dance=\"<?=h($dance)?>\" data-dance-index=\"<?=$dance_index?>\">\n                            <div class=\"dance-header\">\n                                <h3><?=h($dance_display)?></h3>\n                                <p>ì´ <?=count($players)?>ëª… ì¤‘ <?= $recall_count ?>ëª… ì„ íƒ</p>\n                            </div>\n                            \n                            <?php if ($hits_data && !empty($hits_data)): ?>\n                                <!-- Heat-based display -->\n                                <?php foreach ($hits_data as $heat_no => $heat_players): ?>\n                                    <div class=\"heat-section\">\n                                        <h4>íˆíŠ¸ <?= $heat_no ?></h4>\n                                        <div class=\"players-grid\">\n                                            <?php foreach ($heat_players as $player_no): ?>\n                                                <div class=\"player-card\" data-player=\"<?=h($player_no)?>\">\n                                                    <div class=\"player-number\"><?=h($player_no)?></div>\n                                                    <input type=\"checkbox\" \n                                                           name=\"recall_marks[<?=h($dance)?>][<?=h($player_no)?>]\" \n                                                           class=\"recall-checkbox\"\n                                                           data-dance=\"<?=h($dance)?>\"\n                                                           data-player=\"<?=h($player_no)?>\">\n                                                </div>\n                                            <?php endforeach; ?>\n                                        </div>\n                                    </div>\n                                <?php endforeach; ?>\n                            <?php else: ?>\n                                <!-- No heats - all players together -->\n                                <div class=\"players-grid\">\n                                    <?php foreach ($players as $player_no): ?>\n                                        <div class=\"player-card\" data-player=\"<?=h($player_no)?>\">\n                                            <div class=\"player-number\"><?=h($player_no)?></div>\n                                            <input type=\"checkbox\" \n                                                   name=\"recall_marks[<?=h($dance)?>][<?=h($player_no)?>]\" \n                                                   class=\"recall-checkbox\"\n                                                   data-dance=\"<?=h($dance)?>\"\n                                                   data-player=\"<?=h($player_no)?>\">\n                                        </div>\n                                    <?php endforeach; ?>\n                                </div>\n            <?php endif; ?>\n                            \n                            <div class=\"recall-status\">\n                                <div style=\"font-size:20px; margin-bottom:5px;\">ğŸ“Š Recall ì§„í–‰ ìƒí™©</div>\n                                <div style=\"font-size:28px; font-weight:900; color:#2e7d32;\">\n                                    <span class=\"selected-count\">0</span> / <?= $recall_count ?>ëª…\n        </div>\n                                <div style=\"font-size:14px; margin-top:5px; opacity:0.8;\">\n                                    <?= $recall_count ?>ëª…ì„ ì„ íƒí•˜ë©´ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤\n    </div>\n                            </div>\n                            \n                            <div class=\"dance-submit-section\" style=\"text-align:center; margin-top:20px; display:none;\">\n                                <button type=\"button\" \n                                        class=\"dance-submit-btn\" \n                                        data-dance=\"<?=h($dance)?>\"\n                                        style=\"background:#4CAF50; color:#fff; border:none; padding:15px 30px; font-size:16px; font-weight:bold; border-radius:8px; cursor:pointer;\">\n                                    <?=h($dance_display)?> ì „ì†¡\n                                </button>\n                            </div>\n                        </div>\n                    <?php endforeach; ?>\n                </div>\n                \n                <div class=\"dance-navigation\" style=\"text-align:center; margin-top:20px;\">\n                    <button type=\"button\" id=\"prevDance\" style=\"background:#666; color:#fff; border:none; padding:10px 20px; margin:0 10px; border-radius:5px; cursor:pointer; display:none;\">ì´ì „</button>\n                    <button type=\"button\" id=\"nextDance\" style=\"background:#2196F3; color:#fff; border:none; padding:10px 20px; margin:0 10px; border-radius:5px; cursor:pointer; display:none;\">ë‹¤ìŒ</button>\n                </div>\n            </div>\n            <?php endif; ?>\n\n    </form>\n    </div>\n\n    <script>\ndocument.getElementById('scoringForm').addEventListener('submit', function(e) {\n    e.preventDefault();\n    \n    const formData = new FormData(this);\n    const isFinal = formData.get('is_final') === '1';\n    const recallCount = parseInt(formData.get('recall_count'));\n    \n    if (isFinal) {\n        // Final round - ranking system\n        handleFinalRound(formData);\n    } else {\n        // Preliminary round - recall system\n        handleRecallRound(formData, recallCount);\n    }\n});\n\nfunction handleFinalRound(formData) {\n    const adjudicatorMarks = {};\n    \n    // Collect all marks\n    const inputs = document.querySelectorAll('input[name^=\"adjudicator_marks\"]');\n    inputs.forEach(input => {\n        const name = input.name;\n        const matches = name.match(/adjudicator_marks\\[(\\d+)\\]\\[(\\d+)\\]/);\n        if (matches) {\n            const adjudicatorId = matches[1];\n            const coupleId = matches[2];\n            const place = parseInt(input.value);\n            \n            if (!isNaN(place) && place > 0) {\n                if (!adjudicatorMarks[adjudicatorId]) {\n                    adjudicatorMarks[adjudicatorId] = {};\n                }\n                adjudicatorMarks[adjudicatorId][coupleId] = place;\n            }\n        }\n    });\n    \n    // Validate that all places are filled and unique\n    const allPlaces = [];\n    let isValid = true;\n    let errorMessage = '';\n    \n    inputs.forEach(input => {\n        const place = parseInt(input.value);\n        if (isNaN(place) || place < 1 || place > <?=count($players)?>) {\n            isValid = false;\n            errorMessage = 'ëª¨ë“  ìˆœìœ„ë¥¼ 1ë¶€í„° <?=count($players)?>ê¹Œì§€ ì…ë ¥í•´ì£¼ì„¸ìš”.';\n        } else {\n            if (allPlaces.includes(place)) {\n                isValid = false;\n                errorMessage = 'ê°™ì€ ìˆœìœ„ë¥¼ ë‘ ì„ ìˆ˜ì—ê²Œ ì¤„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';\n            }\n            allPlaces.push(place);\n        }\n    });\n    \n    if (!isValid) {\n        showMessage(errorMessage, 'error');\n        return;\n    }\n    \n    // Submit data\n    const submitData = {\n        comp_id: formData.get('comp_id'),\n        event_no: formData.get('event_no'),\n        type: 'final',\n        adjudicator_marks: adjudicatorMarks\n    };\n    \n    submitScores(submitData);\n}\n\nfunction handleRecallRound(formData, recallCount) {\n    const recallMarks = {};\n    let totalSelected = 0;\n    let isValid = true;\n    let errorMessage = '';\n    \n    // Collect recall marks for each dance\n    const danceSections = document.querySelectorAll('.dance-section');\n    danceSections.forEach(section => {\n        const dance = section.dataset.dance;\n        const checkboxes = section.querySelectorAll('.recall-checkbox:checked');\n        \n        recallMarks[dance] = [];\n        checkboxes.forEach(checkbox => {\n            recallMarks[dance].push(checkbox.dataset.player);\n        });\n        \n        totalSelected += checkboxes.length;\n    });\n    \n    // Check if total selected count matches recall count\n    if (totalSelected !== recallCount) {\n        isValid = false;\n        errorMessage = `ì „ì²´ ${recallCount}ëª…ì„ ì„ íƒí•´ì£¼ì„¸ìš”. (í˜„ì¬ ${totalSelected}ëª… ì„ íƒë¨)`;\n    }\n    \n    if (!isValid) {\n        showMessage(errorMessage, 'error');\n        return;\n    }\n    \n    // Submit data\n    const submitData = {\n        comp_id: formData.get('comp_id'),\n        event_no: formData.get('event_no'),\n        type: 'recall',\n        recall_marks: recallMarks\n    };\n    \n    submitScores(submitData);\n}\n\nfunction submitScores(submitData) {\n    fetch('scoring/save_scores.php', {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(submitData)\n    })\n    .then(response => response.json())\n    .then(data => {\n        if (data.success) {\n            showMessage('ì ìˆ˜ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');\n            if (data.results) {\n                showResults(data.results);\n            }\n            \n            // ëª¨ë“  ì±„ì ì´ ì™„ë£Œë˜ë©´ ì°½ ë‹«ê¸°\n            console.log('all_completed:', data.all_completed);\n            console.log('currentDanceIndex:', currentDanceIndex, 'totalDances:', totalDances);\n            \n            // ê°„ë‹¨í•œ ì°½ ë‹«ê¸° ë¡œì§ - ë§ˆì§€ë§‰ ëŒ„ìŠ¤ì—ì„œ ì±„ì  ì™„ë£Œ ì‹œ ë¬´ì¡°ê±´ ë‹«ê¸°\n            const dancePages = document.querySelectorAll('.dance-page');\n            const actualTotalDances = dancePages.length;\n            \n            console.log('actualTotalDances:', actualTotalDances);\n            console.log('currentDanceIndex:', currentDanceIndex);\n            console.log('Is last dance?', currentDanceIndex >= actualTotalDances - 1);\n            \n            // ë§ˆì§€ë§‰ ëŒ„ìŠ¤ì´ê±°ë‚˜ all_completedê°€ trueì´ë©´ ì°½ ë‹«ê¸°\n            if (data.all_completed || currentDanceIndex >= actualTotalDances - 1) {\n                console.log('Closing window...');\n                \n                // íƒœë¸”ë¦¿ ì¹œí™”ì ì¸ ì°½ ë‹«ê¸° - ë‹¨ê³„ë³„ ì‹œë„\n                console.log('Attempting to close window...');\n                \n                // 1ë‹¨ê³„: ë¶€ëª¨ ì°½ì— ë©”ì‹œì§€ ì „ì†¡\n                if (window.opener) {\n                    try {\n                        window.opener.postMessage('closeChildWindow', '*');\n                        console.log('Message sent to parent window');\n                    } catch (e) {\n                        console.log('Failed to send message to parent:', e);\n                    }\n                }\n                \n                // 2ë‹¨ê³„: ì¦‰ì‹œ ì°½ ë‹«ê¸° ì‹œë„\n                setTimeout(() => {\n                    try {\n                        window.close();\n                        console.log('Window closed successfully');\n                    } catch (e) {\n                        console.log('window.close() failed:', e);\n                        \n                        // 3ë‹¨ê³„: í˜ì´ì§€ ë¦¬ë‹¤ì´ë ‰íŠ¸ë¡œ ëŒ€ì²´\n                        try {\n                            window.location.href = 'about:blank';\n                            console.log('Redirected to about:blank');\n                        } catch (e2) {\n                            console.log('Redirect failed:', e2);\n                            \n                            // 4ë‹¨ê³„: ë¹ˆ í˜ì´ì§€ë¡œ êµì²´\n                            try {\n                                document.body.innerHTML = '<div style=\"text-align:center; padding:50px; font-size:18px;\">ì±„ì ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.<br>ì´ ì°½ì„ ë‹«ì•„ì£¼ì„¸ìš”.</div>';\n                                console.log('Page content replaced');\n                            } catch (e3) {\n                                console.log('Content replacement failed:', e3);\n                            }\n                        }\n                    }\n                }, 500);\n                \n                // ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼ í›„ ë°”ë¡œ ì°½ ë‹«ê¸°\n                alert('ëª¨ë“  ì±„ì ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ì°½ì´ ë‹«í™ë‹ˆë‹¤.');\n                closeWindowForcefully();\n            }\n        } else {\n            showMessage('ì €ì¥ ì‹¤íŒ¨: ' + (data.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'), 'error');\n        }\n    })\n    .catch(error => {\n        showMessage('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error, 'error');\n    });\n}\n\nfunction clearAllScores() {\n    if (confirm('ëª¨ë“  ì ìˆ˜ë¥¼ ì§€ìš°ì‹œê² ìŠµë‹ˆê¹Œ?')) {\n        // Clear final round inputs\n        const inputs = document.querySelectorAll('.place-input');\n        inputs.forEach(input => input.value = '');\n        \n        // Clear recall checkboxes\n        const checkboxes = document.querySelectorAll('.recall-checkbox');\n        checkboxes.forEach(checkbox => {\n            checkbox.checked = false;\n            checkbox.closest('.player-card').classList.remove('selected');\n        });\n        \n        // Update recall status\n        updateRecallStatus();\n        \n        showMessage('ëª¨ë“  ì ìˆ˜ê°€ ì§€ì›Œì¡ŒìŠµë‹ˆë‹¤.', 'success');\n    }\n}\n\n// Recall system event handlers\n    document.addEventListener('DOMContentLoaded', function() {\n    // Handle player card clicks - Touch optimized\n    document.querySelectorAll('.player-card').forEach(card => {\n        // Click event\n        card.addEventListener('click', function(e) {\n            e.preventDefault();\n            e.stopPropagation();\n            togglePlayerSelection(this);\n        });\n        \n        // Touch events for better mobile experience\n        card.addEventListener('touchstart', function(e) {\n            e.preventDefault();\n            this.style.transform = 'scale(0.95)';\n        });\n        \n        card.addEventListener('touchend', function(e) {\n            e.preventDefault();\n            this.style.transform = '';\n            togglePlayerSelection(this);\n        });\n        \n        // Prevent default touch behavior\n        card.addEventListener('touchmove', function(e) {\n            e.preventDefault();\n        });\n    });\n\n    // Handle checkbox changes\n    document.querySelectorAll('.recall-checkbox').forEach(checkbox => {\n        checkbox.addEventListener('change', function() {\n            updatePlayerCardState(this.closest('.player-card'));\n            updateRecallStatus();\n        });\n    });\n\n    // Initialize recall status\n    updateRecallStatus();\n    \n    // Initialize drag and drop for final ranking\n    initializeDragAndDrop();\n    \n    // Load saved scores\n    loadSavedScores();\n    \n    // Initialize fixed progress bar\n    initializeFixedProgress();\n});\n\nfunction initializeDragAndDrop() {\n    const container = document.getElementById('rankingContainer');\n    if (!container) return;\n    \n    let draggedElement = null;\n    \n    // Handle drag start\n    container.addEventListener('dragstart', function(e) {\n        if (e.target.classList.contains('ranking-item')) {\n            draggedElement = e.target;\n            e.target.classList.add('dragging');\n            e.dataTransfer.effectAllowed = 'move';\n        }\n    });\n    \n    // Handle drag end\n    container.addEventListener('dragend', function(e) {\n        if (e.target.classList.contains('ranking-item')) {\n            e.target.classList.remove('dragging');\n            draggedElement = null;\n        }\n    });\n    \n    // Handle drag over\n    container.addEventListener('dragover', function(e) {\n        e.preventDefault();\n        e.dataTransfer.dropEffect = 'move';\n        \n        const afterElement = getDragAfterElement(container, e.clientY);\n        if (afterElement == null) {\n            container.appendChild(draggedElement);\n        } else {\n            container.insertBefore(draggedElement, afterElement);\n        }\n    });\n    \n    // Handle drop\n    container.addEventListener('drop', function(e) {\n        e.preventDefault();\n        updateRankingNumbers();\n    });\n    \n    // Handle manual input changes\n    container.addEventListener('input', function(e) {\n        if (e.target.classList.contains('ranking-place-input')) {\n            updateRankingFromInputs();\n        }\n    });\n}\n\nfunction getDragAfterElement(container, y) {\n    const draggableElements = [...container.querySelectorAll('.ranking-item:not(.dragging)')];\n    \n    return draggableElements.reduce((closest, child) => {\n        const box = child.getBoundingClientRect();\n        const offset = y - box.top - box.height / 2;\n        \n        if (offset < 0 && offset > closest.offset) {\n            return { offset: offset, element: child };\n        } else {\n            return closest;\n        }\n    }, { offset: Number.NEGATIVE_INFINITY }).element;\n}\n\nfunction updateRankingNumbers() {\n    const container = document.getElementById('rankingContainer');\n    if (!container) return;\n    \n    const items = container.querySelectorAll('.ranking-item');\n    items.forEach((item, index) => {\n        const numberDiv = item.querySelector('.ranking-number');\n        const input = item.querySelector('.ranking-place-input');\n        \n        numberDiv.textContent = index + 1;\n        input.value = index + 1;\n        \n        // Update input name to reflect new position\n        const player = item.dataset.player;\n        input.name = `adjudicator_marks[${index + 1}][${player}]`;\n    });\n}\n\nfunction updateRankingFromInputs() {\n    const container = document.getElementById('rankingContainer');\n    if (!container) return;\n    \n    const items = Array.from(container.querySelectorAll('.ranking-item'));\n    const inputs = items.map(item => ({\n        element: item,\n        value: parseInt(item.querySelector('.ranking-place-input').value) || 0\n    }));\n    \n    // Sort by input value\n    inputs.sort((a, b) => a.value - b.value);\n    \n    // Reorder DOM elements\n    inputs.forEach((input, index) => {\n        container.appendChild(input.element);\n        \n        // Update visual number\n        const numberDiv = input.element.querySelector('.ranking-number');\n        numberDiv.textContent = index + 1;\n        \n        // Update input name\n        const player = input.element.dataset.player;\n        const inputElement = input.element.querySelector('.ranking-place-input');\n        inputElement.name = `adjudicator_marks[${index + 1}][${player}]`;\n    });\n}\n\nfunction loadSavedScores() {\n    <?php if ($saved_scores && !$is_final): ?>\n    // Load saved recall scores\n    const savedScores = <?= json_encode($saved_scores) ?>;\n    \n    console.log('Loading saved scores:', savedScores);\n    \n        // Check for missing players and add them dynamically\n        console.log('Checking for missing players');\n        const allPlayers = ['11', '12', '13', '14', '15', '16', '17', '18', '19', '95', '21', '22'].sort((a, b) => parseInt(a) - parseInt(b));\n    \n    // Check each dance section\n    document.querySelectorAll('.dance-page').forEach(danceSection => {\n        const dance = danceSection.getAttribute('data-dance');\n        console.log('Checking dance section:', dance);\n        \n        // Find the player list container - try different selectors\n        let playerList = danceSection.querySelector('.player-list');\n        if (!playerList) {\n            playerList = danceSection.querySelector('.players-container');\n        }\n        if (!playerList) {\n            playerList = danceSection.querySelector('.recall-players');\n        }\n        if (!playerList) {\n            // Look for any container with player cards\n            playerList = danceSection.querySelector('div:has(.player-card)');\n        }\n        if (!playerList) {\n            console.log('Player list not found for dance', dance, '- available elements:', danceSection.innerHTML.substring(0, 500));\n            // Try to find any existing player card and add after it\n            const existingPlayerCard = danceSection.querySelector('.player-card');\n            if (existingPlayerCard) {\n                playerList = existingPlayerCard.parentElement;\n                console.log('Using parent of existing player card as container');\n            } else {\n                console.log('No existing player cards found, skipping dance', dance);\n                return;\n            }\n        }\n        \n        // Check if all players are present and add missing ones\n        allPlayers.forEach(playerNumber => {\n            const checkbox = danceSection.querySelector(`input[name=\"recall_marks[${dance}][${playerNumber}]\"]`);\n            if (!checkbox) {\n                console.log('Adding missing player', playerNumber, 'for dance', dance);\n                \n                // Find the last existing player card to add after it\n                const lastPlayerCard = danceSection.querySelector('.player-card:last-child');\n                if (lastPlayerCard) {\n                    // Create player card HTML\n                    const playerCard = document.createElement('div');\n                    playerCard.className = 'player-card';\n                    playerCard.innerHTML = `\n                        <input type=\"checkbox\" name=\"recall_marks[${dance}][${playerNumber}]\" class=\"recall-checkbox\" data-dance=\"${dance}\" data-player=\"${playerNumber}\">\n                        <span class=\"player-number\">${playerNumber}</span>\n                    `;\n                    \n                    // Add after the last player card\n                    lastPlayerCard.parentNode.insertBefore(playerCard, lastPlayerCard.nextSibling);\n                    \n                    // Add event listener\n                    const newCheckbox = playerCard.querySelector('.recall-checkbox');\n                    newCheckbox.addEventListener('change', function() {\n                        updatePlayerCardState(playerCard);\n                        updateRecallStatus();\n                    });\n                    \n                    console.log('Successfully added player', playerNumber, 'for dance', dance);\n                } else {\n                    console.log('No existing player cards found to add after');\n                }\n            }\n        });\n    });\n    \n    if (savedScores && typeof savedScores === 'object') {\n        Object.keys(savedScores).forEach(dance => {\n            console.log('Processing dance:', dance);\n            const danceSection = document.querySelector(`[data-dance=\"${dance}\"]`);\n            console.log('Dance section found:', danceSection);\n            \n            if (!danceSection) return;\n            \n            const selectedPlayers = savedScores[dance];\n            console.log('Selected players for dance', dance, ':', selectedPlayers);\n            \n            // Ensure selectedPlayers is an array\n            if (Array.isArray(selectedPlayers)) {\n                selectedPlayers.forEach(playerNo => {\n                    console.log('Looking for player:', playerNo);\n                    const checkbox = danceSection.querySelector(`input[name=\"recall_marks[${dance}][${playerNo}]\"]`);\n                    console.log('Checkbox found:', checkbox);\n                    \n                    if (checkbox) {\n                        checkbox.checked = true;\n                        updatePlayerCardState(checkbox.closest('.player-card'));\n                        console.log('Checked player:', playerNo);\n                    }\n                });\n            }\n        });\n    }\n\n        // Sort player cards in each dance section\n        document.querySelectorAll('.dance-page').forEach(danceSection => {\n            const playerList = danceSection.querySelector('.players-grid');\n            if (playerList) {\n                const playerCards = Array.from(playerList.querySelectorAll('.player-card'));\n                playerCards.sort((a, b) => {\n                    const aNum = parseInt(a.querySelector('.player-number').textContent);\n                    const bNum = parseInt(b.querySelector('.player-number').textContent);\n                    return aNum - bNum;\n                });\n                \n                // Re-append sorted cards\n                playerCards.forEach(card => playerList.appendChild(card));\n            }\n        });\n\n        // Force update recall status after loading saved scores\n        console.log('Forcing updateRecallStatus after loading saved scores');\n        updateRecallStatus();\n\n        // updateRecallStatus already handles both top and bottom displays\n    <?php endif; ?>\n}\n\nfunction initializeFixedProgress() {\n    const fixedProgress = document.getElementById('fixedProgress');\n    if (!fixedProgress) return;\n    \n    let isScrolling = false;\n    let scrollTimeout;\n    \n    // Show progress bar when scrolling down\n    window.addEventListener('scroll', function() {\n        if (!isScrolling) {\n            fixedProgress.classList.add('show');\n            document.body.classList.add('progress-bar-visible');\n        }\n        \n        isScrolling = true;\n        clearTimeout(scrollTimeout);\n        \n        scrollTimeout = setTimeout(function() {\n            isScrolling = false;\n            // Hide progress bar after scrolling stops (only if no selections)\n            const totalSelected = document.querySelectorAll('.recall-checkbox:checked').length;\n            if (totalSelected === 0) {\n                fixedProgress.classList.remove('show');\n                document.body.classList.remove('progress-bar-visible');\n            }\n        }, 1000);\n    });\n    \n    // Touch events for mobile\n    document.addEventListener('touchstart', function() {\n        fixedProgress.classList.add('show');\n        document.body.classList.add('progress-bar-visible');\n    });\n}\n\nfunction togglePlayerSelection(card) {\n    const checkbox = card.querySelector('.recall-checkbox');\n    checkbox.checked = !checkbox.checked;\n    updatePlayerCardState(card);\n    updateRecallStatus();\n}\n\nfunction updatePlayerCardState(card) {\n    const checkbox = card.querySelector('.recall-checkbox');\n    if (checkbox.checked) {\n        card.classList.add('selected');\n    } else {\n        card.classList.remove('selected');\n    }\n}\n\nfunction updateTopRecallStatus() {\n    // Get checked checkboxes from CURRENT page only\n    const currentPage = document.querySelector('.dance-page[data-dance-index=\"' + currentDanceIndex + '\"]');\n    if (!currentPage) return;\n    \n    const currentPageCheckboxes = currentPage.querySelectorAll('.recall-checkbox:checked');\n    const selectedCount = currentPageCheckboxes.length;\n    const recallCount = <?= json_encode(intval($recall_count)) ?>;\n    \n    console.log('updateTopRecallStatus - currentDanceIndex:', currentDanceIndex, 'selectedCount:', selectedCount, 'recallCount:', recallCount);\n    \n    // Update top recall progress display\n    const topRecallProgress = document.getElementById('recallProgress');\n    if (topRecallProgress) {\n        topRecallProgress.textContent = selectedCount;\n        \n        // Update color based on progress\n        if (selectedCount === recallCount) {\n            topRecallProgress.style.color = '#4CAF50';\n            topRecallProgress.style.fontWeight = 'bold';\n        } else if (selectedCount > recallCount) {\n            topRecallProgress.style.color = '#f44336';\n            topRecallProgress.style.fontWeight = 'bold';\n        } else {\n            topRecallProgress.style.color = '#ff9800';\n            topRecallProgress.style.fontWeight = 'normal';\n        }\n    }\n    \n    // Update fixed progress bar\n    const fixedRecallCount = document.getElementById('fixedRecallCount');\n    if (fixedRecallCount) {\n        fixedRecallCount.textContent = selectedCount;\n    }\n    \n    // Update current page status (sync with updateRecallStatus)\n    const statusDiv = currentPage.querySelector('.recall-status');\n    const countSpan = statusDiv ? statusDiv.querySelector('.selected-count') : null;\n    \n    if (countSpan) {\n        countSpan.textContent = selectedCount;\n    }\n    \n    // Update submit button state for current dance page\n    console.log('Current page for submit button:', currentPage);\n    \n    const submitSection = currentPage.querySelector('.dance-submit-section');\n    const submitBtn = currentPage.querySelector('.dance-submit-btn');\n    \n    console.log('Submit section found:', submitSection);\n    console.log('Submit button found:', submitBtn);\n    \n    if (submitSection && submitBtn) {\n        // Show/hide submit section based on selection count\n        if (selectedCount === recallCount) {\n            submitSection.style.display = 'block';\n            submitBtn.disabled = false;\n            submitBtn.style.opacity = '1';\n            submitBtn.style.cursor = 'pointer';\n            console.log('Submit button shown - selectedCount matches recallCount');\n        } else {\n            submitSection.style.display = 'none';\n            submitBtn.disabled = true;\n            submitBtn.style.opacity = '0.5';\n            submitBtn.style.cursor = 'not-allowed';\n            console.log('Submit button hidden - selectedCount:', selectedCount, 'recallCount:', recallCount);\n        }\n    }\n}\n\nfunction updateRecallStatus() {\n    // Try to find current page by active class first\n    let currentPage = document.querySelector('.dance-page.active');\n    if (!currentPage) {\n        // Fallback to data-dance-index\n        currentPage = document.querySelector('.dance-page[data-dance-index=\"' + currentDanceIndex + '\"]');\n    }\n    if (!currentPage) {\n        // Fallback to first visible page\n        currentPage = document.querySelector('.dance-page[style*=\"display: block\"]');\n    }\n    \n    if (!currentPage) {\n        console.log('Current page not found, using fallback');\n        // Fallback: get all checked checkboxes from all pages\n        const allCheckboxes = document.querySelectorAll('.recall-checkbox:checked');\n        const selectedCount = allCheckboxes.length;\n        const recallCount = <?= json_encode(intval($recall_count)) ?>;\n        \n        console.log('Fallback - selectedCount:', selectedCount, 'recallCount:', recallCount);\n        \n        // Update top recall progress display\n        const topRecallProgress = document.getElementById('recallProgress');\n        if (topRecallProgress) {\n            topRecallProgress.textContent = selectedCount;\n            \n            // Update color based on progress\n            if (selectedCount === recallCount) {\n                topRecallProgress.style.color = '#4CAF50';\n                topRecallProgress.style.fontWeight = 'bold';\n            } else if (selectedCount > recallCount) {\n                topRecallProgress.style.color = '#f44336';\n                topRecallProgress.style.fontWeight = 'bold';\n            } else {\n                topRecallProgress.style.color = '#ff9800';\n                topRecallProgress.style.fontWeight = 'normal';\n            }\n        }\n        return;\n    }\n    \n    const checkboxes = currentPage.querySelectorAll('.recall-checkbox:checked');\n    const selectedCount = checkboxes.length;\n    const recallCount = <?= json_encode(intval($recall_count)) ?>;\n    \n    console.log('updateRecallStatus - selectedCount:', selectedCount, 'recallCount:', recallCount, 'currentDanceIndex:', currentDanceIndex);\n    \n    // Update top recall progress display (sync with updateTopRecallStatus)\n    const topRecallProgress = document.getElementById('recallProgress');\n    if (topRecallProgress) {\n        topRecallProgress.textContent = selectedCount;\n        \n        // Update color based on progress\n        if (selectedCount === recallCount) {\n            topRecallProgress.style.color = '#4CAF50';\n            topRecallProgress.style.fontWeight = 'bold';\n        } else if (selectedCount > recallCount) {\n            topRecallProgress.style.color = '#f44336';\n            topRecallProgress.style.fontWeight = 'bold';\n        } else {\n            topRecallProgress.style.color = '#ff9800';\n            topRecallProgress.style.fontWeight = 'normal';\n        }\n    }\n    \n    // Update fixed progress bar\n    const fixedProgress = document.getElementById('fixedProgress');\n    if (fixedProgress) {\n        const progressText = fixedProgress.querySelector('#recallProgress');\n        if (progressText) {\n            progressText.textContent = selectedCount;\n        }\n        \n        // Update progress bar styling\n        fixedProgress.classList.remove('complete', 'over');\n        if (selectedCount === recallCount) {\n            fixedProgress.classList.add('complete');\n        } else if (selectedCount > recallCount) {\n            fixedProgress.classList.add('over');\n        }\n    }\n    \n    // Update current page status\n    const statusDiv = currentPage.querySelector('.recall-status');\n    const countSpan = statusDiv.querySelector('.selected-count');\n    const submitSection = currentPage.querySelector('.dance-submit-section');\n    \n    if (countSpan) {\n        countSpan.textContent = selectedCount;\n    }\n    \n    // Update status styling\n    statusDiv.classList.remove('complete', 'over');\n    if (selectedCount === recallCount) {\n        statusDiv.classList.add('complete');\n        if (submitSection) submitSection.style.display = 'block';\n    } else if (selectedCount > recallCount) {\n        statusDiv.classList.add('over');\n        if (submitSection) submitSection.style.display = 'none';\n    } else {\n        if (submitSection) submitSection.style.display = 'none';\n    }\n}\n\n// ì°½ ë‹«ê¸° ë‹¤ì´ì–¼ë¡œê·¸ í‘œì‹œ\nfunction showCloseWindowDialog() {\n    // ê¸°ì¡´ ë‹¤ì´ì–¼ë¡œê·¸ê°€ ìˆë‹¤ë©´ ì œê±°\n    const existingDialog = document.getElementById('closeWindowDialog');\n    if (existingDialog) {\n        existingDialog.remove();\n    }\n    \n    // ë‹¤ì´ì–¼ë¡œê·¸ HTML ìƒì„±\n    const dialog = document.createElement('div');\n    dialog.id = 'closeWindowDialog';\n    dialog.style.cssText = `\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(0, 0, 0, 0.7);\n        z-index: 10000;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        font-family: Arial, sans-serif;\n    `;\n    \n    dialog.innerHTML = `\n        <div style=\"\n            background: white;\n            padding: 40px;\n            border-radius: 15px;\n            text-align: center;\n            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);\n            max-width: 400px;\n            width: 90%;\n        \">\n            <div style=\"font-size: 48px; margin-bottom: 20px;\">âœ…</div>\n            <h2 style=\"margin: 0 0 15px 0; color: #333; font-size: 24px;\">ì±„ì ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!</h2>\n            <p style=\"margin: 0 0 30px 0; color: #666; font-size: 16px;\">ëª¨ë“  ëŒ„ìŠ¤ì˜ ì±„ì ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.</p>\n            <div style=\"display: flex; gap: 15px; justify-content: center;\">\n                <button id=\"closeWindowBtn\" style=\"\n                    background: #4CAF50;\n                    color: white;\n                    border: none;\n                    padding: 15px 30px;\n                    border-radius: 8px;\n                    font-size: 16px;\n                    cursor: pointer;\n                    font-weight: bold;\n                    min-width: 120px;\n                \">ì°½ ë‹«ê¸°</button>\n                <button id=\"stayOpenBtn\" style=\"\n                    background: #f44336;\n                    color: white;\n                    border: none;\n                    padding: 15px 30px;\n                    border-radius: 8px;\n                    font-size: 16px;\n                    cursor: pointer;\n                    font-weight: bold;\n                    min-width: 120px;\n                \">ê³„ì† ì—´ì–´ë‘ê¸°</button>\n            </div>\n        </div>\n    `;\n    \n    document.body.appendChild(dialog);\n    \n    // ì°½ ë‹«ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸\n    document.getElementById('closeWindowBtn').addEventListener('click', function() {\n        closeWindowForcefully();\n    });\n    \n    // ê³„ì† ì—´ì–´ë‘ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸\n    document.getElementById('stayOpenBtn').addEventListener('click', function() {\n        dialog.remove();\n    });\n}\n\n// ê°•ì œ ì°½ ë‹«ê¸° í•¨ìˆ˜\nfunction closeWindowForcefully() {\n    console.log('Forcefully closing window...');\n    \n    // ì—¬ëŸ¬ ë°©ë²•ìœ¼ë¡œ ì°½ ë‹«ê¸° ì‹œë„\n    try {\n        // ë°©ë²• 1: window.close()\n        window.close();\n        console.log('Window closed via window.close()');\n    } catch (e) {\n        console.log('window.close() failed:', e);\n        \n        try {\n            // ë°©ë²• 2: self.close()\n            self.close();\n            console.log('Window closed via self.close()');\n        } catch (e2) {\n            console.log('self.close() failed:', e2);\n            \n            try {\n                // ë°©ë²• 3: ë¶€ëª¨ ì°½ì— ë©”ì‹œì§€ ì „ì†¡\n                if (window.opener) {\n                    window.opener.postMessage('closeChildWindow', '*');\n                    window.close();\n                    console.log('Message sent to parent and window.close() called');\n                }\n            } catch (e3) {\n                console.log('Parent message failed:', e3);\n                \n                try {\n                    // ë°©ë²• 4: í˜ì´ì§€ ë¦¬ë‹¤ì´ë ‰íŠ¸\n                    window.location.href = 'about:blank';\n                    console.log('Redirected to about:blank');\n                } catch (e4) {\n                    console.log('Redirect failed:', e4);\n                    \n                    // ë°©ë²• 5: í˜ì´ì§€ ì½˜í…ì¸  êµì²´\n                    document.body.innerHTML = '<div style=\"text-align:center; padding:50px; font-size:18px; color:#4CAF50;\">âœ… ì±„ì ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!<br>ì´ ì°½ì„ ë‹«ì•„ì£¼ì„¸ìš”.</div>';\n                    console.log('Page content replaced');\n                }\n            }\n        }\n    }\n}\n\nfunction showMessage(message, type) {\n    const messageDiv = document.getElementById('message');\n    messageDiv.innerHTML = `<div class=\"${type}\">${message}</div>`;\n    setTimeout(() => {\n        messageDiv.innerHTML = '';\n    }, 5000);\n}\n\nfunction showResults(results) {\n    let resultsHtml = '<div class=\"success\"><h3>ìµœì¢… ê²°ê³¼ (Skating System ì ìš©)</h3><ol>';\n    const sortedResults = Object.entries(results).sort((a, b) => a[1] - b[1]);\n    sortedResults.forEach(([coupleId, place]) => {\n        resultsHtml += `<li>ì„ ìˆ˜ #${coupleId} - ${place}ë“±</li>`;\n    });\n    resultsHtml += '</ol></div>';\n    document.getElementById('message').innerHTML = resultsHtml;\n}\n\n// Instagram Style Dance System\nlet currentDanceIndex = 0;\nlet totalDances = 0;\nlet completedDances = new Set();\nlet existingSelections = <?= json_encode($existing_selections) ?>;\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    const firstInput = document.querySelector('.place-input');\n    if (firstInput) {\n        firstInput.focus();\n    }\n    \n    // Initialize dance system if in preliminary round (not final)\n    <?php if (!$is_final && $event_no !== '8'): ?>\n    const danceSlider = document.getElementById('danceSlider');\n    if (danceSlider) {\n        initializeDanceSystem();\n    }\n    <?php endif; ?>\n    \n    // Setup fixed action buttons\n    setupFixedButtons();\n});\n\nfunction setupFixedButtons() {\n    // Dashboard button\n    const dashboardBtn = document.getElementById('dashboardBtn');\n    if (dashboardBtn) {\n        dashboardBtn.addEventListener('click', function() {\n            const compId = '<?= h($comp_id) ?>';\n            const lang = '<?= h($lang) ?>';\n            window.location.href = `scoring_dashboard.php?comp_id=${compId}&lang=${lang}`;\n        });\n    }\n    \n    // Refresh button\n    const refreshBtn = document.getElementById('refreshBtn');\n    if (refreshBtn) {\n        refreshBtn.addEventListener('click', function() {\n            if (confirm('í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì‹œê² ìŠµë‹ˆê¹Œ? í˜„ì¬ ì‘ì—… ì¤‘ì¸ ë‚´ìš©ì´ ì €ì¥ë˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.')) {\n                window.location.reload();\n            }\n        });\n    }\n}\n\nfunction loadExistingSelections() {\n    // Load existing selections for all dances\n    Object.keys(existingSelections).forEach(dance => {\n        const dancePage = document.querySelector(`[data-dance=\"${dance}\"]`);\n        if (!dancePage) return;\n        \n        const selectedPlayers = existingSelections[dance];\n        selectedPlayers.forEach(playerNo => {\n            const checkbox = dancePage.querySelector(`input[data-player=\"${playerNo}\"]`);\n            if (checkbox) {\n                checkbox.checked = true;\n                const card = checkbox.closest('.player-card');\n                if (card) {\n                    card.classList.add('selected');\n                }\n            }\n        });\n        \n        // Mark as completed if selections exist\n        if (selectedPlayers.length > 0) {\n            completedDances.add(dance);\n        }\n    });\n}\n\nfunction loadExistingSelectionsForDance(page, dance) {\n    // Load existing selections for a specific dance\n    if (existingSelections[dance]) {\n        const selectedPlayers = existingSelections[dance];\n        selectedPlayers.forEach(playerNo => {\n            const checkbox = page.querySelector(`input[data-player=\"${playerNo}\"]`);\n            if (checkbox) {\n                checkbox.checked = true;\n                const card = checkbox.closest('.player-card');\n                if (card) {\n                    card.classList.add('selected');\n                }\n            }\n        });\n    }\n}\n\nfunction initializeDanceSystem() {\n    const dancePages = document.querySelectorAll('.dance-page');\n    totalDances = dancePages.length;\n    \n    if (totalDances === 0) return;\n    \n    // Load existing selections for all dances\n    loadExistingSelections();\n    \n    // Show first dance page\n    showDancePage(0);\n    \n    // Setup event listeners\n    setupDanceEventListeners();\n    updateProgress();\n    \n    // Initialize recall status (both top and bottom)\n    updateRecallStatus();\n}\n\nfunction showDancePage(index) {\n    const danceSlider = document.getElementById('danceSlider');\n    const dancePages = document.querySelectorAll('.dance-page');\n    \n    if (index < 0 || index >= totalDances) return;\n    \n    currentDanceIndex = index;\n    danceSlider.style.transform = `translateX(-${index * 100}%)`;\n    \n    // Update progress\n    updateProgress();\n    \n    // Update navigation buttons\n    updateNavigationButtons();\n    \n    // Reset touch events for current page\n    resetTouchEvents();\n    \n    // Restore dance page state if going back to a completed dance\n    const currentPage = document.querySelector('.dance-page[data-dance-index=\"' + currentDanceIndex + '\"]');\n    if (currentPage) {\n        const dance = currentPage.dataset.dance;\n        const isCompleted = completedDances.has(dance);\n        \n        if (isCompleted) {\n            // Restore the page to editable state\n            restoreDancePageState(currentPage, dance);\n        } else {\n            // Load existing selections for this dance if not completed\n            loadExistingSelectionsForDance(currentPage, dance);\n        }\n    }\n    \n    // Update recall status for current page\n    updateRecallStatus();\n}\n\nfunction setupDanceEventListeners() {\n    // Navigation buttons\n    document.getElementById('prevDance')?.addEventListener('click', () => {\n        if (currentDanceIndex > 0) {\n            showDancePage(currentDanceIndex - 1);\n        }\n    });\n    \n    document.getElementById('nextDance')?.addEventListener('click', () => {\n        if (currentDanceIndex < totalDances - 1) {\n            showDancePage(currentDanceIndex + 1);\n        }\n    });\n    \n    // Dance submit buttons\n    document.querySelectorAll('.dance-submit-btn').forEach(btn => {\n        btn.addEventListener('click', function() {\n            const dance = this.dataset.dance;\n            submitDance(dance);\n        });\n    });\n    \n    // Touch/swipe events\n    let startX = 0;\n    let startY = 0;\n    let isSwipe = false;\n    \n    const danceSlider = document.getElementById('danceSlider');\n    \n    danceSlider.addEventListener('touchstart', function(e) {\n        startX = e.touches[0].clientX;\n        startY = e.touches[0].clientY;\n        isSwipe = false;\n    });\n    \n    danceSlider.addEventListener('touchmove', function(e) {\n        if (!startX || !startY) return;\n        \n        const currentX = e.touches[0].clientX;\n        const currentY = e.touches[0].clientY;\n        const diffX = startX - currentX;\n        const diffY = startY - currentY;\n        \n        // Determine if this is a horizontal swipe\n        if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 50) {\n            isSwipe = true;\n            e.preventDefault();\n        }\n    });\n    \n    danceSlider.addEventListener('touchend', function(e) {\n        if (!isSwipe || !startX || !startY) return;\n        \n        const endX = e.changedTouches[0].clientX;\n        const diffX = startX - endX;\n        \n        if (Math.abs(diffX) > 100) {\n            if (diffX > 0 && currentDanceIndex < totalDances - 1) {\n                // Swipe left - next dance\n                showDancePage(currentDanceIndex + 1);\n            } else if (diffX < 0 && currentDanceIndex > 0) {\n                // Swipe right - previous dance\n                showDancePage(currentDanceIndex - 1);\n            }\n        }\n        \n        startX = 0;\n        startY = 0;\n        isSwipe = false;\n    });\n}\n\nfunction resetTouchEvents() {\n    // Remove existing event listeners and re-add them\n    const playerCards = document.querySelectorAll('.player-card');\n    playerCards.forEach(card => {\n        // Remove old listeners by cloning the element\n        const newCard = card.cloneNode(true);\n        card.parentNode.replaceChild(newCard, card);\n        \n        // Add new listeners\n        setupPlayerCardEvents(newCard);\n    });\n}\n\nfunction setupPlayerCardEvents(card) {\n    let touchStartTime = 0;\n    let touchStartPos = { x: 0, y: 0 };\n    \n    // Click event\n    card.addEventListener('click', function(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        togglePlayerSelection(this);\n    });\n    \n    // Touch start\n    card.addEventListener('touchstart', function(e) {\n        touchStartTime = Date.now();\n        const touch = e.touches[0];\n        touchStartPos = { x: touch.clientX, y: touch.clientY };\n    });\n    \n    // Touch end\n    card.addEventListener('touchend', function(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        \n        const touchEndTime = Date.now();\n        const touchDuration = touchEndTime - touchStartTime;\n        \n        // Only trigger if it's a quick tap (less than 500ms)\n        if (touchDuration < 500) {\n            togglePlayerSelection(this);\n        }\n    });\n    \n    // Prevent context menu on long press\n    card.addEventListener('contextmenu', function(e) {\n        e.preventDefault();\n    });\n}\n\nfunction updateProgress() {\n    const progressFill = document.querySelector('.progress-fill');\n    const currentDanceSpan = document.querySelector('.current-dance');\n    \n    if (progressFill) {\n        const progress = ((currentDanceIndex + 1) / totalDances) * 100;\n        progressFill.style.width = progress + '%';\n    }\n    \n    if (currentDanceSpan) {\n        currentDanceSpan.textContent = currentDanceIndex + 1;\n    }\n}\n\nfunction restoreDancePageState(page, dance) {\n    // Remove from completed dances to allow re-editing\n    completedDances.delete(dance);\n    \n    // Restore the recall status section\n    const statusDiv = page.querySelector('.recall-status');\n    if (statusDiv) {\n        statusDiv.innerHTML = `\n            <div style=\"font-size:20px; margin-bottom:5px;\">ğŸ“Š Recall ì§„í–‰ ìƒí™©</div>\n            <div style=\"font-size:28px; font-weight:900; color:#2e7d32;\">\n                <span class=\"selected-count\">0</span> / <?= $recall_count ?>ëª…\n            </div>\n            <div style=\"font-size:14px; margin-top:5px; opacity:0.8;\">\n                <?= $recall_count ?>ëª…ì„ ì„ íƒí•˜ë©´ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤\n            </div>\n        `;\n    }\n    \n    // Show submit section (will be hidden/shown based on selection count)\n    const submitSection = page.querySelector('.dance-submit-section');\n    if (submitSection) {\n        submitSection.style.display = 'none';\n    }\n    \n    // Load existing selections for this dance\n    if (existingSelections[dance]) {\n        const selectedPlayers = existingSelections[dance];\n        selectedPlayers.forEach(playerNo => {\n            const checkbox = page.querySelector(`input[data-player=\"${playerNo}\"]`);\n            if (checkbox) {\n                checkbox.checked = true;\n                const card = checkbox.closest('.player-card');\n                if (card) {\n                    card.classList.add('selected');\n                }\n            }\n        });\n    } else {\n        // No existing selections, clear all\n        const checkboxes = page.querySelectorAll('.recall-checkbox');\n        checkboxes.forEach(checkbox => {\n            checkbox.checked = false;\n        });\n        \n        // Update player card states\n        const playerCards = page.querySelectorAll('.player-card');\n        playerCards.forEach(card => {\n            card.classList.remove('selected');\n        });\n    }\n}\n\nfunction updateNavigationButtons() {\n    const prevBtn = document.getElementById('prevDance');\n    const nextBtn = document.getElementById('nextDance');\n    \n    if (prevBtn) {\n        prevBtn.style.display = currentDanceIndex > 0 ? 'inline-block' : 'none';\n    }\n    \n    if (nextBtn) {\n        // Show next button if there are more dances AND current dance is completed\n        const currentDance = document.querySelector('.dance-page[data-dance-index=\"' + currentDanceIndex + '\"]');\n        const isCurrentDanceCompleted = currentDance && completedDances.has(currentDance.dataset.dance);\n        \n        if (currentDanceIndex < totalDances - 1 && isCurrentDanceCompleted) {\n            nextBtn.style.display = 'inline-block';\n            nextBtn.disabled = false;\n            nextBtn.style.opacity = '1';\n            nextBtn.style.cursor = 'pointer';\n        } else {\n            nextBtn.style.display = 'none';\n        }\n    }\n}\n\nfunction submitDance(dance) {\n    const currentPage = document.querySelector(`[data-dance=\"${dance}\"]`);\n    const checkboxes = currentPage.querySelectorAll('.recall-checkbox:checked');\n    const recallCount = <?= json_encode(intval($recall_count)) ?>;\n    \n    if (checkboxes.length !== recallCount) {\n        alert(`${recallCount}ëª…ì„ ì •í™•íˆ ì„ íƒí•´ì£¼ì„¸ìš”.`);\n        return;\n    }\n    \n    // Collect selected players for this dance\n    const selectedPlayers = Array.from(checkboxes).map(cb => cb.dataset.player);\n    \n    // Prepare data for this dance only\n    const recallMarks = {};\n    recallMarks[dance] = selectedPlayers;\n    \n    const data = {\n        comp_id: <?= json_encode($comp_id) ?>,\n        event_no: <?= json_encode($event_no) ?>,\n        type: 'recall',\n        recall_marks: recallMarks\n    };\n    \n    // Show loading state\n    const submitBtn = currentPage.querySelector('.dance-submit-btn');\n    const originalText = submitBtn.textContent;\n    submitBtn.textContent = 'ì „ì†¡ ì¤‘...';\n    submitBtn.disabled = true;\n    \n    fetch('scoring/save_scores.php', {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(data)\n    })\n    .then(response => response.json())\n    .then(result => {\n        if (result.success) {\n            // Mark this dance as completed\n            completedDances.add(dance);\n            \n            // Update existing selections\n            existingSelections[dance] = selectedPlayers;\n            \n            // Hide submit button and show completion message\n            submitBtn.style.display = 'none';\n            const statusDiv = currentPage.querySelector('.recall-status');\n            statusDiv.innerHTML = `\n                <div style=\"font-size:20px; margin-bottom:5px;\">âœ… ì™„ë£Œ</div>\n                <div style=\"font-size:18px; font-weight:bold; color:#4CAF50;\">\n                    ${recallCount}ëª… ì„ íƒ ì™„ë£Œ\n                </div>\n                <div style=\"font-size:14px; margin-top:5px; opacity:0.8;\">\n                    ë‹¤ìŒ ëŒ„ìŠ¤ë¡œ ì§„í–‰í•˜ì„¸ìš”\n                </div>\n            `;\n            \n            // Enable next dance button if available\n            updateNavigationButtons();\n            \n            // Show completion message\n            if (currentDanceIndex < totalDances - 1) {\n                setTimeout(() => {\n                    // Direct dance name mapping for JavaScript\n                    const danceNames = {\n                        '1': 'Waltz',\n                        '2': 'Tango', \n                        '3': 'Viennese Waltz',\n                        '4': 'Slow Foxtrot',\n                        '5': 'Quickstep',\n                        '6': 'Cha Cha Cha',\n                        '7': 'Samba',\n                        '8': 'Rumba',\n                        '9': 'Paso Doble',\n                        '10': 'Jive'\n                    };\n                    const danceDisplayName = danceNames[dance] || dance;\n                    alert(`${danceDisplayName} ëŒ„ìŠ¤ ì±„ì ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ëŒ„ìŠ¤ë¡œ ì§„í–‰í•˜ì„¸ìš”.`);\n                }, 1000);\n            } else {\n                // All dances completed\n                setTimeout(() => {\n                    alert('ëª¨ë“  ëŒ„ìŠ¤ ì±„ì ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');\n                }, 1000);\n            }\n        } else {\n            alert('ì „ì†¡ ì‹¤íŒ¨: ' + (result.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));\n            submitBtn.textContent = originalText;\n            submitBtn.disabled = false;\n        }\n    })\n    .catch(error => {\n        console.error('Error:', error);\n        alert('ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error);\n        submitBtn.textContent = originalText;\n        submitBtn.disabled = false;\n    });\n}\n\n// Final Round Dance-by-Dance System\n<?php if ($is_final || $event_no === '8'): ?>\nlet selectedPlayer = null;\nlet playerRankings = {};\nlet draggedSlot = null;\nlet isDragging = false;\nlet dragStartTime = 0;\nlet finalDanceNames = <?= json_encode($event_data['dances']) ?>;\nlet finalDanceDisplayNames = <?= json_encode(getDanceNames($event_data['dances'], $dance_mapping)) ?>;\nlet finalCompletedDances = new Set();\nlet savedRankings = <?= json_encode($saved_rankings ?? []) ?>;\nlet currentJudgeId = <?= json_encode($judge_id) ?>;\nlet isFinalMode = <?= json_encode($is_final) ?>;\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    // Initialize dance-by-dance system\n    initializeFinalDanceSystem();\n    setupFinalDanceNavigation();\n    \n    // Initialize touch-based system\n    initializeTouchSystem();\n    \n    // Setup drag and drop for ranking slots\n    setupDragAndDrop();\n});\n\nfunction initializeFinalDanceSystem() {\n    totalDances = finalDanceNames.length;\n    // Populate progress header\n    updateFinalDanceProgress();\n    // Show first dance\n    showFinalDance(0);\n}\n\nfunction updateFinalDanceProgress() {\n    const progressEl = document.getElementById('danceProgress');\n    if (!progressEl) return;\n    progressEl.innerHTML = finalDanceNames.map((dance, idx) => {\n        const isCurrent = idx === currentDanceIndex;\n        const isCompleted = finalCompletedDances.has(dance);\n        const isPending = !isCompleted && !isCurrent;\n        const danceDisplayName = (typeof isFinalMode !== 'undefined' && isFinalMode) ? (finalDanceDisplayNames[idx] || dance) : dance;\n        return `<span class=\"dance-step ${isCurrent ? 'current' : (isCompleted ? 'completed' : 'pending')}\">${danceDisplayName}</span>`;\n    }).join('');\n}\n\nfunction showFinalDance(danceIndex) {\n    if (danceIndex < 0 || danceIndex >= totalDances) return;\n    currentDanceIndex = danceIndex;\n    updateFinalDanceProgress();\n    updateCurrentDanceDisplay();\n    \n    // Clear rankings when switching dances\n    clearFinalScores();\n    \n    // Update navigation after DOM is ready\n    setTimeout(() => {\n        updateFinalDanceNav();\n    }, 50);\n    \n    // Restore saved rankings for current dance (after clearing)\n    setTimeout(() => {\n        restoreSavedRankings();\n    }, 100);\n}\n\nfunction updateCurrentDanceDisplay() {\n    const currentDanceEl = document.getElementById('currentDanceDisplay');\n    if (currentDanceEl && finalDanceNames[currentDanceIndex]) {\n        const danceDisplayName = (typeof isFinalMode !== 'undefined' && isFinalMode) ? (finalDanceDisplayNames[currentDanceIndex] || finalDanceNames[currentDanceIndex]) : finalDanceNames[currentDanceIndex];\n        currentDanceEl.textContent = `í˜„ì¬ ì¢…ëª©: ${danceDisplayName}`;\n    }\n}\n\nfunction setupFinalDanceNavigation() {\n    // Bind \"Submit Dance\" and \"Next Dance\" buttons\n    const submitBtn = document.getElementById('saveFinalScores');\n    if (submitBtn) {\n        submitBtn.addEventListener('click', submitFinalDance);\n    }\n    const nextBtn = document.getElementById('nextFinalDance');\n    if (nextBtn) {\n        nextBtn.addEventListener('click', () => {\n            if (currentDanceIndex < totalDances - 1) {\n                showFinalDance(currentDanceIndex + 1);\n            }\n        });\n    }\n}\n\nfunction submitFinalDance() {\n    const totalPlayers = document.querySelectorAll('.player-item').length;\n    const assignedPlayers = Object.keys(playerRankings).length;\n    \n    if (assignedPlayers < totalPlayers) {\n        alert(`ëª¨ë“  ì„ ìˆ˜ì—ê²Œ ìˆœìœ„ë¥¼ ë¶€ì—¬í•´ì•¼ í•©ë‹ˆë‹¤. (${assignedPlayers}/${totalPlayers})`);\n        return;\n    }\n    \n    const form = document.getElementById('scoringForm');\n    const formData = new FormData(form);\n    formData.append('is_final', '1');\n    formData.append('dance', finalDanceNames[currentDanceIndex]);\n    \n    Object.keys(playerRankings).forEach(player => {\n        formData.append(`final_ranking[${playerRankings[player]}]`, player);\n    });\n    \n    const submitBtn = document.getElementById('saveFinalScores');\n    const originalText = submitBtn.textContent;\n    submitBtn.textContent = 'ì „ì†¡ ì¤‘...';\n    submitBtn.disabled = true;\n    \n    fetch('scoring/save_scores.php', {\n        method: 'POST',\n        body: formData\n    })\n    .then(response => response.json())\n    .then(result => {\n        if (result.success) {\n            if (result.dance_completed) {\n                // All judges completed this dance\n                finalCompletedDances.add(finalDanceNames[currentDanceIndex]);\n                updateFinalDanceProgress();\n                const danceDisplayName = (typeof isFinalMode !== 'undefined' && isFinalMode) ? (finalDanceDisplayNames[currentDanceIndex] || finalDanceNames[currentDanceIndex]) : finalDanceNames[currentDanceIndex];\n                alert(`${danceDisplayName} ëŒ„ìŠ¤ ì±„ì ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!`);\n            } else {\n                // Only this judge submitted\n                const danceDisplayName = (typeof isFinalMode !== 'undefined' && isFinalMode) ? (finalDanceDisplayNames[currentDanceIndex] || finalDanceNames[currentDanceIndex]) : finalDanceNames[currentDanceIndex];\n                alert(`${danceDisplayName} ëŒ„ìŠ¤ ì ìˆ˜ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤`);\n            }\n            \n            if (currentDanceIndex < totalDances - 1) {\n                showFinalDance(currentDanceIndex + 1);\n            } else {\n                updateFinalDanceNav();\n                alert('ëª¨ë“  ì¢…ëª© ìˆœìœ„ ì œì¶œì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');\n            }\n        } else {\n            alert('ì œì¶œ ì‹¤íŒ¨: ' + (result.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));\n            submitBtn.textContent = originalText;\n            submitBtn.disabled = false;\n        }\n    })\n    .catch(error => {\n        console.error('Error:', error);\n        alert('ì œì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error);\n        submitBtn.textContent = originalText;\n        submitBtn.disabled = false;\n    });\n}\n\nfunction updateFinalDanceNav() {\n    const submitBtn = document.getElementById('saveFinalScores');\n    const nextBtn = document.getElementById('nextFinalDance');\n    \n    console.log('updateFinalDanceNav called - currentDanceIndex:', currentDanceIndex, 'totalDances:', totalDances);\n    \n    if (submitBtn) {\n        const danceDisplayName = (typeof isFinalMode !== 'undefined' && isFinalMode) ? (finalDanceDisplayNames[currentDanceIndex] || finalDanceNames[currentDanceIndex]) : finalDanceNames[currentDanceIndex];\n        const buttonText = currentDanceIndex < totalDances - 1 ? `${danceDisplayName} ìˆœìœ„ ì œì¶œ` : 'ìµœì¢… ì €ì¥';\n        submitBtn.textContent = buttonText;\n        console.log('Button text updated to:', buttonText);\n    }\n    if (nextBtn) {\n        nextBtn.style.display = (currentDanceIndex < totalDances - 1) ? 'inline-block' : 'none';\n    }\n    // Hide clear button\n    const clearBtn = document.getElementById('clearFinalScores');\n    if (clearBtn) clearBtn.style.display = 'none';\n}\n\nfunction initializeTouchSystem() {\n    // Clear any existing rankings when switching dances\n    clearFinalScores();\n    \n    // Bind clear button with confirmation\n    const clearBtn = document.getElementById('clearFinalScores');\n    if (clearBtn) {\n        clearBtn.addEventListener('click', clearFinalScoresWithConfirm);\n    }\n}\n\nfunction setupDragAndDrop() {\n    // Add drag and drop event listeners to all ranking slots\n    document.querySelectorAll('.ranking-slot').forEach(slot => {\n        slot.addEventListener('dragstart', dragStart);\n        slot.addEventListener('dragover', dragOver);\n        slot.addEventListener('drop', drop);\n        slot.addEventListener('dragend', dragEnd);\n        slot.addEventListener('mousedown', handleMouseDown);\n        slot.addEventListener('mouseup', handleMouseUp);\n    });\n}\n\n// Final Round JavaScript - Touch-based System\n\nfunction selectPlayer(element) {\n    // Remove previous selection\n    document.querySelectorAll('.player-item').forEach(item => {\n        item.classList.remove('selected');\n    });\n    \n    // Check if player is already assigned\n    if (element.classList.contains('assigned')) {\n        return;\n    }\n    \n    // Select current player\n    element.classList.add('selected');\n    selectedPlayer = element.dataset.player;\n    \n    console.log('Selected player:', selectedPlayer);\n}\n\nfunction assignRank(element) {\n    // If no player is selected, check if we can cancel an existing assignment\n    if (!selectedPlayer) {\n        if (element.classList.contains('assigned')) {\n            // Cancel existing assignment\n            cancelRank(element);\n        }\n        return;\n    }\n    \n    const rank = element.dataset.rank;\n    \n    // Check if this rank is already assigned\n    if (element.classList.contains('assigned')) {\n        // Remove existing assignment\n        const currentPlayer = element.querySelector('.player-assigned').textContent;\n        if (currentPlayer) {\n            // Remove from player list\n            const playerElement = document.querySelector(`[data-player=\"${currentPlayer}\"]`);\n            if (playerElement) {\n                playerElement.classList.remove('assigned');\n            }\n            // Remove from rankings\n            delete playerRankings[currentPlayer];\n        }\n    }\n    \n    // Assign new player to this rank\n    element.querySelector('.player-assigned').textContent = selectedPlayer;\n    element.querySelector('input').value = selectedPlayer;\n    element.classList.add('assigned');\n    \n    // Mark player as assigned\n    const playerElement = document.querySelector(`[data-player=\"${selectedPlayer}\"]`);\n    if (playerElement) {\n        playerElement.classList.add('assigned');\n    }\n    \n    // Update rankings object\n    playerRankings[selectedPlayer] = rank;\n    \n    // Clear selection\n    selectedPlayer = null;\n    document.querySelectorAll('.player-item').forEach(item => {\n        item.classList.remove('selected');\n    });\n    \n    console.log('Assigned player', selectedPlayer, 'to rank', rank);\n    console.log('Current rankings:', playerRankings);\n}\n\nfunction cancelRank(element) {\n    const currentPlayer = element.querySelector('.player-assigned').textContent;\n    if (currentPlayer) {\n        // Remove from player list\n        const playerElement = document.querySelector(`[data-player=\"${currentPlayer}\"]`);\n        if (playerElement) {\n            playerElement.classList.remove('assigned');\n        }\n        \n        // Clear the ranking slot\n        element.querySelector('.player-assigned').textContent = '';\n        element.querySelector('input').value = '';\n        element.classList.remove('assigned');\n        \n        // Remove from rankings\n        delete playerRankings[currentPlayer];\n        \n        console.log('Cancelled assignment for player', currentPlayer);\n        console.log('Current rankings:', playerRankings);\n    }\n}\n\n// Drag and Drop functions for ranking slots\nfunction dragStart(event) {\n    console.log('dragStart called', event.target);\n    isDragging = true;\n    draggedSlot = event.target;\n    draggedSlot.classList.add('dragging');\n    event.dataTransfer.effectAllowed = 'move';\n    event.dataTransfer.setData('text/html', draggedSlot.outerHTML);\n}\n\nfunction dragOver(event) {\n    event.preventDefault();\n    event.dataTransfer.dropEffect = 'move';\n    \n    // Add visual feedback\n    if (event.target.classList.contains('ranking-slot')) {\n        event.target.classList.add('drag-over');\n        console.log('dragOver on ranking slot');\n    }\n}\n\nfunction drop(event) {\n    event.preventDefault();\n    console.log('drop called', event.target, 'draggedSlot:', draggedSlot);\n    \n    // Remove drag-over class\n    document.querySelectorAll('.ranking-slot').forEach(slot => {\n        slot.classList.remove('drag-over');\n    });\n    \n    if (event.target.classList.contains('ranking-slot') && draggedSlot !== event.target) {\n        console.log('Swapping rankings between slots');\n        // Swap the players between the two slots\n        swapRankings(draggedSlot, event.target);\n    }\n}\n\nfunction dragEnd(event) {\n    // Remove dragging class\n    document.querySelectorAll('.ranking-slot').forEach(slot => {\n        slot.classList.remove('dragging', 'drag-over');\n    });\n    draggedSlot = null;\n    isDragging = false;\n}\n\n// Mouse event handlers for better drag detection\nfunction handleMouseDown(event) {\n    dragStartTime = Date.now();\n    isDragging = false;\n    console.log('Mouse down on ranking slot');\n}\n\nfunction handleMouseUp(event) {\n    const dragDuration = Date.now() - dragStartTime;\n    console.log('Mouse up, drag duration:', dragDuration);\n    \n    if (dragDuration > 200 && isDragging) {\n        // This was a drag operation, not a click\n        event.preventDefault();\n        event.stopPropagation();\n        return false;\n    }\n}\n\n// Double-click to swap with next rank\nfunction swapWithNext(element) {\n    console.log('Double-clicked ranking slot:', element);\n    \n    const currentRank = parseInt(element.dataset.rank);\n    const nextRank = currentRank + 1;\n    const nextElement = document.querySelector(`[data-rank=\"${nextRank}\"]`);\n    \n    if (nextElement && element.classList.contains('assigned') && nextElement.classList.contains('assigned')) {\n        console.log('Swapping ranks', currentRank, 'and', nextRank);\n        swapRankings(element, nextElement);\n    } else {\n        console.log('Cannot swap - one or both slots are empty');\n    }\n}\n\nfunction swapRankings(slot1, slot2) {\n    const player1 = slot1.querySelector('.player-assigned').textContent;\n    const player2 = slot2.querySelector('.player-assigned').textContent;\n    const input1 = slot1.querySelector('input');\n    const input2 = slot2.querySelector('input');\n    \n    // Swap the players\n    slot1.querySelector('.player-assigned').textContent = player2;\n    slot2.querySelector('.player-assigned').textContent = player1;\n    input1.value = player2;\n    input2.value = player1;\n    \n    // Update visual states\n    if (player1) {\n        slot1.classList.add('assigned');\n    } else {\n        slot1.classList.remove('assigned');\n    }\n    \n    if (player2) {\n        slot2.classList.add('assigned');\n    } else {\n        slot2.classList.remove('assigned');\n    }\n    \n    // Update rankings object\n    const rank1 = slot1.dataset.rank;\n    const rank2 = slot2.dataset.rank;\n    \n    if (player1) {\n        playerRankings[player1] = rank2;\n    } else {\n        // Remove from rankings if empty\n        Object.keys(playerRankings).forEach(player => {\n            if (playerRankings[player] === rank1) {\n                delete playerRankings[player];\n            }\n        });\n    }\n    \n    if (player2) {\n        playerRankings[player2] = rank1;\n    } else {\n        // Remove from rankings if empty\n        Object.keys(playerRankings).forEach(player => {\n            if (playerRankings[player] === rank2) {\n                delete playerRankings[player];\n            }\n        });\n    }\n    \n    console.log('Swapped rankings:', playerRankings);\n}\n\nfunction submitFinalDance() {\n    // Check if all players are assigned\n    const totalPlayers = document.querySelectorAll('.player-item').length;\n    const assignedPlayers = Object.keys(playerRankings).length;\n    \n    if (assignedPlayers < totalPlayers) {\n        alert(`ëª¨ë“  ì„ ìˆ˜ì—ê²Œ ìˆœìœ„ë¥¼ ë¶€ì—¬í•´ì•¼ í•©ë‹ˆë‹¤. (${assignedPlayers}/${totalPlayers})`);\n        return;\n    }\n    \n    const form = document.getElementById('scoringForm');\n    const formData = new FormData(form);\n    \n    // Add final round flag\n    formData.append('is_final', '1');\n    \n    // Add current dance\n    const currentDance = finalDanceNames[currentDanceIndex];\n    formData.append('dance', currentDance);\n    \n    // Add rankings data in the format expected by save_scores.php\n    const adjudicator_marks = {};\n    adjudicator_marks[<?= json_encode($judge_id) ?>] = {};\n    \n    Object.keys(playerRankings).forEach(player => {\n        const rank = playerRankings[player];\n        adjudicator_marks[<?= json_encode($judge_id) ?>][player] = rank;\n    });\n    \n    console.log('Sending adjudicator_marks:', adjudicator_marks);\n    formData.append('adjudicator_marks', JSON.stringify(adjudicator_marks));\n    \n    const saveBtn = document.getElementById('saveFinalScores');\n    const originalText = saveBtn.textContent;\n    saveBtn.textContent = 'ì €ì¥ ì¤‘...';\n    saveBtn.disabled = true;\n    \n    fetch('scoring/save_scores.php', {\n        method: 'POST',\n        body: formData\n    })\n    .then(response => response.json())\n    .then(result => {\n        if (result.success) {\n            if (result.dance_completed) {\n                finalCompletedDances.add(currentDance);\n                updateFinalDanceProgress();\n                const danceDisplayName = (typeof isFinalMode !== 'undefined' && isFinalMode) ? (finalDanceDisplayNames[currentDanceIndex] || currentDance) : currentDance;\n                alert(`${danceDisplayName} ëŒ„ìŠ¤ ì±„ì ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!`);\n            } else {\n                const danceDisplayName = (typeof isFinalMode !== 'undefined' && isFinalMode) ? (finalDanceDisplayNames[currentDanceIndex] || currentDance) : currentDance;\n                alert(`${danceDisplayName} ëŒ„ìŠ¤ ì ìˆ˜ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤`);\n            }\n            updateFinalDanceNav();\n            \n            if (currentDanceIndex < totalDances - 1) {\n                showFinalDance(currentDanceIndex + 1);\n            } else {\n                alert('ëª¨ë“  ì¢…ëª© ìˆœìœ„ ì œì¶œì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');\n            }\n        } else {\n            alert('ì €ì¥ ì‹¤íŒ¨: ' + (result.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));\n        }\n    })\n    .catch(error => {\n        console.error('Error:', error);\n        alert('ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error);\n    })\n    .finally(() => {\n        saveBtn.textContent = originalText;\n        saveBtn.disabled = false;\n    });\n}\n\nfunction clearFinalScores() {\n    // Clear all assignments (no confirmation for dance switching)\n    document.querySelectorAll('.ranking-slot').forEach(slot => {\n        slot.classList.remove('assigned');\n        slot.querySelector('.player-assigned').textContent = '';\n        slot.querySelector('input').value = '';\n    });\n    \n    document.querySelectorAll('.player-item').forEach(item => {\n        item.classList.remove('assigned');\n    });\n    \n    // Clear selection\n    selectedPlayer = null;\n    playerRankings = {};\n    \n    console.log('Cleared all scores');\n}\n\nfunction clearFinalScoresWithConfirm() {\n    if (confirm('ëª¨ë“  ì ìˆ˜ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {\n        clearFinalScores();\n    }\n}\n\nfunction restoreSavedRankings() {\n    // Get current dance name\n    const currentDance = finalDanceNames[currentDanceIndex];\n    console.log('=== RESTORE SAVED RANKINGS DEBUG ===');\n    console.log('Current judge ID:', currentJudgeId);\n    console.log('Current dance:', currentDance);\n    console.log('Current dance index:', currentDanceIndex);\n    console.log('Available saved rankings:', savedRankings);\n    console.log('Final dance names:', finalDanceNames);\n    \n    if (!currentDance || !savedRankings[currentDance]) {\n        console.log('No saved data for dance:', currentDance);\n        return; // No saved data for this dance\n    }\n    \n    const rankings = savedRankings[currentDance];\n    console.log('Restoring rankings for', currentDance, ':', rankings);\n    \n    // Restore each ranking\n    Object.keys(rankings).forEach(rank => {\n        const player = rankings[rank];\n        const rankElement = document.querySelector(`[data-rank=\"${rank}\"]`);\n        \n        console.log(`Attempting to restore rank ${rank}: player ${player}`);\n        console.log('Rank element found:', rankElement);\n        \n        if (rankElement && player) {\n            // Assign player to this rank\n            rankElement.querySelector('.player-assigned').textContent = player;\n            rankElement.querySelector('input').value = player;\n            rankElement.classList.add('assigned');\n            \n            // Mark player as assigned\n            const playerElement = document.querySelector(`[data-player=\"${player}\"]`);\n            if (playerElement) {\n                playerElement.classList.add('assigned');\n            }\n            \n            // Update rankings object\n            playerRankings[player] = rank;\n            \n            console.log(`Successfully restored rank ${rank}: player ${player}`);\n        } else {\n            console.log(`Failed to restore rank ${rank}: player ${player} - element not found`);\n        }\n    });\n    \n    console.log('Restored rankings:', playerRankings);\n}\n<?php endif; ?>\n    </script>\n    \n    <!-- Bottom Navigation -->\n    <div class=\"bottom-nav\">\n        <button type=\"button\" id=\"closeWindowBtn\" class=\"nav-button primary\" onclick=\"closeWindowForcefully()\">\n            <div class=\"nav-icon\">âŒ</div>\n            <div class=\"nav-text\">ì°½ ë‹«ê¸°</div>\n        </button>\n        <button type=\"button\" id=\"refreshBtn\" class=\"nav-button\">\n            <div class=\"nav-icon\">ğŸ”„</div>\n            <div class=\"nav-text\">ìƒˆë¡œê³ ì¹¨</div>\n        </button>\n    </div>\n    \n    <footer style=\"text-align: center; margin-top: 30px; color: #666; font-size: 0.9em; padding: 20px; border-top: 1px solid #eee;\">\n        2025 danceoffice.net | Powered by Seyoung Lee\n    </footer>\n</body>\n</html>","size_bytes":127093},"comp/judge_scoring_fixed.php":{"content":"<?php\n// ì—ëŸ¬ ë¦¬í¬íŒ… í™œì„±í™”\nerror_reporting(E_ALL);\nini_set('display_errors', 1);\n\nsession_start();\n\n$comp_id = $_GET['comp_id'] ?? '';\n$event_no = $_GET['event_no'] ?? '';\n$multievent = $_GET['multievent'] ?? '0';\n$lang = $_GET['lang'] ?? 'ko';\n\n// ì„ì‹œë¡œ ì„¸ì…˜ ê²€ì¦ ìš°íšŒ (ë””ë²„ê¹…ìš©)\nif (!isset($_SESSION['scoring_logged_in']) || !$_SESSION['scoring_logged_in']) {\n    $_SESSION['scoring_logged_in'] = true;\n    $_SESSION['scoring_comp_id'] = $comp_id;\n    $_SESSION['scoring_judge_id'] = '20';\n    $_SESSION['scoring_judge_name'] = 'Test Judge';\n}\n\n// ê¸°ë³¸ ê²€ì¦\nif (!$comp_id || !$event_no) {\n    echo \"<h1>ì˜ëª»ëœ ëŒ€íšŒ ID ë˜ëŠ” ì´ë²¤íŠ¸ ë²ˆí˜¸ì…ë‹ˆë‹¤.</h1>\";\n    exit;\n}\n\n// íŒŒì¼ ë¡œë”©\n$data_dir = __DIR__ . \"/data/$comp_id\";\n$runorder_file = \"$data_dir/RunOrder_Tablet.txt\";\n$players_file = \"$data_dir/players_$event_no.txt\";\n\nif (!file_exists($players_file)) {\n    echo \"<h1>ì„ ìˆ˜ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: \" . $players_file . \"</h1>\";\n    exit;\n}\n\n// ì„ ìˆ˜ ë°ì´í„° ë¡œë”©\n$players = file($players_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n\n// ì´ë²¤íŠ¸ ë°ì´í„° ë¡œë”©\n$event_data = null;\nif (file_exists($runorder_file)) {\n    $lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        $line = preg_replace('/\\x{FEFF}/u', '', $line);\n        $cols = array_map('trim', explode(',', $line));\n        if (count($cols) >= 2 && $cols[0] == $event_no) {\n            $event_data = [\n                'no' => $cols[0],\n                'name' => $cols[1],\n                'round' => $cols[2] ?? 'Final',\n                'dances' => array_filter(array_slice($cols, 6, 5), function($d) { return $d && $d != '0'; })\n            ];\n            break;\n        }\n    }\n}\n\nif (!$event_data) {\n    echo \"<h1>ì´ë²¤íŠ¸ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</h1>\";\n    exit;\n}\n\n?>\n<!DOCTYPE html>\n<html lang=\"<?= $lang ?>\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>ì‹¬ì‚¬ìœ„ì› ì±„ì  ì‹œìŠ¤í…œ</title>\n    <style>\n        body { font-family: Arial, sans-serif; margin: 20px; }\n        .container { max-width: 800px; margin: 0 auto; }\n        .event-info { background: #f5f5f5; padding: 15px; margin-bottom: 20px; border-radius: 5px; }\n        .players { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; }\n        .player { background: #e9e9e9; padding: 10px; border-radius: 5px; text-align: center; }\n        .submit-btn { background: #007cba; color: white; padding: 15px 30px; border: none; border-radius: 5px; font-size: 16px; cursor: pointer; margin-top: 20px; }\n        .submit-btn:hover { background: #005a87; }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>ì‹¬ì‚¬ìœ„ì› ì±„ì  ì‹œìŠ¤í…œ</h1>\n        \n        <div class=\"event-info\">\n            <h2>ì´ë²¤íŠ¸ ì •ë³´</h2>\n            <p><strong>ì´ë²¤íŠ¸ ë²ˆí˜¸:</strong> <?= htmlspecialchars($event_data['no']) ?></p>\n            <p><strong>ì´ë²¤íŠ¸ëª…:</strong> <?= htmlspecialchars($event_data['name']) ?></p>\n            <p><strong>ë¼ìš´ë“œ:</strong> <?= htmlspecialchars($event_data['round']) ?></p>\n            <p><strong>ì¢…ëª©:</strong> <?= htmlspecialchars(implode(', ', $event_data['dances'])) ?></p>\n            <p><strong>ì‹¬ì‚¬ìœ„ì›:</strong> <?= htmlspecialchars($_SESSION['scoring_judge_name']) ?> (ID: <?= htmlspecialchars($_SESSION['scoring_judge_id']) ?>)</p>\n        </div>\n        \n        <div class=\"players\">\n            <h2>ì¶œì „ ì„ ìˆ˜</h2>\n            <?php foreach ($players as $player): ?>\n                <div class=\"player\">\n                    <strong>ì„ ìˆ˜ ë²ˆí˜¸: <?= htmlspecialchars($player) ?></strong>\n                </div>\n            <?php endforeach; ?>\n        </div>\n        \n        <button class=\"submit-btn\" onclick=\"alert('ì±„ì  ê¸°ëŠ¥ì€ ì•„ì§ êµ¬í˜„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.')\">\n            ì±„ì í•˜ê¸°\n        </button>\n        \n        <p><a href=\"scoring_dashboard.php?comp_id=<?= urlencode($comp_id) ?>&lang=<?= urlencode($lang) ?>\">ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ê¸°</a></p>\n    </div>\n</body>\n</html>\n\n\n\n\n\n\n","size_bytes":4164},"comp/judge_scoring_free.php":{"content":"<?php\nsession_start();\nerror_reporting(E_ALL); ini_set('display_errors', 1);\n\nif (!isset($_SESSION['judge_id']) || !isset($_SESSION['judge_name'])) {\n    // ì´ë²¤íŠ¸ íŒŒë¼ë¯¸í„°ê°€ ìˆìœ¼ë©´ ë¡œê·¸ì¸ í›„ í•´ë‹¹ ì´ë²¤íŠ¸ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸\n    $event_param = isset($_GET['event']) ? '?event=' . urlencode($_GET['event']) : '';\n    header(\"Location: judge_login.php\" . $event_param);\n    exit;\n}\n\n$data_dir = __DIR__ . '/data';\n$event_file = $data_dir . '/events.txt';\n\n// ì¢…ëª© ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°\n$events = [];\nif (file_exists($event_file)) {\n    $lines = file($event_file);\n    foreach ($lines as $line) {\n        $cols = explode(',', trim($line));\n        if (count($cols) >= 2) {\n            $events[] = [\n                'code' => $cols[0],\n                'name' => $cols[1]\n            ];\n        }\n    }\n}\n\n// ì„ íƒëœ ì¢…ëª© (GET íŒŒë¼ë¯¸í„° ìš°ì„ , ì—†ìœ¼ë©´ ì²« ë²ˆì§¸ ì´ë²¤íŠ¸)\n$selected_event = isset($_GET['event']) ? $_GET['event'] : (isset($events[0]) ? $events[0]['code'] : '');\n$event_name = '';\n\n// ì´ë²¤íŠ¸ê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸\n$event_exists = false;\nforeach ($events as $ev) {\n    if ($ev['code'] === $selected_event) {\n        $event_name = $ev['name'];\n        $event_exists = true;\n        break;\n    }\n}\n\n// ì´ë²¤íŠ¸ê°€ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ì²« ë²ˆì§¸ ì´ë²¤íŠ¸ë¡œ ì„¤ì •\nif (!$event_exists && !empty($events)) {\n    $selected_event = $events[0]['code'];\n    $event_name = $events[0]['name'];\n}\n\n// í•´ë‹¹ ì¢…ëª© ì„ ìˆ˜ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°\n$event_players_file = $data_dir . '/event_players/' . $selected_event . '_players.txt';\n$players = [];\nif ($selected_event && file_exists($event_players_file)) {\n    $lines = file($event_players_file);\n    foreach ($lines as $line) {\n        $cols = array_map('trim', explode(',', $line));\n        if (count($cols) >= 2) {\n            $players[] = [\n                'number' => $cols[0],\n                'name' => $cols[1],\n                'partner' => isset($cols[2]) ? $cols[2] : ''\n            ];\n        }\n    }\n}\n\n// ì ìˆ˜ ì €ì¥\n$score_dir = $data_dir . '/scores';\nif (!is_dir($score_dir)) mkdir($score_dir, 0777, true);\n\n$score_file = $score_dir . \"/score_{$selected_event}_J{$_SESSION['judge_id']}.txt\";\n\n$scoring_msg = \"\";\n\nif ($_SERVER['REQUEST_METHOD'] === 'POST' && (isset($_POST['save_score']) || isset($_POST['finish_and_go_dashboard']))) {\n    $scores = [];\n    foreach ($players as $pl) {\n        $num = $pl['number'];\n        // ë¶ˆì°¸ ì²˜ë¦¬: ê°’ ê°•ì œ\n        if (isset($_POST['absent_'.$num]) && $_POST['absent_'.$num] === '1') {\n            $score1 = 5;\n            $score2 = 5;\n            $score3 = 1;\n        } else {\n            $score1 = isset($_POST[\"score1_$num\"]) ? trim($_POST[\"score1_$num\"]) : '';\n            $score2 = isset($_POST[\"score2_$num\"]) ? trim($_POST[\"score2_$num\"]) : '';\n            $score3 = isset($_POST[\"score3_$num\"]) ? trim($_POST[\"score3_$num\"]) : '';\n        }\n        $scores[] = \"$num,$score1,$score2,$score3\";\n    }\n    $save_result = file_put_contents($score_file, implode(\"\\n\", $scores));\n    if ($save_result !== false) {\n        $scoring_msg = \"<div class='score-msg success'>ì±„ì ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!</div>\";\n    } else {\n        $scoring_msg = \"<div class='score-msg error'>ì ìˆ˜ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì„œë²„ ê¶Œí•œì´ë‚˜ ê²½ë¡œë¥¼ í™•ì¸í•˜ì„¸ìš”.</div>\";\n    }\n\n    if (isset($_POST['finish_and_go_dashboard'])) {\n        header(\"Location: judge_dashboard.php\");\n        exit;\n    }\n}\n\n// ê¸°ì¡´ ì ìˆ˜ ë¶ˆëŸ¬ì˜¤ê¸°(ìˆìœ¼ë©´)\n$saved_scores = [];\nif (file_exists($score_file)) {\n    $lines = file($score_file);\n    foreach ($lines as $line) {\n        $cols = explode(',', trim($line));\n        if (count($cols) === 4) {\n            $saved_scores[$cols[0]] = [\n                'score1' => $cols[1],\n                'score2' => $cols[2],\n                'score3' => $cols[3],\n            ];\n        }\n    }\n}\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>ì±„ì  - ì‹¬ì‚¬ìœ„ì› | danceoffice.net</title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\n    <link rel=\"stylesheet\" href=\"/assets/style.css\">\n    <style>\n        .score-section {background:#23262b; border-radius:14px; padding:2em 2em 2.5em 2em; max-width:750px; margin:3em auto;}\n        .score-title {font-size:1.2em; font-weight:700; color:#03C75A; margin-bottom:1.1em;}\n        .event-select-form {margin-bottom:2em;}\n        .event-select-form select {padding:0.5em 1em; border-radius:8px; background:#181B20; color:#03C75A; border:1px solid #31343a;}\n        .score-table {width:100%; background:#222; border-radius:8px; border-collapse:collapse;}\n        .score-table th,.score-table td {padding:0.7em 0.5em; border-bottom:1px solid #31343a;}\n        .score-table th {background:#181B20; color:#03C75A;}\n        .score-table td {color:#F5F7FA;}\n        .score-table tr:last-child td {border-bottom:none;}\n        .score-input {width:4em; padding:0.5em; border-radius:6px; border:1px solid #31343a; background:#1E2126; color:#fff; text-align:center;}\n        .score-input[readonly] {background:#333;color:#aaf;cursor:pointer;}\n        .score-msg {margin:1em 0; padding:0.8em 1em; border-radius:8px;}\n        .score-msg.success {background:#232; color:#03C75A;}\n        .score-msg.error {background:#311; color:#ff5e5e;}\n        .score-btn, .finish-btn {background:linear-gradient(90deg,#03C75A 70%,#00BFAE 100%); color:#222; border:none; border-radius:20px; padding:0.7em 2em; font-weight:700; margin-right:0.8em;}\n        .score-btn:hover, .finish-btn:hover {background:linear-gradient(90deg,#00BFAE 60%,#03C75A 100%); color:#fff;}\n        .finish-btn {background:#0057b7; color:#fff;}\n        .finish-btn:hover {background:#03C75A; color:#222;}\n        .absent-btn {\n            margin-left:0.5em;\n            background:#f55; color:#fff; font-weight:700; border:none; border-radius:10px;\n            padding:0.25em 0.95em; font-size:0.98em; cursor:pointer; transition:background 0.14s;\n        }\n        .absent-btn.absent-active, .absent-btn:focus { background:#a00; color:#fff;}\n        .score-row-absent td {background:#fff5f5 !important; color:#a00;}\n        .score-row-absent input {background:#fff4f4 !important; color:#a00;}\n        /* ëª¨ë‹¬ ë“± ê¸°ì¡´ ìŠ¤íƒ€ì¼ ê·¸ëŒ€ë¡œ ìœ ì§€ */\n        .modal-bg {\n            display:none; position:fixed; left:0; top:0; width:100vw; height:100vh;\n            background:rgba(10,20,30,0.85); z-index:9999;\n        }\n        .modal-wrap {\n            background:#181C25; border-radius: 20px;\n            box-sizing:border-box;\n            width:96vw; max-width:650px; min-width:0;\n            margin:4vh auto 0 auto; padding:2em 0.5em 2em 0.5em; position:relative;\n            overflow-x: auto;\n        }\n        .modal-label {\n            font-weight:900; color:#03C75A; font-size:1.6em; text-align:center; margin-bottom:1.3em;\n        }\n        .modal-btns {\n            display:flex; flex-direction:column; gap:1.1em; width:100%; align-items:center;\n            margin-bottom:2em;\n        }\n        .modal-btn-row {\n            display:flex; flex-wrap:nowrap; gap:0.65em; justify-content:center; width:100%;\n        }\n        .modal-btn {\n            background:#31343a; color:#fff; border:none; border-radius:10px;\n            padding:0.8em 0.9em; min-width:2.1em;\n            font-weight:900; font-size:1.35em;\n            cursor:pointer; transition:background 0.15s;\n            line-height:1.6;\n            box-shadow: 0 2px 6px rgba(0,0,0,0.08);\n        }\n        .modal-btn.active, .modal-btn:focus {background:#03C75A; color:#222;}\n        .modal-btn:hover {background:#00BFAE; color:#fff;}\n        .modal-close {\n            position:absolute; top:0.7em; right:1.5em; background:none; border:none;\n            color:#ff5e5e; font-size:2.3em; cursor:pointer; font-weight:900;\n        }\n        .modal-btn.difficulty-btn {\n            border-radius:50%;\n            width:2.7em; height:2.7em; min-width:2.7em; min-height:2.7em;\n            padding:0; font-size:1.25em; display:flex; align-items:center; justify-content:center;\n            background:#222b37;\n            margin-bottom:0.08em;\n        }\n        .modal-btn.difficulty-btn.active, .modal-btn.difficulty-btn:focus {background:#03C75A; color:#181c25;}\n        .modal-btn.difficulty-btn:hover {background:#00BFAE; color:#fff;}\n    </style>\n</head>\n<body>\n    <main>\n        <section class=\"score-section\">\n            <div class=\"score-title\">ì‹¬ì‚¬ ì±„ì  íŒ¨ë„</div>\n            <div style=\"margin-bottom:1em;\">\n                <b><?= htmlspecialchars($_SESSION['judge_name']) ?></b> ì‹¬ì‚¬ìœ„ì›ë‹˜<br>\n            </div>\n            <form class=\"event-select-form\" method=\"get\">\n                <label for=\"event_select\" style=\"color:#03C75A; font-weight:700;\">ì¢…ëª© ì„ íƒ:</label>\n                <select name=\"event\" id=\"event_select\" onchange=\"this.form.submit()\">\n                    <?php foreach($events as $ev): ?>\n                        <option value=\"<?= htmlspecialchars($ev['code']) ?>\" <?= $selected_event === $ev['code'] ? 'selected' : '' ?>>\n                            <?= htmlspecialchars($ev['name']) ?>\n                        </option>\n                    <?php endforeach; ?>\n                </select>\n            </form>\n            \n            <?php if (isset($_GET['event'])): ?>\n            <div style=\"background: #e8f4fd; padding: 10px; border-radius: 6px; margin: 10px 0; border-left: 4px solid #2196F3;\">\n                <strong>ğŸ­ í”„ë¦¬ìŠ¤íƒ€ì¼ ì±„ì  ëª¨ë“œ</strong><br>\n                <small>ì´ ì¢…ëª©ì€ í”„ë¦¬ìŠ¤íƒ€ì¼ ì‹¬ì‚¬ ì‹œìŠ¤í…œìœ¼ë¡œ ì±„ì ë©ë‹ˆë‹¤.</small>\n            </div>\n            <?php endif; ?>\n            <div style=\"font-size:1.08em; color:#0ef; margin-bottom:0.7em;\">\n                [<?= htmlspecialchars($event_name) ?>]\n            </div>\n            <?php if ($scoring_msg) echo $scoring_msg; ?>\n            <?php if ($players): ?>\n            <form method=\"post\" autocomplete=\"off\" onsubmit=\"return lockButtonsOnSubmit(this)\">\n                <table class=\"score-table\">\n                    <thead>\n                        <tr>\n                            <th style=\"width:65px;\">ë²ˆí˜¸</th>\n                            <th>ì´ë¦„</th>\n                            <th>íŒŒíŠ¸ë„ˆ</th>\n                            <th style=\"width:100px;\">ê¸°ìˆ </th>\n                            <th style=\"width:100px;\">ì•ˆë¬´</th>\n                            <th style=\"width:100px;\">ë‚œì´ë„</th>\n                            <th>ë¶ˆì°¸</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <?php foreach($players as $pl): \n                            $num = $pl['number'];\n                            $score1 = isset($saved_scores[$num]['score1']) ? $saved_scores[$num]['score1'] : '';\n                            $score2 = isset($saved_scores[$num]['score2']) ? $saved_scores[$num]['score2'] : '';\n                            $score3 = isset($saved_scores[$num]['score3']) ? $saved_scores[$num]['score3'] : '';\n                            $is_absent = ($score1 == 5 && $score2 == 5 && $score3 == 1);\n                        ?>\n                        <tr id=\"score_row_<?= htmlspecialchars($num) ?>\"<?= $is_absent ? ' class=\"score-row-absent\"' : '' ?>>\n                            <td><?= htmlspecialchars($pl['number']) ?></td>\n                            <td><?= htmlspecialchars($pl['name']) ?></td>\n                            <td><?= htmlspecialchars($pl['partner']) ?></td>\n                            <td>\n                                <input type=\"text\" class=\"score-input\" \n                                    name=\"score1_<?= htmlspecialchars($num) ?>\" \n                                    id=\"score1_<?= htmlspecialchars($num) ?>\"\n                                    value=\"<?= htmlspecialchars($score1) ?>\"\n                                    readonly onclick=\"if(!isAbsent('<?= $num ?>'))openModal('ê¸°ìˆ ', 'score1_<?= htmlspecialchars($num) ?>', 'tech')\">\n                            </td>\n                            <td>\n                                <input type=\"text\" class=\"score-input\" \n                                    name=\"score2_<?= htmlspecialchars($num) ?>\" \n                                    id=\"score2_<?= htmlspecialchars($num) ?>\"\n                                    value=\"<?= htmlspecialchars($score2) ?>\"\n                                    readonly onclick=\"if(!isAbsent('<?= $num ?>'))openModal('ì•ˆë¬´', 'score2_<?= htmlspecialchars($num) ?>', 'choreo')\">\n                            </td>\n                            <td>\n                                <input type=\"text\" class=\"score-input\" \n                                    name=\"score3_<?= htmlspecialchars($num) ?>\" \n                                    id=\"score3_<?= htmlspecialchars($num) ?>\"\n                                    value=\"<?= htmlspecialchars($score3) ?>\"\n                                    readonly onclick=\"if(!isAbsent('<?= $num ?>'))openModal('ë‚œì´ë„', 'score3_<?= htmlspecialchars($num) ?>', 'difficult')\">\n                            </td>\n                            <td>\n                                <input type=\"hidden\" name=\"absent_<?= htmlspecialchars($num) ?>\" value=\"<?= $is_absent ? '1' : '0' ?>\">\n                                <button type=\"button\" class=\"absent-btn<?= $is_absent ? ' absent-active' : '' ?>\" id=\"absent_btn_<?= htmlspecialchars($num) ?>\" onclick=\"toggleAbsent('<?= htmlspecialchars($num) ?>')\"><?= $is_absent ? 'ë¶ˆì°¸ ì·¨ì†Œ' : 'ë¶ˆì°¸' ?></button>\n                            </td>\n                        </tr>\n                        <?php endforeach; ?>\n                    </tbody>\n                </table>\n                <div style=\"margin-top:1.4em;\">\n                    <button type=\"submit\" name=\"save_score\" class=\"score-btn\">ì ìˆ˜ ì €ì¥</button>\n                    <button type=\"submit\" name=\"finish_and_go_dashboard\" class=\"finish-btn\">ì±„ì  ì™„ë£Œ(ëŒ€ì‹œë³´ë“œë¡œ)</button>\n                </div>\n            </form>\n            <?php else: ?>\n                <div class=\"score-msg error\">ì„ ìˆ˜ ëª…ë‹¨ì´ ì—†ìŠµë‹ˆë‹¤. ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.</div>\n            <?php endif; ?>\n        </section>\n    </main>\n    <!-- Modal -->\n    <div id=\"modal-bg\" class=\"modal-bg\">\n        <div class=\"modal-wrap\">\n            <button class=\"modal-close\" onclick=\"closeModal()\">&times;</button>\n            <div class=\"modal-label\" id=\"modal-label\"></div>\n            <div class=\"modal-btns\" id=\"modal-btns\"></div>\n        </div>\n    </div>\n    <script>\n        let currentInputId = \"\";\n        function openModal(label, inputId, mode) {\n            currentInputId = inputId;\n            document.getElementById('modal-label').textContent = label + \" ì ìˆ˜ ì„ íƒ\";\n            let btnsHtml = '';\n            if (mode === 'tech' || mode === 'choreo') {\n                let min = 5.1, max = 10, step = 0.1;\n                for (let rowStart = min; rowStart < max; rowStart += 1.0) {\n                    let rowEnd = Math.min(rowStart + 0.9, max);\n                    btnsHtml += \"<div class='modal-btn-row'>\";\n                    for (let v = rowStart; v <= rowEnd + 0.0001; v += step) {\n                        let val = parseFloat(v.toFixed(1));\n                        btnsHtml += `<button type='button' class='modal-btn' data-score='${val}'>${val}</button>`;\n                    }\n                    btnsHtml += \"</div>\";\n                }\n            } else if (mode === 'difficult') {\n                let min = 1.25, max = 2, step = 0.05;\n                let col = 0, perRow = 7;\n                for (let rowStart = min; rowStart <= max; rowStart += step * perRow) {\n                    btnsHtml += \"<div class='modal-btn-row'>\";\n                    for (let v = rowStart; v < rowStart + step * perRow && v <= max + 0.0001; v += step) {\n                        let val = parseFloat(v.toFixed(2));\n                        btnsHtml += `<button type='button' class='modal-btn difficulty-btn' data-score='${val}'>${val}</button>`;\n                    }\n                    btnsHtml += \"</div>\";\n                }\n            }\n            document.getElementById('modal-btns').innerHTML = btnsHtml;\n            document.getElementById('modal-bg').style.display = 'block';\n        }\n        function closeModal() {\n            document.getElementById('modal-bg').style.display = 'none';\n            currentInputId = \"\";\n        }\n        document.getElementById('modal-btns').addEventListener('click', function(e){\n            if (e.target.classList.contains('modal-btn')) {\n                let score = e.target.getAttribute('data-score');\n                if (currentInputId) {\n                    document.getElementById(currentInputId).value = score;\n                }\n                closeModal();\n            }\n        });\n        document.addEventListener('keydown', function(e){\n            if (e.key === \"Escape\") closeModal();\n        });\n        document.getElementById('modal-bg').addEventListener('click', function(e){\n            if (e.target === this) closeModal();\n        });\n\n        // ë¶ˆì°¸ ë²„íŠ¼ ê¸°ëŠ¥\n        function toggleAbsent(num) {\n            const btn = document.getElementById('absent_btn_' + num);\n            const isNowAbsent = btn.classList.toggle('absent-active');\n            const s1 = document.getElementsByName('score1_' + num)[0];\n            const s2 = document.getElementsByName('score2_' + num)[0];\n            const s3 = document.getElementsByName('score3_' + num)[0];\n            const row = document.getElementById('score_row_' + num);\n            if (isNowAbsent) {\n                btn.innerText = 'ë¶ˆì°¸ ì·¨ì†Œ';\n                s1.value = 5; s2.value = 5; s3.value = 1;\n                s1.readOnly = true; s2.readOnly = true; s3.readOnly = true;\n                row.classList.add('score-row-absent');\n                document.getElementsByName('absent_' + num)[0].value = '1';\n            } else {\n                btn.innerText = 'ë¶ˆì°¸';\n                s1.readOnly = false; s2.readOnly = false; s3.readOnly = false;\n                row.classList.remove('score-row-absent');\n                document.getElementsByName('absent_' + num)[0].value = '0';\n            }\n        }\n        function isAbsent(num) {\n            return document.getElementById('absent_btn_' + num).classList.contains('absent-active');\n        }\n        function lockButtonsOnSubmit(f) {\n            f.querySelectorAll(\"button[type=submit]\").forEach(btn => btn.disabled = true);\n            return true;\n        }\n    </script>\n</body>\n</html>","size_bytes":18580},"comp/judge_scoring_minimal.php":{"content":"<?php\n// ì—ëŸ¬ ë¦¬í¬íŒ… í™œì„±í™”\nerror_reporting(E_ALL);\nini_set('display_errors', 1);\n\necho \"<!-- Minimal judge scoring -->\\n\";\n\nsession_start();\n\n$comp_id = $_GET['comp_id'] ?? '';\n$event_no = $_GET['event_no'] ?? '';\n$lang = $_GET['lang'] ?? 'ko';\n\necho \"<h1>ì‹¬ì‚¬ìœ„ì› ì±„ì  ì‹œìŠ¤í…œ (ìµœì†Œ ë²„ì „)</h1>\";\n\n// ê¸°ë³¸ ê²€ì¦\nif (!$comp_id || !$event_no) {\n    echo \"<p>ì˜ëª»ëœ ëŒ€íšŒ ID ë˜ëŠ” ì´ë²¤íŠ¸ ë²ˆí˜¸ì…ë‹ˆë‹¤.</p>\";\n    exit;\n}\n\n// ì„¸ì…˜ ê²€ì¦\nif (!isset($_SESSION['scoring_logged_in']) || !$_SESSION['scoring_logged_in']) {\n    echo \"<p>ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>\";\n    exit;\n}\n\necho \"<p>comp_id: \" . htmlspecialchars($comp_id) . \"</p>\";\necho \"<p>event_no: \" . htmlspecialchars($event_no) . \"</p>\";\necho \"<p>ì‹¬ì‚¬ìœ„ì› ID: \" . ($_SESSION['scoring_judge_id'] ?? 'N/A') . \"</p>\";\n\n// íŒŒì¼ ë¡œë”©\n$data_dir = __DIR__ . \"/data/$comp_id\";\n$players_file = \"$data_dir/players_$event_no.txt\";\n\nif (!file_exists($players_file)) {\n    echo \"<p>ì„ ìˆ˜ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: \" . $players_file . \"</p>\";\n    exit;\n}\n\n// ì„ ìˆ˜ ë°ì´í„° ë¡œë”©\n$players = file($players_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n\necho \"<h2>ì¶œì „ ì„ ìˆ˜:</h2>\";\nforeach ($players as $player) {\n    echo \"<p>ì„ ìˆ˜ ë²ˆí˜¸: \" . htmlspecialchars($player) . \"</p>\";\n}\n\necho \"<p>ê¸°ë³¸ ë¡œë”© ì™„ë£Œ!</p>\";\n?>\n\n\n\n\n\n\n","size_bytes":1343},"comp/judge_scoring_new.php":{"content":"<?php\n/**\n * ì‹¬ì‚¬ìœ„ì› ì±„ì  ì‹œìŠ¤í…œ - ë©”ì¸ ë¼ìš°í„°\n * ì´ë²¤íŠ¸ íƒ€ì…ì— ë”°ë¼ ì ì ˆí•œ ì‹¬ì‚¬ ì‹œìŠ¤í…œì„ ë¡œë“œ\n */\n\nsession_start();\n\n// ê³µí†µ í•¨ìˆ˜ë“¤ í¬í•¨\nrequire_once __DIR__ . '/scoring/shared/functions.php';\n\n// ê¸°ë³¸ ì„¤ì •\n$comp_id = $_GET['comp_id'] ?? '';\n$event_no = $_GET['event_no'] ?? '';\n$lang = $_GET['lang'] ?? 'ko';\n\n// ì„¸ì…˜ ê²€ì¦\nif (!validateJudgeSession($comp_id)) {\n    header(\"Location: scoring_login.php?comp_id=\" . urlencode($comp_id));\n    exit;\n}\n\n// ì´ë²¤íŠ¸ ë°ì´í„° ë¡œë“œ\n$event_data = loadEventData($comp_id, $event_no);\nif (!$event_data) {\n    die('<div class=\"error\">ì´ë²¤íŠ¸ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>');\n}\n\n// ì„ ìˆ˜ ë°ì´í„° ë¡œë“œ\n$players = loadPlayersData($comp_id, $event_no);\nif (empty($players)) {\n    die('<div class=\"error\">ì„ ìˆ˜ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>');\n}\n\n// ëŒ„ìŠ¤ ë§¤í•‘ ë¡œë“œ\n$dance_mapping = loadDanceMapping($comp_id);\n\n// ë¼ìš´ë“œ ì •ë³´ ë¡œë“œ\n$round_info = loadRoundInfo($comp_id);\n\n// ê²°ìŠ¹ì „ ì—¬ë¶€ í™•ì¸\n$is_final = isFinalRound($event_no, $round_info, $event_data);\n\n// ì–¸ì–´ í…ìŠ¤íŠ¸ ë¡œë“œ\n$t = getLanguageTexts($lang);\n\n// ì‹¬ì‚¬ìœ„ì› ì •ë³´\n$judge_id = $_SESSION['scoring_judge_id'] ?? '';\n$judge_name = $_SESSION['scoring_judge_name'] ?? '';\n$judge_country = $_SESSION['scoring_judge_country'] ?? '';\n\n// ì´ë²¤íŠ¸ë³„ ë°ì´í„° ì¤€ë¹„\n$recall_count = intval($event_data['recall_count'] ?? 0);\n$round_display = $event_data['round_type'] ?? '';\n\n// íˆíŠ¸ ë°ì´í„° ë¡œë“œ (ì˜ˆì„ /ì¤€ê²°ìŠ¹ìš©)\n$hits_data = null;\nif (!$is_final && $event_no !== '8') {\n    $data_dir = __DIR__ . \"/data/$comp_id\";\n    $hits_file = \"$data_dir/players_hits_$event_no.json\";\n    if (file_exists($hits_file)) {\n        $hits_data = json_decode(file_get_contents($hits_file), true);\n    }\n}\n\n// ê¸°ì¡´ ì„ íƒëœ ì„ ìˆ˜ë“¤ ë¡œë“œ (ì˜ˆì„ /ì¤€ê²°ìŠ¹ìš©)\n$existing_selections = [];\nif (!$is_final && $event_no !== '8') {\n    $existing_selections = loadExistingSelections($comp_id, $event_no, $judge_id, $event_data['dances']);\n}\n\n// ì €ì¥ëœ ìˆœìœ„ ë¡œë“œ (ê²°ìŠ¹ì „ìš©)\n$saved_rankings = [];\nif ($is_final || $event_no === '8') {\n    $data_dir = __DIR__ . \"/data/$comp_id\";\n    foreach ($event_data['dances'] as $dance) {\n        $adj_file = \"$data_dir/{$event_no}_{$dance}_{$judge_id}.adj\";\n        if (file_exists($adj_file)) {\n            $lines = file($adj_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n            $dance_rankings = [];\n            foreach ($lines as $line) {\n                $line = cleanInput($line);\n                $parts = explode(',', $line);\n                if (count($parts) >= 2) {\n                    $dance_rankings[] = [trim($parts[0]), trim($parts[1])];\n                }\n            }\n            if (!empty($dance_rankings)) {\n                $saved_rankings[$dance] = $dance_rankings;\n            }\n        }\n    }\n}\n\n// ì €ì¥ëœ ì ìˆ˜ í‘œì‹œìš©\n$saved_scores = [];\nif ($is_final || $event_no === '8') {\n    $saved_scores = array_keys($saved_rankings);\n} else {\n    $saved_scores = array_keys($existing_selections);\n}\n\n// ëŒ„ìŠ¤ ì´ë¦„ ë³€í™˜\n$dance_names = getDanceNames($event_data['dances'], $dance_mapping);\n?>\n\n<!DOCTYPE html>\n<html lang=\"<?=h($lang)?>\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title><?=h($t['title'])?></title>\n    \n    <!-- ê³µí†µ ìŠ¤íƒ€ì¼ í¬í•¨ -->\n    <?php include __DIR__ . '/scoring/shared/styles.php'; ?>\n</head>\n<body>\n    <div class=\"scoring-container\">\n        <!-- ì‹¬ì‚¬ìœ„ì› ì •ë³´ í—¤ë” -->\n        <?php renderJudgeInfoHeader($judge_id, $judge_name, $judge_country, $recall_count, $is_final, $event_no); ?>\n        \n        <!-- ì´ë²¤íŠ¸ ì •ë³´ í—¤ë” -->\n        <?php renderEventInfoHeader($event_data, $round_display, $dance_names, count($players), $hits_data, $saved_scores); ?>\n        \n        <!-- ë©”ì‹œì§€ ì»¨í…Œì´ë„ˆ -->\n        <?php renderMessageContainer(); ?>\n        \n        <!-- í¼ ì‹œì‘ -->\n        <?php renderFormStart($comp_id, $event_no, $is_final, $recall_count); ?>\n        \n        <!-- ì‹¬ì‚¬ ì‹œìŠ¤í…œ ë¡œë“œ -->\n        <?php if ($is_final || $event_no === '8'): ?>\n            <!-- ê²°ìŠ¹ì „ ì‹œìŠ¤í…œ -->\n            <?php include __DIR__ . '/scoring/types/multievent_final.php'; ?>\n        <?php else: ?>\n            <!-- ì˜ˆì„ /ì¤€ê²°ìŠ¹ ì‹œìŠ¤í…œ -->\n            <?php include __DIR__ . '/scoring/types/multievent_preliminary.php'; ?>\n        <?php endif; ?>\n        \n        <!-- í¼ ì¢…ë£Œ -->\n        <?php renderFormEnd(); ?>\n        \n        <!-- í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->\n        <?php renderBottomNavigation($comp_id, $lang); ?>\n        \n        <!-- í‘¸í„° -->\n        <?php renderFooter(); ?>\n    </div>\n    \n    <!-- ê³µí†µ JavaScript í¬í•¨ -->\n    <?php renderCommonJavaScript($comp_id, $lang); ?>\n</body>\n</html>\n\n\n\n\n\n\n","size_bytes":4848},"comp/judge_scoring_router.php":{"content":"<?php\n/**\n * ì‹¬ì‚¬ìœ„ì› ì±„ì  ì‹œìŠ¤í…œ - ë©”ì¸ ë¼ìš°í„°\n * 5ê°€ì§€ ì‹¬ì‚¬ ë°©ì‹ì„ ì§€ì›í•˜ëŠ” í†µí•© ë¼ìš°í„°\n */\n\nsession_start();\n\n// ê³µí†µ í•¨ìˆ˜ë“¤ í¬í•¨\nrequire_once __DIR__ . '/scoring/shared/functions.php';\n\n// ê¸°ë³¸ ì„¤ì •\n$comp_id = $_GET['comp_id'] ?? '';\n$event_no = $_GET['event_no'] ?? '';\n$lang = $_GET['lang'] ?? 'ko';\n\n// ì„¸ì…˜ ê²€ì¦ (ì„ì‹œë¡œ ìš°íšŒ)\necho \"<!-- SESSION DEBUG -->\";\necho \"<!-- scoring_logged_in: \" . (isset($_SESSION['scoring_logged_in']) ? ($_SESSION['scoring_logged_in'] ? 'TRUE' : 'FALSE') : 'NOT SET') . \" -->\";\necho \"<!-- scoring_comp_id: \" . ($_SESSION['scoring_comp_id'] ?? 'NOT SET') . \" -->\";\necho \"<!-- comp_id: \" . $comp_id . \" -->\";\necho \"<!-- END SESSION DEBUG -->\";\n\n// ì„ì‹œë¡œ ì„¸ì…˜ ê²€ì¦ ìš°íšŒ (í…ŒìŠ¤íŠ¸ìš©)\nif (false && !validateJudgeSession($comp_id)) {\n    header(\"Location: scoring_login.php?comp_id=\" . urlencode($comp_id));\n    exit;\n}\n\n// ì´ë²¤íŠ¸ ë°ì´í„° ë¡œë“œ\n$event_data = loadEventData($comp_id, $event_no);\nif (!$event_data) {\n    die('<div class=\"error\">ì´ë²¤íŠ¸ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>');\n}\n\n// ì„ ìˆ˜ ë°ì´í„° ë¡œë“œ\n$players = loadPlayersData($comp_id, $event_no);\nif (empty($players)) {\n    die('<div class=\"error\">ì„ ìˆ˜ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>');\n}\n\n// ëŒ„ìŠ¤ ë§¤í•‘ ë¡œë“œ\n$dance_mapping = loadDanceMapping($comp_id);\n\n// ë¼ìš´ë“œ ì •ë³´ ë¡œë“œ\n$round_info = loadRoundInfo($comp_id);\n\n// ê²°ìŠ¹ì „ ì—¬ë¶€ í™•ì¸\n$is_final = isFinalRound($event_no, $round_info, $event_data);\n\n// ì–¸ì–´ í…ìŠ¤íŠ¸ ë¡œë“œ\n$t = getLanguageTexts($lang);\n\n// ì‹¬ì‚¬ìœ„ì› ì •ë³´ (ì„ì‹œë¡œ ì„¤ì •)\n$judge_id = $_SESSION['scoring_judge_id'] ?? '8';\n$judge_name = $_SESSION['scoring_judge_name'] ?? 'Test Judge';\n$judge_country = $_SESSION['scoring_judge_country'] ?? 'Korea';\n\n// ì´ë²¤íŠ¸ë³„ ë°ì´í„° ì¤€ë¹„\n$recall_count = intval($event_data['recall_count'] ?? 0);\n$round_display = $event_data['round_type'] ?? '';\n\n// ì‹¬ì‚¬ ë°©ì‹ ê²°ì •\n$scoring_type = 'multievent_preliminary'; // ê¸°ë³¸ê°’\n\n// ì´ë²¤íŠ¸ë³„ ì‹¬ì‚¬ ë°©ì‹ ë§¤í•‘\n$scoring_type_mapping = [\n    '8' => 'multievent_final',           // ê¸°ì¡´ ê²°ìŠ¹ì „\n    '9' => 'multievent_preliminary',     // ê¸°ì¡´ ì¤€ê²°ìŠ¹\n    '10' => 'freestyle',                 // í”„ë¦¬ìŠ¤íƒ€ì¼\n    '11' => 'formation',                 // í¬ë©”ì´ì…˜\n    '12' => 'multievent_final_only'      // ë©€í‹°ì´ë²¤íŠ¸ ê²°ìŠ¹ì „(ì¤€ê²°ìŠ¹ ì—†ìŒ)\n];\n\n// ì´ë²¤íŠ¸ ë²ˆí˜¸ì— ë”°ë¥¸ ì‹¬ì‚¬ ë°©ì‹ ê²°ì •\nif (isset($scoring_type_mapping[$event_no])) {\n    $scoring_type = $scoring_type_mapping[$event_no];\n} elseif ($is_final || $event_no === '8') {\n    $scoring_type = 'multievent_final';\n}\n\n// ì‹¬ì‚¬ ë°©ì‹ë³„ ë°ì´í„° ì¤€ë¹„\n$hits_data = null;\n$existing_selections = [];\n$saved_rankings = [];\n\nif ($scoring_type === 'multievent_preliminary') {\n    // ì˜ˆì„ /ì¤€ê²°ìŠ¹ìš© ë°ì´í„°\n    $data_dir = __DIR__ . \"/data/$comp_id\";\n    $hits_file = \"$data_dir/players_hits_$event_no.json\";\n    if (file_exists($hits_file)) {\n        $hits_data = json_decode(file_get_contents($hits_file), true);\n    }\n    $existing_selections = loadExistingSelections($comp_id, $event_no, $judge_id, $event_data['dances']);\n} elseif (in_array($scoring_type, ['multievent_final', 'multievent_final_only'])) {\n    // ê²°ìŠ¹ì „ìš© ë°ì´í„°\n    $data_dir = __DIR__ . \"/data/$comp_id\";\n    foreach ($event_data['dances'] as $dance) {\n        $adj_file = \"$data_dir/{$event_no}_{$dance}_{$judge_id}.adj\";\n        if (file_exists($adj_file)) {\n            $lines = file($adj_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n            $dance_rankings = [];\n            foreach ($lines as $line) {\n                $line = cleanInput($line);\n                $parts = explode(',', $line);\n                if (count($parts) >= 2) {\n                    $dance_rankings[] = [trim($parts[0]), trim($parts[1])];\n                }\n            }\n            if (!empty($dance_rankings)) {\n                $saved_rankings[$dance] = $dance_rankings;\n            }\n        }\n    }\n}\n\n// ì €ì¥ëœ ì ìˆ˜ í‘œì‹œìš©\n$saved_scores = [];\nif (in_array($scoring_type, ['multievent_final', 'multievent_final_only'])) {\n    $saved_scores = array_keys($saved_rankings);\n} elseif ($scoring_type === 'multievent_preliminary') {\n    $saved_scores = array_keys($existing_selections);\n}\n\n// ëŒ„ìŠ¤ ì´ë¦„ ë³€í™˜\n$dance_names = getDanceNames($event_data['dances'], $dance_mapping);\n?>\n\n<!DOCTYPE html>\n<html lang=\"<?=h($lang)?>\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title><?=h($t['title'])?></title>\n    \n    <!-- ê³µí†µ ìŠ¤íƒ€ì¼ í¬í•¨ -->\n    <?php include __DIR__ . '/scoring/shared/styles.php'; ?>\n</head>\n<body>\n    <div class=\"scoring-container\">\n        <!-- ì‹¬ì‚¬ìœ„ì› ì •ë³´ í—¤ë” -->\n        <?php renderJudgeInfoHeader($judge_id, $judge_name, $judge_country, $recall_count, $is_final, $event_no); ?>\n        \n        <!-- ì´ë²¤íŠ¸ ì •ë³´ í—¤ë” -->\n        <?php renderEventInfoHeader($event_data, $round_display, $dance_names, count($players), $hits_data, $saved_scores); ?>\n        \n        <!-- ë©”ì‹œì§€ ì»¨í…Œì´ë„ˆ -->\n        <?php renderMessageContainer(); ?>\n        \n        <!-- í¼ ì‹œì‘ -->\n        <?php renderFormStart($comp_id, $event_no, $is_final, $recall_count); ?>\n        \n        <!-- ì‹¬ì‚¬ ì‹œìŠ¤í…œ ë¡œë“œ -->\n        <?php \n        echo \"<!-- DEBUG: scoring_type = \" . $scoring_type . \" -->\";\n        echo \"<!-- DEBUG: event_no = \" . $event_no . \" -->\";\n        echo \"<!-- DEBUG: is_final = \" . ($is_final ? 'TRUE' : 'FALSE') . \" -->\";\n        \n        $scoring_file = __DIR__ . \"/scoring/types/{$scoring_type}.php\";\n        echo \"<!-- DEBUG: scoring_file = \" . $scoring_file . \" -->\";\n        echo \"<!-- DEBUG: file_exists = \" . (file_exists($scoring_file) ? 'TRUE' : 'FALSE') . \" -->\";\n        \n        if (file_exists($scoring_file)) {\n            include $scoring_file;\n        } else {\n            echo '<div class=\"error\">ì§€ì›í•˜ì§€ ì•ŠëŠ” ì‹¬ì‚¬ ë°©ì‹ì…ë‹ˆë‹¤: ' . h($scoring_type) . '</div>';\n        }\n        ?>\n        \n        <!-- í¼ ì¢…ë£Œ -->\n        <?php renderFormEnd(); ?>\n        \n        <!-- í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->\n        <?php renderBottomNavigation($comp_id, $lang); ?>\n        \n        <!-- í‘¸í„° -->\n        <?php renderFooter(); ?>\n    </div>\n    \n    <!-- ê³µí†µ JavaScript í¬í•¨ -->\n    <?php renderCommonJavaScript($comp_id, $lang); ?>\n</body>\n</html>\n","size_bytes":6423},"comp/judge_scoring_simple.php":{"content":"<?php\n// ì—ëŸ¬ ë¦¬í¬íŒ… í™œì„±í™”\nerror_reporting(E_ALL);\nini_set('display_errors', 1);\n\necho \"<!-- Simple judge scoring test -->\\n\";\n\nsession_start();\n\n$comp_id = $_GET['comp_id'] ?? '';\n$event_no = $_GET['event_no'] ?? '';\n$lang = $_GET['lang'] ?? 'ko';\n\necho \"<h1>ì‹¬ì‚¬ìœ„ì› ì±„ì  ì‹œìŠ¤í…œ (ê°„ë‹¨ í…ŒìŠ¤íŠ¸)</h1>\";\necho \"<p>comp_id: \" . htmlspecialchars($comp_id) . \"</p>\";\necho \"<p>event_no: \" . htmlspecialchars($event_no) . \"</p>\";\necho \"<p>lang: \" . htmlspecialchars($lang) . \"</p>\";\n\n// ì„¸ì…˜ í™•ì¸\necho \"<p>ì„¸ì…˜ ë¡œê·¸ì¸ ìƒíƒœ: \" . (isset($_SESSION['scoring_logged_in']) ? 'YES' : 'NO') . \"</p>\";\necho \"<p>ì‹¬ì‚¬ìœ„ì› ID: \" . ($_SESSION['scoring_judge_id'] ?? 'N/A') . \"</p>\";\n\n// íŒŒì¼ ì¡´ì¬ í™•ì¸\n$data_dir = __DIR__ . \"/data/$comp_id\";\n$runorder_file = \"$data_dir/RunOrder_Tablet.txt\";\n$players_file = \"$data_dir/players_$event_no.txt\";\n\necho \"<p>ë°ì´í„° ë””ë ‰í† ë¦¬: \" . $data_dir . \"</p>\";\necho \"<p>ë””ë ‰í† ë¦¬ ì¡´ì¬: \" . (is_dir($data_dir) ? 'YES' : 'NO') . \"</p>\";\necho \"<p>RunOrder íŒŒì¼: \" . $runorder_file . \"</p>\";\necho \"<p>RunOrder íŒŒì¼ ì¡´ì¬: \" . (file_exists($runorder_file) ? 'YES' : 'NO') . \"</p>\";\necho \"<p>ì„ ìˆ˜ íŒŒì¼: \" . $players_file . \"</p>\";\necho \"<p>ì„ ìˆ˜ íŒŒì¼ ì¡´ì¬: \" . (file_exists($players_file) ? 'YES' : 'NO') . \"</p>\";\n\n// RunOrder íŒŒì¼ ì½ê¸° í…ŒìŠ¤íŠ¸\nif (file_exists($runorder_file)) {\n    echo \"<h2>RunOrder íŒŒì¼ ë‚´ìš© (ì²˜ìŒ 5ì¤„):</h2>\";\n    $lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    for ($i = 0; $i < min(5, count($lines)); $i++) {\n        echo \"<p>\" . ($i + 1) . \": \" . htmlspecialchars($lines[$i]) . \"</p>\";\n    }\n}\n\n// ì„ ìˆ˜ íŒŒì¼ ì½ê¸° í…ŒìŠ¤íŠ¸\nif (file_exists($players_file)) {\n    echo \"<h2>ì„ ìˆ˜ íŒŒì¼ ë‚´ìš©:</h2>\";\n    $players = file($players_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($players as $player) {\n        echo \"<p>ì„ ìˆ˜: \" . htmlspecialchars($player) . \"</p>\";\n    }\n}\n\necho \"<p><a href='judge_scoring.php?comp_id=$comp_id&event_no=$event_no&lang=$lang'>ì›ë˜ ì±„ì  í˜ì´ì§€ë¡œ ì´ë™</a></p>\";\n?>\n\n\n\n\n\n\n","size_bytes":2085},"comp/judge_scoring_test.php":{"content":"<?php\nsession_start();\n\n$comp_id = $_GET['comp_id'] ?? '';\n$event_no = $_GET['event_no'] ?? '';\n\n// Remove BOM and normalize - multiple methods\n$comp_id = preg_replace('/\\x{FEFF}/u', '', $comp_id);\n$event_no = preg_replace('/\\x{FEFF}/u', '', $event_no);\n\n// Additional BOM removal\n$comp_id = str_replace([\"\\xEF\\xBB\\xBF\", \"\\xFEFF\", \"\\uFEFF\"], '', $comp_id);\n$event_no = str_replace([\"\\xEF\\xBB\\xBF\", \"\\xFEFF\", \"\\uFEFF\"], '', $event_no);\n\n// Remove any non-printable characters\n$comp_id = preg_replace('/[\\x00-\\x1F\\x7F-\\x9F]/', '', $comp_id);\n$event_no = preg_replace('/[\\x00-\\x1F\\x7F-\\x9F]/', '', $event_no);\n\n$comp_id = preg_replace('/[^\\d-]/', '', $comp_id);\n$event_no = preg_replace('/\\D+/', '', $event_no);\n\n\n// Language setting\n$lang = $_GET['lang'] ?? 'ko';\nif (!in_array($lang, ['ko', 'en', 'zh', 'ja'])) {\n    $lang = 'ko';\n}\n\n// Language texts\n$texts = [\n    'ko' => [\n        'title' => 'ì‹¬ì‚¬ìœ„ì› ì±„ì  ì‹œìŠ¤í…œ',\n        'judge_info' => 'ì‹¬ì‚¬ìœ„ì›',\n        'event_info' => 'ì´ë²¤íŠ¸ ì •ë³´',\n        'event_no' => 'ì´ë²¤íŠ¸ ë²ˆí˜¸',\n        'round' => 'ë¼ìš´ë“œ',\n        'dances' => 'ì¢…ëª©',\n        'players' => 'ì¶œì „ ì„ ìˆ˜',\n        'place' => 'ìˆœìœ„',\n        'couple' => 'ì„ ìˆ˜',\n        'submit' => 'ì œì¶œ',\n        'no_data' => 'ì´ë²¤íŠ¸ ë°ì´í„° ë˜ëŠ” ì„ ìˆ˜ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.',\n        'invalid_data' => 'ì˜ëª»ëœ ëŒ€íšŒ ID ë˜ëŠ” ì´ë²¤íŠ¸ ë²ˆí˜¸ì…ë‹ˆë‹¤.'\n    ],\n    'en' => [\n        'title' => 'Judge Scoring System',\n        'judge_info' => 'Judge',\n        'event_info' => 'Event Information',\n        'event_no' => 'Event Number',\n        'round' => 'Round',\n        'dances' => 'Dances',\n        'players' => 'Competitors',\n        'place' => 'Place',\n        'couple' => 'Couple',\n        'submit' => 'Submit',\n        'no_data' => 'Event data or player data not found.',\n        'invalid_data' => 'Invalid competition ID or event number.'\n    ],\n    'zh' => [\n        'title' => 'è¯„å§”è¯„åˆ†ç³»ç»Ÿ',\n        'judge_info' => 'è¯„å§”',\n        'event_info' => 'èµ›äº‹ä¿¡æ¯',\n        'event_no' => 'èµ›äº‹ç¼–å·',\n        'round' => 'è½®æ¬¡',\n        'dances' => 'èˆç§',\n        'players' => 'å‚èµ›é€‰æ‰‹',\n        'place' => 'åæ¬¡',\n        'couple' => 'é€‰æ‰‹',\n        'submit' => 'æäº¤',\n        'no_data' => 'æ‰¾ä¸åˆ°èµ›äº‹æ•°æ®æˆ–é€‰æ‰‹æ•°æ®ã€‚',\n        'invalid_data' => 'æ— æ•ˆçš„æ¯”èµ›IDæˆ–èµ›äº‹ç¼–å·ã€‚'\n    ],\n    'ja' => [\n        'title' => 'å¯©æŸ»å“¡æ¡ç‚¹ã‚·ã‚¹ãƒ†ãƒ ',\n        'judge_info' => 'å¯©æŸ»å“¡',\n        'event_info' => 'ã‚¤ãƒ™ãƒ³ãƒˆæƒ…å ±',\n        'event_no' => 'ã‚¤ãƒ™ãƒ³ãƒˆç•ªå·',\n        'round' => 'ãƒ©ã‚¦ãƒ³ãƒ‰',\n        'dances' => 'ç¨®ç›®',\n        'players' => 'å‡ºå ´é¸æ‰‹',\n        'place' => 'é †ä½',\n        'couple' => 'é¸æ‰‹',\n        'submit' => 'æå‡º',\n        'no_data' => 'ã‚¤ãƒ™ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ã¾ãŸã¯é¸æ‰‹ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚',\n        'invalid_data' => 'ç„¡åŠ¹ãªå¤§ä¼šIDã¾ãŸã¯ã‚¤ãƒ™ãƒ³ãƒˆç•ªå·ã§ã™ã€‚'\n    ]\n];\n\n$t = $texts[$lang];\n\n// Check if judge is logged in\nif (!isset($_SESSION['scoring_logged_in']) || !$_SESSION['scoring_logged_in'] || $_SESSION['scoring_comp_id'] !== $comp_id) {\n    $lang = $_GET['lang'] ?? 'ko';\n    header(\"Location: scoring_login.php?comp_id=\" . urlencode($comp_id) . \"&lang=\" . urlencode($lang));\n    exit;\n}\n\nif (!$comp_id || !$event_no) {\n    echo \"<h1>\" . $t['invalid_data'] . \"</h1>\";\n    exit;\n}\n\n// Load event data\n$data_dir = __DIR__ . \"/data/$comp_id\";\n$runorder_file = \"$data_dir/RunOrder_Tablet.txt\";\n$players_file = \"$data_dir/players_$event_no.txt\";\n$round_info_file = \"$data_dir/round_info.json\";\n$dance_name_file = \"$data_dir/DanceName.txt\";\n\n$event_data = null;\n$players = [];\n$round_info = null;\n$hits_data = null;\n$dance_mapping = [];\n\n// Load dance name mapping\nif (file_exists($dance_name_file)) {\n    $lines = file($dance_name_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        $line = preg_replace('/\\x{FEFF}/u', '', $line);\n        $cols = array_map('trim', explode(',', $line));\n        if (count($cols) >= 3 && !empty($cols[2])) {\n            $dance_mapping[$cols[2]] = $cols[1]; // abbreviation => full name\n        }\n    }\n}\n\n// Function to convert dance abbreviations to full names\nfunction getDanceNames($dances, $dance_mapping) {\n    $result = [];\n    foreach ($dances as $dance) {\n        $dance = trim($dance);\n        if (isset($dance_mapping[$dance])) {\n            $result[] = $dance_mapping[$dance];\n        } else {\n            $result[] = $dance; // fallback to original if not found\n        }\n    }\n    return $result;\n}\n\n// Function to load existing selected numbers from .adj files\nfunction loadExistingSelections($comp_id, $event_no, $judge_id, $dances) {\n    $data_dir = __DIR__ . \"/data/$comp_id\";\n    $selections = [];\n    \n    foreach ($dances as $dance) {\n        $adj_file = \"$data_dir/{$event_no}_{$dance}_{$judge_id}.adj\";\n        if (file_exists($adj_file)) {\n            $lines = file($adj_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n            $dance_selections = [];\n    foreach ($lines as $line) {\n                $line = preg_replace('/\\x{FEFF}/u', '', $line);\n                $line = trim($line, '\"');\n                if (!empty($line)) {\n                    $dance_selections[] = $line;\n                }\n            }\n            $selections[$dance] = $dance_selections;\n        }\n    }\n    \n    return $selections;\n}\n\n// Load event information\nif (file_exists($runorder_file)) {\n    $lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        // Remove BOM from line - multiple methods\n        $line = preg_replace('/\\x{FEFF}/u', '', $line);\n        $line = str_replace([\"\\xEF\\xBB\\xBF\", \"\\xFEFF\", \"\\uFEFF\"], '', $line);\n        $line = preg_replace('/[\\x00-\\x1F\\x7F-\\x9F]/', '', $line);\n        \n        if (preg_match('/^bom/', $line)) continue;\n        $cols = array_map('trim', explode(',', $line));\n        if (($cols[0] ?? '') === $event_no) {\n            $event_data = [\n                'no' => $cols[0],\n                'name' => $cols[1],\n                'round_type' => $cols[2],\n                'round_num' => $cols[3],\n                'recall_count' => intval($cols[4] ?? 0), // 5th column (index 4) is recall count\n                'dances' => []\n            ];\n            for ($i = 6; $i <= 10; $i++) {\n                if (!empty($cols[$i])) $event_data['dances'][] = $cols[$i];\n            }\n            break;\n        }\n    }\n}\n\n// Load players\nif (file_exists($players_file)) {\n    $lines = file($players_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        // Remove BOM from line - multiple methods\n        $line = preg_replace('/\\x{FEFF}/u', '', $line);\n        $line = str_replace([\"\\xEF\\xBB\\xBF\", \"\\xFEFF\", \"\\uFEFF\"], '', $line);\n        $line = preg_replace('/[\\x00-\\x1F\\x7F-\\x9F]/', '', $line);\n        $line = trim($line);\n        if ($line && is_numeric($line)) {\n            $players[] = $line;\n        }\n    }\n}\n\n// Load round information\nif (file_exists($round_info_file)) {\n    $round_info = json_decode(file_get_contents($round_info_file), true);\n}\n\n// Determine if this is a final round\n$is_final = false;\n$round_display = '';\n\nif ($round_info && isset($round_info['round_info'])) {\n    // Try both string and numeric keys\n    $round_display = $round_info['round_info'][$event_no] ?? $round_info['round_info'][intval($event_no)] ?? '';\n    $is_final = ($round_display === 'Final' || stripos($round_display, 'Final') !== false);\n    error_log(\"After round_info check: is_final = \" . ($is_final ? 'true' : 'false'));\n} elseif ($event_data && isset($event_data['round_type'])) {\n    $round_display = $event_data['round_type'];\n    $is_final = ($round_display === 'Final' || stripos($event_data['round_type'], 'Final') !== false);\n    error_log(\"After event_data check: is_final = \" . ($is_final ? 'true' : 'false'));\n}\n\n// Fallback: Check if this is a known final event\nif (!$is_final) {\n    $known_final_events = ['8', '9', '39', '28', '75', '74']; // Known final events from round_info.json\n    if (in_array($event_no, $known_final_events)) {\n        $is_final = true;\n        $round_display = 'Final';\n        error_log(\"After fallback check: is_final = \" . ($is_final ? 'true' : 'false'));\n    }\n}\n\nerror_log(\"Final is_final value: \" . ($is_final ? 'true' : 'false'));\n\n// Force final for event 8 for testing\nif ($event_no === '8') {\n    $is_final = true;\n    $round_display = 'Final';\n    error_log(\"Forced is_final to true for event 8\");\n}\n\n// Additional debug\nerror_log(\"Final check - Event: $event_no, is_final: \" . ($is_final ? 'true' : 'false'));\n\n\n// Load hits data if exists\n$hits_file = \"$data_dir/players_hits_$event_no.json\";\nif (file_exists($hits_file)) {\n    $hits_data = json_decode(file_get_contents($hits_file), true);\n}\n\n// Load existing selections for all dances\n$existing_selections = [];\nif ($event_data && isset($event_data['dances'])) {\n    $existing_selections = loadExistingSelections($comp_id, $event_no, $_SESSION['scoring_judge_id'], $event_data['dances']);\n}\n\n// Load saved scores\n$saved_scores = null;\n$judge_id = $_SESSION['scoring_judge_id'] ?? 'unknown';\n\nif ($is_final) {\n    // Load final round scores - check individual dance files for this judge\n    $adj_files = glob(\"$data_dir/{$event_no}_*.adj\");\n    \n    // Also check for files with different event numbers but same judge (for compatibility)\n    $compat_files = glob(\"$data_dir/*_*_{$judge_id}.adj\");\n    $adj_files = array_merge($adj_files, $compat_files);\n    \n    // Debug: Log found files\n    error_log(\"Found adj files: \" . implode(', ', $adj_files));\n    $final_scores = [];\n    $saved_rankings = []; // Store actual ranking data for UI restoration\n    \n    foreach ($adj_files as $file) {\n        $filename = basename($file);\n        if (preg_match('/^(\\d+)_(.+)_(\\d+)\\.adj$/', $filename, $matches)) {\n            $file_event = $matches[1];\n            $file_dance = $matches[2];\n            $file_judge_id = $matches[3];\n            \n            // Check if this is for current judge and current event (or compatible event)\n            if ($file_judge_id === $judge_id && ($file_event === $event_no || $file_event === '1')) {\n                error_log(\"Loading file: $filename for dance: $file_dance\");\n                $final_scores[$file_dance] = true; // This judge has submitted for this dance\n                \n                // Load actual ranking data for UI restoration\n                $lines = file($file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n                $rankings = [];\n                \n                foreach ($lines as $line) {\n                    $line = trim($line);\n                    if (empty($line)) continue;\n                    \n                    if (strpos($line, ',') !== false) {\n                        // New format: player,rank\n                        list($player, $rank) = explode(',', $line, 2);\n                        $player = trim($player, '\"');\n                        $rank = intval(trim($rank));\n                        if (is_numeric($player) && $rank > 0) {\n                            $rankings[$rank] = $player;\n                        }\n        } else {\n                        // Old format: just player numbers (convert to rank 1,2,3...)\n                        $player = trim($line, '\"');\n                        if (is_numeric($player)) {\n                            $rankings[count($rankings) + 1] = $player;\n                        }\n                    }\n                }\n                \n                if (!empty($rankings)) {\n                    $saved_rankings[$file_dance] = $rankings;\n                }\n            }\n        }\n    }\n    \n    if (!empty($final_scores)) {\n        $saved_scores = $final_scores;\n    }\n    \n    // Debug: Log saved rankings\n    error_log(\"Judge ID: $judge_id, Event: $event_no, Saved rankings: \" . json_encode($saved_rankings));\n} else {\n    // Load recall scores for this judge\n    $adj_files = glob(\"$data_dir/{$event_no}_*.adj\");\n    $recall_scores = [];\n    \n    foreach ($adj_files as $file) {\n        $filename = basename($file);\n        if (preg_match('/^(\\d+)_(.+)_(\\d+)\\.adj$/', $filename, $matches)) {\n            $file_dance = $matches[2];\n            $file_judge_id = $matches[3];\n            \n            if ($file_judge_id === $judge_id) {\n                $lines = file($file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n                $players = [];\n                \n    foreach ($lines as $line) {\n                    $line = trim($line, '\"');\n                    if ($line && is_numeric($line)) {\n                        $players[] = $line;\n                    }\n                }\n                \n                $recall_scores[$file_dance] = $players;\n            }\n        }\n    }\n    \n    if (!empty($recall_scores)) {\n        $saved_scores = $recall_scores;\n    }\n}\n\nif (!$event_data || empty($players)) {\n    echo \"<h1>\" . $t['no_data'] . \"</h1>\";\n    echo \"<p>comp_id: '$comp_id', event_no: '$event_no'</p>\";\n    echo \"<p>runorder_file: \" . (file_exists($runorder_file) ? 'exists' : 'not found') . \"</p>\";\n    echo \"<p>players_file: \" . (file_exists($players_file) ? 'exists' : 'not found') . \"</p>\";\n    exit;\n}\n\nfunction h($s) { return htmlspecialchars($s ?? ''); }\n?>\n<!DOCTYPE html>\n<html lang=\"<?=h($lang)?>\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title><?=h($t['title'])?> | <?=h($event_data['name'])?></title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\n    <style>\n        body { background:#1a1a1a; font-family:sans-serif; margin:0; padding:2px;}\n        .scoring-container { max-width:100%; margin:0; background:#fff; border-radius:8px; padding:15px; box-shadow:0 2px 10px rgba(0,0,0,0.3);}\n        h1 { color:#003399; margin-bottom:20px; text-align:center;}\n        .event-info { background:#f0f4ff; padding:15px; border-radius:8px; margin-bottom:20px; text-align:center;}\n        .event-info h2 { margin:0 0 10px 0; color:#0d2c96;}\n        .event-info p { margin:5px 0; color:#333;}\n        .adjudicator-section { margin-bottom:10px;}\n        .adjudicator-header { background:#003399; color:#fff; padding:10px 15px; border-radius:6px 6px 0 0; font-weight:bold;}\n        .scoring-table { width:100%; border-collapse:collapse; background:#fff; border:1px solid #ddd;}\n        .scoring-table th, .scoring-table td { padding:12px 8px; text-align:center; border:1px solid #ddd;}\n        .scoring-table th { background:#f8f9fa; font-weight:bold; color:#333;}\n        .scoring-table tr:nth-child(even) { background:#f8f9fa;}\n        .place-input { width:60px; padding:8px; border:2px solid #ddd; border-radius:4px; text-align:center; font-size:16px; font-weight:bold;}\n        .place-input:focus { border-color:#003399; outline:none;}\n        .couple-info { text-align:left; font-weight:bold; color:#333;}\n        .submit-section { text-align:center; margin-top:30px;}\n        .submit-btn { background:#03C75A; color:#fff; border:none; padding:15px 30px; font-size:16px; font-weight:bold; border-radius:8px; cursor:pointer; margin:0 10px;}\n        .submit-btn:hover { background:#00BFAE;}\n        .clear-btn { background:#FF6B35; color:#fff; border:none; padding:15px 30px; font-size:16px; font-weight:bold; border-radius:8px; cursor:pointer; margin:0 10px;}\n        .clear-btn:hover { background:#E55A2B;}\n        .warning { background:#fff3cd; border:1px solid #ffeaa7; color:#856404; padding:10px; border-radius:4px; margin-bottom:20px;}\n        .error { background:#f8d7da; border:1px solid #f5c6cb; color:#721c24; padding:10px; border-radius:4px; margin-bottom:20px;}\n        .success { background:#d4edda; border:1px solid #c3e6cb; color:#155724; padding:10px; border-radius:4px; margin-bottom:20px;}\n        .rules-info { background:#e7f3ff; border:1px solid #b3d9ff; color:#004085; padding:15px; border-radius:6px; margin-bottom:20px;}\n        .rules-info h3 { margin:0 0 10px 0; color:#003399;}\n        .rules-info ul { margin:10px 0; padding-left:20px;}\n        .rules-info li { margin:5px 0;}\n        \n        /* Final Round Styles - Touch-based System */\n        .final-scoring-container {\n            display: flex;\n            gap: 15px;\n            padding: 15px;\n            background: #fff;\n            border: 3px solid #003399;\n            border-radius: 8px;\n            min-height: 450px;\n            box-shadow: 0 4px 12px rgba(0, 51, 153, 0.15);\n        }\n        \n        .players-column, .ranking-column {\n            flex: 1;\n            background: #f8f9fa;\n            border: 2px solid #e9ecef;\n            border-radius: 8px;\n            padding: 12px;\n            box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n            display: flex;\n            flex-direction: column;\n        }\n        \n        .players-column h3, .ranking-column h3 {\n            margin: 0 0 8px 0;\n            color: #333;\n            font-size: 16px;\n            text-align: center;\n            padding-bottom: 6px;\n            border-bottom: 2px solid #003399;\n        }\n        \n        .players-list,         .ranking-list {\n            display: flex;\n            flex-direction: column;\n            gap: 12px; /* Increased gap for better spacing */\n            flex: 1;\n            overflow-y: auto;\n            padding-left: 10px; /* Add left padding for rank labels */\n        }\n        \n        .player-item {\n            background: #003399;\n            color: #fff;\n            padding: 16px 12px; /* Reduced horizontal padding */\n            border-radius: 8px;\n            text-align: center;\n            font-size: 18px; /* Slightly smaller font */\n            font-weight: bold;\n            cursor: pointer;\n            transition: all 0.3s ease;\n            user-select: none;\n            min-height: 60px;\n            height: 60px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n        }\n        \n        .player-item:hover {\n            background: #002266;\n            transform: translateY(-2px);\n            box-shadow: 0 4px 8px rgba(0,0,0,0.2);\n        }\n        \n        .player-item.selected {\n            background: #28a745;\n            transform: scale(1.05);\n            box-shadow: 0 6px 12px rgba(40, 167, 69, 0.3);\n        }\n        \n        .player-item.assigned {\n            opacity: 0.3;\n            background: #6c757d;\n            cursor: not-allowed;\n        }\n        \n        .ranking-slot {\n            background: #fff;\n            border: 2px solid #ddd;\n            border-radius: 8px;\n            padding: 16px 12px; /* Reduced horizontal padding */\n            text-align: center;\n            cursor: pointer;\n            transition: all 0.3s ease;\n            min-height: 60px;\n            height: 60px;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n            position: relative;\n            margin-left: 20px; /* Add left margin for rank label */\n        }\n        \n        .ranking-slot::before {\n            content: attr(data-rank) \"ìœ„\";\n            position: absolute;\n            top: 50%;\n            left: -15px;\n            transform: translateY(-50%);\n            background: #003399;\n            color: #fff;\n            padding: 4px 8px;\n            border-radius: 12px;\n            font-size: 12px;\n            font-weight: bold;\n            z-index: 10;\n            white-space: nowrap;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n        }\n        \n        .ranking-slot:hover {\n            border-color: #003399;\n            background: #f8f9ff;\n        }\n        \n        .ranking-slot.assigned {\n            border-color: #28a745;\n            background: #f8fff9;\n            cursor: pointer;\n        }\n        \n        .ranking-slot.assigned:hover {\n            border-color: #dc3545;\n            background: #fff5f5;\n        }\n        \n        .ranking-slot.assigned:hover .player-assigned {\n            color: #dc3545;\n        }\n        \n        .ranking-slot.dragging {\n            opacity: 0.5;\n            transform: rotate(5deg);\n            border-color: #ffc107;\n            background: #fff3cd;\n        }\n        \n        .ranking-slot.drag-over {\n            border-color: #007bff;\n            background: #e3f2fd;\n            transform: scale(1.05);\n        }\n        \n        .player-assigned {\n            font-size: 20px;\n            font-weight: bold;\n            color: #28a745;\n            min-height: 24px;\n        }\n        \n        .final-actions {\n            text-align: center;\n            margin-top: 20px;\n            padding: 20px;\n        }\n        \n        /* Dance Progress Styles for Final Round */\n        .dance-progress-header .dance-progress {\n            display: flex;\n            justify-content: center;\n            gap: 10px;\n            flex-wrap: wrap;\n        }\n        \n        .dance-step {\n            padding: 8px 16px;\n            border-radius: 20px;\n            font-size: 14px;\n            font-weight: bold;\n            transition: all 0.3s ease;\n            cursor: pointer;\n            border: 2px solid #ddd;\n            background: #fff;\n            color: #666;\n        }\n        \n        .dance-step.current {\n            background: #003399;\n            color: #fff;\n            border-color: #003399;\n        }\n        \n        .dance-step.completed {\n            background: #28a745;\n            color: #fff;\n            border-color: #28a745;\n        }\n        \n        .dance-step.pending {\n            background: #f8f9fa;\n            color: #6c757d;\n            border-color: #dee2e6;\n        }\n        \n        .dance-step:hover:not(.pending) {\n            transform: translateY(-2px);\n            box-shadow: 0 4px 8px rgba(0,0,0,0.2);\n        }\n        \n        .btn {\n            padding: 12px 24px;\n            border: none;\n            border-radius: 6px;\n            cursor: pointer;\n            font-size: 14px;\n            font-weight: 600;\n            transition: all 0.2s;\n            margin: 5px;\n        }\n        \n        .btn-primary {\n            background: #003399;\n            color: #fff;\n        }\n        \n        .btn-primary:hover {\n            background: #002266;\n        }\n        \n        .btn-secondary {\n            background: #6c757d;\n            color: #fff;\n        }\n        \n        .btn-secondary:hover {\n            background: #545b62;\n        }\n        \n        /* Instagram Style Dance Container */\n        .dance-container { position: relative; overflow: hidden; }\n        \n        .dance-progress {\n    display: flex;\n    align-items: center;\n            margin-bottom: 20px;\n            padding: 0 20px;\n        }\n        \n        .progress-bar {\n            flex: 1;\n            height: 6px;\n            background: #e0e0e0;\n            border-radius: 3px;\n            margin-right: 15px;\n            overflow: hidden;\n        }\n        \n        .progress-fill {\n            height: 100%;\n            background: linear-gradient(90deg, #4CAF50, #2e7d32);\n            border-radius: 3px;\n            transition: width 0.3s ease;\n        }\n        \n        .progress-text {\n            font-size: 14px;\n            font-weight: bold;\n            color: #666;\n            white-space: nowrap;\n        }\n        \n        .dance-slider {\n    display: flex;\n            transition: transform 0.3s ease;\n        }\n        \n        .dance-page {\n            min-width: 100%;\n            padding: 0 20px;\n            box-sizing: border-box;\n        }\n        \n        .dance-header { \n            background:#4CAF50; \n            color:#fff; \n            padding:10px; \n            border-radius:6px; \n            margin-bottom:15px; \n            text-align:center;\n        }\n        .dance-header h3 { margin:0 0 5px 0; font-size:16px;}\n        .dance-header p { margin:0; font-size:12px; opacity:0.9;}\n        \n        /* Heat section styles */\n        .heat-section { margin-bottom:15px; padding:10px; background:#fff; border-radius:6px; border:1px solid #ddd;}\n        .heat-section h4 { margin:0 0 10px 0; color:#333; font-size:14px; text-align:center;}\n        \n        /* Players grid styles - Mobile optimized */\n        .players-grid { \n            display:grid; \n            grid-template-columns:repeat(auto-fill, minmax(60px, 1fr)); \n            gap:4px; \n            margin-bottom:15px;\n        }\n        .player-card { \n            background:#fff; \n            border:2px solid #ddd; \n            border-radius:6px; \n            padding:6px 2px; \n            text-align:center; \n            cursor:pointer; \n            transition:all 0.3s ease;\n            position:relative;\n            min-height:50px;\n            display:flex;\n            flex-direction:column;\n            justify-content:center;\n            align-items:center;\n        }\n        .player-card:hover { \n            border-color:#4CAF50; \n            transform:translateY(-2px); \n            box-shadow:0 4px 8px rgba(0,0,0,0.15);\n        }\n        .player-card.selected { \n            border-color:#4CAF50; \n            background:linear-gradient(135deg, #e8f5e8, #c8e6c9);\n            transform:scale(1.05);\n            box-shadow:0 6px 12px rgba(76, 175, 80, 0.3);\n        }\n        .player-number { \n            font-size:24px; \n            font-weight:900; \n            color:#333;\n            margin:0;\n            line-height:1;\n        }\n        .player-card.selected .player-number {\n            color:#2e7d32;\n        }\n        .recall-checkbox { \n            display:none; /* Hide checkbox, use card click instead */\n        }\n        \n        /* Recall status - Large and clear */\n        .recall-status { \n            text-align:center; \n            padding:15px; \n            background:#f0f0f0; \n            border-radius:8px; \n            font-weight:bold; \n            color:#333;\n            font-size:16px;\n            margin:15px 0;\n            border:2px solid #ddd;\n        }\n        .recall-status.complete { \n            background:linear-gradient(135deg, #d4edda, #c3e6cb); \n            color:#155724; \n            border:3px solid #28a745;\n            animation:pulse 2s infinite;\n        }\n        .recall-status.over { \n            background:linear-gradient(135deg, #f8d7da, #f5c6cb); \n            color:#721c24; \n            border:3px solid #dc3545;\n        }\n        .recall-status .selected-count {\n            font-size:24px;\n            font-weight:900;\n        }\n        \n        @keyframes pulse {\n            0% { transform: scale(1); }\n            50% { transform: scale(1.02); }\n            100% { transform: scale(1); }\n        }\n        \n        /* Drag and drop for final ranking */\n        .ranking-container { display:flex; flex-direction:column; gap:10px; margin:20px 0;}\n        .ranking-item { \n            display:flex; \n            align-items:center; \n            background:#fff; \n            border:2px solid #ddd; \n            border-radius:8px; \n            padding:15px; \n            cursor:move;\n            transition:all 0.3s ease;\n            user-select:none;\n        }\n        .ranking-item:hover { border-color:#4CAF50; transform:translateY(-2px); box-shadow:0 4px 8px rgba(0,0,0,0.1);}\n        .ranking-item.dragging { opacity:0.5; transform:rotate(5deg);}\n        .ranking-number { \n            background:#4CAF50; \n            color:#fff; \n            width:40px; \n            height:40px; \n            border-radius:50%; \n            display:flex; \n            align-items:center; \n            justify-content:center; \n            font-weight:bold; \n            margin-right:15px;\n            flex-shrink:0;\n        }\n        .ranking-player { \n            flex:1; \n            font-size:18px; \n            font-weight:bold; \n            color:#333;\n        }\n        .ranking-place-input { \n            width:60px; \n            padding:8px; \n            border:2px solid #ddd; \n            border-radius:4px; \n            text-align:center; \n            font-size:16px; \n            font-weight:bold;\n            margin-left:15px;\n        }\n        .ranking-place-input:focus { border-color:#4CAF50; outline:none;}\n        \n        /* Fixed Progress Bar for Mobile */\n        .fixed-progress {\n            position: fixed;\n            top: 0;\n            left: 0;\n            right: 0;\n            background: linear-gradient(135deg, #ff9800, #ff5722);\n            color: white;\n            padding: 12px 20px;\n            text-align: center;\n            font-size: 18px;\n            font-weight: bold;\n            z-index: 1000;\n            box-shadow: 0 2px 10px rgba(0,0,0,0.3);\n            transform: translateY(-100%);\n            transition: transform 0.3s ease;\n        }\n        .fixed-progress.show {\n            transform: translateY(0);\n        }\n        .fixed-progress.complete {\n            background: linear-gradient(135deg, #4CAF50, #2e7d32);\n        }\n        .fixed-progress.over {\n            background: linear-gradient(135deg, #f44336, #d32f2f);\n        }\n        \n        /* Add top padding to body when progress bar is shown */\n        body.progress-bar-visible {\n            padding-top: 60px;\n        }\n        \n        /* Bottom Navigation */\n        .bottom-nav {\n            position: fixed;\n            bottom: 0;\n            left: 0;\n            right: 0;\n            background: #fff;\n            border-top: 2px solid #e0e0e0;\n            padding: 10px 20px;\n            display: flex;\n            justify-content: space-around;\n    align-items: center;\n            z-index: 1000;\n            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);\n        }\n        \n        .nav-button {\n            background: #f5f5f5;\n            color: #333;\n            border: none;\n            padding: 12px 20px;\n            border-radius: 8px;\n            cursor: pointer;\n            font-size: 14px;\n            font-weight: bold;\n            transition: all 0.3s ease;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            gap: 4px;\n            min-width: 80px;\n        }\n        \n        .nav-button:hover {\n            background: #e0e0e0;\n            transform: translateY(-2px);\n        }\n        \n        .nav-button.primary {\n            background: #2196F3;\n            color: #fff;\n        }\n        \n        .nav-button.primary:hover {\n            background: #1976D2;\n        }\n        \n        .nav-icon {\n            font-size: 18px;\n        }\n        \n        .nav-text {\n            font-size: 12px;\n        }\n        \n        /* Add bottom padding to body for navigation */\n        body {\n            padding-bottom: 80px;\n        }\n        \n        /* Tablet responsive - Optimized for tablet screens */\n        @media (min-width: 769px) and (max-width: 1024px) {\n            .event-info {\n                padding: 3px !important;\n                margin-bottom: 2px !important;\n            }\n            \n            .event-info h1 {\n                font-size: 16px !important;\n                margin-bottom: 1px !important;\n            }\n            \n            .event-info p {\n                font-size: 11px !important;\n            }\n            \n            .saved-scores-info {\n                padding: 4px !important;\n                margin-bottom: 6px !important;\n            }\n            \n            .saved-scores-info h3 {\n                font-size: 12px !important;\n                margin-bottom: 2px !important;\n            }\n            \n            .dance-progress-header {\n                padding: 3px !important;\n                margin-bottom: 4px !important;\n            }\n            \n            .dance-progress-header h3 {\n                font-size: 12px !important;\n                margin-bottom: 1px !important;\n            }\n            \n            .final-scoring-container {\n                gap: 10px;\n                padding: 10px;\n                min-height: 380px;\n            }\n            \n            .players-column, .ranking-column {\n                padding: 8px;\n            }\n            \n            .players-column h3, .ranking-column h3 {\n                font-size: 14px;\n                margin-bottom: 6px;\n            }\n            \n            .players-list, .ranking-list {\n                gap: 8px;\n            }\n            \n            .player-item, .ranking-slot {\n                padding: 12px 16px;\n                font-size: 16px;\n                min-height: 50px;\n                height: 50px;\n            }\n            \n            .ranking-slot::before {\n                font-size: 10px;\n                padding: 2px 6px;\n            }\n        }\n        \n        /* Mobile responsive - Optimized for touch */\n        @media (max-width: 768px) {\n            .final-scoring-container {\n                flex-direction: row; /* ì¢Œìš° ë°°ì¹˜ ìœ ì§€ */\n                gap: 10px;\n                padding: 10px;\n                min-height: 400px;\n            }\n            \n            .players-column, .ranking-column {\n                min-height: 350px;\n                flex: 1;\n            }\n            \n            .player-item, .ranking-slot {\n                padding: 12px;\n                font-size: 16px;\n                min-height: 45px;\n                height: 45px;\n            }\n            \n            .ranking-slot::before {\n                font-size: 10px;\n                padding: 2px 6px;\n                top: 50%;\n                left: -12px;\n                transform: translateY(-50%);\n            }\n            \n            .ranking-slot {\n                margin-left: 15px; /* Smaller margin for mobile */\n            }\n            \n            .player-assigned {\n                font-size: 16px;\n            }\n            \n            .players-grid { \n                grid-template-columns:repeat(auto-fill, minmax(50px, 1fr)); \n                gap:4px;\n                margin-bottom:10px;\n            }\n            .player-card { \n                padding:4px 2px;\n                min-height:45px;\n                border-width:2px;\n            }\n            .player-number { \n                font-size:20px;\n            }\n            .dance-header h3 { \n                font-size:14px;\n            }\n            .dance-header p {\n                font-size:12px;\n            }\n            .recall-status {\n                padding:15px;\n                font-size:16px;\n                margin:15px 0;\n            }\n            .recall-status .selected-count {\n                font-size:20px;\n            }\n            .ranking-item { \n                padding:10px;\n                flex-direction:column;\n                gap:8px;\n            }\n            .ranking-number { \n                width:35px; \n                height:35px; \n                margin-right:0;\n                margin-bottom:5px;\n            }\n            .ranking-player { \n                font-size:16px;\n                text-align:center;\n            }\n            .ranking-place-input {\n                width:50px;\n                margin-left:0;\n            }\n        }\n        \n        @media (max-width: 480px) {\n            .players-grid { \n                grid-template-columns:repeat(auto-fill, minmax(55px, 1fr)); \n                gap:5px;\n            }\n            .player-card { \n                padding:5px 2px;\n                min-height:45px;\n            }\n            .player-number { \n                font-size:22px;\n            }\n            .recall-status {\n                padding:12px;\n                font-size:14px;\n            }\n            .recall-status .selected-count {\n                font-size:18px;\n            }\n        }\n    </style>\n</head>\n<body>\n<div class=\"scoring-container\">\n    <?php \n    // Determine scoring type and recall count\n    $is_final = false;\n    $is_preliminary = false;\n    $recall_count = $event_data['recall_count'] ?? 0;\n    \n    if ($round_info && isset($round_info[$event_no])) {\n        $round_display = $round_info[$event_no]['round_display'] ?? '';\n        $is_final = (strpos($round_display, 'Final') !== false);\n        $is_preliminary = !$is_final;\n    } else {\n        // Fallback to old system\n        $is_final = (strpos($event_data['round_type'], 'Final') !== false);\n        $is_preliminary = !$is_final;\n    }\n    ?>\n\n    <!-- Judge Info and Recall in One Line -->\n    <div style=\"margin-bottom:15px; text-align:center; padding:10px; background:#f8f9fa; border-radius:6px;\">\n        <div style=\"display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:10px;\">\n            <div style=\"font-size:14px; font-weight:bold; color:#333;\">\n                #<?=h($_SESSION['scoring_judge_id'])?> <?=h($_SESSION['scoring_judge_name'])?>(<?=h($_SESSION['scoring_judge_country'])?>)\n            </div>\n            <?php if (!$is_final && $event_no !== '8'): ?>\n            <div style=\"font-size:16px; font-weight:bold; color:#ff9800;\">\n                Recall <span id=\"recallProgress\">0</span> / <?= $recall_count ?>\n            </div>\n            <?php endif; ?>\n        </div>\n    </div>\n    \n    \n            <div class=\"event-info\" style=\"display:flex; justify-content:space-between; align-items:center; margin-bottom:2px; padding:4px; background:#f8f9fa; border-radius:4px;\">\n        <div style=\"flex:1;\">\n            <h1 style=\"margin:0 0 2px 0; color:#333; font-size:18px; font-weight:bold;\"><?=h($event_data['name'])?></h1>\n            <?php \n            // Get round display\n            $round_display = '';\n            if ($round_info && isset($round_info['round_info'][$event_no])) {\n                $round_display = $round_info['round_info'][$event_no] ?? '';\n            } else {\n                $round_display = trim($event_data['round_type'] . ' ' . $event_data['round_num']);\n            }\n            \n            // Get dance names\n            $dance_names = getDanceNames($event_data['dances'], $dance_mapping);\n            ?>\n            <p style=\"margin:0; font-size:12px; color:#666;\">\n                <?=h($round_display)?> (<?=h(implode(',', $dance_names))?>) | <?=count($players)?> couples<?php if ($hits_data && !empty($hits_data)): ?> / <?=count($hits_data)?> heats<?php endif; ?>\n            </p>\n                    </div>\n        <div style=\"text-align:right; font-size:11px; color:#666;\">\n            <div style=\"font-weight:bold; color:#2e7d32;\">\n                <?php if ($saved_scores): ?>\n                    <?= implode(', ', array_keys($saved_scores)) ?>\n                <?php else: ?>\n                    ì—†ìŒ\n                <?php endif; ?>\n                    </div>\n        </div>\n                    </div>\n\n    \n\n    <div id=\"message\"></div>\n    \n    <!-- Fixed Progress Bar for Mobile (Preliminary/Recall only) -->\n    <?php if (!$is_final && $event_no !== '8'): ?>\n    <div id=\"fixedProgress\" class=\"fixed-progress\">\n        Recall <span id=\"fixedRecallCount\">0</span> / <?= $recall_count ?>\n                    </div>\n    <?php endif; ?>\n    \n\n    <form id=\"scoringForm\">\n        <input type=\"hidden\" name=\"comp_id\" value=\"<?=h($comp_id)?>\">\n        <input type=\"hidden\" name=\"event_no\" value=\"<?=h($event_no)?>\">\n        <input type=\"hidden\" name=\"is_final\" value=\"<?= $is_final ? '1' : '0' ?>\">\n        <input type=\"hidden\" name=\"recall_count\" value=\"<?= $recall_count ?>\">\n        \n        <?php if ($is_final || $event_no === '8'): ?>\n            <!-- Final Round - Touch-based Ranking System -->\n        <div class=\"adjudicator-section\">\n            <!-- Dance Progress Header -->\n            <div class=\"dance-progress-header\" id=\"danceProgressHeader\" style=\"display:flex; justify-content:flex-end; align-items:center; background: #f8f9fa; padding: 4px; border-radius: 4px; margin-bottom: 4px;\">\n                <div style=\"display:flex; align-items:center; gap:10px;\">\n                    <div class=\"dance-progress\" id=\"danceProgress\">\n                        <!-- Dance progress will be populated by JavaScript -->\n                    </div>\n                    <div id=\"currentDanceDisplay\" style=\"font-size: 12px; font-weight: bold; color: #003399;\">\n                        <!-- Current dance will be displayed here -->\n                    </div>\n                </div>\n            </div>\n            \n            <p style=\"text-align:center; color:#666; margin:2px 0; font-size:11px;\">\n                ğŸ’¡ ë“±ë²ˆí˜¸ í„°ì¹˜ â†’ ë“±ìœ„ ë¹ˆì¹¸ í„°ì¹˜ | ğŸ”„ ìˆœìœ„ ë³€ê²½: ê¸°ì¡´ ìˆœìœ„ í„°ì¹˜/ë“œë˜ê·¸ | âŒ ì·¨ì†Œ: ë°°ì •ëœ ë“±ë²ˆí˜¸ ì¬í„°ì¹˜\n            </p>\n                \n                <div class=\"final-scoring-container\" style=\"margin-top: 0;\">\n                    <div class=\"players-column\">\n                        <h3>ì„ ìˆ˜ ëª©ë¡</h3>\n                        <div class=\"players-list\" id=\"playersList\">\n                            <?php foreach ($players as $player_no): ?>\n                            <div class=\"player-item\" data-player=\"<?=h($player_no)?>\" onclick=\"selectPlayer(this)\">\n                                <?=h($player_no)?>\n                </div>\n                <?php endforeach; ?>\n                </div>\n                    </div>\n                    \n                    <div class=\"ranking-column\">\n                        <h3>ìˆœìœ„</h3>\n                        <div class=\"ranking-list\" id=\"rankingList\">\n                            <?php for ($i = 1; $i <= count($players); $i++): ?>\n                            <div class=\"ranking-slot\" data-rank=\"<?=$i?>\" onclick=\"assignRank(this)\" \n                                 ondblclick=\"swapWithNext(this)\" \n                                 draggable=\"true\" ondragstart=\"dragStart(event)\" ondragover=\"dragOver(event)\" \n                                 ondrop=\"drop(event)\" ondragend=\"dragEnd(event)\"\n                                 onmousedown=\"handleMouseDown(event)\" onmouseup=\"handleMouseUp(event)\">\n                                <span class=\"player-assigned\" id=\"player-<?=$i?>\"></span>\n                                <input type=\"hidden\" name=\"final_ranking[<?=$i?>]\" id=\"input-<?=$i?>\" value=\"\">\n                            </div>\n                            <?php endfor; ?>\n                        </div>\n                    </div>\n                </div>\n                \n                <div class=\"final-actions\">\n                    <button type=\"button\" id=\"saveFinalScores\" class=\"btn btn-primary\">\n                        ì ìˆ˜ ì €ì¥\n                    </button>\n                    <button type=\"button\" id=\"nextFinalDance\" class=\"btn btn-secondary\" style=\"display:none;\">\n                        ë‹¤ìŒ ì¢…ëª©\n                    </button>\n                    <button type=\"button\" id=\"clearFinalScores\" class=\"btn btn-secondary\">\n                        ì´ˆê¸°í™”\n                    </button>\n                </div>\n            </div>\n            <?php else: ?>\n            <!-- Preliminary Round - Instagram Style Dance by Dance System -->\n            <div class=\"dance-container\">\n                <div class=\"dance-progress\">\n                    <div class=\"progress-bar\">\n                        <div class=\"progress-fill\" style=\"width: 0%\"></div>\n                    </div>\n                    <div class=\"progress-text\">\n                        <span class=\"current-dance\">1</span> / <?= count($event_data['dances']) ?>\n                    </div>\n                </div>\n                \n                <div class=\"dance-slider\" id=\"danceSlider\">\n                    <?php foreach ($event_data['dances'] as $dance_index => $dance): ?>\n                        <?php \n                        $dance_display = isset($dance_mapping[$dance]) ? $dance_mapping[$dance] : $dance;\n                        ?>\n                        <div class=\"dance-page\" data-dance=\"<?=h($dance)?>\" data-dance-index=\"<?=$dance_index?>\">\n                            <div class=\"dance-header\">\n                                <h3><?=h($dance_display)?></h3>\n                                <p>ì´ <?=count($players)?>ëª… ì¤‘ <?= $recall_count ?>ëª… ì„ íƒ</p>\n                            </div>\n                            \n                            <?php if ($hits_data && !empty($hits_data)): ?>\n                                <!-- Heat-based display -->\n                                <?php foreach ($hits_data as $heat_no => $heat_players): ?>\n                                    <div class=\"heat-section\">\n                                        <h4>íˆíŠ¸ <?= $heat_no ?></h4>\n                                        <div class=\"players-grid\">\n                                            <?php foreach ($heat_players as $player_no): ?>\n                                                <div class=\"player-card\" data-player=\"<?=h($player_no)?>\">\n                                                    <div class=\"player-number\"><?=h($player_no)?></div>\n                                                    <input type=\"checkbox\" \n                                                           name=\"recall_marks[<?=h($dance)?>][<?=h($player_no)?>]\" \n                                                           class=\"recall-checkbox\"\n                                                           data-dance=\"<?=h($dance)?>\"\n                                                           data-player=\"<?=h($player_no)?>\">\n                                                </div>\n                                            <?php endforeach; ?>\n                                        </div>\n                                    </div>\n                                <?php endforeach; ?>\n                            <?php else: ?>\n                                <!-- No heats - all players together -->\n                                <div class=\"players-grid\">\n                                    <?php foreach ($players as $player_no): ?>\n                                        <div class=\"player-card\" data-player=\"<?=h($player_no)?>\">\n                                            <div class=\"player-number\"><?=h($player_no)?></div>\n                                            <input type=\"checkbox\" \n                                                   name=\"recall_marks[<?=h($dance)?>][<?=h($player_no)?>]\" \n                                                   class=\"recall-checkbox\"\n                                                   data-dance=\"<?=h($dance)?>\"\n                                                   data-player=\"<?=h($player_no)?>\">\n                                        </div>\n                                    <?php endforeach; ?>\n                                </div>\n            <?php endif; ?>\n                            \n                            <div class=\"recall-status\">\n                                <div style=\"font-size:20px; margin-bottom:5px;\">ğŸ“Š Recall ì§„í–‰ ìƒí™©</div>\n                                <div style=\"font-size:28px; font-weight:900; color:#2e7d32;\">\n                                    <span class=\"selected-count\">0</span> / <?= $recall_count ?>ëª…\n        </div>\n                                <div style=\"font-size:14px; margin-top:5px; opacity:0.8;\">\n                                    <?= $recall_count ?>ëª…ì„ ì„ íƒí•˜ë©´ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤\n    </div>\n                            </div>\n                            \n                            <div class=\"dance-submit-section\" style=\"text-align:center; margin-top:20px; display:none;\">\n                                <button type=\"button\" \n                                        class=\"dance-submit-btn\" \n                                        data-dance=\"<?=h($dance)?>\"\n                                        style=\"background:#4CAF50; color:#fff; border:none; padding:15px 30px; font-size:16px; font-weight:bold; border-radius:8px; cursor:pointer;\">\n                                    <?=h($dance_display)?> ì „ì†¡\n                                </button>\n                            </div>\n                        </div>\n                    <?php endforeach; ?>\n                </div>\n                \n                <div class=\"dance-navigation\" style=\"text-align:center; margin-top:20px;\">\n                    <button type=\"button\" id=\"prevDance\" style=\"background:#666; color:#fff; border:none; padding:10px 20px; margin:0 10px; border-radius:5px; cursor:pointer; display:none;\">ì´ì „</button>\n                    <button type=\"button\" id=\"nextDance\" style=\"background:#2196F3; color:#fff; border:none; padding:10px 20px; margin:0 10px; border-radius:5px; cursor:pointer; display:none;\">ë‹¤ìŒ</button>\n                </div>\n            </div>\n            <?php endif; ?>\n\n    </form>\n    </div>\n\n    <script>\ndocument.getElementById('scoringForm').addEventListener('submit', function(e) {\n    e.preventDefault();\n    \n    const formData = new FormData(this);\n    const isFinal = formData.get('is_final') === '1';\n    const recallCount = parseInt(formData.get('recall_count'));\n    \n    if (isFinal) {\n        // Final round - ranking system\n        handleFinalRound(formData);\n    } else {\n        // Preliminary round - recall system\n        handleRecallRound(formData, recallCount);\n    }\n});\n\nfunction handleFinalRound(formData) {\n    const adjudicatorMarks = {};\n    \n    // Collect all marks\n    const inputs = document.querySelectorAll('input[name^=\"adjudicator_marks\"]');\n    inputs.forEach(input => {\n        const name = input.name;\n        const matches = name.match(/adjudicator_marks\\[(\\d+)\\]\\[(\\d+)\\]/);\n        if (matches) {\n            const adjudicatorId = matches[1];\n            const coupleId = matches[2];\n            const place = parseInt(input.value);\n            \n            if (!isNaN(place) && place > 0) {\n                if (!adjudicatorMarks[adjudicatorId]) {\n                    adjudicatorMarks[adjudicatorId] = {};\n                }\n                adjudicatorMarks[adjudicatorId][coupleId] = place;\n            }\n        }\n    });\n    \n    // Validate that all places are filled and unique\n    const allPlaces = [];\n    let isValid = true;\n    let errorMessage = '';\n    \n    inputs.forEach(input => {\n        const place = parseInt(input.value);\n        if (isNaN(place) || place < 1 || place > <?=count($players)?>) {\n            isValid = false;\n            errorMessage = 'ëª¨ë“  ìˆœìœ„ë¥¼ 1ë¶€í„° <?=count($players)?>ê¹Œì§€ ì…ë ¥í•´ì£¼ì„¸ìš”.';\n        } else {\n            if (allPlaces.includes(place)) {\n                isValid = false;\n                errorMessage = 'ê°™ì€ ìˆœìœ„ë¥¼ ë‘ ì„ ìˆ˜ì—ê²Œ ì¤„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';\n            }\n            allPlaces.push(place);\n        }\n    });\n    \n    if (!isValid) {\n        showMessage(errorMessage, 'error');\n        return;\n    }\n    \n    // Submit data\n    const submitData = {\n        comp_id: formData.get('comp_id'),\n        event_no: formData.get('event_no'),\n        type: 'final',\n        adjudicator_marks: adjudicatorMarks\n    };\n    \n    submitScores(submitData);\n}\n\nfunction handleRecallRound(formData, recallCount) {\n    const recallMarks = {};\n    let totalSelected = 0;\n    let isValid = true;\n    let errorMessage = '';\n    \n    // Collect recall marks for each dance\n    const danceSections = document.querySelectorAll('.dance-section');\n    danceSections.forEach(section => {\n        const dance = section.dataset.dance;\n        const checkboxes = section.querySelectorAll('.recall-checkbox:checked');\n        \n        recallMarks[dance] = [];\n        checkboxes.forEach(checkbox => {\n            recallMarks[dance].push(checkbox.dataset.player);\n        });\n        \n        totalSelected += checkboxes.length;\n    });\n    \n    // Check if total selected count matches recall count\n    if (totalSelected !== recallCount) {\n        isValid = false;\n        errorMessage = `ì „ì²´ ${recallCount}ëª…ì„ ì„ íƒí•´ì£¼ì„¸ìš”. (í˜„ì¬ ${totalSelected}ëª… ì„ íƒë¨)`;\n    }\n    \n    if (!isValid) {\n        showMessage(errorMessage, 'error');\n        return;\n    }\n    \n    // Submit data\n    const submitData = {\n        comp_id: formData.get('comp_id'),\n        event_no: formData.get('event_no'),\n        type: 'recall',\n        recall_marks: recallMarks\n    };\n    \n    submitScores(submitData);\n}\n\nfunction submitScores(submitData) {\n    fetch('scoring/save_scores.php', {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(submitData)\n    })\n    .then(response => response.json())\n    .then(data => {\n        if (data.success) {\n            showMessage('ì ìˆ˜ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');\n            if (data.results) {\n                showResults(data.results);\n            }\n        } else {\n            showMessage('ì €ì¥ ì‹¤íŒ¨: ' + (data.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'), 'error');\n        }\n    })\n    .catch(error => {\n        showMessage('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error, 'error');\n    });\n}\n\nfunction clearAllScores() {\n    if (confirm('ëª¨ë“  ì ìˆ˜ë¥¼ ì§€ìš°ì‹œê² ìŠµë‹ˆê¹Œ?')) {\n        // Clear final round inputs\n        const inputs = document.querySelectorAll('.place-input');\n        inputs.forEach(input => input.value = '');\n        \n        // Clear recall checkboxes\n        const checkboxes = document.querySelectorAll('.recall-checkbox');\n        checkboxes.forEach(checkbox => {\n            checkbox.checked = false;\n            checkbox.closest('.player-card').classList.remove('selected');\n        });\n        \n        // Update recall status\n        updateRecallStatus();\n        \n        showMessage('ëª¨ë“  ì ìˆ˜ê°€ ì§€ì›Œì¡ŒìŠµë‹ˆë‹¤.', 'success');\n    }\n}\n\n// Recall system event handlers\n    document.addEventListener('DOMContentLoaded', function() {\n    // Handle player card clicks - Touch optimized\n    document.querySelectorAll('.player-card').forEach(card => {\n        // Click event\n        card.addEventListener('click', function(e) {\n            e.preventDefault();\n            e.stopPropagation();\n            togglePlayerSelection(this);\n        });\n        \n        // Touch events for better mobile experience\n        card.addEventListener('touchstart', function(e) {\n            e.preventDefault();\n            this.style.transform = 'scale(0.95)';\n        });\n        \n        card.addEventListener('touchend', function(e) {\n            e.preventDefault();\n            this.style.transform = '';\n            togglePlayerSelection(this);\n        });\n        \n        // Prevent default touch behavior\n        card.addEventListener('touchmove', function(e) {\n            e.preventDefault();\n        });\n    });\n\n    // Handle checkbox changes\n    document.querySelectorAll('.recall-checkbox').forEach(checkbox => {\n        checkbox.addEventListener('change', function() {\n            updatePlayerCardState(this.closest('.player-card'));\n            updateRecallStatus();\n        });\n    });\n\n    // Initialize recall status\n    updateRecallStatus();\n    \n    // Initialize drag and drop for final ranking\n    initializeDragAndDrop();\n    \n    // Load saved scores\n    loadSavedScores();\n    \n    // Initialize fixed progress bar\n    initializeFixedProgress();\n});\n\nfunction initializeDragAndDrop() {\n    const container = document.getElementById('rankingContainer');\n    if (!container) return;\n    \n    let draggedElement = null;\n    \n    // Handle drag start\n    container.addEventListener('dragstart', function(e) {\n        if (e.target.classList.contains('ranking-item')) {\n            draggedElement = e.target;\n            e.target.classList.add('dragging');\n            e.dataTransfer.effectAllowed = 'move';\n        }\n    });\n    \n    // Handle drag end\n    container.addEventListener('dragend', function(e) {\n        if (e.target.classList.contains('ranking-item')) {\n            e.target.classList.remove('dragging');\n            draggedElement = null;\n        }\n    });\n    \n    // Handle drag over\n    container.addEventListener('dragover', function(e) {\n        e.preventDefault();\n        e.dataTransfer.dropEffect = 'move';\n        \n        const afterElement = getDragAfterElement(container, e.clientY);\n        if (afterElement == null) {\n            container.appendChild(draggedElement);\n        } else {\n            container.insertBefore(draggedElement, afterElement);\n        }\n    });\n    \n    // Handle drop\n    container.addEventListener('drop', function(e) {\n        e.preventDefault();\n        updateRankingNumbers();\n    });\n    \n    // Handle manual input changes\n    container.addEventListener('input', function(e) {\n        if (e.target.classList.contains('ranking-place-input')) {\n            updateRankingFromInputs();\n        }\n    });\n}\n\nfunction getDragAfterElement(container, y) {\n    const draggableElements = [...container.querySelectorAll('.ranking-item:not(.dragging)')];\n    \n    return draggableElements.reduce((closest, child) => {\n        const box = child.getBoundingClientRect();\n        const offset = y - box.top - box.height / 2;\n        \n        if (offset < 0 && offset > closest.offset) {\n            return { offset: offset, element: child };\n        } else {\n            return closest;\n        }\n    }, { offset: Number.NEGATIVE_INFINITY }).element;\n}\n\nfunction updateRankingNumbers() {\n    const container = document.getElementById('rankingContainer');\n    if (!container) return;\n    \n    const items = container.querySelectorAll('.ranking-item');\n    items.forEach((item, index) => {\n        const numberDiv = item.querySelector('.ranking-number');\n        const input = item.querySelector('.ranking-place-input');\n        \n        numberDiv.textContent = index + 1;\n        input.value = index + 1;\n        \n        // Update input name to reflect new position\n        const player = item.dataset.player;\n        input.name = `adjudicator_marks[${index + 1}][${player}]`;\n    });\n}\n\nfunction updateRankingFromInputs() {\n    const container = document.getElementById('rankingContainer');\n    if (!container) return;\n    \n    const items = Array.from(container.querySelectorAll('.ranking-item'));\n    const inputs = items.map(item => ({\n        element: item,\n        value: parseInt(item.querySelector('.ranking-place-input').value) || 0\n    }));\n    \n    // Sort by input value\n    inputs.sort((a, b) => a.value - b.value);\n    \n    // Reorder DOM elements\n    inputs.forEach((input, index) => {\n        container.appendChild(input.element);\n        \n        // Update visual number\n        const numberDiv = input.element.querySelector('.ranking-number');\n        numberDiv.textContent = index + 1;\n        \n        // Update input name\n        const player = input.element.dataset.player;\n        const inputElement = input.element.querySelector('.ranking-place-input');\n        inputElement.name = `adjudicator_marks[${index + 1}][${player}]`;\n    });\n}\n\nfunction loadSavedScores() {\n    <?php if ($saved_scores && !$is_final): ?>\n    // Load saved recall scores\n    const savedScores = <?= json_encode($saved_scores) ?>;\n    \n    Object.keys(savedScores).forEach(dance => {\n        const danceSection = document.querySelector(`[data-dance=\"${dance}\"]`);\n        if (!danceSection) return;\n        \n        const selectedPlayers = savedScores[dance];\n        selectedPlayers.forEach(playerNo => {\n            const checkbox = danceSection.querySelector(`input[data-player=\"${playerNo}\"]`);\n            if (checkbox) {\n                checkbox.checked = true;\n                updatePlayerCardState(checkbox.closest('.player-card'));\n            }\n        });\n    });\n\n    updateRecallStatus();\n    <?php endif; ?>\n}\n\nfunction initializeFixedProgress() {\n    const fixedProgress = document.getElementById('fixedProgress');\n    if (!fixedProgress) return;\n    \n    let isScrolling = false;\n    let scrollTimeout;\n    \n    // Show progress bar when scrolling down\n    window.addEventListener('scroll', function() {\n        if (!isScrolling) {\n            fixedProgress.classList.add('show');\n            document.body.classList.add('progress-bar-visible');\n        }\n        \n        isScrolling = true;\n        clearTimeout(scrollTimeout);\n        \n        scrollTimeout = setTimeout(function() {\n            isScrolling = false;\n            // Hide progress bar after scrolling stops (only if no selections)\n            const totalSelected = document.querySelectorAll('.recall-checkbox:checked').length;\n            if (totalSelected === 0) {\n                fixedProgress.classList.remove('show');\n                document.body.classList.remove('progress-bar-visible');\n            }\n        }, 1000);\n    });\n    \n    // Touch events for mobile\n    document.addEventListener('touchstart', function() {\n        fixedProgress.classList.add('show');\n        document.body.classList.add('progress-bar-visible');\n    });\n}\n\nfunction togglePlayerSelection(card) {\n    const checkbox = card.querySelector('.recall-checkbox');\n    checkbox.checked = !checkbox.checked;\n    updatePlayerCardState(card);\n    updateRecallStatus();\n    updateTopRecallStatus(); // Add this line\n}\n\nfunction updatePlayerCardState(card) {\n    const checkbox = card.querySelector('.recall-checkbox');\n    if (checkbox.checked) {\n        card.classList.add('selected');\n    } else {\n        card.classList.remove('selected');\n    }\n}\n\nfunction updateTopRecallStatus() {\n    // Get all checked checkboxes from all pages\n    const allCheckboxes = document.querySelectorAll('.recall-checkbox:checked');\n    const selectedCount = allCheckboxes.length;\n    const recallCount = <?= json_encode(intval($recall_count)) ?>;\n    \n    // Update top recall progress display\n    const topRecallProgress = document.getElementById('recallProgress');\n    if (topRecallProgress) {\n        topRecallProgress.textContent = selectedCount;\n        \n        // Update color based on progress\n        if (selectedCount === recallCount) {\n            topRecallProgress.style.color = '#4CAF50';\n            topRecallProgress.style.fontWeight = 'bold';\n        } else if (selectedCount > recallCount) {\n            topRecallProgress.style.color = '#f44336';\n            topRecallProgress.style.fontWeight = 'bold';\n        } else {\n            topRecallProgress.style.color = '#ff9800';\n            topRecallProgress.style.fontWeight = 'normal';\n        }\n    }\n    \n    // Update fixed progress bar\n    const fixedRecallCount = document.getElementById('fixedRecallCount');\n    if (fixedRecallCount) {\n        fixedRecallCount.textContent = selectedCount;\n    }\n    \n    // Update submit button state for current dance page\n    const currentPage = document.querySelector('.dance-page[data-dance-index=\"' + currentDanceIndex + '\"]');\n    if (currentPage) {\n        const submitSection = currentPage.querySelector('.dance-submit-section');\n        const submitBtn = currentPage.querySelector('.dance-submit-btn');\n        \n        if (submitSection && submitBtn) {\n            // Show/hide submit section based on selection count\n            if (selectedCount === recallCount) {\n                submitSection.style.display = 'block';\n                submitBtn.disabled = false;\n                submitBtn.style.opacity = '1';\n                submitBtn.style.cursor = 'pointer';\n            } else {\n                submitSection.style.display = 'none';\n                submitBtn.disabled = true;\n                submitBtn.style.opacity = '0.5';\n                submitBtn.style.cursor = 'not-allowed';\n            }\n        }\n    }\n}\n\nfunction updateRecallStatus() {\n    const currentPage = document.querySelector('.dance-page[data-dance-index=\"' + currentDanceIndex + '\"]');\n    \n    if (!currentPage) {\n        // Fallback: get all checked checkboxes from all pages\n        const allCheckboxes = document.querySelectorAll('.recall-checkbox:checked');\n        const selectedCount = allCheckboxes.length;\n        const recallCount = <?= json_encode(intval($recall_count)) ?>;\n        \n        // Update top recall progress display\n        const topRecallProgress = document.getElementById('recallProgress');\n        if (topRecallProgress) {\n            topRecallProgress.textContent = selectedCount;\n            \n            // Update color based on progress\n            if (selectedCount === recallCount) {\n                topRecallProgress.style.color = '#4CAF50';\n                topRecallProgress.style.fontWeight = 'bold';\n            } else if (selectedCount > recallCount) {\n                topRecallProgress.style.color = '#f44336';\n                topRecallProgress.style.fontWeight = 'bold';\n            } else {\n                topRecallProgress.style.color = '#ff9800';\n                topRecallProgress.style.fontWeight = 'normal';\n            }\n        }\n        return;\n    }\n    \n    const checkboxes = currentPage.querySelectorAll('.recall-checkbox:checked');\n    const selectedCount = checkboxes.length;\n    const recallCount = <?= json_encode(intval($recall_count)) ?>;\n    \n    // Top recall progress is handled by updateTopRecallStatus function\n    \n    // Update fixed progress bar\n    const fixedProgress = document.getElementById('fixedProgress');\n    if (fixedProgress) {\n        const progressText = fixedProgress.querySelector('#recallProgress');\n        if (progressText) {\n            progressText.textContent = selectedCount;\n        }\n        \n        // Update progress bar styling\n        fixedProgress.classList.remove('complete', 'over');\n        if (selectedCount === recallCount) {\n            fixedProgress.classList.add('complete');\n        } else if (selectedCount > recallCount) {\n            fixedProgress.classList.add('over');\n        }\n    }\n    \n    // Update current page status\n    const statusDiv = currentPage.querySelector('.recall-status');\n    const countSpan = statusDiv.querySelector('.selected-count');\n    const submitSection = currentPage.querySelector('.dance-submit-section');\n    \n    if (countSpan) {\n        countSpan.textContent = selectedCount;\n    }\n    \n    // Update status styling\n    statusDiv.classList.remove('complete', 'over');\n    if (selectedCount === recallCount) {\n        statusDiv.classList.add('complete');\n        if (submitSection) submitSection.style.display = 'block';\n    } else if (selectedCount > recallCount) {\n        statusDiv.classList.add('over');\n        if (submitSection) submitSection.style.display = 'none';\n    } else {\n        if (submitSection) submitSection.style.display = 'none';\n    }\n}\n\nfunction showMessage(message, type) {\n    const messageDiv = document.getElementById('message');\n    messageDiv.innerHTML = `<div class=\"${type}\">${message}</div>`;\n    setTimeout(() => {\n        messageDiv.innerHTML = '';\n    }, 5000);\n}\n\nfunction showResults(results) {\n    let resultsHtml = '<div class=\"success\"><h3>ìµœì¢… ê²°ê³¼ (Skating System ì ìš©)</h3><ol>';\n    const sortedResults = Object.entries(results).sort((a, b) => a[1] - b[1]);\n    sortedResults.forEach(([coupleId, place]) => {\n        resultsHtml += `<li>ì„ ìˆ˜ #${coupleId} - ${place}ë“±</li>`;\n    });\n    resultsHtml += '</ol></div>';\n    document.getElementById('message').innerHTML = resultsHtml;\n}\n\n// Instagram Style Dance System\nlet currentDanceIndex = 0;\nlet totalDances = 0;\nlet completedDances = new Set();\nlet existingSelections = <?= json_encode($existing_selections) ?>;\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    const firstInput = document.querySelector('.place-input');\n    if (firstInput) {\n        firstInput.focus();\n    }\n    \n    // Initialize dance system if in preliminary round (not final)\n    <?php if (!$is_final && $event_no !== '8'): ?>\n    const danceSlider = document.getElementById('danceSlider');\n    if (danceSlider) {\n        initializeDanceSystem();\n    }\n    <?php endif; ?>\n    \n    // Setup fixed action buttons\n    setupFixedButtons();\n});\n\nfunction setupFixedButtons() {\n    // Dashboard button\n    const dashboardBtn = document.getElementById('dashboardBtn');\n    if (dashboardBtn) {\n        dashboardBtn.addEventListener('click', function() {\n            const compId = '<?= h($comp_id) ?>';\n            const lang = '<?= h($lang) ?>';\n            window.location.href = `scoring_dashboard.php?comp_id=${compId}&lang=${lang}`;\n        });\n    }\n    \n    // Refresh button\n    const refreshBtn = document.getElementById('refreshBtn');\n    if (refreshBtn) {\n        refreshBtn.addEventListener('click', function() {\n            if (confirm('í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì‹œê² ìŠµë‹ˆê¹Œ? í˜„ì¬ ì‘ì—… ì¤‘ì¸ ë‚´ìš©ì´ ì €ì¥ë˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.')) {\n                window.location.reload();\n            }\n        });\n    }\n}\n\nfunction loadExistingSelections() {\n    // Load existing selections for all dances\n    Object.keys(existingSelections).forEach(dance => {\n        const dancePage = document.querySelector(`[data-dance=\"${dance}\"]`);\n        if (!dancePage) return;\n        \n        const selectedPlayers = existingSelections[dance];\n        selectedPlayers.forEach(playerNo => {\n            const checkbox = dancePage.querySelector(`input[data-player=\"${playerNo}\"]`);\n            if (checkbox) {\n                checkbox.checked = true;\n                const card = checkbox.closest('.player-card');\n                if (card) {\n                    card.classList.add('selected');\n                }\n            }\n        });\n        \n        // Mark as completed if selections exist\n        if (selectedPlayers.length > 0) {\n            completedDances.add(dance);\n        }\n    });\n}\n\nfunction loadExistingSelectionsForDance(page, dance) {\n    // Load existing selections for a specific dance\n    if (existingSelections[dance]) {\n        const selectedPlayers = existingSelections[dance];\n        selectedPlayers.forEach(playerNo => {\n            const checkbox = page.querySelector(`input[data-player=\"${playerNo}\"]`);\n            if (checkbox) {\n                checkbox.checked = true;\n                const card = checkbox.closest('.player-card');\n                if (card) {\n                    card.classList.add('selected');\n                }\n            }\n        });\n    }\n}\n\nfunction initializeDanceSystem() {\n    const dancePages = document.querySelectorAll('.dance-page');\n    totalDances = dancePages.length;\n    \n    if (totalDances === 0) return;\n    \n    // Load existing selections for all dances\n    loadExistingSelections();\n    \n    // Show first dance page\n    showDancePage(0);\n    \n    // Setup event listeners\n    setupDanceEventListeners();\n    updateProgress();\n    \n    // Initialize top recall status\n    updateTopRecallStatus();\n}\n\nfunction showDancePage(index) {\n    const danceSlider = document.getElementById('danceSlider');\n    const dancePages = document.querySelectorAll('.dance-page');\n    \n    if (index < 0 || index >= totalDances) return;\n    \n    currentDanceIndex = index;\n    danceSlider.style.transform = `translateX(-${index * 100}%)`;\n    \n    // Update progress\n    updateProgress();\n    \n    // Update navigation buttons\n    updateNavigationButtons();\n    \n    // Reset touch events for current page\n    resetTouchEvents();\n    \n    // Restore dance page state if going back to a completed dance\n    const currentPage = document.querySelector('.dance-page[data-dance-index=\"' + currentDanceIndex + '\"]');\n    if (currentPage) {\n        const dance = currentPage.dataset.dance;\n        const isCompleted = completedDances.has(dance);\n        \n        if (isCompleted) {\n            // Restore the page to editable state\n            restoreDancePageState(currentPage, dance);\n        } else {\n            // Load existing selections for this dance if not completed\n            loadExistingSelectionsForDance(currentPage, dance);\n        }\n    }\n    \n    // Update recall status for current page\n    updateTopRecallStatus();\n}\n\nfunction setupDanceEventListeners() {\n    // Navigation buttons\n    document.getElementById('prevDance')?.addEventListener('click', () => {\n        if (currentDanceIndex > 0) {\n            showDancePage(currentDanceIndex - 1);\n        }\n    });\n    \n    document.getElementById('nextDance')?.addEventListener('click', () => {\n        if (currentDanceIndex < totalDances - 1) {\n            showDancePage(currentDanceIndex + 1);\n        }\n    });\n    \n    // Dance submit buttons\n    document.querySelectorAll('.dance-submit-btn').forEach(btn => {\n        btn.addEventListener('click', function() {\n            const dance = this.dataset.dance;\n            submitDance(dance);\n        });\n    });\n    \n    // Touch/swipe events\n    let startX = 0;\n    let startY = 0;\n    let isSwipe = false;\n    \n    const danceSlider = document.getElementById('danceSlider');\n    \n    danceSlider.addEventListener('touchstart', function(e) {\n        startX = e.touches[0].clientX;\n        startY = e.touches[0].clientY;\n        isSwipe = false;\n    });\n    \n    danceSlider.addEventListener('touchmove', function(e) {\n        if (!startX || !startY) return;\n        \n        const currentX = e.touches[0].clientX;\n        const currentY = e.touches[0].clientY;\n        const diffX = startX - currentX;\n        const diffY = startY - currentY;\n        \n        // Determine if this is a horizontal swipe\n        if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 50) {\n            isSwipe = true;\n            e.preventDefault();\n        }\n    });\n    \n    danceSlider.addEventListener('touchend', function(e) {\n        if (!isSwipe || !startX || !startY) return;\n        \n        const endX = e.changedTouches[0].clientX;\n        const diffX = startX - endX;\n        \n        if (Math.abs(diffX) > 100) {\n            if (diffX > 0 && currentDanceIndex < totalDances - 1) {\n                // Swipe left - next dance\n                showDancePage(currentDanceIndex + 1);\n            } else if (diffX < 0 && currentDanceIndex > 0) {\n                // Swipe right - previous dance\n                showDancePage(currentDanceIndex - 1);\n            }\n        }\n        \n        startX = 0;\n        startY = 0;\n        isSwipe = false;\n    });\n}\n\nfunction resetTouchEvents() {\n    // Remove existing event listeners and re-add them\n    const playerCards = document.querySelectorAll('.player-card');\n    playerCards.forEach(card => {\n        // Remove old listeners by cloning the element\n        const newCard = card.cloneNode(true);\n        card.parentNode.replaceChild(newCard, card);\n        \n        // Add new listeners\n        setupPlayerCardEvents(newCard);\n    });\n}\n\nfunction setupPlayerCardEvents(card) {\n    let touchStartTime = 0;\n    let touchStartPos = { x: 0, y: 0 };\n    \n    // Click event\n    card.addEventListener('click', function(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        togglePlayerSelection(this);\n    });\n    \n    // Touch start\n    card.addEventListener('touchstart', function(e) {\n        touchStartTime = Date.now();\n        const touch = e.touches[0];\n        touchStartPos = { x: touch.clientX, y: touch.clientY };\n    });\n    \n    // Touch end\n    card.addEventListener('touchend', function(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        \n        const touchEndTime = Date.now();\n        const touchDuration = touchEndTime - touchStartTime;\n        \n        // Only trigger if it's a quick tap (less than 500ms)\n        if (touchDuration < 500) {\n            togglePlayerSelection(this);\n        }\n    });\n    \n    // Prevent context menu on long press\n    card.addEventListener('contextmenu', function(e) {\n        e.preventDefault();\n    });\n}\n\nfunction updateProgress() {\n    const progressFill = document.querySelector('.progress-fill');\n    const currentDanceSpan = document.querySelector('.current-dance');\n    \n    if (progressFill) {\n        const progress = ((currentDanceIndex + 1) / totalDances) * 100;\n        progressFill.style.width = progress + '%';\n    }\n    \n    if (currentDanceSpan) {\n        currentDanceSpan.textContent = currentDanceIndex + 1;\n    }\n}\n\nfunction restoreDancePageState(page, dance) {\n    // Remove from completed dances to allow re-editing\n    completedDances.delete(dance);\n    \n    // Restore the recall status section\n    const statusDiv = page.querySelector('.recall-status');\n    if (statusDiv) {\n        statusDiv.innerHTML = `\n            <div style=\"font-size:20px; margin-bottom:5px;\">ğŸ“Š Recall ì§„í–‰ ìƒí™©</div>\n            <div style=\"font-size:28px; font-weight:900; color:#2e7d32;\">\n                <span class=\"selected-count\">0</span> / <?= $recall_count ?>ëª…\n            </div>\n            <div style=\"font-size:14px; margin-top:5px; opacity:0.8;\">\n                <?= $recall_count ?>ëª…ì„ ì„ íƒí•˜ë©´ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤\n            </div>\n        `;\n    }\n    \n    // Show submit section (will be hidden/shown based on selection count)\n    const submitSection = page.querySelector('.dance-submit-section');\n    if (submitSection) {\n        submitSection.style.display = 'none';\n    }\n    \n    // Load existing selections for this dance\n    if (existingSelections[dance]) {\n        const selectedPlayers = existingSelections[dance];\n        selectedPlayers.forEach(playerNo => {\n            const checkbox = page.querySelector(`input[data-player=\"${playerNo}\"]`);\n            if (checkbox) {\n                checkbox.checked = true;\n                const card = checkbox.closest('.player-card');\n                if (card) {\n                    card.classList.add('selected');\n                }\n            }\n        });\n    } else {\n        // No existing selections, clear all\n        const checkboxes = page.querySelectorAll('.recall-checkbox');\n        checkboxes.forEach(checkbox => {\n            checkbox.checked = false;\n        });\n        \n        // Update player card states\n        const playerCards = page.querySelectorAll('.player-card');\n        playerCards.forEach(card => {\n            card.classList.remove('selected');\n        });\n    }\n}\n\nfunction updateNavigationButtons() {\n    const prevBtn = document.getElementById('prevDance');\n    const nextBtn = document.getElementById('nextDance');\n    \n    if (prevBtn) {\n        prevBtn.style.display = currentDanceIndex > 0 ? 'inline-block' : 'none';\n    }\n    \n    if (nextBtn) {\n        // Show next button if there are more dances AND current dance is completed\n        const currentDance = document.querySelector('.dance-page[data-dance-index=\"' + currentDanceIndex + '\"]');\n        const isCurrentDanceCompleted = currentDance && completedDances.has(currentDance.dataset.dance);\n        \n        if (currentDanceIndex < totalDances - 1 && isCurrentDanceCompleted) {\n            nextBtn.style.display = 'inline-block';\n            nextBtn.disabled = false;\n            nextBtn.style.opacity = '1';\n            nextBtn.style.cursor = 'pointer';\n        } else {\n            nextBtn.style.display = 'none';\n        }\n    }\n}\n\nfunction submitDance(dance) {\n    const currentPage = document.querySelector(`[data-dance=\"${dance}\"]`);\n    const checkboxes = currentPage.querySelectorAll('.recall-checkbox:checked');\n    const recallCount = <?= json_encode(intval($recall_count)) ?>;\n    \n    if (checkboxes.length !== recallCount) {\n        alert(`${recallCount}ëª…ì„ ì •í™•íˆ ì„ íƒí•´ì£¼ì„¸ìš”.`);\n        return;\n    }\n    \n    // Collect selected players for this dance\n    const selectedPlayers = Array.from(checkboxes).map(cb => cb.dataset.player);\n    \n    // Prepare data for this dance only\n    const recallMarks = {};\n    recallMarks[dance] = selectedPlayers;\n    \n    const data = {\n        comp_id: <?= json_encode($comp_id) ?>,\n        event_no: <?= json_encode($event_no) ?>,\n        type: 'recall',\n        recall_marks: recallMarks\n    };\n    \n    // Show loading state\n    const submitBtn = currentPage.querySelector('.dance-submit-btn');\n    const originalText = submitBtn.textContent;\n    submitBtn.textContent = 'ì „ì†¡ ì¤‘...';\n    submitBtn.disabled = true;\n    \n    fetch('scoring/save_scores.php', {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(data)\n    })\n    .then(response => response.json())\n    .then(result => {\n        if (result.success) {\n            // Mark this dance as completed\n            completedDances.add(dance);\n            \n            // Update existing selections\n            existingSelections[dance] = selectedPlayers;\n            \n            // Hide submit button and show completion message\n            submitBtn.style.display = 'none';\n            const statusDiv = currentPage.querySelector('.recall-status');\n            statusDiv.innerHTML = `\n                <div style=\"font-size:20px; margin-bottom:5px;\">âœ… ì™„ë£Œ</div>\n                <div style=\"font-size:18px; font-weight:bold; color:#4CAF50;\">\n                    ${recallCount}ëª… ì„ íƒ ì™„ë£Œ\n                </div>\n                <div style=\"font-size:14px; margin-top:5px; opacity:0.8;\">\n                    ë‹¤ìŒ ëŒ„ìŠ¤ë¡œ ì§„í–‰í•˜ì„¸ìš”\n                </div>\n            `;\n            \n            // Enable next dance button if available\n            updateNavigationButtons();\n            \n            // Show completion message\n            if (currentDanceIndex < totalDances - 1) {\n                setTimeout(() => {\n                    alert(`${dance} ëŒ„ìŠ¤ ì±„ì ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ëŒ„ìŠ¤ë¡œ ì§„í–‰í•˜ì„¸ìš”.`);\n                }, 1000);\n            } else {\n                // All dances completed\n                setTimeout(() => {\n                    alert('ëª¨ë“  ëŒ„ìŠ¤ ì±„ì ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');\n                }, 1000);\n            }\n        } else {\n            alert('ì „ì†¡ ì‹¤íŒ¨: ' + (result.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));\n            submitBtn.textContent = originalText;\n            submitBtn.disabled = false;\n        }\n    })\n    .catch(error => {\n        console.error('Error:', error);\n        alert('ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error);\n        submitBtn.textContent = originalText;\n        submitBtn.disabled = false;\n    });\n}\n\n// Final Round Dance-by-Dance System\n<?php if ($is_final || $event_no === '8'): ?>\nlet selectedPlayer = null;\nlet playerRankings = {};\nlet draggedSlot = null;\nlet isDragging = false;\nlet dragStartTime = 0;\nlet finalDanceNames = <?= json_encode($event_data['dances']) ?>;\nlet finalCompletedDances = new Set();\nlet savedRankings = <?= json_encode($saved_rankings ?? []) ?>;\nlet currentJudgeId = <?= json_encode($judge_id) ?>;\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    // Initialize dance-by-dance system\n    initializeFinalDanceSystem();\n    setupFinalDanceNavigation();\n    \n    // Initialize touch-based system\n    initializeTouchSystem();\n    \n    // Setup drag and drop for ranking slots\n    setupDragAndDrop();\n});\n\nfunction initializeFinalDanceSystem() {\n    totalDances = finalDanceNames.length;\n    // Populate progress header\n    updateFinalDanceProgress();\n    // Show first dance\n    showFinalDance(0);\n}\n\nfunction updateFinalDanceProgress() {\n    const progressEl = document.getElementById('danceProgress');\n    if (!progressEl) return;\n    progressEl.innerHTML = finalDanceNames.map((dance, idx) => {\n        const isCurrent = idx === currentDanceIndex;\n        const isCompleted = finalCompletedDances.has(dance);\n        const isPending = !isCompleted && !isCurrent;\n        return `<span class=\"dance-step ${isCurrent ? 'current' : (isCompleted ? 'completed' : 'pending')}\">${dance}</span>`;\n    }).join('');\n}\n\nfunction showFinalDance(danceIndex) {\n    if (danceIndex < 0 || danceIndex >= totalDances) return;\n    currentDanceIndex = danceIndex;\n    updateFinalDanceProgress();\n    updateCurrentDanceDisplay();\n    \n    // Clear rankings when switching dances\n    clearFinalScores();\n    \n    // Update navigation after DOM is ready\n    setTimeout(() => {\n        updateFinalDanceNav();\n    }, 50);\n    \n    // Restore saved rankings for current dance (after clearing)\n    setTimeout(() => {\n        restoreSavedRankings();\n    }, 100);\n}\n\nfunction updateCurrentDanceDisplay() {\n    const currentDanceEl = document.getElementById('currentDanceDisplay');\n    if (currentDanceEl && finalDanceNames[currentDanceIndex]) {\n        currentDanceEl.textContent = `í˜„ì¬ ì¢…ëª©: ${finalDanceNames[currentDanceIndex]}`;\n    }\n}\n\nfunction setupFinalDanceNavigation() {\n    // Bind \"Submit Dance\" and \"Next Dance\" buttons\n    const submitBtn = document.getElementById('saveFinalScores');\n    if (submitBtn) {\n        submitBtn.addEventListener('click', submitFinalDance);\n    }\n    const nextBtn = document.getElementById('nextFinalDance');\n    if (nextBtn) {\n        nextBtn.addEventListener('click', () => {\n            if (currentDanceIndex < totalDances - 1) {\n                showFinalDance(currentDanceIndex + 1);\n            }\n        });\n    }\n}\n\nfunction submitFinalDance() {\n    const totalPlayers = document.querySelectorAll('.player-item').length;\n    const assignedPlayers = Object.keys(playerRankings).length;\n    \n    if (assignedPlayers < totalPlayers) {\n        alert(`ëª¨ë“  ì„ ìˆ˜ì—ê²Œ ìˆœìœ„ë¥¼ ë¶€ì—¬í•´ì•¼ í•©ë‹ˆë‹¤. (${assignedPlayers}/${totalPlayers})`);\n        return;\n    }\n    \n    const form = document.getElementById('scoringForm');\n    const formData = new FormData(form);\n    formData.append('is_final', '1');\n    formData.append('dance', finalDanceNames[currentDanceIndex]);\n    \n    Object.keys(playerRankings).forEach(player => {\n        formData.append(`final_ranking[${playerRankings[player]}]`, player);\n    });\n    \n    const submitBtn = document.getElementById('saveFinalScores');\n    const originalText = submitBtn.textContent;\n    submitBtn.textContent = 'ì „ì†¡ ì¤‘...';\n    submitBtn.disabled = true;\n    \n    fetch('scoring/save_scores.php', {\n        method: 'POST',\n        body: formData\n    })\n    .then(response => response.json())\n    .then(result => {\n        if (result.success) {\n            if (result.dance_completed) {\n                // All judges completed this dance\n                finalCompletedDances.add(finalDanceNames[currentDanceIndex]);\n                updateFinalDanceProgress();\n                alert(`${finalDanceNames[currentDanceIndex]} ëŒ„ìŠ¤ ì±„ì ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!`);\n            } else {\n                // Only this judge submitted\n                alert(`${finalDanceNames[currentDanceIndex]} ëŒ„ìŠ¤ ì ìˆ˜ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤`);\n            }\n            \n            if (currentDanceIndex < totalDances - 1) {\n                showFinalDance(currentDanceIndex + 1);\n            } else {\n                updateFinalDanceNav();\n                alert('ëª¨ë“  ì¢…ëª© ìˆœìœ„ ì œì¶œì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');\n            }\n        } else {\n            alert('ì œì¶œ ì‹¤íŒ¨: ' + (result.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));\n            submitBtn.textContent = originalText;\n            submitBtn.disabled = false;\n        }\n    })\n    .catch(error => {\n        console.error('Error:', error);\n        alert('ì œì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error);\n        submitBtn.textContent = originalText;\n        submitBtn.disabled = false;\n    });\n}\n\nfunction updateFinalDanceNav() {\n    const submitBtn = document.getElementById('saveFinalScores');\n    const nextBtn = document.getElementById('nextFinalDance');\n    \n    console.log('updateFinalDanceNav called - currentDanceIndex:', currentDanceIndex, 'totalDances:', totalDances);\n    \n    if (submitBtn) {\n        const buttonText = currentDanceIndex < totalDances - 1 ? `${finalDanceNames[currentDanceIndex]} ìˆœìœ„ ì œì¶œ` : 'ìµœì¢… ì €ì¥';\n        submitBtn.textContent = buttonText;\n        console.log('Button text updated to:', buttonText);\n    }\n    if (nextBtn) {\n        nextBtn.style.display = (currentDanceIndex < totalDances - 1) ? 'inline-block' : 'none';\n    }\n    // Hide clear button\n    const clearBtn = document.getElementById('clearFinalScores');\n    if (clearBtn) clearBtn.style.display = 'none';\n}\n\nfunction initializeTouchSystem() {\n    // Clear any existing rankings when switching dances\n    clearFinalScores();\n    \n    // Bind clear button with confirmation\n    const clearBtn = document.getElementById('clearFinalScores');\n    if (clearBtn) {\n        clearBtn.addEventListener('click', clearFinalScoresWithConfirm);\n    }\n}\n\nfunction setupDragAndDrop() {\n    // Add drag and drop event listeners to all ranking slots\n    document.querySelectorAll('.ranking-slot').forEach(slot => {\n        slot.addEventListener('dragstart', dragStart);\n        slot.addEventListener('dragover', dragOver);\n        slot.addEventListener('drop', drop);\n        slot.addEventListener('dragend', dragEnd);\n        slot.addEventListener('mousedown', handleMouseDown);\n        slot.addEventListener('mouseup', handleMouseUp);\n    });\n}\n\n// Final Round JavaScript - Touch-based System\n\nfunction selectPlayer(element) {\n    // Remove previous selection\n    document.querySelectorAll('.player-item').forEach(item => {\n        item.classList.remove('selected');\n    });\n    \n    // Check if player is already assigned\n    if (element.classList.contains('assigned')) {\n        return;\n    }\n    \n    // Select current player\n    element.classList.add('selected');\n    selectedPlayer = element.dataset.player;\n    \n    console.log('Selected player:', selectedPlayer);\n}\n\nfunction assignRank(element) {\n    // If no player is selected, check if we can cancel an existing assignment\n    if (!selectedPlayer) {\n        if (element.classList.contains('assigned')) {\n            // Cancel existing assignment\n            cancelRank(element);\n        }\n        return;\n    }\n    \n    const rank = element.dataset.rank;\n    \n    // Check if this rank is already assigned\n    if (element.classList.contains('assigned')) {\n        // Remove existing assignment\n        const currentPlayer = element.querySelector('.player-assigned').textContent;\n        if (currentPlayer) {\n            // Remove from player list\n            const playerElement = document.querySelector(`[data-player=\"${currentPlayer}\"]`);\n            if (playerElement) {\n                playerElement.classList.remove('assigned');\n            }\n            // Remove from rankings\n            delete playerRankings[currentPlayer];\n        }\n    }\n    \n    // Assign new player to this rank\n    element.querySelector('.player-assigned').textContent = selectedPlayer;\n    element.querySelector('input').value = selectedPlayer;\n    element.classList.add('assigned');\n    \n    // Mark player as assigned\n    const playerElement = document.querySelector(`[data-player=\"${selectedPlayer}\"]`);\n    if (playerElement) {\n        playerElement.classList.add('assigned');\n    }\n    \n    // Update rankings object\n    playerRankings[selectedPlayer] = rank;\n    \n    // Clear selection\n    selectedPlayer = null;\n    document.querySelectorAll('.player-item').forEach(item => {\n        item.classList.remove('selected');\n    });\n    \n    console.log('Assigned player', selectedPlayer, 'to rank', rank);\n    console.log('Current rankings:', playerRankings);\n}\n\nfunction cancelRank(element) {\n    const currentPlayer = element.querySelector('.player-assigned').textContent;\n    if (currentPlayer) {\n        // Remove from player list\n        const playerElement = document.querySelector(`[data-player=\"${currentPlayer}\"]`);\n        if (playerElement) {\n            playerElement.classList.remove('assigned');\n        }\n        \n        // Clear the ranking slot\n        element.querySelector('.player-assigned').textContent = '';\n        element.querySelector('input').value = '';\n        element.classList.remove('assigned');\n        \n        // Remove from rankings\n        delete playerRankings[currentPlayer];\n        \n        console.log('Cancelled assignment for player', currentPlayer);\n        console.log('Current rankings:', playerRankings);\n    }\n}\n\n// Drag and Drop functions for ranking slots\nfunction dragStart(event) {\n    console.log('dragStart called', event.target);\n    isDragging = true;\n    draggedSlot = event.target;\n    draggedSlot.classList.add('dragging');\n    event.dataTransfer.effectAllowed = 'move';\n    event.dataTransfer.setData('text/html', draggedSlot.outerHTML);\n}\n\nfunction dragOver(event) {\n    event.preventDefault();\n    event.dataTransfer.dropEffect = 'move';\n    \n    // Add visual feedback\n    if (event.target.classList.contains('ranking-slot')) {\n        event.target.classList.add('drag-over');\n        console.log('dragOver on ranking slot');\n    }\n}\n\nfunction drop(event) {\n    event.preventDefault();\n    console.log('drop called', event.target, 'draggedSlot:', draggedSlot);\n    \n    // Remove drag-over class\n    document.querySelectorAll('.ranking-slot').forEach(slot => {\n        slot.classList.remove('drag-over');\n    });\n    \n    if (event.target.classList.contains('ranking-slot') && draggedSlot !== event.target) {\n        console.log('Swapping rankings between slots');\n        // Swap the players between the two slots\n        swapRankings(draggedSlot, event.target);\n    }\n}\n\nfunction dragEnd(event) {\n    // Remove dragging class\n    document.querySelectorAll('.ranking-slot').forEach(slot => {\n        slot.classList.remove('dragging', 'drag-over');\n    });\n    draggedSlot = null;\n    isDragging = false;\n}\n\n// Mouse event handlers for better drag detection\nfunction handleMouseDown(event) {\n    dragStartTime = Date.now();\n    isDragging = false;\n    console.log('Mouse down on ranking slot');\n}\n\nfunction handleMouseUp(event) {\n    const dragDuration = Date.now() - dragStartTime;\n    console.log('Mouse up, drag duration:', dragDuration);\n    \n    if (dragDuration > 200 && isDragging) {\n        // This was a drag operation, not a click\n        event.preventDefault();\n        event.stopPropagation();\n        return false;\n    }\n}\n\n// Double-click to swap with next rank\nfunction swapWithNext(element) {\n    console.log('Double-clicked ranking slot:', element);\n    \n    const currentRank = parseInt(element.dataset.rank);\n    const nextRank = currentRank + 1;\n    const nextElement = document.querySelector(`[data-rank=\"${nextRank}\"]`);\n    \n    if (nextElement && element.classList.contains('assigned') && nextElement.classList.contains('assigned')) {\n        console.log('Swapping ranks', currentRank, 'and', nextRank);\n        swapRankings(element, nextElement);\n    } else {\n        console.log('Cannot swap - one or both slots are empty');\n    }\n}\n\nfunction swapRankings(slot1, slot2) {\n    const player1 = slot1.querySelector('.player-assigned').textContent;\n    const player2 = slot2.querySelector('.player-assigned').textContent;\n    const input1 = slot1.querySelector('input');\n    const input2 = slot2.querySelector('input');\n    \n    // Swap the players\n    slot1.querySelector('.player-assigned').textContent = player2;\n    slot2.querySelector('.player-assigned').textContent = player1;\n    input1.value = player2;\n    input2.value = player1;\n    \n    // Update visual states\n    if (player1) {\n        slot1.classList.add('assigned');\n    } else {\n        slot1.classList.remove('assigned');\n    }\n    \n    if (player2) {\n        slot2.classList.add('assigned');\n    } else {\n        slot2.classList.remove('assigned');\n    }\n    \n    // Update rankings object\n    const rank1 = slot1.dataset.rank;\n    const rank2 = slot2.dataset.rank;\n    \n    if (player1) {\n        playerRankings[player1] = rank2;\n    } else {\n        // Remove from rankings if empty\n        Object.keys(playerRankings).forEach(player => {\n            if (playerRankings[player] === rank1) {\n                delete playerRankings[player];\n            }\n        });\n    }\n    \n    if (player2) {\n        playerRankings[player2] = rank1;\n    } else {\n        // Remove from rankings if empty\n        Object.keys(playerRankings).forEach(player => {\n            if (playerRankings[player] === rank2) {\n                delete playerRankings[player];\n            }\n        });\n    }\n    \n    console.log('Swapped rankings:', playerRankings);\n}\n\nfunction submitFinalDance() {\n    // Check if all players are assigned\n    const totalPlayers = document.querySelectorAll('.player-item').length;\n    const assignedPlayers = Object.keys(playerRankings).length;\n    \n    if (assignedPlayers < totalPlayers) {\n        alert(`ëª¨ë“  ì„ ìˆ˜ì—ê²Œ ìˆœìœ„ë¥¼ ë¶€ì—¬í•´ì•¼ í•©ë‹ˆë‹¤. (${assignedPlayers}/${totalPlayers})`);\n        return;\n    }\n    \n    const form = document.getElementById('scoringForm');\n    const formData = new FormData(form);\n    \n    // Add final round flag\n    formData.append('is_final', '1');\n    \n    // Add current dance\n    const currentDance = finalDanceNames[currentDanceIndex];\n    formData.append('dance', currentDance);\n    \n    // Add rankings data in the format expected by save_scores.php\n    const adjudicator_marks = {};\n    adjudicator_marks[<?= json_encode($judge_id) ?>] = {};\n    \n    Object.keys(playerRankings).forEach(player => {\n        const rank = playerRankings[player];\n        adjudicator_marks[<?= json_encode($judge_id) ?>][player] = rank;\n    });\n    \n    console.log('Sending adjudicator_marks:', adjudicator_marks);\n    formData.append('adjudicator_marks', JSON.stringify(adjudicator_marks));\n    \n    const saveBtn = document.getElementById('saveFinalScores');\n    const originalText = saveBtn.textContent;\n    saveBtn.textContent = 'ì €ì¥ ì¤‘...';\n    saveBtn.disabled = true;\n    \n    fetch('scoring/save_scores.php', {\n        method: 'POST',\n        body: formData\n    })\n    .then(response => response.json())\n    .then(result => {\n        if (result.success) {\n            if (result.dance_completed) {\n                finalCompletedDances.add(currentDance);\n                updateFinalDanceProgress();\n                alert(`${currentDance} ëŒ„ìŠ¤ ì±„ì ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!`);\n            } else {\n                alert(`${currentDance} ëŒ„ìŠ¤ ì ìˆ˜ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤`);\n            }\n            updateFinalDanceNav();\n            \n            if (currentDanceIndex < totalDances - 1) {\n                showFinalDance(currentDanceIndex + 1);\n            } else {\n                alert('ëª¨ë“  ì¢…ëª© ìˆœìœ„ ì œì¶œì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');\n            }\n        } else {\n            alert('ì €ì¥ ì‹¤íŒ¨: ' + (result.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));\n        }\n    })\n    .catch(error => {\n        console.error('Error:', error);\n        alert('ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error);\n    })\n    .finally(() => {\n        saveBtn.textContent = originalText;\n        saveBtn.disabled = false;\n    });\n}\n\nfunction clearFinalScores() {\n    // Clear all assignments (no confirmation for dance switching)\n    document.querySelectorAll('.ranking-slot').forEach(slot => {\n        slot.classList.remove('assigned');\n        slot.querySelector('.player-assigned').textContent = '';\n        slot.querySelector('input').value = '';\n    });\n    \n    document.querySelectorAll('.player-item').forEach(item => {\n        item.classList.remove('assigned');\n    });\n    \n    // Clear selection\n    selectedPlayer = null;\n    playerRankings = {};\n    \n    console.log('Cleared all scores');\n}\n\nfunction clearFinalScoresWithConfirm() {\n    if (confirm('ëª¨ë“  ì ìˆ˜ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {\n        clearFinalScores();\n    }\n}\n\nfunction restoreSavedRankings() {\n    // Get current dance name\n    const currentDance = finalDanceNames[currentDanceIndex];\n    console.log('=== RESTORE SAVED RANKINGS DEBUG ===');\n    console.log('Current judge ID:', currentJudgeId);\n    console.log('Current dance:', currentDance);\n    console.log('Current dance index:', currentDanceIndex);\n    console.log('Available saved rankings:', savedRankings);\n    console.log('Final dance names:', finalDanceNames);\n    \n    if (!currentDance || !savedRankings[currentDance]) {\n        console.log('No saved data for dance:', currentDance);\n        return; // No saved data for this dance\n    }\n    \n    const rankings = savedRankings[currentDance];\n    console.log('Restoring rankings for', currentDance, ':', rankings);\n    \n    // Restore each ranking\n    Object.keys(rankings).forEach(rank => {\n        const player = rankings[rank];\n        const rankElement = document.querySelector(`[data-rank=\"${rank}\"]`);\n        \n        console.log(`Attempting to restore rank ${rank}: player ${player}`);\n        console.log('Rank element found:', rankElement);\n        \n        if (rankElement && player) {\n            // Assign player to this rank\n            rankElement.querySelector('.player-assigned').textContent = player;\n            rankElement.querySelector('input').value = player;\n            rankElement.classList.add('assigned');\n            \n            // Mark player as assigned\n            const playerElement = document.querySelector(`[data-player=\"${player}\"]`);\n            if (playerElement) {\n                playerElement.classList.add('assigned');\n            }\n            \n            // Update rankings object\n            playerRankings[player] = rank;\n            \n            console.log(`Successfully restored rank ${rank}: player ${player}`);\n        } else {\n            console.log(`Failed to restore rank ${rank}: player ${player} - element not found`);\n        }\n    });\n    \n    console.log('Restored rankings:', playerRankings);\n}\n<?php endif; ?>\n    </script>\n    \n    <!-- Bottom Navigation -->\n    <div class=\"bottom-nav\">\n        <button type=\"button\" id=\"dashboardBtn\" class=\"nav-button primary\">\n            <div class=\"nav-icon\">ğŸ </div>\n            <div class=\"nav-text\">ë©”ì¸ìœ¼ë¡œ</div>\n        </button>\n        <button type=\"button\" id=\"refreshBtn\" class=\"nav-button\">\n            <div class=\"nav-icon\">ğŸ”„</div>\n            <div class=\"nav-text\">ìƒˆë¡œê³ ì¹¨</div>\n        </button>\n    </div>\n    \n    <footer style=\"text-align: center; margin-top: 30px; color: #666; font-size: 0.9em; padding: 20px; border-top: 1px solid #eee;\">\n        2025 danceoffice.net | Powered by Seyoung Lee\n    </footer>\n</body>\n</html>","size_bytes":101680},"comp/judge_scoring_working.php":{"content":"<?php\nsession_start();\n\n$comp_id = $_GET['comp_id'] ?? '';\n$event_no = $_GET['event_no'] ?? '';\n\n// Remove BOM and normalize - multiple methods\n$comp_id = preg_replace('/\\x{FEFF}/u', '', $comp_id);\n$event_no = preg_replace('/\\x{FEFF}/u', '', $event_no);\n\n// Additional BOM removal\n$comp_id = str_replace([\"\\xEF\\xBB\\xBF\", \"\\xFEFF\", \"\\uFEFF\"], '', $comp_id);\n$event_no = str_replace([\"\\xEF\\xBB\\xBF\", \"\\xFEFF\", \"\\uFEFF\"], '', $event_no);\n\n// Remove any non-printable characters\n$comp_id = preg_replace('/[\\x00-\\x1F\\x7F-\\x9F]/', '', $comp_id);\n$event_no = preg_replace('/[\\x00-\\x1F\\x7F-\\x9F]/', '', $event_no);\n\n$comp_id = preg_replace('/[^\\d-]/', '', $comp_id);\n$event_no = preg_replace('/\\D+/', '', $event_no);\n\n\n// Language setting\n$lang = $_GET['lang'] ?? 'ko';\nif (!in_array($lang, ['ko', 'en', 'zh', 'ja'])) {\n    $lang = 'ko';\n}\n\n// Language texts\n$texts = [\n    'ko' => [\n        'title' => 'ì‹¬ì‚¬ìœ„ì› ì±„ì  ì‹œìŠ¤í…œ',\n        'judge_info' => 'ì‹¬ì‚¬ìœ„ì›',\n        'event_info' => 'ì´ë²¤íŠ¸ ì •ë³´',\n        'event_no' => 'ì´ë²¤íŠ¸ ë²ˆí˜¸',\n        'round' => 'ë¼ìš´ë“œ',\n        'dances' => 'ì¢…ëª©',\n        'players' => 'ì¶œì „ ì„ ìˆ˜',\n        'place' => 'ìˆœìœ„',\n        'couple' => 'ì„ ìˆ˜',\n        'submit' => 'ì œì¶œ',\n        'no_data' => 'ì´ë²¤íŠ¸ ë°ì´í„° ë˜ëŠ” ì„ ìˆ˜ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.',\n        'invalid_data' => 'ì˜ëª»ëœ ëŒ€íšŒ ID ë˜ëŠ” ì´ë²¤íŠ¸ ë²ˆí˜¸ì…ë‹ˆë‹¤.'\n    ],\n    'en' => [\n        'title' => 'Judge Scoring System',\n        'judge_info' => 'Judge',\n        'event_info' => 'Event Information',\n        'event_no' => 'Event Number',\n        'round' => 'Round',\n        'dances' => 'Dances',\n        'players' => 'Competitors',\n        'place' => 'Place',\n        'couple' => 'Couple',\n        'submit' => 'Submit',\n        'no_data' => 'Event data or player data not found.',\n        'invalid_data' => 'Invalid competition ID or event number.'\n    ],\n    'zh' => [\n        'title' => 'è¯„å§”è¯„åˆ†ç³»ç»Ÿ',\n        'judge_info' => 'è¯„å§”',\n        'event_info' => 'èµ›äº‹ä¿¡æ¯',\n        'event_no' => 'èµ›äº‹ç¼–å·',\n        'round' => 'è½®æ¬¡',\n        'dances' => 'èˆç§',\n        'players' => 'å‚èµ›é€‰æ‰‹',\n        'place' => 'åæ¬¡',\n        'couple' => 'é€‰æ‰‹',\n        'submit' => 'æäº¤',\n        'no_data' => 'æ‰¾ä¸åˆ°èµ›äº‹æ•°æ®æˆ–é€‰æ‰‹æ•°æ®ã€‚',\n        'invalid_data' => 'æ— æ•ˆçš„æ¯”èµ›IDæˆ–èµ›äº‹ç¼–å·ã€‚'\n    ],\n    'ja' => [\n        'title' => 'å¯©æŸ»å“¡æ¡ç‚¹ã‚·ã‚¹ãƒ†ãƒ ',\n        'judge_info' => 'å¯©æŸ»å“¡',\n        'event_info' => 'ã‚¤ãƒ™ãƒ³ãƒˆæƒ…å ±',\n        'event_no' => 'ã‚¤ãƒ™ãƒ³ãƒˆç•ªå·',\n        'round' => 'ãƒ©ã‚¦ãƒ³ãƒ‰',\n        'dances' => 'ç¨®ç›®',\n        'players' => 'å‡ºå ´é¸æ‰‹',\n        'place' => 'é †ä½',\n        'couple' => 'é¸æ‰‹',\n        'submit' => 'æå‡º',\n        'no_data' => 'ã‚¤ãƒ™ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ã¾ãŸã¯é¸æ‰‹ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚',\n        'invalid_data' => 'ç„¡åŠ¹ãªå¤§ä¼šIDã¾ãŸã¯ã‚¤ãƒ™ãƒ³ãƒˆç•ªå·ã§ã™ã€‚'\n    ]\n];\n\n$t = $texts[$lang];\n\n// Check if judge is logged in\nif (!isset($_SESSION['scoring_logged_in']) || !$_SESSION['scoring_logged_in'] || $_SESSION['scoring_comp_id'] !== $comp_id) {\n    $lang = $_GET['lang'] ?? 'ko';\n    header(\"Location: scoring_login.php?comp_id=\" . urlencode($comp_id) . \"&lang=\" . urlencode($lang));\n    exit;\n}\n\nif (!$comp_id || !$event_no) {\n    echo \"<h1>\" . $t['invalid_data'] . \"</h1>\";\n    exit;\n}\n\n// Load event data\n$data_dir = __DIR__ . \"/data/$comp_id\";\n$runorder_file = \"$data_dir/RunOrder_Tablet.txt\";\n$players_file = \"$data_dir/players_$event_no.txt\";\n$round_info_file = \"$data_dir/round_info.json\";\n$dance_name_file = \"$data_dir/DanceName.txt\";\n\n$event_data = null;\n$players = [];\n$round_info = null;\n$hits_data = null;\n$dance_mapping = [];\n\n// Load dance name mapping\nif (file_exists($dance_name_file)) {\n    $lines = file($dance_name_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        $line = preg_replace('/\\x{FEFF}/u', '', $line);\n        $cols = array_map('trim', explode(',', $line));\n        if (count($cols) >= 3 && !empty($cols[2])) {\n            $dance_mapping[$cols[2]] = $cols[1]; // abbreviation => full name\n        }\n    }\n}\n\n// Function to convert dance abbreviations to full names\nfunction getDanceNames($dances, $dance_mapping) {\n    $result = [];\n    foreach ($dances as $dance) {\n        $dance = trim($dance);\n        if (isset($dance_mapping[$dance])) {\n            $result[] = $dance_mapping[$dance];\n        } else {\n            $result[] = $dance; // fallback to original if not found\n        }\n    }\n    return $result;\n}\n\n// Function to load existing selected numbers from .adj files\nfunction loadExistingSelections($comp_id, $event_no, $judge_id, $dances) {\n    $data_dir = __DIR__ . \"/data/$comp_id\";\n    $selections = [];\n    \n    foreach ($dances as $dance) {\n        $adj_file = \"$data_dir/{$event_no}_{$dance}_{$judge_id}.adj\";\n        if (file_exists($adj_file)) {\n            $lines = file($adj_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n            $dance_selections = [];\n    foreach ($lines as $line) {\n                $line = preg_replace('/\\x{FEFF}/u', '', $line);\n                $line = trim($line, '\"');\n                if (!empty($line)) {\n                    $dance_selections[] = $line;\n                }\n            }\n            $selections[$dance] = $dance_selections;\n        }\n    }\n    \n    return $selections;\n}\n\n// Load event information\nif (file_exists($runorder_file)) {\n    $lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        // Remove BOM from line - multiple methods\n        $line = preg_replace('/\\x{FEFF}/u', '', $line);\n        $line = str_replace([\"\\xEF\\xBB\\xBF\", \"\\xFEFF\", \"\\uFEFF\"], '', $line);\n        $line = preg_replace('/[\\x00-\\x1F\\x7F-\\x9F]/', '', $line);\n        \n        if (preg_match('/^bom/', $line)) continue;\n        $cols = array_map('trim', explode(',', $line));\n        if (($cols[0] ?? '') === $event_no) {\n            $event_data = [\n                'no' => $cols[0],\n                'name' => $cols[1],\n                'round_type' => $cols[2],\n                'round_num' => $cols[3],\n                'recall_count' => intval($cols[4] ?? 0), // 5th column (index 4) is recall count\n                'dances' => []\n            ];\n            for ($i = 6; $i <= 10; $i++) {\n                if (!empty($cols[$i])) $event_data['dances'][] = $cols[$i];\n            }\n            break;\n        }\n    }\n}\n\n// Load players\nif (file_exists($players_file)) {\n    $lines = file($players_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        // Remove BOM from line - multiple methods\n        $line = preg_replace('/\\x{FEFF}/u', '', $line);\n        $line = str_replace([\"\\xEF\\xBB\\xBF\", \"\\xFEFF\", \"\\uFEFF\"], '', $line);\n        $line = preg_replace('/[\\x00-\\x1F\\x7F-\\x9F]/', '', $line);\n        $line = trim($line);\n        if ($line && is_numeric($line)) {\n            $players[] = $line;\n        }\n    }\n}\n\n// Load round information\nif (file_exists($round_info_file)) {\n    $round_info = json_decode(file_get_contents($round_info_file), true);\n}\n\n// Determine if this is a final round\n$is_final = false;\n$round_display = '';\n\nif ($round_info && isset($round_info['round_info'])) {\n    // Try both string and numeric keys\n    $round_display = $round_info['round_info'][$event_no] ?? $round_info['round_info'][intval($event_no)] ?? '';\n    $is_final = ($round_display === 'Final' || stripos($round_display, 'Final') !== false);\n    error_log(\"After round_info check: is_final = \" . ($is_final ? 'true' : 'false'));\n} elseif ($event_data && isset($event_data['round_type'])) {\n    $round_display = $event_data['round_type'];\n    $is_final = ($round_display === 'Final' || stripos($event_data['round_type'], 'Final') !== false);\n    error_log(\"After event_data check: is_final = \" . ($is_final ? 'true' : 'false'));\n}\n\n// Fallback: Check if this is a known final event\nif (!$is_final) {\n    $known_final_events = ['8', '9', '39', '28', '75', '74']; // Known final events from round_info.json\n    if (in_array($event_no, $known_final_events)) {\n        $is_final = true;\n        $round_display = 'Final';\n        error_log(\"After fallback check: is_final = \" . ($is_final ? 'true' : 'false'));\n    }\n}\n\nerror_log(\"Final is_final value: \" . ($is_final ? 'true' : 'false'));\n\n// Force final for event 8 for testing\nif ($event_no === '8') {\n    $is_final = true;\n    $round_display = 'Final';\n    error_log(\"Forced is_final to true for event 8\");\n}\n\n// Additional debug\nerror_log(\"Final check - Event: $event_no, is_final: \" . ($is_final ? 'true' : 'false'));\n\n\n// Load hits data if exists\n$hits_file = \"$data_dir/players_hits_$event_no.json\";\nif (file_exists($hits_file)) {\n    $hits_data = json_decode(file_get_contents($hits_file), true);\n}\n\n// Load existing selections for all dances\n$existing_selections = [];\nif ($event_data && isset($event_data['dances'])) {\n    $existing_selections = loadExistingSelections($comp_id, $event_no, $_SESSION['scoring_judge_id'], $event_data['dances']);\n}\n\n// Load saved scores\n$saved_scores = null;\n$judge_id = $_SESSION['scoring_judge_id'] ?? 'unknown';\n\nif ($is_final) {\n    // Load final round scores - check individual dance files for this judge\n    $adj_files = glob(\"$data_dir/{$event_no}_*.adj\");\n    \n    // Also check for files with different event numbers but same judge (for compatibility)\n    $compat_files = glob(\"$data_dir/*_*_{$judge_id}.adj\");\n    $adj_files = array_merge($adj_files, $compat_files);\n    \n    // Debug: Log found files\n    error_log(\"Found adj files: \" . implode(', ', $adj_files));\n    $final_scores = [];\n    $saved_rankings = []; // Store actual ranking data for UI restoration\n    \n    foreach ($adj_files as $file) {\n        $filename = basename($file);\n        if (preg_match('/^(\\d+)_(.+)_(\\d+)\\.adj$/', $filename, $matches)) {\n            $file_event = $matches[1];\n            $file_dance = $matches[2];\n            $file_judge_id = $matches[3];\n            \n            // Check if this is for current judge and current event (or compatible event)\n            if ($file_judge_id === $judge_id && ($file_event === $event_no || $file_event === '1')) {\n                error_log(\"Loading file: $filename for dance: $file_dance\");\n                $final_scores[$file_dance] = true; // This judge has submitted for this dance\n                \n                // Load actual ranking data for UI restoration\n                $lines = file($file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n                $rankings = [];\n                \n                foreach ($lines as $line) {\n                    $line = trim($line);\n                    if (empty($line)) continue;\n                    \n                    if (strpos($line, ',') !== false) {\n                        // New format: player,rank\n                        list($player, $rank) = explode(',', $line, 2);\n                        $player = trim($player, '\"');\n                        $rank = intval(trim($rank));\n                        if (is_numeric($player) && $rank > 0) {\n                            $rankings[$rank] = $player;\n                        }\n        } else {\n                        // Old format: just player numbers (convert to rank 1,2,3...)\n                        $player = trim($line, '\"');\n                        if (is_numeric($player)) {\n                            $rankings[count($rankings) + 1] = $player;\n                        }\n                    }\n                }\n                \n                if (!empty($rankings)) {\n                    $saved_rankings[$file_dance] = $rankings;\n                }\n            }\n        }\n    }\n    \n    if (!empty($final_scores)) {\n        $saved_scores = $final_scores;\n    }\n    \n    // Debug: Log saved rankings\n    error_log(\"Judge ID: $judge_id, Event: $event_no, Saved rankings: \" . json_encode($saved_rankings));\n} else {\n    // Load recall scores for this judge\n    $adj_files = glob(\"$data_dir/{$event_no}_*.adj\");\n    $recall_scores = [];\n    \n    foreach ($adj_files as $file) {\n        $filename = basename($file);\n        if (preg_match('/^(\\d+)_(.+)_(\\d+)\\.adj$/', $filename, $matches)) {\n            $file_dance = $matches[2];\n            $file_judge_id = $matches[3];\n            \n            if ($file_judge_id === $judge_id) {\n                $lines = file($file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n                $players = [];\n                \n    foreach ($lines as $line) {\n                    $line = trim($line, '\"');\n                    if ($line && is_numeric($line)) {\n                        $players[] = $line;\n                    }\n                }\n                \n                $recall_scores[$file_dance] = $players;\n            }\n        }\n    }\n    \n    if (!empty($recall_scores)) {\n        $saved_scores = $recall_scores;\n    }\n}\n\nif (!$event_data || empty($players)) {\n    echo \"<h1>\" . $t['no_data'] . \"</h1>\";\n    echo \"<p>comp_id: '$comp_id', event_no: '$event_no'</p>\";\n    echo \"<p>runorder_file: \" . (file_exists($runorder_file) ? 'exists' : 'not found') . \"</p>\";\n    echo \"<p>players_file: \" . (file_exists($players_file) ? 'exists' : 'not found') . \"</p>\";\n    exit;\n}\n\nfunction h($s) { return htmlspecialchars($s ?? ''); }\n?>\n<!DOCTYPE html>\n<html lang=\"<?=h($lang)?>\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title><?=h($t['title'])?> | <?=h($event_data['name'])?></title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\n    <style>\n        body { background:#1a1a1a; font-family:sans-serif; margin:0; padding:2px;}\n        .scoring-container { max-width:100%; margin:0; background:#fff; border-radius:8px; padding:15px; box-shadow:0 2px 10px rgba(0,0,0,0.3);}\n        h1 { color:#003399; margin-bottom:20px; text-align:center;}\n        .event-info { background:#f0f4ff; padding:15px; border-radius:8px; margin-bottom:20px; text-align:center;}\n        .event-info h2 { margin:0 0 10px 0; color:#0d2c96;}\n        .event-info p { margin:5px 0; color:#333;}\n        .adjudicator-section { margin-bottom:10px;}\n        .adjudicator-header { background:#003399; color:#fff; padding:10px 15px; border-radius:6px 6px 0 0; font-weight:bold;}\n        .scoring-table { width:100%; border-collapse:collapse; background:#fff; border:1px solid #ddd;}\n        .scoring-table th, .scoring-table td { padding:12px 8px; text-align:center; border:1px solid #ddd;}\n        .scoring-table th { background:#f8f9fa; font-weight:bold; color:#333;}\n        .scoring-table tr:nth-child(even) { background:#f8f9fa;}\n        .place-input { width:60px; padding:8px; border:2px solid #ddd; border-radius:4px; text-align:center; font-size:16px; font-weight:bold;}\n        .place-input:focus { border-color:#003399; outline:none;}\n        .couple-info { text-align:left; font-weight:bold; color:#333;}\n        .submit-section { text-align:center; margin-top:30px;}\n        .submit-btn { background:#03C75A; color:#fff; border:none; padding:15px 30px; font-size:16px; font-weight:bold; border-radius:8px; cursor:pointer; margin:0 10px;}\n        .submit-btn:hover { background:#00BFAE;}\n        .clear-btn { background:#FF6B35; color:#fff; border:none; padding:15px 30px; font-size:16px; font-weight:bold; border-radius:8px; cursor:pointer; margin:0 10px;}\n        .clear-btn:hover { background:#E55A2B;}\n        .warning { background:#fff3cd; border:1px solid #ffeaa7; color:#856404; padding:10px; border-radius:4px; margin-bottom:20px;}\n        .error { background:#f8d7da; border:1px solid #f5c6cb; color:#721c24; padding:10px; border-radius:4px; margin-bottom:20px;}\n        .success { background:#d4edda; border:1px solid #c3e6cb; color:#155724; padding:10px; border-radius:4px; margin-bottom:20px;}\n        .rules-info { background:#e7f3ff; border:1px solid #b3d9ff; color:#004085; padding:15px; border-radius:6px; margin-bottom:20px;}\n        .rules-info h3 { margin:0 0 10px 0; color:#003399;}\n        .rules-info ul { margin:10px 0; padding-left:20px;}\n        .rules-info li { margin:5px 0;}\n        \n        /* Final Round Styles - Touch-based System */\n        .final-scoring-container {\n            display: flex;\n            gap: 15px;\n            padding: 15px;\n            background: #fff;\n            border: 3px solid #003399;\n            border-radius: 8px;\n            min-height: 450px;\n            box-shadow: 0 4px 12px rgba(0, 51, 153, 0.15);\n        }\n        \n        .players-column, .ranking-column {\n            flex: 1;\n            background: #f8f9fa;\n            border: 2px solid #e9ecef;\n            border-radius: 8px;\n            padding: 12px;\n            box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n            display: flex;\n            flex-direction: column;\n        }\n        \n        .players-column h3, .ranking-column h3 {\n            margin: 0 0 8px 0;\n            color: #333;\n            font-size: 16px;\n            text-align: center;\n            padding-bottom: 6px;\n            border-bottom: 2px solid #003399;\n        }\n        \n        .players-list,         .ranking-list {\n            display: flex;\n            flex-direction: column;\n            gap: 12px; /* Increased gap for better spacing */\n            flex: 1;\n            overflow-y: auto;\n            padding-left: 10px; /* Add left padding for rank labels */\n        }\n        \n        .player-item {\n            background: #003399;\n            color: #fff;\n            padding: 16px 12px; /* Reduced horizontal padding */\n            border-radius: 8px;\n            text-align: center;\n            font-size: 18px; /* Slightly smaller font */\n            font-weight: bold;\n            cursor: pointer;\n            transition: all 0.3s ease;\n            user-select: none;\n            min-height: 60px;\n            height: 60px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n        }\n        \n        .player-item:hover {\n            background: #002266;\n            transform: translateY(-2px);\n            box-shadow: 0 4px 8px rgba(0,0,0,0.2);\n        }\n        \n        .player-item.selected {\n            background: #28a745;\n            transform: scale(1.05);\n            box-shadow: 0 6px 12px rgba(40, 167, 69, 0.3);\n        }\n        \n        .player-item.assigned {\n            opacity: 0.3;\n            background: #6c757d;\n            cursor: not-allowed;\n        }\n        \n        .ranking-slot {\n            background: #fff;\n            border: 2px solid #ddd;\n            border-radius: 8px;\n            padding: 16px 12px; /* Reduced horizontal padding */\n            text-align: center;\n            cursor: pointer;\n            transition: all 0.3s ease;\n            min-height: 60px;\n            height: 60px;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n            position: relative;\n            margin-left: 20px; /* Add left margin for rank label */\n        }\n        \n        .ranking-slot::before {\n            content: attr(data-rank) \"ìœ„\";\n            position: absolute;\n            top: 50%;\n            left: -15px;\n            transform: translateY(-50%);\n            background: #003399;\n            color: #fff;\n            padding: 4px 8px;\n            border-radius: 12px;\n            font-size: 12px;\n            font-weight: bold;\n            z-index: 10;\n            white-space: nowrap;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n        }\n        \n        .ranking-slot:hover {\n            border-color: #003399;\n            background: #f8f9ff;\n        }\n        \n        .ranking-slot.assigned {\n            border-color: #28a745;\n            background: #f8fff9;\n            cursor: pointer;\n        }\n        \n        .ranking-slot.assigned:hover {\n            border-color: #dc3545;\n            background: #fff5f5;\n        }\n        \n        .ranking-slot.assigned:hover .player-assigned {\n            color: #dc3545;\n        }\n        \n        .ranking-slot.dragging {\n            opacity: 0.5;\n            transform: rotate(5deg);\n            border-color: #ffc107;\n            background: #fff3cd;\n        }\n        \n        .ranking-slot.drag-over {\n            border-color: #007bff;\n            background: #e3f2fd;\n            transform: scale(1.05);\n        }\n        \n        .player-assigned {\n            font-size: 20px;\n            font-weight: bold;\n            color: #28a745;\n            min-height: 24px;\n        }\n        \n        .final-actions {\n            text-align: center;\n            margin-top: 20px;\n            padding: 20px;\n        }\n        \n        /* Dance Progress Styles for Final Round */\n        .dance-progress-header .dance-progress {\n            display: flex;\n            justify-content: center;\n            gap: 10px;\n            flex-wrap: wrap;\n        }\n        \n        .dance-step {\n            padding: 8px 16px;\n            border-radius: 20px;\n            font-size: 14px;\n            font-weight: bold;\n            transition: all 0.3s ease;\n            cursor: pointer;\n            border: 2px solid #ddd;\n            background: #fff;\n            color: #666;\n        }\n        \n        .dance-step.current {\n            background: #003399;\n            color: #fff;\n            border-color: #003399;\n        }\n        \n        .dance-step.completed {\n            background: #28a745;\n            color: #fff;\n            border-color: #28a745;\n        }\n        \n        .dance-step.pending {\n            background: #f8f9fa;\n            color: #6c757d;\n            border-color: #dee2e6;\n        }\n        \n        .dance-step:hover:not(.pending) {\n            transform: translateY(-2px);\n            box-shadow: 0 4px 8px rgba(0,0,0,0.2);\n        }\n        \n        .btn {\n            padding: 12px 24px;\n            border: none;\n            border-radius: 6px;\n            cursor: pointer;\n            font-size: 14px;\n            font-weight: 600;\n            transition: all 0.2s;\n            margin: 5px;\n        }\n        \n        .btn-primary {\n            background: #003399;\n            color: #fff;\n        }\n        \n        .btn-primary:hover {\n            background: #002266;\n        }\n        \n        .btn-secondary {\n            background: #6c757d;\n            color: #fff;\n        }\n        \n        .btn-secondary:hover {\n            background: #545b62;\n        }\n        \n        /* Instagram Style Dance Container */\n        .dance-container { position: relative; overflow: hidden; }\n        \n        .dance-progress {\n    display: flex;\n    align-items: center;\n            margin-bottom: 20px;\n            padding: 0 20px;\n        }\n        \n        .progress-bar {\n            flex: 1;\n            height: 6px;\n            background: #e0e0e0;\n            border-radius: 3px;\n            margin-right: 15px;\n            overflow: hidden;\n        }\n        \n        .progress-fill {\n            height: 100%;\n            background: linear-gradient(90deg, #4CAF50, #2e7d32);\n            border-radius: 3px;\n            transition: width 0.3s ease;\n        }\n        \n        .progress-text {\n            font-size: 14px;\n            font-weight: bold;\n            color: #666;\n            white-space: nowrap;\n        }\n        \n        .dance-slider {\n    display: flex;\n            transition: transform 0.3s ease;\n        }\n        \n        .dance-page {\n            min-width: 100%;\n            padding: 0 20px;\n            box-sizing: border-box;\n        }\n        \n        .dance-header { \n            background:#4CAF50; \n            color:#fff; \n            padding:10px; \n            border-radius:6px; \n            margin-bottom:15px; \n            text-align:center;\n        }\n        .dance-header h3 { margin:0 0 5px 0; font-size:16px;}\n        .dance-header p { margin:0; font-size:12px; opacity:0.9;}\n        \n        /* Heat section styles */\n        .heat-section { margin-bottom:15px; padding:10px; background:#fff; border-radius:6px; border:1px solid #ddd;}\n        .heat-section h4 { margin:0 0 10px 0; color:#333; font-size:14px; text-align:center;}\n        \n        /* Players grid styles - Mobile optimized */\n        .players-grid { \n            display:grid; \n            grid-template-columns:repeat(auto-fill, minmax(60px, 1fr)); \n            gap:4px; \n            margin-bottom:15px;\n        }\n        .player-card { \n            background:#fff; \n            border:2px solid #ddd; \n            border-radius:6px; \n            padding:6px 2px; \n            text-align:center; \n            cursor:pointer; \n            transition:all 0.3s ease;\n            position:relative;\n            min-height:50px;\n            display:flex;\n            flex-direction:column;\n            justify-content:center;\n            align-items:center;\n        }\n        .player-card:hover { \n            border-color:#4CAF50; \n            transform:translateY(-2px); \n            box-shadow:0 4px 8px rgba(0,0,0,0.15);\n        }\n        .player-card.selected { \n            border-color:#4CAF50; \n            background:linear-gradient(135deg, #e8f5e8, #c8e6c9);\n            transform:scale(1.05);\n            box-shadow:0 6px 12px rgba(76, 175, 80, 0.3);\n        }\n        .player-number { \n            font-size:24px; \n            font-weight:900; \n            color:#333;\n            margin:0;\n            line-height:1;\n        }\n        .player-card.selected .player-number {\n            color:#2e7d32;\n        }\n        .recall-checkbox { \n            display:none; /* Hide checkbox, use card click instead */\n        }\n        \n        /* Recall status - Large and clear */\n        .recall-status { \n            text-align:center; \n            padding:15px; \n            background:#f0f0f0; \n            border-radius:8px; \n            font-weight:bold; \n            color:#333;\n            font-size:16px;\n            margin:15px 0;\n            border:2px solid #ddd;\n        }\n        .recall-status.complete { \n            background:linear-gradient(135deg, #d4edda, #c3e6cb); \n            color:#155724; \n            border:3px solid #28a745;\n            animation:pulse 2s infinite;\n        }\n        .recall-status.over { \n            background:linear-gradient(135deg, #f8d7da, #f5c6cb); \n            color:#721c24; \n            border:3px solid #dc3545;\n        }\n        .recall-status .selected-count {\n            font-size:24px;\n            font-weight:900;\n        }\n        \n        @keyframes pulse {\n            0% { transform: scale(1); }\n            50% { transform: scale(1.02); }\n            100% { transform: scale(1); }\n        }\n        \n        /* Drag and drop for final ranking */\n        .ranking-container { display:flex; flex-direction:column; gap:10px; margin:20px 0;}\n        .ranking-item { \n            display:flex; \n            align-items:center; \n            background:#fff; \n            border:2px solid #ddd; \n            border-radius:8px; \n            padding:15px; \n            cursor:move;\n            transition:all 0.3s ease;\n            user-select:none;\n        }\n        .ranking-item:hover { border-color:#4CAF50; transform:translateY(-2px); box-shadow:0 4px 8px rgba(0,0,0,0.1);}\n        .ranking-item.dragging { opacity:0.5; transform:rotate(5deg);}\n        .ranking-number { \n            background:#4CAF50; \n            color:#fff; \n            width:40px; \n            height:40px; \n            border-radius:50%; \n            display:flex; \n            align-items:center; \n            justify-content:center; \n            font-weight:bold; \n            margin-right:15px;\n            flex-shrink:0;\n        }\n        .ranking-player { \n            flex:1; \n            font-size:18px; \n            font-weight:bold; \n            color:#333;\n        }\n        .ranking-place-input { \n            width:60px; \n            padding:8px; \n            border:2px solid #ddd; \n            border-radius:4px; \n            text-align:center; \n            font-size:16px; \n            font-weight:bold;\n            margin-left:15px;\n        }\n        .ranking-place-input:focus { border-color:#4CAF50; outline:none;}\n        \n        /* Fixed Progress Bar for Mobile */\n        .fixed-progress {\n            position: fixed;\n            top: 0;\n            left: 0;\n            right: 0;\n            background: linear-gradient(135deg, #ff9800, #ff5722);\n            color: white;\n            padding: 12px 20px;\n            text-align: center;\n            font-size: 18px;\n            font-weight: bold;\n            z-index: 1000;\n            box-shadow: 0 2px 10px rgba(0,0,0,0.3);\n            transform: translateY(-100%);\n            transition: transform 0.3s ease;\n        }\n        .fixed-progress.show {\n            transform: translateY(0);\n        }\n        .fixed-progress.complete {\n            background: linear-gradient(135deg, #4CAF50, #2e7d32);\n        }\n        .fixed-progress.over {\n            background: linear-gradient(135deg, #f44336, #d32f2f);\n        }\n        \n        /* Add top padding to body when progress bar is shown */\n        body.progress-bar-visible {\n            padding-top: 60px;\n        }\n        \n        /* Bottom Navigation */\n        .bottom-nav {\n            position: fixed;\n            bottom: 0;\n            left: 0;\n            right: 0;\n            background: #fff;\n            border-top: 2px solid #e0e0e0;\n            padding: 10px 20px;\n            display: flex;\n            justify-content: space-around;\n    align-items: center;\n            z-index: 1000;\n            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);\n        }\n        \n        .nav-button {\n            background: #f5f5f5;\n            color: #333;\n            border: none;\n            padding: 12px 20px;\n            border-radius: 8px;\n            cursor: pointer;\n            font-size: 14px;\n            font-weight: bold;\n            transition: all 0.3s ease;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            gap: 4px;\n            min-width: 80px;\n        }\n        \n        .nav-button:hover {\n            background: #e0e0e0;\n            transform: translateY(-2px);\n        }\n        \n        .nav-button.primary {\n            background: #2196F3;\n            color: #fff;\n        }\n        \n        .nav-button.primary:hover {\n            background: #1976D2;\n        }\n        \n        .nav-icon {\n            font-size: 18px;\n        }\n        \n        .nav-text {\n            font-size: 12px;\n        }\n        \n        /* Add bottom padding to body for navigation */\n        body {\n            padding-bottom: 80px;\n        }\n        \n        /* Tablet responsive - Optimized for tablet screens */\n        @media (min-width: 769px) and (max-width: 1024px) {\n            .event-info {\n                padding: 3px !important;\n                margin-bottom: 2px !important;\n            }\n            \n            .event-info h1 {\n                font-size: 16px !important;\n                margin-bottom: 1px !important;\n            }\n            \n            .event-info p {\n                font-size: 11px !important;\n            }\n            \n            .saved-scores-info {\n                padding: 4px !important;\n                margin-bottom: 6px !important;\n            }\n            \n            .saved-scores-info h3 {\n                font-size: 12px !important;\n                margin-bottom: 2px !important;\n            }\n            \n            .dance-progress-header {\n                padding: 3px !important;\n                margin-bottom: 4px !important;\n            }\n            \n            .dance-progress-header h3 {\n                font-size: 12px !important;\n                margin-bottom: 1px !important;\n            }\n            \n            .final-scoring-container {\n                gap: 10px;\n                padding: 10px;\n                min-height: 380px;\n            }\n            \n            .players-column, .ranking-column {\n                padding: 8px;\n            }\n            \n            .players-column h3, .ranking-column h3 {\n                font-size: 14px;\n                margin-bottom: 6px;\n            }\n            \n            .players-list, .ranking-list {\n                gap: 8px;\n            }\n            \n            .player-item, .ranking-slot {\n                padding: 12px 16px;\n                font-size: 16px;\n                min-height: 50px;\n                height: 50px;\n            }\n            \n            .ranking-slot::before {\n                font-size: 10px;\n                padding: 2px 6px;\n            }\n        }\n        \n        /* Mobile responsive - Optimized for touch */\n        @media (max-width: 768px) {\n            .final-scoring-container {\n                flex-direction: row; /* ì¢Œìš° ë°°ì¹˜ ìœ ì§€ */\n                gap: 10px;\n                padding: 10px;\n                min-height: 400px;\n            }\n            \n            .players-column, .ranking-column {\n                min-height: 350px;\n                flex: 1;\n            }\n            \n            .player-item, .ranking-slot {\n                padding: 12px;\n                font-size: 16px;\n                min-height: 45px;\n                height: 45px;\n            }\n            \n            .ranking-slot::before {\n                font-size: 10px;\n                padding: 2px 6px;\n                top: 50%;\n                left: -12px;\n                transform: translateY(-50%);\n            }\n            \n            .ranking-slot {\n                margin-left: 15px; /* Smaller margin for mobile */\n            }\n            \n            .player-assigned {\n                font-size: 16px;\n            }\n            \n            .players-grid { \n                grid-template-columns:repeat(auto-fill, minmax(50px, 1fr)); \n                gap:4px;\n                margin-bottom:10px;\n            }\n            .player-card { \n                padding:4px 2px;\n                min-height:45px;\n                border-width:2px;\n            }\n            .player-number { \n                font-size:20px;\n            }\n            .dance-header h3 { \n                font-size:14px;\n            }\n            .dance-header p {\n                font-size:12px;\n            }\n            .recall-status {\n                padding:15px;\n                font-size:16px;\n                margin:15px 0;\n            }\n            .recall-status .selected-count {\n                font-size:20px;\n            }\n            .ranking-item { \n                padding:10px;\n                flex-direction:column;\n                gap:8px;\n            }\n            .ranking-number { \n                width:35px; \n                height:35px; \n                margin-right:0;\n                margin-bottom:5px;\n            }\n            .ranking-player { \n                font-size:16px;\n                text-align:center;\n            }\n            .ranking-place-input {\n                width:50px;\n                margin-left:0;\n            }\n        }\n        \n        @media (max-width: 480px) {\n            .players-grid { \n                grid-template-columns:repeat(auto-fill, minmax(55px, 1fr)); \n                gap:5px;\n            }\n            .player-card { \n                padding:5px 2px;\n                min-height:45px;\n            }\n            .player-number { \n                font-size:22px;\n            }\n            .recall-status {\n                padding:12px;\n                font-size:14px;\n            }\n            .recall-status .selected-count {\n                font-size:18px;\n            }\n        }\n    </style>\n</head>\n<body>\n<div class=\"scoring-container\">\n    <?php \n    // Determine scoring type and recall count\n    $is_final = false;\n    $is_preliminary = false;\n    $recall_count = $event_data['recall_count'] ?? 0;\n    \n    if ($round_info && isset($round_info[$event_no])) {\n        $round_display = $round_info[$event_no]['round_display'] ?? '';\n        $is_final = (strpos($round_display, 'Final') !== false);\n        $is_preliminary = !$is_final;\n    } else {\n        // Fallback to old system\n        $is_final = (strpos($event_data['round_type'], 'Final') !== false);\n        $is_preliminary = !$is_final;\n    }\n    ?>\n\n    <!-- Judge Info and Recall in One Line -->\n    <div style=\"margin-bottom:15px; text-align:center; padding:10px; background:#f8f9fa; border-radius:6px;\">\n        <div style=\"display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:10px;\">\n            <div style=\"font-size:14px; font-weight:bold; color:#333;\">\n                #<?=h($_SESSION['scoring_judge_id'])?> <?=h($_SESSION['scoring_judge_name'])?>(<?=h($_SESSION['scoring_judge_country'])?>)\n            </div>\n            <?php if (!$is_final && $event_no !== '8'): ?>\n            <div style=\"font-size:16px; font-weight:bold; color:#ff9800;\">\n                Recall <span id=\"recallProgress\">0</span> / <?= $recall_count ?>\n            </div>\n            <?php endif; ?>\n        </div>\n    </div>\n    \n    \n            <div class=\"event-info\" style=\"display:flex; justify-content:space-between; align-items:center; margin-bottom:2px; padding:4px; background:#f8f9fa; border-radius:4px;\">\n        <div style=\"flex:1;\">\n            <h1 style=\"margin:0 0 2px 0; color:#333; font-size:18px; font-weight:bold;\"><?=h($event_data['name'])?></h1>\n            <?php \n            // Get round display\n            $round_display = '';\n            if ($round_info && isset($round_info['round_info'][$event_no])) {\n                $round_display = $round_info['round_info'][$event_no] ?? '';\n            } else {\n                $round_display = trim($event_data['round_type'] . ' ' . $event_data['round_num']);\n            }\n            \n            // Get dance names\n            $dance_names = getDanceNames($event_data['dances'], $dance_mapping);\n            ?>\n            <p style=\"margin:0; font-size:12px; color:#666;\">\n                <?=h($round_display)?> (<?=h(implode(',', $dance_names))?>) | <?=count($players)?> couples<?php if ($hits_data && !empty($hits_data)): ?> / <?=count($hits_data)?> heats<?php endif; ?>\n            </p>\n                    </div>\n        <div style=\"text-align:right; font-size:11px; color:#666;\">\n            <div style=\"font-weight:bold; color:#2e7d32;\">\n                <?php if ($saved_scores): ?>\n                    <?= implode(', ', array_keys($saved_scores)) ?>\n                <?php else: ?>\n                    ì—†ìŒ\n                <?php endif; ?>\n                    </div>\n        </div>\n                    </div>\n\n    \n\n    <div id=\"message\"></div>\n    \n    <!-- Fixed Progress Bar for Mobile (Preliminary/Recall only) -->\n    <?php if (!$is_final && $event_no !== '8'): ?>\n    <div id=\"fixedProgress\" class=\"fixed-progress\">\n        Recall <span id=\"fixedRecallCount\">0</span> / <?= $recall_count ?>\n                    </div>\n    <?php endif; ?>\n    \n\n    <form id=\"scoringForm\">\n        <input type=\"hidden\" name=\"comp_id\" value=\"<?=h($comp_id)?>\">\n        <input type=\"hidden\" name=\"event_no\" value=\"<?=h($event_no)?>\">\n        <input type=\"hidden\" name=\"is_final\" value=\"<?= $is_final ? '1' : '0' ?>\">\n        <input type=\"hidden\" name=\"recall_count\" value=\"<?= $recall_count ?>\">\n        \n        <?php if ($is_final || $event_no === '8'): ?>\n            <!-- Final Round - Touch-based Ranking System -->\n        <div class=\"adjudicator-section\">\n            <!-- Dance Progress Header -->\n            <div class=\"dance-progress-header\" id=\"danceProgressHeader\" style=\"display:flex; justify-content:flex-end; align-items:center; background: #f8f9fa; padding: 4px; border-radius: 4px; margin-bottom: 4px;\">\n                <div style=\"display:flex; align-items:center; gap:10px;\">\n                    <div class=\"dance-progress\" id=\"danceProgress\">\n                        <!-- Dance progress will be populated by JavaScript -->\n                    </div>\n                    <div id=\"currentDanceDisplay\" style=\"font-size: 12px; font-weight: bold; color: #003399;\">\n                        <!-- Current dance will be displayed here -->\n                    </div>\n                </div>\n            </div>\n            \n            <p style=\"text-align:center; color:#666; margin:2px 0; font-size:11px;\">\n                ğŸ’¡ ë“±ë²ˆí˜¸ í„°ì¹˜ â†’ ë“±ìœ„ ë¹ˆì¹¸ í„°ì¹˜ | ğŸ”„ ìˆœìœ„ ë³€ê²½: ê¸°ì¡´ ìˆœìœ„ í„°ì¹˜/ë“œë˜ê·¸ | âŒ ì·¨ì†Œ: ë°°ì •ëœ ë“±ë²ˆí˜¸ ì¬í„°ì¹˜\n            </p>\n                \n                <div class=\"final-scoring-container\" style=\"margin-top: 0;\">\n                    <div class=\"players-column\">\n                        <h3>ì„ ìˆ˜ ëª©ë¡</h3>\n                        <div class=\"players-list\" id=\"playersList\">\n                            <?php foreach ($players as $player_no): ?>\n                            <div class=\"player-item\" data-player=\"<?=h($player_no)?>\" onclick=\"selectPlayer(this)\">\n                                <?=h($player_no)?>\n                </div>\n                <?php endforeach; ?>\n                </div>\n                    </div>\n                    \n                    <div class=\"ranking-column\">\n                        <h3>ìˆœìœ„</h3>\n                        <div class=\"ranking-list\" id=\"rankingList\">\n                            <?php for ($i = 1; $i <= count($players); $i++): ?>\n                            <div class=\"ranking-slot\" data-rank=\"<?=$i?>\" onclick=\"assignRank(this)\" \n                                 ondblclick=\"swapWithNext(this)\" \n                                 draggable=\"true\" ondragstart=\"dragStart(event)\" ondragover=\"dragOver(event)\" \n                                 ondrop=\"drop(event)\" ondragend=\"dragEnd(event)\"\n                                 onmousedown=\"handleMouseDown(event)\" onmouseup=\"handleMouseUp(event)\">\n                                <span class=\"player-assigned\" id=\"player-<?=$i?>\"></span>\n                                <input type=\"hidden\" name=\"final_ranking[<?=$i?>]\" id=\"input-<?=$i?>\" value=\"\">\n                            </div>\n                            <?php endfor; ?>\n                        </div>\n                    </div>\n                </div>\n                \n                <div class=\"final-actions\">\n                    <button type=\"button\" id=\"saveFinalScores\" class=\"btn btn-primary\">\n                        ì ìˆ˜ ì €ì¥\n                    </button>\n                    <button type=\"button\" id=\"nextFinalDance\" class=\"btn btn-secondary\" style=\"display:none;\">\n                        ë‹¤ìŒ ì¢…ëª©\n                    </button>\n                    <button type=\"button\" id=\"clearFinalScores\" class=\"btn btn-secondary\">\n                        ì´ˆê¸°í™”\n                    </button>\n                </div>\n            </div>\n            <?php else: ?>\n            <!-- Preliminary Round - Instagram Style Dance by Dance System -->\n            <div class=\"dance-container\">\n                <div class=\"dance-progress\">\n                    <div class=\"progress-bar\">\n                        <div class=\"progress-fill\" style=\"width: 0%\"></div>\n                    </div>\n                    <div class=\"progress-text\">\n                        <span class=\"current-dance\">1</span> / <?= count($event_data['dances']) ?>\n                    </div>\n                </div>\n                \n                <div class=\"dance-slider\" id=\"danceSlider\">\n                    <?php foreach ($event_data['dances'] as $dance_index => $dance): ?>\n                        <?php \n                        $dance_display = isset($dance_mapping[$dance]) ? $dance_mapping[$dance] : $dance;\n                        ?>\n                        <div class=\"dance-page\" data-dance=\"<?=h($dance)?>\" data-dance-index=\"<?=$dance_index?>\">\n                            <div class=\"dance-header\">\n                                <h3><?=h($dance_display)?></h3>\n                                <p>ì´ <?=count($players)?>ëª… ì¤‘ <?= $recall_count ?>ëª… ì„ íƒ</p>\n                            </div>\n                            \n                            <?php if ($hits_data && !empty($hits_data)): ?>\n                                <!-- Heat-based display -->\n                                <?php foreach ($hits_data as $heat_no => $heat_players): ?>\n                                    <div class=\"heat-section\">\n                                        <h4>íˆíŠ¸ <?= $heat_no ?></h4>\n                                        <div class=\"players-grid\">\n                                            <?php foreach ($heat_players as $player_no): ?>\n                                                <div class=\"player-card\" data-player=\"<?=h($player_no)?>\">\n                                                    <div class=\"player-number\"><?=h($player_no)?></div>\n                                                    <input type=\"checkbox\" \n                                                           name=\"recall_marks[<?=h($dance)?>][<?=h($player_no)?>]\" \n                                                           class=\"recall-checkbox\"\n                                                           data-dance=\"<?=h($dance)?>\"\n                                                           data-player=\"<?=h($player_no)?>\">\n                                                </div>\n                                            <?php endforeach; ?>\n                                        </div>\n                                    </div>\n                                <?php endforeach; ?>\n                            <?php else: ?>\n                                <!-- No heats - all players together -->\n                                <div class=\"players-grid\">\n                                    <?php foreach ($players as $player_no): ?>\n                                        <div class=\"player-card\" data-player=\"<?=h($player_no)?>\">\n                                            <div class=\"player-number\"><?=h($player_no)?></div>\n                                            <input type=\"checkbox\" \n                                                   name=\"recall_marks[<?=h($dance)?>][<?=h($player_no)?>]\" \n                                                   class=\"recall-checkbox\"\n                                                   data-dance=\"<?=h($dance)?>\"\n                                                   data-player=\"<?=h($player_no)?>\">\n                                        </div>\n                                    <?php endforeach; ?>\n                                </div>\n            <?php endif; ?>\n                            \n                            <div class=\"recall-status\">\n                                <div style=\"font-size:20px; margin-bottom:5px;\">ğŸ“Š Recall ì§„í–‰ ìƒí™©</div>\n                                <div style=\"font-size:28px; font-weight:900; color:#2e7d32;\">\n                                    <span class=\"selected-count\">0</span> / <?= $recall_count ?>ëª…\n        </div>\n                                <div style=\"font-size:14px; margin-top:5px; opacity:0.8;\">\n                                    <?= $recall_count ?>ëª…ì„ ì„ íƒí•˜ë©´ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤\n    </div>\n                            </div>\n                            \n                            <div class=\"dance-submit-section\" style=\"text-align:center; margin-top:20px; display:none;\">\n                                <button type=\"button\" \n                                        class=\"dance-submit-btn\" \n                                        data-dance=\"<?=h($dance)?>\"\n                                        style=\"background:#4CAF50; color:#fff; border:none; padding:15px 30px; font-size:16px; font-weight:bold; border-radius:8px; cursor:pointer;\">\n                                    <?=h($dance_display)?> ì „ì†¡\n                                </button>\n                            </div>\n                        </div>\n                    <?php endforeach; ?>\n                </div>\n                \n                <div class=\"dance-navigation\" style=\"text-align:center; margin-top:20px;\">\n                    <button type=\"button\" id=\"prevDance\" style=\"background:#666; color:#fff; border:none; padding:10px 20px; margin:0 10px; border-radius:5px; cursor:pointer; display:none;\">ì´ì „</button>\n                    <button type=\"button\" id=\"nextDance\" style=\"background:#2196F3; color:#fff; border:none; padding:10px 20px; margin:0 10px; border-radius:5px; cursor:pointer; display:none;\">ë‹¤ìŒ</button>\n                </div>\n            </div>\n            <?php endif; ?>\n\n    </form>\n    </div>\n\n    <script>\ndocument.getElementById('scoringForm').addEventListener('submit', function(e) {\n    e.preventDefault();\n    \n    const formData = new FormData(this);\n    const isFinal = formData.get('is_final') === '1';\n    const recallCount = parseInt(formData.get('recall_count'));\n    \n    if (isFinal) {\n        // Final round - ranking system\n        handleFinalRound(formData);\n    } else {\n        // Preliminary round - recall system\n        handleRecallRound(formData, recallCount);\n    }\n});\n\nfunction handleFinalRound(formData) {\n    const adjudicatorMarks = {};\n    \n    // Collect all marks\n    const inputs = document.querySelectorAll('input[name^=\"adjudicator_marks\"]');\n    inputs.forEach(input => {\n        const name = input.name;\n        const matches = name.match(/adjudicator_marks\\[(\\d+)\\]\\[(\\d+)\\]/);\n        if (matches) {\n            const adjudicatorId = matches[1];\n            const coupleId = matches[2];\n            const place = parseInt(input.value);\n            \n            if (!isNaN(place) && place > 0) {\n                if (!adjudicatorMarks[adjudicatorId]) {\n                    adjudicatorMarks[adjudicatorId] = {};\n                }\n                adjudicatorMarks[adjudicatorId][coupleId] = place;\n            }\n        }\n    });\n    \n    // Validate that all places are filled and unique\n    const allPlaces = [];\n    let isValid = true;\n    let errorMessage = '';\n    \n    inputs.forEach(input => {\n        const place = parseInt(input.value);\n        if (isNaN(place) || place < 1 || place > <?=count($players)?>) {\n            isValid = false;\n            errorMessage = 'ëª¨ë“  ìˆœìœ„ë¥¼ 1ë¶€í„° <?=count($players)?>ê¹Œì§€ ì…ë ¥í•´ì£¼ì„¸ìš”.';\n        } else {\n            if (allPlaces.includes(place)) {\n                isValid = false;\n                errorMessage = 'ê°™ì€ ìˆœìœ„ë¥¼ ë‘ ì„ ìˆ˜ì—ê²Œ ì¤„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';\n            }\n            allPlaces.push(place);\n        }\n    });\n    \n    if (!isValid) {\n        showMessage(errorMessage, 'error');\n        return;\n    }\n    \n    // Submit data\n    const submitData = {\n        comp_id: formData.get('comp_id'),\n        event_no: formData.get('event_no'),\n        type: 'final',\n        adjudicator_marks: adjudicatorMarks\n    };\n    \n    submitScores(submitData);\n}\n\nfunction handleRecallRound(formData, recallCount) {\n    const recallMarks = {};\n    let totalSelected = 0;\n    let isValid = true;\n    let errorMessage = '';\n    \n    // Collect recall marks for each dance\n    const danceSections = document.querySelectorAll('.dance-section');\n    danceSections.forEach(section => {\n        const dance = section.dataset.dance;\n        const checkboxes = section.querySelectorAll('.recall-checkbox:checked');\n        \n        recallMarks[dance] = [];\n        checkboxes.forEach(checkbox => {\n            recallMarks[dance].push(checkbox.dataset.player);\n        });\n        \n        totalSelected += checkboxes.length;\n    });\n    \n    // Check if total selected count matches recall count\n    if (totalSelected !== recallCount) {\n        isValid = false;\n        errorMessage = `ì „ì²´ ${recallCount}ëª…ì„ ì„ íƒí•´ì£¼ì„¸ìš”. (í˜„ì¬ ${totalSelected}ëª… ì„ íƒë¨)`;\n    }\n    \n    if (!isValid) {\n        showMessage(errorMessage, 'error');\n        return;\n    }\n    \n    // Submit data\n    const submitData = {\n        comp_id: formData.get('comp_id'),\n        event_no: formData.get('event_no'),\n        type: 'recall',\n        recall_marks: recallMarks\n    };\n    \n    submitScores(submitData);\n}\n\nfunction submitScores(submitData) {\n    fetch('scoring/save_scores.php', {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(submitData)\n    })\n    .then(response => response.json())\n    .then(data => {\n        if (data.success) {\n            showMessage('ì ìˆ˜ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');\n            if (data.results) {\n                showResults(data.results);\n            }\n        } else {\n            showMessage('ì €ì¥ ì‹¤íŒ¨: ' + (data.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'), 'error');\n        }\n    })\n    .catch(error => {\n        showMessage('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error, 'error');\n    });\n}\n\nfunction clearAllScores() {\n    if (confirm('ëª¨ë“  ì ìˆ˜ë¥¼ ì§€ìš°ì‹œê² ìŠµë‹ˆê¹Œ?')) {\n        // Clear final round inputs\n        const inputs = document.querySelectorAll('.place-input');\n        inputs.forEach(input => input.value = '');\n        \n        // Clear recall checkboxes\n        const checkboxes = document.querySelectorAll('.recall-checkbox');\n        checkboxes.forEach(checkbox => {\n            checkbox.checked = false;\n            checkbox.closest('.player-card').classList.remove('selected');\n        });\n        \n        // Update recall status\n        updateRecallStatus();\n        \n        showMessage('ëª¨ë“  ì ìˆ˜ê°€ ì§€ì›Œì¡ŒìŠµë‹ˆë‹¤.', 'success');\n    }\n}\n\n// Recall system event handlers\n    document.addEventListener('DOMContentLoaded', function() {\n    // Handle player card clicks - Touch optimized\n    document.querySelectorAll('.player-card').forEach(card => {\n        // Click event\n        card.addEventListener('click', function(e) {\n            e.preventDefault();\n            e.stopPropagation();\n            togglePlayerSelection(this);\n        });\n        \n        // Touch events for better mobile experience\n        card.addEventListener('touchstart', function(e) {\n            e.preventDefault();\n            this.style.transform = 'scale(0.95)';\n        });\n        \n        card.addEventListener('touchend', function(e) {\n            e.preventDefault();\n            this.style.transform = '';\n            togglePlayerSelection(this);\n        });\n        \n        // Prevent default touch behavior\n        card.addEventListener('touchmove', function(e) {\n            e.preventDefault();\n        });\n    });\n\n    // Handle checkbox changes\n    document.querySelectorAll('.recall-checkbox').forEach(checkbox => {\n        checkbox.addEventListener('change', function() {\n            updatePlayerCardState(this.closest('.player-card'));\n            updateRecallStatus();\n        });\n    });\n\n    // Initialize recall status\n    updateRecallStatus();\n    \n    // Initialize drag and drop for final ranking\n    initializeDragAndDrop();\n    \n    // Load saved scores\n    loadSavedScores();\n    \n    // Initialize fixed progress bar\n    initializeFixedProgress();\n});\n\nfunction initializeDragAndDrop() {\n    const container = document.getElementById('rankingContainer');\n    if (!container) return;\n    \n    let draggedElement = null;\n    \n    // Handle drag start\n    container.addEventListener('dragstart', function(e) {\n        if (e.target.classList.contains('ranking-item')) {\n            draggedElement = e.target;\n            e.target.classList.add('dragging');\n            e.dataTransfer.effectAllowed = 'move';\n        }\n    });\n    \n    // Handle drag end\n    container.addEventListener('dragend', function(e) {\n        if (e.target.classList.contains('ranking-item')) {\n            e.target.classList.remove('dragging');\n            draggedElement = null;\n        }\n    });\n    \n    // Handle drag over\n    container.addEventListener('dragover', function(e) {\n        e.preventDefault();\n        e.dataTransfer.dropEffect = 'move';\n        \n        const afterElement = getDragAfterElement(container, e.clientY);\n        if (afterElement == null) {\n            container.appendChild(draggedElement);\n        } else {\n            container.insertBefore(draggedElement, afterElement);\n        }\n    });\n    \n    // Handle drop\n    container.addEventListener('drop', function(e) {\n        e.preventDefault();\n        updateRankingNumbers();\n    });\n    \n    // Handle manual input changes\n    container.addEventListener('input', function(e) {\n        if (e.target.classList.contains('ranking-place-input')) {\n            updateRankingFromInputs();\n        }\n    });\n}\n\nfunction getDragAfterElement(container, y) {\n    const draggableElements = [...container.querySelectorAll('.ranking-item:not(.dragging)')];\n    \n    return draggableElements.reduce((closest, child) => {\n        const box = child.getBoundingClientRect();\n        const offset = y - box.top - box.height / 2;\n        \n        if (offset < 0 && offset > closest.offset) {\n            return { offset: offset, element: child };\n        } else {\n            return closest;\n        }\n    }, { offset: Number.NEGATIVE_INFINITY }).element;\n}\n\nfunction updateRankingNumbers() {\n    const container = document.getElementById('rankingContainer');\n    if (!container) return;\n    \n    const items = container.querySelectorAll('.ranking-item');\n    items.forEach((item, index) => {\n        const numberDiv = item.querySelector('.ranking-number');\n        const input = item.querySelector('.ranking-place-input');\n        \n        numberDiv.textContent = index + 1;\n        input.value = index + 1;\n        \n        // Update input name to reflect new position\n        const player = item.dataset.player;\n        input.name = `adjudicator_marks[${index + 1}][${player}]`;\n    });\n}\n\nfunction updateRankingFromInputs() {\n    const container = document.getElementById('rankingContainer');\n    if (!container) return;\n    \n    const items = Array.from(container.querySelectorAll('.ranking-item'));\n    const inputs = items.map(item => ({\n        element: item,\n        value: parseInt(item.querySelector('.ranking-place-input').value) || 0\n    }));\n    \n    // Sort by input value\n    inputs.sort((a, b) => a.value - b.value);\n    \n    // Reorder DOM elements\n    inputs.forEach((input, index) => {\n        container.appendChild(input.element);\n        \n        // Update visual number\n        const numberDiv = input.element.querySelector('.ranking-number');\n        numberDiv.textContent = index + 1;\n        \n        // Update input name\n        const player = input.element.dataset.player;\n        const inputElement = input.element.querySelector('.ranking-place-input');\n        inputElement.name = `adjudicator_marks[${index + 1}][${player}]`;\n    });\n}\n\nfunction loadSavedScores() {\n    <?php if ($saved_scores && !$is_final): ?>\n    // Load saved recall scores\n    const savedScores = <?= json_encode($saved_scores) ?>;\n    \n    Object.keys(savedScores).forEach(dance => {\n        const danceSection = document.querySelector(`[data-dance=\"${dance}\"]`);\n        if (!danceSection) return;\n        \n        const selectedPlayers = savedScores[dance];\n        selectedPlayers.forEach(playerNo => {\n            const checkbox = danceSection.querySelector(`input[data-player=\"${playerNo}\"]`);\n            if (checkbox) {\n                checkbox.checked = true;\n                updatePlayerCardState(checkbox.closest('.player-card'));\n            }\n        });\n    });\n\n    updateRecallStatus();\n    <?php endif; ?>\n}\n\nfunction initializeFixedProgress() {\n    const fixedProgress = document.getElementById('fixedProgress');\n    if (!fixedProgress) return;\n    \n    let isScrolling = false;\n    let scrollTimeout;\n    \n    // Show progress bar when scrolling down\n    window.addEventListener('scroll', function() {\n        if (!isScrolling) {\n            fixedProgress.classList.add('show');\n            document.body.classList.add('progress-bar-visible');\n        }\n        \n        isScrolling = true;\n        clearTimeout(scrollTimeout);\n        \n        scrollTimeout = setTimeout(function() {\n            isScrolling = false;\n            // Hide progress bar after scrolling stops (only if no selections)\n            const totalSelected = document.querySelectorAll('.recall-checkbox:checked').length;\n            if (totalSelected === 0) {\n                fixedProgress.classList.remove('show');\n                document.body.classList.remove('progress-bar-visible');\n            }\n        }, 1000);\n    });\n    \n    // Touch events for mobile\n    document.addEventListener('touchstart', function() {\n        fixedProgress.classList.add('show');\n        document.body.classList.add('progress-bar-visible');\n    });\n}\n\nfunction togglePlayerSelection(card) {\n    const checkbox = card.querySelector('.recall-checkbox');\n    checkbox.checked = !checkbox.checked;\n    updatePlayerCardState(card);\n    updateRecallStatus();\n    updateTopRecallStatus(); // Add this line\n}\n\nfunction updatePlayerCardState(card) {\n    const checkbox = card.querySelector('.recall-checkbox');\n    if (checkbox.checked) {\n        card.classList.add('selected');\n    } else {\n        card.classList.remove('selected');\n    }\n}\n\nfunction updateTopRecallStatus() {\n    // Get all checked checkboxes from all pages\n    const allCheckboxes = document.querySelectorAll('.recall-checkbox:checked');\n    const selectedCount = allCheckboxes.length;\n    const recallCount = <?= json_encode(intval($recall_count)) ?>;\n    \n    // Update top recall progress display\n    const topRecallProgress = document.getElementById('recallProgress');\n    if (topRecallProgress) {\n        topRecallProgress.textContent = selectedCount;\n        \n        // Update color based on progress\n        if (selectedCount === recallCount) {\n            topRecallProgress.style.color = '#4CAF50';\n            topRecallProgress.style.fontWeight = 'bold';\n        } else if (selectedCount > recallCount) {\n            topRecallProgress.style.color = '#f44336';\n            topRecallProgress.style.fontWeight = 'bold';\n        } else {\n            topRecallProgress.style.color = '#ff9800';\n            topRecallProgress.style.fontWeight = 'normal';\n        }\n    }\n    \n    // Update fixed progress bar\n    const fixedRecallCount = document.getElementById('fixedRecallCount');\n    if (fixedRecallCount) {\n        fixedRecallCount.textContent = selectedCount;\n    }\n    \n    // Update submit button state for current dance page\n    const currentPage = document.querySelector('.dance-page[data-dance-index=\"' + currentDanceIndex + '\"]');\n    if (currentPage) {\n        const submitSection = currentPage.querySelector('.dance-submit-section');\n        const submitBtn = currentPage.querySelector('.dance-submit-btn');\n        \n        if (submitSection && submitBtn) {\n            // Show/hide submit section based on selection count\n            if (selectedCount === recallCount) {\n                submitSection.style.display = 'block';\n                submitBtn.disabled = false;\n                submitBtn.style.opacity = '1';\n                submitBtn.style.cursor = 'pointer';\n            } else {\n                submitSection.style.display = 'none';\n                submitBtn.disabled = true;\n                submitBtn.style.opacity = '0.5';\n                submitBtn.style.cursor = 'not-allowed';\n            }\n        }\n    }\n}\n\nfunction updateRecallStatus() {\n    const currentPage = document.querySelector('.dance-page[data-dance-index=\"' + currentDanceIndex + '\"]');\n    \n    if (!currentPage) {\n        // Fallback: get all checked checkboxes from all pages\n        const allCheckboxes = document.querySelectorAll('.recall-checkbox:checked');\n        const selectedCount = allCheckboxes.length;\n        const recallCount = <?= json_encode(intval($recall_count)) ?>;\n        \n        // Update top recall progress display\n        const topRecallProgress = document.getElementById('recallProgress');\n        if (topRecallProgress) {\n            topRecallProgress.textContent = selectedCount;\n            \n            // Update color based on progress\n            if (selectedCount === recallCount) {\n                topRecallProgress.style.color = '#4CAF50';\n                topRecallProgress.style.fontWeight = 'bold';\n            } else if (selectedCount > recallCount) {\n                topRecallProgress.style.color = '#f44336';\n                topRecallProgress.style.fontWeight = 'bold';\n            } else {\n                topRecallProgress.style.color = '#ff9800';\n                topRecallProgress.style.fontWeight = 'normal';\n            }\n        }\n        return;\n    }\n    \n    const checkboxes = currentPage.querySelectorAll('.recall-checkbox:checked');\n    const selectedCount = checkboxes.length;\n    const recallCount = <?= json_encode(intval($recall_count)) ?>;\n    \n    // Top recall progress is handled by updateTopRecallStatus function\n    \n    // Update fixed progress bar\n    const fixedProgress = document.getElementById('fixedProgress');\n    if (fixedProgress) {\n        const progressText = fixedProgress.querySelector('#recallProgress');\n        if (progressText) {\n            progressText.textContent = selectedCount;\n        }\n        \n        // Update progress bar styling\n        fixedProgress.classList.remove('complete', 'over');\n        if (selectedCount === recallCount) {\n            fixedProgress.classList.add('complete');\n        } else if (selectedCount > recallCount) {\n            fixedProgress.classList.add('over');\n        }\n    }\n    \n    // Update current page status\n    const statusDiv = currentPage.querySelector('.recall-status');\n    const countSpan = statusDiv.querySelector('.selected-count');\n    const submitSection = currentPage.querySelector('.dance-submit-section');\n    \n    if (countSpan) {\n        countSpan.textContent = selectedCount;\n    }\n    \n    // Update status styling\n    statusDiv.classList.remove('complete', 'over');\n    if (selectedCount === recallCount) {\n        statusDiv.classList.add('complete');\n        if (submitSection) submitSection.style.display = 'block';\n    } else if (selectedCount > recallCount) {\n        statusDiv.classList.add('over');\n        if (submitSection) submitSection.style.display = 'none';\n    } else {\n        if (submitSection) submitSection.style.display = 'none';\n    }\n}\n\nfunction showMessage(message, type) {\n    const messageDiv = document.getElementById('message');\n    messageDiv.innerHTML = `<div class=\"${type}\">${message}</div>`;\n    setTimeout(() => {\n        messageDiv.innerHTML = '';\n    }, 5000);\n}\n\nfunction showResults(results) {\n    let resultsHtml = '<div class=\"success\"><h3>ìµœì¢… ê²°ê³¼ (Skating System ì ìš©)</h3><ol>';\n    const sortedResults = Object.entries(results).sort((a, b) => a[1] - b[1]);\n    sortedResults.forEach(([coupleId, place]) => {\n        resultsHtml += `<li>ì„ ìˆ˜ #${coupleId} - ${place}ë“±</li>`;\n    });\n    resultsHtml += '</ol></div>';\n    document.getElementById('message').innerHTML = resultsHtml;\n}\n\n// Instagram Style Dance System\nlet currentDanceIndex = 0;\nlet totalDances = 0;\nlet completedDances = new Set();\nlet existingSelections = <?= json_encode($existing_selections) ?>;\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    const firstInput = document.querySelector('.place-input');\n    if (firstInput) {\n        firstInput.focus();\n    }\n    \n    // Initialize dance system if in preliminary round (not final)\n    <?php if (!$is_final && $event_no !== '8'): ?>\n    const danceSlider = document.getElementById('danceSlider');\n    if (danceSlider) {\n        initializeDanceSystem();\n    }\n    <?php endif; ?>\n    \n    // Setup fixed action buttons\n    setupFixedButtons();\n});\n\nfunction setupFixedButtons() {\n    // Dashboard button\n    const dashboardBtn = document.getElementById('dashboardBtn');\n    if (dashboardBtn) {\n        dashboardBtn.addEventListener('click', function() {\n            const compId = '<?= h($comp_id) ?>';\n            const lang = '<?= h($lang) ?>';\n            window.location.href = `scoring_dashboard.php?comp_id=${compId}&lang=${lang}`;\n        });\n    }\n    \n    // Refresh button\n    const refreshBtn = document.getElementById('refreshBtn');\n    if (refreshBtn) {\n        refreshBtn.addEventListener('click', function() {\n            if (confirm('í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì‹œê² ìŠµë‹ˆê¹Œ? í˜„ì¬ ì‘ì—… ì¤‘ì¸ ë‚´ìš©ì´ ì €ì¥ë˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.')) {\n                window.location.reload();\n            }\n        });\n    }\n}\n\nfunction loadExistingSelections() {\n    // Load existing selections for all dances\n    Object.keys(existingSelections).forEach(dance => {\n        const dancePage = document.querySelector(`[data-dance=\"${dance}\"]`);\n        if (!dancePage) return;\n        \n        const selectedPlayers = existingSelections[dance];\n        selectedPlayers.forEach(playerNo => {\n            const checkbox = dancePage.querySelector(`input[data-player=\"${playerNo}\"]`);\n            if (checkbox) {\n                checkbox.checked = true;\n                const card = checkbox.closest('.player-card');\n                if (card) {\n                    card.classList.add('selected');\n                }\n            }\n        });\n        \n        // Mark as completed if selections exist\n        if (selectedPlayers.length > 0) {\n            completedDances.add(dance);\n        }\n    });\n}\n\nfunction loadExistingSelectionsForDance(page, dance) {\n    // Load existing selections for a specific dance\n    if (existingSelections[dance]) {\n        const selectedPlayers = existingSelections[dance];\n        selectedPlayers.forEach(playerNo => {\n            const checkbox = page.querySelector(`input[data-player=\"${playerNo}\"]`);\n            if (checkbox) {\n                checkbox.checked = true;\n                const card = checkbox.closest('.player-card');\n                if (card) {\n                    card.classList.add('selected');\n                }\n            }\n        });\n    }\n}\n\nfunction initializeDanceSystem() {\n    const dancePages = document.querySelectorAll('.dance-page');\n    totalDances = dancePages.length;\n    \n    if (totalDances === 0) return;\n    \n    // Load existing selections for all dances\n    loadExistingSelections();\n    \n    // Show first dance page\n    showDancePage(0);\n    \n    // Setup event listeners\n    setupDanceEventListeners();\n    updateProgress();\n    \n    // Initialize top recall status\n    updateTopRecallStatus();\n}\n\nfunction showDancePage(index) {\n    const danceSlider = document.getElementById('danceSlider');\n    const dancePages = document.querySelectorAll('.dance-page');\n    \n    if (index < 0 || index >= totalDances) return;\n    \n    currentDanceIndex = index;\n    danceSlider.style.transform = `translateX(-${index * 100}%)`;\n    \n    // Update progress\n    updateProgress();\n    \n    // Update navigation buttons\n    updateNavigationButtons();\n    \n    // Reset touch events for current page\n    resetTouchEvents();\n    \n    // Restore dance page state if going back to a completed dance\n    const currentPage = document.querySelector('.dance-page[data-dance-index=\"' + currentDanceIndex + '\"]');\n    if (currentPage) {\n        const dance = currentPage.dataset.dance;\n        const isCompleted = completedDances.has(dance);\n        \n        if (isCompleted) {\n            // Restore the page to editable state\n            restoreDancePageState(currentPage, dance);\n        } else {\n            // Load existing selections for this dance if not completed\n            loadExistingSelectionsForDance(currentPage, dance);\n        }\n    }\n    \n    // Update recall status for current page\n    updateTopRecallStatus();\n}\n\nfunction setupDanceEventListeners() {\n    // Navigation buttons\n    document.getElementById('prevDance')?.addEventListener('click', () => {\n        if (currentDanceIndex > 0) {\n            showDancePage(currentDanceIndex - 1);\n        }\n    });\n    \n    document.getElementById('nextDance')?.addEventListener('click', () => {\n        if (currentDanceIndex < totalDances - 1) {\n            showDancePage(currentDanceIndex + 1);\n        }\n    });\n    \n    // Dance submit buttons\n    document.querySelectorAll('.dance-submit-btn').forEach(btn => {\n        btn.addEventListener('click', function() {\n            const dance = this.dataset.dance;\n            submitDance(dance);\n        });\n    });\n    \n    // Touch/swipe events\n    let startX = 0;\n    let startY = 0;\n    let isSwipe = false;\n    \n    const danceSlider = document.getElementById('danceSlider');\n    \n    danceSlider.addEventListener('touchstart', function(e) {\n        startX = e.touches[0].clientX;\n        startY = e.touches[0].clientY;\n        isSwipe = false;\n    });\n    \n    danceSlider.addEventListener('touchmove', function(e) {\n        if (!startX || !startY) return;\n        \n        const currentX = e.touches[0].clientX;\n        const currentY = e.touches[0].clientY;\n        const diffX = startX - currentX;\n        const diffY = startY - currentY;\n        \n        // Determine if this is a horizontal swipe\n        if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 50) {\n            isSwipe = true;\n            e.preventDefault();\n        }\n    });\n    \n    danceSlider.addEventListener('touchend', function(e) {\n        if (!isSwipe || !startX || !startY) return;\n        \n        const endX = e.changedTouches[0].clientX;\n        const diffX = startX - endX;\n        \n        if (Math.abs(diffX) > 100) {\n            if (diffX > 0 && currentDanceIndex < totalDances - 1) {\n                // Swipe left - next dance\n                showDancePage(currentDanceIndex + 1);\n            } else if (diffX < 0 && currentDanceIndex > 0) {\n                // Swipe right - previous dance\n                showDancePage(currentDanceIndex - 1);\n            }\n        }\n        \n        startX = 0;\n        startY = 0;\n        isSwipe = false;\n    });\n}\n\nfunction resetTouchEvents() {\n    // Remove existing event listeners and re-add them\n    const playerCards = document.querySelectorAll('.player-card');\n    playerCards.forEach(card => {\n        // Remove old listeners by cloning the element\n        const newCard = card.cloneNode(true);\n        card.parentNode.replaceChild(newCard, card);\n        \n        // Add new listeners\n        setupPlayerCardEvents(newCard);\n    });\n}\n\nfunction setupPlayerCardEvents(card) {\n    let touchStartTime = 0;\n    let touchStartPos = { x: 0, y: 0 };\n    \n    // Click event\n    card.addEventListener('click', function(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        togglePlayerSelection(this);\n    });\n    \n    // Touch start\n    card.addEventListener('touchstart', function(e) {\n        touchStartTime = Date.now();\n        const touch = e.touches[0];\n        touchStartPos = { x: touch.clientX, y: touch.clientY };\n    });\n    \n    // Touch end\n    card.addEventListener('touchend', function(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        \n        const touchEndTime = Date.now();\n        const touchDuration = touchEndTime - touchStartTime;\n        \n        // Only trigger if it's a quick tap (less than 500ms)\n        if (touchDuration < 500) {\n            togglePlayerSelection(this);\n        }\n    });\n    \n    // Prevent context menu on long press\n    card.addEventListener('contextmenu', function(e) {\n        e.preventDefault();\n    });\n}\n\nfunction updateProgress() {\n    const progressFill = document.querySelector('.progress-fill');\n    const currentDanceSpan = document.querySelector('.current-dance');\n    \n    if (progressFill) {\n        const progress = ((currentDanceIndex + 1) / totalDances) * 100;\n        progressFill.style.width = progress + '%';\n    }\n    \n    if (currentDanceSpan) {\n        currentDanceSpan.textContent = currentDanceIndex + 1;\n    }\n}\n\nfunction restoreDancePageState(page, dance) {\n    // Remove from completed dances to allow re-editing\n    completedDances.delete(dance);\n    \n    // Restore the recall status section\n    const statusDiv = page.querySelector('.recall-status');\n    if (statusDiv) {\n        statusDiv.innerHTML = `\n            <div style=\"font-size:20px; margin-bottom:5px;\">ğŸ“Š Recall ì§„í–‰ ìƒí™©</div>\n            <div style=\"font-size:28px; font-weight:900; color:#2e7d32;\">\n                <span class=\"selected-count\">0</span> / <?= $recall_count ?>ëª…\n            </div>\n            <div style=\"font-size:14px; margin-top:5px; opacity:0.8;\">\n                <?= $recall_count ?>ëª…ì„ ì„ íƒí•˜ë©´ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤\n            </div>\n        `;\n    }\n    \n    // Show submit section (will be hidden/shown based on selection count)\n    const submitSection = page.querySelector('.dance-submit-section');\n    if (submitSection) {\n        submitSection.style.display = 'none';\n    }\n    \n    // Load existing selections for this dance\n    if (existingSelections[dance]) {\n        const selectedPlayers = existingSelections[dance];\n        selectedPlayers.forEach(playerNo => {\n            const checkbox = page.querySelector(`input[data-player=\"${playerNo}\"]`);\n            if (checkbox) {\n                checkbox.checked = true;\n                const card = checkbox.closest('.player-card');\n                if (card) {\n                    card.classList.add('selected');\n                }\n            }\n        });\n    } else {\n        // No existing selections, clear all\n        const checkboxes = page.querySelectorAll('.recall-checkbox');\n        checkboxes.forEach(checkbox => {\n            checkbox.checked = false;\n        });\n        \n        // Update player card states\n        const playerCards = page.querySelectorAll('.player-card');\n        playerCards.forEach(card => {\n            card.classList.remove('selected');\n        });\n    }\n}\n\nfunction updateNavigationButtons() {\n    const prevBtn = document.getElementById('prevDance');\n    const nextBtn = document.getElementById('nextDance');\n    \n    if (prevBtn) {\n        prevBtn.style.display = currentDanceIndex > 0 ? 'inline-block' : 'none';\n    }\n    \n    if (nextBtn) {\n        // Show next button if there are more dances AND current dance is completed\n        const currentDance = document.querySelector('.dance-page[data-dance-index=\"' + currentDanceIndex + '\"]');\n        const isCurrentDanceCompleted = currentDance && completedDances.has(currentDance.dataset.dance);\n        \n        if (currentDanceIndex < totalDances - 1 && isCurrentDanceCompleted) {\n            nextBtn.style.display = 'inline-block';\n            nextBtn.disabled = false;\n            nextBtn.style.opacity = '1';\n            nextBtn.style.cursor = 'pointer';\n        } else {\n            nextBtn.style.display = 'none';\n        }\n    }\n}\n\nfunction submitDance(dance) {\n    const currentPage = document.querySelector(`[data-dance=\"${dance}\"]`);\n    const checkboxes = currentPage.querySelectorAll('.recall-checkbox:checked');\n    const recallCount = <?= json_encode(intval($recall_count)) ?>;\n    \n    if (checkboxes.length !== recallCount) {\n        alert(`${recallCount}ëª…ì„ ì •í™•íˆ ì„ íƒí•´ì£¼ì„¸ìš”.`);\n        return;\n    }\n    \n    // Collect selected players for this dance\n    const selectedPlayers = Array.from(checkboxes).map(cb => cb.dataset.player);\n    \n    // Prepare data for this dance only\n    const recallMarks = {};\n    recallMarks[dance] = selectedPlayers;\n    \n    const data = {\n        comp_id: <?= json_encode($comp_id) ?>,\n        event_no: <?= json_encode($event_no) ?>,\n        type: 'recall',\n        recall_marks: recallMarks\n    };\n    \n    // Show loading state\n    const submitBtn = currentPage.querySelector('.dance-submit-btn');\n    const originalText = submitBtn.textContent;\n    submitBtn.textContent = 'ì „ì†¡ ì¤‘...';\n    submitBtn.disabled = true;\n    \n    fetch('scoring/save_scores.php', {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(data)\n    })\n    .then(response => response.json())\n    .then(result => {\n        if (result.success) {\n            // Mark this dance as completed\n            completedDances.add(dance);\n            \n            // Update existing selections\n            existingSelections[dance] = selectedPlayers;\n            \n            // Hide submit button and show completion message\n            submitBtn.style.display = 'none';\n            const statusDiv = currentPage.querySelector('.recall-status');\n            statusDiv.innerHTML = `\n                <div style=\"font-size:20px; margin-bottom:5px;\">âœ… ì™„ë£Œ</div>\n                <div style=\"font-size:18px; font-weight:bold; color:#4CAF50;\">\n                    ${recallCount}ëª… ì„ íƒ ì™„ë£Œ\n                </div>\n                <div style=\"font-size:14px; margin-top:5px; opacity:0.8;\">\n                    ë‹¤ìŒ ëŒ„ìŠ¤ë¡œ ì§„í–‰í•˜ì„¸ìš”\n                </div>\n            `;\n            \n            // Enable next dance button if available\n            updateNavigationButtons();\n            \n            // Show completion message\n            if (currentDanceIndex < totalDances - 1) {\n                setTimeout(() => {\n                    alert(`${dance} ëŒ„ìŠ¤ ì±„ì ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ëŒ„ìŠ¤ë¡œ ì§„í–‰í•˜ì„¸ìš”.`);\n                }, 1000);\n            } else {\n                // All dances completed\n                setTimeout(() => {\n                    alert('ëª¨ë“  ëŒ„ìŠ¤ ì±„ì ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');\n                }, 1000);\n            }\n        } else {\n            alert('ì „ì†¡ ì‹¤íŒ¨: ' + (result.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));\n            submitBtn.textContent = originalText;\n            submitBtn.disabled = false;\n        }\n    })\n    .catch(error => {\n        console.error('Error:', error);\n        alert('ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error);\n        submitBtn.textContent = originalText;\n        submitBtn.disabled = false;\n    });\n}\n\n// Final Round Dance-by-Dance System\n<?php if ($is_final || $event_no === '8'): ?>\nlet selectedPlayer = null;\nlet playerRankings = {};\nlet draggedSlot = null;\nlet isDragging = false;\nlet dragStartTime = 0;\nlet finalDanceNames = <?= json_encode($event_data['dances']) ?>;\nlet finalCompletedDances = new Set();\nlet savedRankings = <?= json_encode($saved_rankings ?? []) ?>;\nlet currentJudgeId = <?= json_encode($judge_id) ?>;\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    // Initialize dance-by-dance system\n    initializeFinalDanceSystem();\n    setupFinalDanceNavigation();\n    \n    // Initialize touch-based system\n    initializeTouchSystem();\n    \n    // Setup drag and drop for ranking slots\n    setupDragAndDrop();\n});\n\nfunction initializeFinalDanceSystem() {\n    totalDances = finalDanceNames.length;\n    // Populate progress header\n    updateFinalDanceProgress();\n    // Show first dance\n    showFinalDance(0);\n}\n\nfunction updateFinalDanceProgress() {\n    const progressEl = document.getElementById('danceProgress');\n    if (!progressEl) return;\n    progressEl.innerHTML = finalDanceNames.map((dance, idx) => {\n        const isCurrent = idx === currentDanceIndex;\n        const isCompleted = finalCompletedDances.has(dance);\n        const isPending = !isCompleted && !isCurrent;\n        return `<span class=\"dance-step ${isCurrent ? 'current' : (isCompleted ? 'completed' : 'pending')}\">${dance}</span>`;\n    }).join('');\n}\n\nfunction showFinalDance(danceIndex) {\n    if (danceIndex < 0 || danceIndex >= totalDances) return;\n    currentDanceIndex = danceIndex;\n    updateFinalDanceProgress();\n    updateCurrentDanceDisplay();\n    \n    // Clear rankings when switching dances\n    clearFinalScores();\n    \n    // Update navigation after DOM is ready\n    setTimeout(() => {\n        updateFinalDanceNav();\n    }, 50);\n    \n    // Restore saved rankings for current dance (after clearing)\n    setTimeout(() => {\n        restoreSavedRankings();\n    }, 100);\n}\n\nfunction updateCurrentDanceDisplay() {\n    const currentDanceEl = document.getElementById('currentDanceDisplay');\n    if (currentDanceEl && finalDanceNames[currentDanceIndex]) {\n        currentDanceEl.textContent = `í˜„ì¬ ì¢…ëª©: ${finalDanceNames[currentDanceIndex]}`;\n    }\n}\n\nfunction setupFinalDanceNavigation() {\n    // Bind \"Submit Dance\" and \"Next Dance\" buttons\n    const submitBtn = document.getElementById('saveFinalScores');\n    if (submitBtn) {\n        submitBtn.addEventListener('click', submitFinalDance);\n    }\n    const nextBtn = document.getElementById('nextFinalDance');\n    if (nextBtn) {\n        nextBtn.addEventListener('click', () => {\n            if (currentDanceIndex < totalDances - 1) {\n                showFinalDance(currentDanceIndex + 1);\n            }\n        });\n    }\n}\n\nfunction submitFinalDance() {\n    const totalPlayers = document.querySelectorAll('.player-item').length;\n    const assignedPlayers = Object.keys(playerRankings).length;\n    \n    if (assignedPlayers < totalPlayers) {\n        alert(`ëª¨ë“  ì„ ìˆ˜ì—ê²Œ ìˆœìœ„ë¥¼ ë¶€ì—¬í•´ì•¼ í•©ë‹ˆë‹¤. (${assignedPlayers}/${totalPlayers})`);\n        return;\n    }\n    \n    const form = document.getElementById('scoringForm');\n    const formData = new FormData(form);\n    formData.append('is_final', '1');\n    formData.append('dance', finalDanceNames[currentDanceIndex]);\n    \n    Object.keys(playerRankings).forEach(player => {\n        formData.append(`final_ranking[${playerRankings[player]}]`, player);\n    });\n    \n    const submitBtn = document.getElementById('saveFinalScores');\n    const originalText = submitBtn.textContent;\n    submitBtn.textContent = 'ì „ì†¡ ì¤‘...';\n    submitBtn.disabled = true;\n    \n    fetch('scoring/save_scores.php', {\n        method: 'POST',\n        body: formData\n    })\n    .then(response => response.json())\n    .then(result => {\n        if (result.success) {\n            if (result.dance_completed) {\n                // All judges completed this dance\n                finalCompletedDances.add(finalDanceNames[currentDanceIndex]);\n                updateFinalDanceProgress();\n                alert(`${finalDanceNames[currentDanceIndex]} ëŒ„ìŠ¤ ì±„ì ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!`);\n            } else {\n                // Only this judge submitted\n                alert(`${finalDanceNames[currentDanceIndex]} ëŒ„ìŠ¤ ì ìˆ˜ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤`);\n            }\n            \n            if (currentDanceIndex < totalDances - 1) {\n                showFinalDance(currentDanceIndex + 1);\n            } else {\n                updateFinalDanceNav();\n                alert('ëª¨ë“  ì¢…ëª© ìˆœìœ„ ì œì¶œì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');\n            }\n        } else {\n            alert('ì œì¶œ ì‹¤íŒ¨: ' + (result.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));\n            submitBtn.textContent = originalText;\n            submitBtn.disabled = false;\n        }\n    })\n    .catch(error => {\n        console.error('Error:', error);\n        alert('ì œì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error);\n        submitBtn.textContent = originalText;\n        submitBtn.disabled = false;\n    });\n}\n\nfunction updateFinalDanceNav() {\n    const submitBtn = document.getElementById('saveFinalScores');\n    const nextBtn = document.getElementById('nextFinalDance');\n    \n    console.log('updateFinalDanceNav called - currentDanceIndex:', currentDanceIndex, 'totalDances:', totalDances);\n    \n    if (submitBtn) {\n        const buttonText = currentDanceIndex < totalDances - 1 ? `${finalDanceNames[currentDanceIndex]} ìˆœìœ„ ì œì¶œ` : 'ìµœì¢… ì €ì¥';\n        submitBtn.textContent = buttonText;\n        console.log('Button text updated to:', buttonText);\n    }\n    if (nextBtn) {\n        nextBtn.style.display = (currentDanceIndex < totalDances - 1) ? 'inline-block' : 'none';\n    }\n    // Hide clear button\n    const clearBtn = document.getElementById('clearFinalScores');\n    if (clearBtn) clearBtn.style.display = 'none';\n}\n\nfunction initializeTouchSystem() {\n    // Clear any existing rankings when switching dances\n    clearFinalScores();\n    \n    // Bind clear button with confirmation\n    const clearBtn = document.getElementById('clearFinalScores');\n    if (clearBtn) {\n        clearBtn.addEventListener('click', clearFinalScoresWithConfirm);\n    }\n}\n\nfunction setupDragAndDrop() {\n    // Add drag and drop event listeners to all ranking slots\n    document.querySelectorAll('.ranking-slot').forEach(slot => {\n        slot.addEventListener('dragstart', dragStart);\n        slot.addEventListener('dragover', dragOver);\n        slot.addEventListener('drop', drop);\n        slot.addEventListener('dragend', dragEnd);\n        slot.addEventListener('mousedown', handleMouseDown);\n        slot.addEventListener('mouseup', handleMouseUp);\n    });\n}\n\n// Final Round JavaScript - Touch-based System\n\nfunction selectPlayer(element) {\n    // Remove previous selection\n    document.querySelectorAll('.player-item').forEach(item => {\n        item.classList.remove('selected');\n    });\n    \n    // Check if player is already assigned\n    if (element.classList.contains('assigned')) {\n        return;\n    }\n    \n    // Select current player\n    element.classList.add('selected');\n    selectedPlayer = element.dataset.player;\n    \n    console.log('Selected player:', selectedPlayer);\n}\n\nfunction assignRank(element) {\n    // If no player is selected, check if we can cancel an existing assignment\n    if (!selectedPlayer) {\n        if (element.classList.contains('assigned')) {\n            // Cancel existing assignment\n            cancelRank(element);\n        }\n        return;\n    }\n    \n    const rank = element.dataset.rank;\n    \n    // Check if this rank is already assigned\n    if (element.classList.contains('assigned')) {\n        // Remove existing assignment\n        const currentPlayer = element.querySelector('.player-assigned').textContent;\n        if (currentPlayer) {\n            // Remove from player list\n            const playerElement = document.querySelector(`[data-player=\"${currentPlayer}\"]`);\n            if (playerElement) {\n                playerElement.classList.remove('assigned');\n            }\n            // Remove from rankings\n            delete playerRankings[currentPlayer];\n        }\n    }\n    \n    // Assign new player to this rank\n    element.querySelector('.player-assigned').textContent = selectedPlayer;\n    element.querySelector('input').value = selectedPlayer;\n    element.classList.add('assigned');\n    \n    // Mark player as assigned\n    const playerElement = document.querySelector(`[data-player=\"${selectedPlayer}\"]`);\n    if (playerElement) {\n        playerElement.classList.add('assigned');\n    }\n    \n    // Update rankings object\n    playerRankings[selectedPlayer] = rank;\n    \n    // Clear selection\n    selectedPlayer = null;\n    document.querySelectorAll('.player-item').forEach(item => {\n        item.classList.remove('selected');\n    });\n    \n    console.log('Assigned player', selectedPlayer, 'to rank', rank);\n    console.log('Current rankings:', playerRankings);\n}\n\nfunction cancelRank(element) {\n    const currentPlayer = element.querySelector('.player-assigned').textContent;\n    if (currentPlayer) {\n        // Remove from player list\n        const playerElement = document.querySelector(`[data-player=\"${currentPlayer}\"]`);\n        if (playerElement) {\n            playerElement.classList.remove('assigned');\n        }\n        \n        // Clear the ranking slot\n        element.querySelector('.player-assigned').textContent = '';\n        element.querySelector('input').value = '';\n        element.classList.remove('assigned');\n        \n        // Remove from rankings\n        delete playerRankings[currentPlayer];\n        \n        console.log('Cancelled assignment for player', currentPlayer);\n        console.log('Current rankings:', playerRankings);\n    }\n}\n\n// Drag and Drop functions for ranking slots\nfunction dragStart(event) {\n    console.log('dragStart called', event.target);\n    isDragging = true;\n    draggedSlot = event.target;\n    draggedSlot.classList.add('dragging');\n    event.dataTransfer.effectAllowed = 'move';\n    event.dataTransfer.setData('text/html', draggedSlot.outerHTML);\n}\n\nfunction dragOver(event) {\n    event.preventDefault();\n    event.dataTransfer.dropEffect = 'move';\n    \n    // Add visual feedback\n    if (event.target.classList.contains('ranking-slot')) {\n        event.target.classList.add('drag-over');\n        console.log('dragOver on ranking slot');\n    }\n}\n\nfunction drop(event) {\n    event.preventDefault();\n    console.log('drop called', event.target, 'draggedSlot:', draggedSlot);\n    \n    // Remove drag-over class\n    document.querySelectorAll('.ranking-slot').forEach(slot => {\n        slot.classList.remove('drag-over');\n    });\n    \n    if (event.target.classList.contains('ranking-slot') && draggedSlot !== event.target) {\n        console.log('Swapping rankings between slots');\n        // Swap the players between the two slots\n        swapRankings(draggedSlot, event.target);\n    }\n}\n\nfunction dragEnd(event) {\n    // Remove dragging class\n    document.querySelectorAll('.ranking-slot').forEach(slot => {\n        slot.classList.remove('dragging', 'drag-over');\n    });\n    draggedSlot = null;\n    isDragging = false;\n}\n\n// Mouse event handlers for better drag detection\nfunction handleMouseDown(event) {\n    dragStartTime = Date.now();\n    isDragging = false;\n    console.log('Mouse down on ranking slot');\n}\n\nfunction handleMouseUp(event) {\n    const dragDuration = Date.now() - dragStartTime;\n    console.log('Mouse up, drag duration:', dragDuration);\n    \n    if (dragDuration > 200 && isDragging) {\n        // This was a drag operation, not a click\n        event.preventDefault();\n        event.stopPropagation();\n        return false;\n    }\n}\n\n// Double-click to swap with next rank\nfunction swapWithNext(element) {\n    console.log('Double-clicked ranking slot:', element);\n    \n    const currentRank = parseInt(element.dataset.rank);\n    const nextRank = currentRank + 1;\n    const nextElement = document.querySelector(`[data-rank=\"${nextRank}\"]`);\n    \n    if (nextElement && element.classList.contains('assigned') && nextElement.classList.contains('assigned')) {\n        console.log('Swapping ranks', currentRank, 'and', nextRank);\n        swapRankings(element, nextElement);\n    } else {\n        console.log('Cannot swap - one or both slots are empty');\n    }\n}\n\nfunction swapRankings(slot1, slot2) {\n    const player1 = slot1.querySelector('.player-assigned').textContent;\n    const player2 = slot2.querySelector('.player-assigned').textContent;\n    const input1 = slot1.querySelector('input');\n    const input2 = slot2.querySelector('input');\n    \n    // Swap the players\n    slot1.querySelector('.player-assigned').textContent = player2;\n    slot2.querySelector('.player-assigned').textContent = player1;\n    input1.value = player2;\n    input2.value = player1;\n    \n    // Update visual states\n    if (player1) {\n        slot1.classList.add('assigned');\n    } else {\n        slot1.classList.remove('assigned');\n    }\n    \n    if (player2) {\n        slot2.classList.add('assigned');\n    } else {\n        slot2.classList.remove('assigned');\n    }\n    \n    // Update rankings object\n    const rank1 = slot1.dataset.rank;\n    const rank2 = slot2.dataset.rank;\n    \n    if (player1) {\n        playerRankings[player1] = rank2;\n    } else {\n        // Remove from rankings if empty\n        Object.keys(playerRankings).forEach(player => {\n            if (playerRankings[player] === rank1) {\n                delete playerRankings[player];\n            }\n        });\n    }\n    \n    if (player2) {\n        playerRankings[player2] = rank1;\n    } else {\n        // Remove from rankings if empty\n        Object.keys(playerRankings).forEach(player => {\n            if (playerRankings[player] === rank2) {\n                delete playerRankings[player];\n            }\n        });\n    }\n    \n    console.log('Swapped rankings:', playerRankings);\n}\n\nfunction submitFinalDance() {\n    // Check if all players are assigned\n    const totalPlayers = document.querySelectorAll('.player-item').length;\n    const assignedPlayers = Object.keys(playerRankings).length;\n    \n    if (assignedPlayers < totalPlayers) {\n        alert(`ëª¨ë“  ì„ ìˆ˜ì—ê²Œ ìˆœìœ„ë¥¼ ë¶€ì—¬í•´ì•¼ í•©ë‹ˆë‹¤. (${assignedPlayers}/${totalPlayers})`);\n        return;\n    }\n    \n    const form = document.getElementById('scoringForm');\n    const formData = new FormData(form);\n    \n    // Add final round flag\n    formData.append('is_final', '1');\n    \n    // Add current dance\n    const currentDance = finalDanceNames[currentDanceIndex];\n    formData.append('dance', currentDance);\n    \n    // Add rankings data in the format expected by save_scores.php\n    const adjudicator_marks = {};\n    adjudicator_marks[<?= json_encode($judge_id) ?>] = {};\n    \n    Object.keys(playerRankings).forEach(player => {\n        const rank = playerRankings[player];\n        adjudicator_marks[<?= json_encode($judge_id) ?>][player] = rank;\n    });\n    \n    console.log('Sending adjudicator_marks:', adjudicator_marks);\n    formData.append('adjudicator_marks', JSON.stringify(adjudicator_marks));\n    \n    const saveBtn = document.getElementById('saveFinalScores');\n    const originalText = saveBtn.textContent;\n    saveBtn.textContent = 'ì €ì¥ ì¤‘...';\n    saveBtn.disabled = true;\n    \n    fetch('scoring/save_scores.php', {\n        method: 'POST',\n        body: formData\n    })\n    .then(response => response.json())\n    .then(result => {\n        if (result.success) {\n            if (result.dance_completed) {\n                finalCompletedDances.add(currentDance);\n                updateFinalDanceProgress();\n                alert(`${currentDance} ëŒ„ìŠ¤ ì±„ì ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!`);\n            } else {\n                alert(`${currentDance} ëŒ„ìŠ¤ ì ìˆ˜ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤`);\n            }\n            updateFinalDanceNav();\n            \n            if (currentDanceIndex < totalDances - 1) {\n                showFinalDance(currentDanceIndex + 1);\n            } else {\n                alert('ëª¨ë“  ì¢…ëª© ìˆœìœ„ ì œì¶œì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');\n            }\n        } else {\n            alert('ì €ì¥ ì‹¤íŒ¨: ' + (result.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));\n        }\n    })\n    .catch(error => {\n        console.error('Error:', error);\n        alert('ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error);\n    })\n    .finally(() => {\n        saveBtn.textContent = originalText;\n        saveBtn.disabled = false;\n    });\n}\n\nfunction clearFinalScores() {\n    // Clear all assignments (no confirmation for dance switching)\n    document.querySelectorAll('.ranking-slot').forEach(slot => {\n        slot.classList.remove('assigned');\n        slot.querySelector('.player-assigned').textContent = '';\n        slot.querySelector('input').value = '';\n    });\n    \n    document.querySelectorAll('.player-item').forEach(item => {\n        item.classList.remove('assigned');\n    });\n    \n    // Clear selection\n    selectedPlayer = null;\n    playerRankings = {};\n    \n    console.log('Cleared all scores');\n}\n\nfunction clearFinalScoresWithConfirm() {\n    if (confirm('ëª¨ë“  ì ìˆ˜ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {\n        clearFinalScores();\n    }\n}\n\nfunction restoreSavedRankings() {\n    // Get current dance name\n    const currentDance = finalDanceNames[currentDanceIndex];\n    console.log('=== RESTORE SAVED RANKINGS DEBUG ===');\n    console.log('Current judge ID:', currentJudgeId);\n    console.log('Current dance:', currentDance);\n    console.log('Current dance index:', currentDanceIndex);\n    console.log('Available saved rankings:', savedRankings);\n    console.log('Final dance names:', finalDanceNames);\n    \n    if (!currentDance || !savedRankings[currentDance]) {\n        console.log('No saved data for dance:', currentDance);\n        return; // No saved data for this dance\n    }\n    \n    const rankings = savedRankings[currentDance];\n    console.log('Restoring rankings for', currentDance, ':', rankings);\n    \n    // Restore each ranking\n    Object.keys(rankings).forEach(rank => {\n        const player = rankings[rank];\n        const rankElement = document.querySelector(`[data-rank=\"${rank}\"]`);\n        \n        console.log(`Attempting to restore rank ${rank}: player ${player}`);\n        console.log('Rank element found:', rankElement);\n        \n        if (rankElement && player) {\n            // Assign player to this rank\n            rankElement.querySelector('.player-assigned').textContent = player;\n            rankElement.querySelector('input').value = player;\n            rankElement.classList.add('assigned');\n            \n            // Mark player as assigned\n            const playerElement = document.querySelector(`[data-player=\"${player}\"]`);\n            if (playerElement) {\n                playerElement.classList.add('assigned');\n            }\n            \n            // Update rankings object\n            playerRankings[player] = rank;\n            \n            console.log(`Successfully restored rank ${rank}: player ${player}`);\n        } else {\n            console.log(`Failed to restore rank ${rank}: player ${player} - element not found`);\n        }\n    });\n    \n    console.log('Restored rankings:', playerRankings);\n}\n<?php endif; ?>\n    </script>\n    \n    <!-- Bottom Navigation -->\n    <div class=\"bottom-nav\">\n        <button type=\"button\" id=\"dashboardBtn\" class=\"nav-button primary\">\n            <div class=\"nav-icon\">ğŸ </div>\n            <div class=\"nav-text\">ë©”ì¸ìœ¼ë¡œ</div>\n        </button>\n        <button type=\"button\" id=\"refreshBtn\" class=\"nav-button\">\n            <div class=\"nav-icon\">ğŸ”„</div>\n            <div class=\"nav-text\">ìƒˆë¡œê³ ì¹¨</div>\n        </button>\n    </div>\n    \n    <footer style=\"text-align: center; margin-top: 30px; color: #666; font-size: 0.9em; padding: 20px; border-top: 1px solid #eee;\">\n        2025 danceoffice.net | Powered by Seyoung Lee\n    </footer>\n</body>\n</html>","size_bytes":101680},"comp/live_aggregation_api.php":{"content":"<?php\nheader('Content-Type: application/json; charset=utf-8');\nerror_reporting(E_ALL);\nini_set('display_errors', 1);\n\n// ëª…ë ¹í–‰ì—ì„œ ì‹¤í–‰ë˜ëŠ” ê²½ìš°ì™€ ì›¹ì—ì„œ ì‹¤í–‰ë˜ëŠ” ê²½ìš° ëª¨ë‘ ì²˜ë¦¬\nif (php_sapi_name() === 'cli') {\n    // ëª…ë ¹í–‰ì—ì„œ ì‹¤í–‰ë˜ëŠ” ê²½ìš°\n    $comp_id = $argv[1] ?? '';\n    $event_no = $argv[2] ?? '';\n} else {\n    // ì›¹ì—ì„œ ì‹¤í–‰ë˜ëŠ” ê²½ìš°\n    $comp_id = $_GET['comp_id'] ?? '';\n    $event_no = $_GET['event_no'] ?? '';\n}\n\nerror_log(\"=== Live Aggregation API Called ===\");\nerror_log(\"GET parameters: \" . json_encode($_GET ?? []));\nerror_log(\"comp_id: '$comp_id', event_no: '$event_no'\");\n\nif (empty($comp_id) || empty($event_no)) {\n    error_log(\"Missing parameters - comp_id: '$comp_id', event_no: '$event_no'\");\n    echo json_encode(['success' => false, 'error' => 'Missing parameters']);\n    exit;\n}\n\n$data_dir = \"data/{$comp_id}\";\nerror_log(\"data_dir: $data_dir\");\n\n// ì´ë²¤íŠ¸ ì •ë³´ ê°€ì ¸ì˜¤ê¸°\nerror_log(\"Looking for event: $event_no\");\n$event_info = getEventInfo($data_dir, $event_no);\nif (!$event_info) {\n    error_log(\"Event not found: $event_no\");\n    echo json_encode(['success' => false, 'error' => 'Event not found']);\n    exit;\n}\nerror_log(\"Event found: \" . json_encode($event_info));\n\n// ëŒ„ìŠ¤ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°\n$dances = $event_info['dances'];\nif (empty($dances)) {\n    echo json_encode(['success' => false, 'error' => 'No dances found for this event']);\n    exit;\n}\n\n// ì‹¬ì‚¬ìœ„ì› ëª©ë¡ ê°€ì ¸ì˜¤ê¸°\n$judges = getJudgesForEvent($data_dir, $event_no);\nif (empty($judges)) {\n    echo json_encode(['success' => false, 'error' => 'No judges found for this event']);\n    exit;\n}\n\n// ì„ ìˆ˜ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°\n$players = getPlayersForEvent($data_dir, $event_no);\nif (empty($players)) {\n    echo json_encode(['success' => false, 'error' => 'No players found for this event']);\n    exit;\n}\n\n// ì „ì²´ ì„ ìˆ˜ ì •ë³´ ê°€ì ¸ì˜¤ê¸° (ì‹¤ì œ ì„ ìˆ˜ëª…ì„ ìœ„í•´)\n$all_players = [];\n$players_file = \"$data_dir/players.txt\";\nif (file_exists($players_file)) {\n    $lines = file($players_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        $cols = array_map('trim', explode(',', $line));\n        if (count($cols) >= 3) {\n            $all_players[$cols[0]] = [\n                'male' => $cols[1] ?? '',\n                'female' => $cols[2] ?? '',\n            ];\n        }\n    }\n}\n\n// ì§‘ê³„ ë°ì´í„° ìˆ˜ì§‘\n$aggregation_data = collectAggregationData($data_dir, $event_no, $dances, $judges, $players, $all_players);\n\necho json_encode([\n    'success' => true,\n    'event_info' => $event_info,\n    'judges' => $judges,\n    'players' => $players,\n    'all_players' => $all_players,\n    'aggregation' => $aggregation_data\n]);\n\nfunction getEventInfo($data_dir, $event_no) {\n    $runorder_file = \"$data_dir/RunOrder_Tablet.txt\";\n    if (!file_exists($runorder_file)) {\n        return null;\n    }\n    \n    $lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    \n    foreach ($lines as $line) {\n        $cols = explode(',', $line);\n        if (count($cols) >= 13) {\n            $file_event_no = preg_replace('/\\x{FEFF}/u', '', $cols[0] ?? '');\n            $file_event_no = preg_replace('/\\D+/', '', $file_event_no);\n            $detail_no = trim($cols[13] ?? '');\n            \n            $match_event_no = !empty($detail_no) ? $detail_no : $file_event_no;\n            \n            // ë””ë²„ê·¸ ë¡œê·¸ ì¶”ê°€\n            error_log(\"Event matching: file_event_no='$file_event_no', detail_no='$detail_no', match_event_no='$match_event_no', target='$event_no'\");\n            \n            if ($match_event_no === $event_no) {\n                $dances = [];\n                for ($i = 6; $i <= 10; $i++) {\n                    if (!empty($cols[$i]) && $cols[$i] !== '0') {\n                        $dances[] = $cols[$i];\n                    }\n                }\n                \n                return [\n                    'no' => $cols[0],\n                    'detail_no' => $detail_no,\n                    'name' => $cols[1],\n                    'round' => $cols[2],\n                    'dances' => $dances,\n                    'panel' => $cols[11] ?? ''\n                ];\n            }\n        }\n    }\n    \n    return null;\n}\n\nfunction getJudgesForEvent($data_dir, $event_no) {\n    $panel_file = \"$data_dir/panel_list.json\";\n    if (!file_exists($panel_file)) {\n        error_log(\"Panel file not found: $panel_file\");\n        return [];\n    }\n    \n    $panel_data = json_decode(file_get_contents($panel_file), true);\n    if (!$panel_data) {\n        error_log(\"Failed to parse panel file: $panel_file\");\n        return [];\n    }\n    \n    // ì´ë²¤íŠ¸ì˜ íŒ¨ë„ ì½”ë“œ ê°€ì ¸ì˜¤ê¸°\n    $event_info = getEventInfo($data_dir, $event_no);\n    if (!$event_info || !isset($event_info['panel'])) {\n        error_log(\"No panel info for event: $event_no\");\n        return [];\n    }\n    \n    $panel_code = $event_info['panel'];\n    error_log(\"Looking for judges in panel: $panel_code\");\n    \n    // í•´ë‹¹ íŒ¨ë„ì˜ ì‹¬ì‚¬ìœ„ì›ë“¤ ì°¾ê¸°\n    $judges = [];\n    foreach ($panel_data as $item) {\n        if (isset($item['panel_code']) && $item['panel_code'] === $panel_code) {\n            $judges[] = [\n                'code' => $item['adj_code'],\n                'name' => \"Judge {$item['adj_code']}\" // ì‹¤ì œ ì´ë¦„ì´ ì—†ìœ¼ë¯€ë¡œ ì½”ë“œë¡œ ëŒ€ì²´\n            ];\n        }\n    }\n    \n    error_log(\"Found \" . count($judges) . \" judges for panel: $panel_code\");\n    return $judges;\n}\n\nfunction getPlayersForEvent($data_dir, $event_no) {\n    // live_panel.phpì™€ ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ ì„ ìˆ˜ ì •ë³´ ë¡œë“œ\n    $players_file = \"$data_dir/players_{$event_no}.txt\";\n    if (!file_exists($players_file)) {\n        // BOM ë“± ë¹„ì •ìƒ ë¬¸ìê°€ ë¼ì–´ ìƒì„±ëœ íŒŒì¼ì„ íƒìƒ‰í•˜ì—¬ ë³´ì •\n        foreach (glob($data_dir . \"/players_*.txt\") as $alt) {\n            $base = basename($alt);\n            $num = $base;\n            $num = preg_replace('/^players_/u', '', $num);\n            $num = preg_replace('/\\.txt$/u', '', $num);\n            $num = preg_replace('/\\x{FEFF}/u', '', $num); // BOM ì œê±°\n            $num = preg_replace('/\\D+/', '', $num); // ìˆ«ìë§Œ ë‚¨ê¹€\n            \n            if ($num === (string)$event_no) {\n                $players_file = $alt;\n                break;\n            }\n        }\n    }\n    \n    if (!file_exists($players_file)) {\n        error_log(\"Players file not found for event: $event_no\");\n        return [];\n    }\n    \n    $lines = file($players_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    $players = [];\n    \n    foreach ($lines as $line) {\n        $line = trim($line);\n        if (empty($line)) continue;\n        \n        $parts = explode(',', $line);\n        if (count($parts) >= 2) {\n            $players[] = [\n                'number' => trim($parts[0]),\n                'name' => trim($parts[1])\n            ];\n        } else {\n            // ë“±ë²ˆí˜¸ë§Œ ìˆëŠ” ê²½ìš°\n            $player_number = trim($line);\n            if (!empty($player_number)) {\n                $players[] = [\n                    'number' => $player_number,\n                    'name' => \"ì„ ìˆ˜ {$player_number}\"\n                ];\n            }\n        }\n    }\n    \n    error_log(\"Loaded \" . count($players) . \" players for event: $event_no\");\n    return $players;\n}\n\nfunction collectAggregationData($data_dir, $event_no, $dances, $judges, $players, $all_players = []) {\n    $player_scores = [];\n    $judge_status = [];\n    \n    // ê° ì„ ìˆ˜ë³„ ì ìˆ˜ ì´ˆê¸°í™”\n    foreach ($players as $player) {\n        $player_number = $player['number'];\n        $player_name = $player['name'];\n        \n        // ì „ì²´ ì„ ìˆ˜ ì •ë³´ì—ì„œ ì‹¤ì œ ì„ ìˆ˜ëª… ê°€ì ¸ì˜¤ê¸°\n        if (isset($all_players[$player_number])) {\n            $male = $all_players[$player_number]['male'] ?? '';\n            $female = $all_players[$player_number]['female'] ?? '';\n            if ($male && $female) {\n                $player_name = \"{$male} / {$female}\";\n            } elseif ($male) {\n                $player_name = $male;\n            } elseif ($female) {\n                $player_name = $female;\n            }\n        }\n        \n        $player_scores[$player_number] = [\n            'name' => $player_name,\n            'total_recall' => 0,\n            'dance_scores' => []\n        ];\n    }\n    \n    // ê° ì‹¬ì‚¬ìœ„ì›ë³„ ìƒíƒœ ì´ˆê¸°í™”\n    foreach ($judges as $judge) {\n        $judge_status[$judge['code']] = [\n            'name' => $judge['name'],\n            'completed_dances' => 0,\n            'total_dances' => count($dances),\n            'status' => 'waiting'\n        ];\n    }\n    \n    // ê° ëŒ„ìŠ¤ë³„ë¡œ .adj íŒŒì¼ í™•ì¸\n    foreach ($dances as $dance) {\n        foreach ($judges as $judge) {\n            $adj_file = \"$data_dir/{$event_no}_{$dance}_{$judge['code']}.adj\";\n            \n            if (file_exists($adj_file)) {\n                $judge_status[$judge['code']]['completed_dances']++;\n                $judge_status[$judge['code']]['status'] = 'scoring';\n                \n                // .adj íŒŒì¼ì—ì„œ Recall ë°ì´í„° ì½ê¸°\n                $recall_data = file($adj_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n                foreach ($recall_data as $line) {\n                    $player_number = trim($line, '\"');\n                    if (isset($player_scores[$player_number])) {\n                        $player_scores[$player_number]['total_recall']++;\n                        $player_scores[$player_number]['dance_scores'][$dance] = \n                            ($player_scores[$player_number]['dance_scores'][$dance] ?? 0) + 1;\n                    }\n                }\n            }\n        }\n    }\n    \n    // ì‹¬ì‚¬ìœ„ì› ìƒíƒœ ì—…ë°ì´íŠ¸\n    foreach ($judge_status as $code => &$status) {\n        if ($status['completed_dances'] === 0) {\n            $status['status'] = 'waiting';\n        } elseif ($status['completed_dances'] < $status['total_dances']) {\n            $status['status'] = 'scoring';\n        } else {\n            $status['status'] = 'completed';\n        }\n    }\n    \n    // ì„ ìˆ˜ë³„ ì ìˆ˜ë¡œ ì •ë ¬\n    uasort($player_scores, function($a, $b) {\n        return $b['total_recall'] - $a['total_recall'];\n    });\n    \n    return [\n        'player_scores' => $player_scores,\n        'judge_status' => $judge_status,\n        'total_judges' => count($judges),\n        'completed_judges' => count(array_filter($judge_status, function($status) {\n            return $status['status'] === 'completed';\n        })),\n        'progress_rate' => round((count(array_filter($judge_status, function($status) {\n            return $status['status'] === 'completed';\n        })) / count($judges)) * 100, 1)\n    ];\n}\n?>\n","size_bytes":10688},"comp/live_panel.php":{"content":"<?php\n// í…ŒìŠ¤íŠ¸ í˜ì´ì§€ 2: ê³ ê¸‰ ë©€í‹° ì´ë²¤íŠ¸ íƒ­ êµ¬ì¡° (ì‹¤ì œ ë°ì´í„° ì—°ë™)\n$comp_id = $_GET['comp_id'] ?? '20250913-001';\n$data_dir = __DIR__ . \"/data/$comp_id\";\n\n// ì§‘ê³„ ê²°ê³¼ í‘œì‹œ ëª¨ë“œ í™•ì¸\n$view_mode = $_GET['view'] ?? '';\n$view_event_no = $_GET['event_no'] ?? '';\n$aggregation_result = null;\n\n// ì§‘ê³„ ê²°ê³¼ í‘œì‹œ ëª¨ë“œì¸ ê²½ìš°\nif ($view_mode === 'aggregation' && $view_event_no) {\n    // ì§ì ‘ API íŒŒì¼ì„ includeí•˜ì—¬ ì‹¤í–‰\n    $aggregation_result = null;\n    \n    try {\n        // GET ë§¤ê°œë³€ìˆ˜ ì„¤ì •\n        $_GET['comp_id'] = $comp_id;\n        $_GET['event_no'] = $view_event_no;\n        \n        // API íŒŒì¼ ì§ì ‘ ì‹¤í–‰í•˜ì—¬ ê²°ê³¼ ìº¡ì²˜\n        ob_start();\n        include 'final_aggregation_api.php';\n        $aggregation_data = ob_get_clean();\n        \n        error_log(\"ì§‘ê³„ ë°ì´í„° ê¸¸ì´: \" . strlen($aggregation_data));\n        error_log(\"ì§‘ê³„ ë°ì´í„°: \" . substr($aggregation_data, 0, 500));\n        \n        if ($aggregation_data) {\n            $aggregation_result = json_decode($aggregation_data, true);\n            if (json_last_error() !== JSON_ERROR_NONE) {\n                error_log(\"JSON íŒŒì‹± ì˜¤ë¥˜: \" . json_last_error_msg());\n                error_log(\"ì›ë³¸ ë°ì´í„°: \" . substr($aggregation_data, 0, 500));\n                $aggregation_result = null;\n            } else {\n                error_log(\"ì§‘ê³„ ê²°ê³¼ íŒŒì‹± ì„±ê³µ: \" . json_encode($aggregation_result));\n            }\n        } else {\n            error_log(\"ì§‘ê³„ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨\");\n        }\n        \n        // ë””ë²„ê¹…: ì§‘ê³„ ê²°ê³¼ ìƒíƒœ í™•ì¸\n        error_log(\"ì§‘ê³„ ê²°ê³¼ ìµœì¢… ìƒíƒœ: \" . ($aggregation_result ? \"ì„±ê³µ\" : \"ì‹¤íŒ¨\"));\n        if ($aggregation_result) {\n            error_log(\"ì§‘ê³„ ê²°ê³¼ í‚¤: \" . implode(', ', array_keys($aggregation_result)));\n        }\n    } catch (Exception $e) {\n        error_log(\"ì§‘ê³„ API ì‹¤í–‰ ì˜¤ë¥˜: \" . $e->getMessage());\n        $aggregation_result = null;\n    }\n}\n\n// --- ëŒ„ìŠ¤ì¢…ëª© ì•½ì–´->ì´ë¦„ ë§¤í•‘ (DanceName.txt ê¸°ì¤€) ---\n$dancename_file = \"$data_dir/DanceName.txt\";\n$dance_map_en = [];\nif (is_file($dancename_file)) {\n    foreach (file($dancename_file) as $line) {\n        $cols = array_map('trim', explode(',', $line));\n        if (count($cols) < 3 || $cols[2] == '-' || $cols[2] == '') continue;\n        // ì˜ë¬¸ ì½”ë“œë¥¼ í‚¤ë¡œ ì‚¬ìš©\n        $dance_map_en[$cols[2]] = $cols[1];\n        // ìˆ«ì ì½”ë“œë„ í‚¤ë¡œ ì‚¬ìš© (28ë²ˆ ì´ë²¤íŠ¸ ë“±ì—ì„œ ì‚¬ìš©)\n        $dance_map_en[$cols[0]] = $cols[1];\n    }\n}\n\n// --- ì „ì²´ ì„ ìˆ˜ëª…ë‹¨ players.txt (ë“±ë²ˆí˜¸,ë‚¨ì,ì—¬ì) ---\n$players_file = \"$data_dir/players.txt\";\n$all_players = [];\nif (file_exists($players_file)) {\n    $lines = file($players_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        $cols = array_map('trim', explode(',', $line));\n        $all_players[$cols[0]] = [\n            'male' => $cols[1] ?? '',\n            'female' => $cols[2] ?? '',\n        ];\n    }\n}\n\n// ì‹¤ì œ ì´ë²¤íŠ¸ ë°ì´í„° ë¡œë“œ (live_panel.phpì™€ ë™ì¼í•œ ë¡œì§)\n$runorder_file = \"$data_dir/RunOrder_Tablet.txt\";\n$events = [];\n$event_groups = [];\n\nif (file_exists($runorder_file)) {\n    $lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        if (preg_match('/^bom/', $line)) continue;\n        $cols = array_map('trim', explode(',', $line));\n        // ì´ë²¤íŠ¸ ë²ˆí˜¸ ì •ê·œí™”: BOM ë° ìˆ«ì ì´ì™¸ ë¬¸ì ì œê±°\n        $no = $cols[0] ?? '';\n        $no = preg_replace('/\\x{FEFF}/u', '', $no); // UTF-8 BOM ì œê±°\n        $no = preg_replace('/\\D+/', '', $no);       // ìˆ«ìë§Œ ë‚¨ê¹€\n        $no = trim($no);\n        $desc = $cols[1] ?? '';\n        $roundtype = $cols[2] ?? '';\n        $panel = isset($cols[11]) ? strtoupper($cols[11]) : '';\n        $recall = $cols[4] ?? '';\n        $heats = $cols[14] ?? ''; // íˆíŠ¸ëŠ” 15ë²ˆì§¸ ì»¬ëŸ¼ (ì¸ë±ìŠ¤ 14)\n        $dance_codes = [];\n        // 6-10ë²ˆì§¸ ì»¬ëŸ¼ì˜ ìˆ«ìë¥¼ ëŒ„ìŠ¤ ì½”ë“œë¡œ ì‚¬ìš© (ì •í™•í•œ ë°ì´í„°)\n        for ($i=6; $i<=10; $i++) {\n            if (isset($cols[$i]) && is_numeric($cols[$i]) && $cols[$i] > 0) {\n                $dance_codes[] = $cols[$i];\n            }\n        }\n        // ëŒ„ìŠ¤ ì½”ë“œë¥¼ ì‹¤ì œ ëŒ„ìŠ¤ëª…ìœ¼ë¡œ ë³€í™˜\n        $dance_names = [];\n        foreach ($dance_codes as $code) {\n            $dance_names[] = $dance_map_en[$code] ?? $code; // ë§¤í•‘ëœ ì´ë¦„ ë˜ëŠ” ì½”ë“œ\n        }\n        \n        $events[] = [\n            'no' => $no,\n            'desc' => $desc,\n            'round' => $roundtype,\n            'panel' => $panel,\n            'recall' => $recall,\n            'heats' => $heats,\n            'dances' => $dance_codes,\n            'dance_names' => $dance_names,\n            'detail_no' => $cols[13] ?? '' // 14ë²ˆì§¸ ì»¬ëŸ¼ì—ì„œ detail_no ì½ê¸°\n        ];\n    }\n}\n\n// ì‹¤ì œ ì‹¬ì‚¬ìœ„ì› ë°ì´í„° ë¡œë“œ (live_panel.phpì™€ ë™ì¼í•œ ë¡œì§)\n$adjudicator_file = \"$data_dir/adjudicators.txt\";\n$adjudicator_dict = [];\nif (file_exists($adjudicator_file)) {\n    $lines = file($adjudicator_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        $cols = array_map('trim', explode(',', $line));\n        if (count($cols) < 2) continue;\n        $code = (string)$cols[0];\n        $adjudicator_dict[$code] = [\n            'code' => $cols[0],\n            'name' => $cols[1],\n            'nation' => $cols[2] ?? '',\n            'id' => $cols[3] ?? ''\n        ];\n    }\n}\n\n// íŒ¨ë„ ë§¤í•‘ ë°ì´í„° ë¡œë“œ\n$panel_map_file = \"$data_dir/panel_list.json\";\n$panel_map = [];\nif (file_exists($panel_map_file)) {\n    $panel_map = json_decode(file_get_contents($panel_map_file), true);\n}\n\n// ì‹¤ì œ ì„ ìˆ˜ ë°ì´í„° ë¡œë“œ (live_panel.phpì™€ ë™ì¼í•œ ë¡œì§)\n$players_by_event = [];\nforeach ($events as $ev) {\n    $eno = $ev['no'];\n    $detail_no = $ev['detail_no'] ?? '';\n    \n    // ì„¸ë¶€ë²ˆí˜¸ê°€ ìˆìœ¼ë©´ ì„¸ë¶€ë²ˆí˜¸ë¡œ, ì—†ìœ¼ë©´ ì´ë²¤íŠ¸ ë²ˆí˜¸ë¡œ\n    $file_key = !empty($detail_no) ? $detail_no : $eno;\n    $pfile = \"$data_dir/players_$file_key.txt\";\n    \n    if (file_exists($pfile)) {\n        $lines = file($pfile, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n        $player_data = [];\n        foreach ($lines as $line) {\n            $line = trim($line);\n            if (!empty($line)) {\n                // ë“±ë²ˆê³¼ ì´ë¦„ ë¶„ë¦¬ (ê³µë°±ìœ¼ë¡œ êµ¬ë¶„)\n                $parts = explode(' ', $line, 2);\n                $number = trim($parts[0]);\n                $name = isset($parts[1]) ? trim($parts[1]) : '';\n                \n                // ë“±ë²ˆ ì •ê·œí™” (ìˆ«ìì™€ í•˜ì´í”ˆë§Œ ë‚¨ê¹€)\n            if (!empty($detail_no)) {\n                    $num = preg_replace('/[^0-9\\-]/', '', $number);\n            } else {\n                    $num = preg_replace('/[^0-9]/', '', $number);\n                }\n                \n                if (!empty($num)) {\n                    $arr = [\n                        'number' => $num,\n                        'name' => $name,\n                        'display_name' => $name ? \"$num $name\" : $num,\n                        'type' => 'couple' // ê¸°ë³¸ê°’, ì‹¤ì œë¡œëŠ” ë°ì´í„°ì—ì„œ íŒë‹¨\n                    ];\n                    $player_data[] = $arr;\n                }\n            }\n        }\n        $players_by_event[$eno] = $player_data;\n        // ì„¸ë¶€ë²ˆí˜¸ê°€ ìˆìœ¼ë©´ ì„¸ë¶€ë²ˆí˜¸ í‚¤ë¡œë„ ì €ì¥\n        if (!empty($detail_no)) {\n            $players_by_event[$detail_no] = $player_data;\n        }\n    }\n}\n\n// ì´ë²¤íŠ¸ ê·¸ë£¹ ìƒì„± (ì‹¤ì œ ë°ì´í„° ê¸°ë°˜)\n$event_groups = [];\n$grouped_events = [];\n\n// ì´ë²¤íŠ¸ë¥¼ ê·¸ë£¹í™” (detail_noê°€ ìˆëŠ” ê²½ìš° ë©€í‹° ì´ë²¤íŠ¸ë¡œ ì²˜ë¦¬)\nforeach ($events as $event) {\n    $group_key = $event['detail_no'] ? $event['no'] : $event['no'];\n    \n    if (!isset($grouped_events[$group_key])) {\n        $grouped_events[$group_key] = [\n            'group_no' => $group_key,\n            'group_name' => $event['desc'],\n            'events' => [],\n            'is_multi' => false\n        ];\n    }\n    \n    $grouped_events[$group_key]['events'][] = $event;\n}\n\n// ë©€í‹° ì´ë²¤íŠ¸ í™•ì¸\nforeach ($grouped_events as $group_key => $group) {\n    if (count($group['events']) > 1) {\n        $grouped_events[$group_key]['is_multi'] = true;\n    }\n}\n\n$event_groups = array_values($grouped_events);\n\n// ì´ë²¤íŠ¸ë³„ ì„ ìˆ˜ ë°ì´í„° ë¡œë“œ í•¨ìˆ˜\nfunction getPlayersForEvent($data_dir, $event_key, $all_players) {\n    $players = [];\n    \n    // ì´ë²¤íŠ¸ë³„ ì„ ìˆ˜ íŒŒì¼ í™•ì¸\n    $players_file = \"$data_dir/players_{$event_key}.txt\";\n    if (file_exists($players_file)) {\n        $lines = file($players_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n        foreach ($lines as $line) {\n            $line = trim($line);\n            if (!empty($line)) {\n                $player_data = $all_players[$line] ?? null;\n                if ($player_data) {\n                    // ì‹±ê¸€/ì»¤í”Œ êµ¬ë¶„: ì—¬ì ì´ë¦„ì´ ìˆìœ¼ë©´ ì»¤í”Œ, ì—†ìœ¼ë©´ ì‹±ê¸€\n                    $isCouple = !empty($player_data['female']);\n                    $players[] = [\n                        'number' => $line,\n                        'name' => $player_data['male'] . ($player_data['female'] ? ' & ' . $player_data['female'] : ''),\n                        'male' => $player_data['male'],\n                        'female' => $player_data['female'],\n                        'type' => $isCouple ? 'couple' : 'single'\n                    ];\n                } else {\n                    $players[] = [\n                        'number' => $line,\n                        'name' => \"ì„ ìˆ˜ {$line}\",\n                        'male' => '',\n                        'female' => '',\n                        'type' => 'single' // ê¸°ë³¸ê°’ì€ ì‹±ê¸€\n                    ];\n                }\n            }\n        }\n    }\n    \n    return $players;\n}\n\n// ì´ë²¤íŠ¸ë³„ ì‹¬ì‚¬ìœ„ì› ìƒíƒœ í™•ì¸ í•¨ìˆ˜\nfunction getJudgeStatus($data_dir, $event_key, $dances, $panel_map, $adjudicator_dict) {\n    global $events;\n    $judge_status = [];\n    \n    // í•´ë‹¹ ì´ë²¤íŠ¸ì˜ íŒ¨ë„ ì½”ë“œ ì°¾ê¸° (ì‹¤ì œ ì´ë²¤íŠ¸ ë°ì´í„°ì—ì„œ)\n    $panel_code = '';\n    foreach ($events as $event) {\n        $event_key_check = $event['detail_no'] ?: $event['no'];\n        if ($event_key_check === $event_key) {\n            $panel_code = $event['panel'];\n            break;\n        }\n    }\n    \n    if (empty($panel_code)) {\n        return $judge_status;\n    }\n    \n    // íŒ¨ë„ì— ì†í•œ ì‹¬ì‚¬ìœ„ì›ë“¤ ì°¾ê¸°\n    $panel_judges = [];\n    foreach ($panel_map as $mapping) {\n        if (isset($mapping['panel_code']) && $mapping['panel_code'] === $panel_code) {\n            $judge_code = $mapping['adj_code'];\n            if (isset($adjudicator_dict[$judge_code])) {\n                $panel_judges[] = $judge_code;\n            }\n        }\n    }\n    \n    // ê° ì‹¬ì‚¬ìœ„ì›ì˜ ì±„ì  ìƒíƒœ í™•ì¸\n    foreach ($panel_judges as $judge_code) {\n        $judge_info = $adjudicator_dict[$judge_code];\n        $completed = 0;\n        $total = count($dances);\n        \n        // .adj íŒŒì¼ì—ì„œ ì‹¤ì œ ì±„ì  ìƒíƒœ í™•ì¸\n        $adj_file = \"$data_dir/{$event_key}.adj\";\n        if (file_exists($adj_file)) {\n            $adj_data = file($adj_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n            foreach ($adj_data as $line) {\n                if (strpos($line, $judge_code) === 0) {\n                    $completed++;\n                }\n            }\n        }\n        \n        $status = $completed === $total ? 'completed' : ($completed > 0 ? 'partial' : 'waiting');\n        \n        $judge_status[] = [\n            'code' => $judge_code,\n            'name' => $judge_info['name'],\n            'country' => $judge_info['nation'],\n            'status' => $status,\n            'completed' => $completed,\n            'total' => $total\n        ];\n    }\n    \n    return $judge_status;\n}\n\n// ì´ë²¤íŠ¸ ê·¸ë£¹ì— ì‹¬ì‚¬ìœ„ì›/ì„ ìˆ˜ ë°ì´í„° ì¶”ê°€\nforeach ($event_groups as &$group) {\n    foreach ($group['events'] as &$event) {\n        $event_key = $event['detail_no'] ?: $event['no'];\n        $event['judges'] = getJudgeStatus($data_dir, $event_key, $event['dances'], $panel_map, $adjudicator_dict);\n        $event['players'] = getPlayersForEvent($data_dir, $event_key, $all_players);\n    }\n    \n    // ë©€í‹° ì´ë²¤íŠ¸ì¸ ê²½ìš° ëŒ„ìŠ¤ ìˆœì„œ ìƒì„±\n    if (count($group['events']) > 1) {\n        $group['dance_sequence'] = generateDanceSequence($group['events']);\n    }\n}\n\n// ì¹´í…Œê³ ë¦¬ ì¶”ì¶œ í•¨ìˆ˜\nfunction extractCategory($desc) {\n    // ì´ë²¤íŠ¸ ì„¤ëª…ì—ì„œ ì¹´í…Œê³ ë¦¬ ì¶”ì¶œ (ì˜ˆ: \"1-1 íƒ±ê³ \" -> \"1-1\")\n    if (preg_match('/^(\\d+-\\d+)/', $desc, $matches)) {\n        return $matches[1];\n    }\n    return $desc;\n}\n\n// ë©€í‹°ì´ë²¤íŠ¸ì˜ ëŒ„ìŠ¤ ìˆœì„œ ì·¨í•© í•¨ìˆ˜\nfunction generateDanceSequence($events) {\n    global $dance_map_en;\n    $all_dances = [];\n    $dance_events = [];\n    \n    // ëª¨ë“  ì´ë²¤íŠ¸ì˜ ëŒ„ìŠ¤ ìˆ˜ì§‘\n    foreach ($events as $event) {\n        if (!empty($event['dances'])) {\n            foreach ($event['dances'] as $dance) {\n                if (!isset($all_dances[$dance])) {\n                    $all_dances[$dance] = [];\n                }\n                $all_dances[$dance][] = $event['detail_no'] ?: $event['no'];\n            }\n        }\n    }\n    \n    // ê³µë™ ëŒ„ìŠ¤ì™€ ê°œë³„ ëŒ„ìŠ¤ ë¶„ë¥˜\n    $common_dances = [];\n    $individual_dances = [];\n    \n    foreach ($all_dances as $dance => $event_list) {\n        $dance_name = $dance_map_en[$dance] ?? $dance;\n        if (count($event_list) > 1) {\n            // ì—¬ëŸ¬ ì´ë²¤íŠ¸ì—ì„œ ê³µí†µìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ëŒ„ìŠ¤\n            $common_dances[] = [\n                'dance' => $dance,\n                'dance_name' => $dance_name,\n                'events' => $event_list,\n                'type' => 'common'\n            ];\n        } else {\n            // ê°œë³„ ì´ë²¤íŠ¸ì—ì„œë§Œ ì‚¬ìš©ë˜ëŠ” ëŒ„ìŠ¤\n            $individual_dances[] = [\n                'dance' => $dance,\n                'dance_name' => $dance_name,\n                'events' => $event_list,\n                'type' => 'individual'\n            ];\n        }\n    }\n    \n    // ê³µë™ ëŒ„ìŠ¤ë¥¼ ë¨¼ì €, ê°œë³„ ëŒ„ìŠ¤ë¥¼ ë‚˜ì¤‘ì— ë°°ì¹˜\n    $sequence = array_merge($common_dances, $individual_dances);\n    \n    return $sequence;\n}\n\n// ê° ê·¸ë£¹ì˜ ëŒ„ìŠ¤ ìˆœì„œ ìƒì„±\nforeach ($event_groups as $group_key => &$group) {\n    if (count($group['events']) > 1) {\n        $group['dance_sequence'] = generateDanceSequence($group['events']);\n    } else {\n        // ì‹±ê¸€ ì´ë²¤íŠ¸ëŠ” ê¸°ì¡´ ëŒ„ìŠ¤ ìˆœì„œ ìœ ì§€\n        $group['dance_sequence'] = [];\n        if (!empty($group['events'][0]['dances'])) {\n            foreach ($group['events'][0]['dances'] as $dance) {\n                $dance_name = $dance_map_en[$dance] ?? $dance;\n                $group['dance_sequence'][] = [\n                    'dance' => $dance,\n                    'dance_name' => $dance_name,\n                    'events' => [$group['events'][0]['detail_no'] ?: $group['events'][0]['no']],\n                    'type' => 'single'\n                ];\n            }\n        }\n    }\n}\n\nfunction h($s) { return htmlspecialchars($s ?? ''); }\n?>\n\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>ë¼ì´ë¸Œ íŒ¨ë„ - ë©€í‹° ì´ë²¤íŠ¸ ê´€ë¦¬</title>\n    <style>\n        body {\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n            margin: 0;\n            padding: 20px;\n            background-color: #f5f5f5;\n        }\n        \n        .container {\n            display: flex;\n            gap: 20px;\n            max-width: 1600px;\n            margin: 0 auto;\n        }\n        \n        .left-panel {\n            width: 350px;\n            background: white;\n            border-radius: 8px;\n            box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n            overflow: hidden;\n        }\n        \n        .right-panel {\n            flex: 1;\n            background: white;\n            border-radius: 8px;\n            box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n            overflow: hidden;\n        }\n        \n        .panel-header {\n            background: #2c3e50;\n            color: white;\n            padding: 15px;\n            font-weight: bold;\n            font-size: 16px;\n        }\n        \n        .event-group {\n            border-bottom: 1px solid #eee;\n        }\n        \n        .event-group:last-child {\n            border-bottom: none;\n        }\n        \n        .group-header {\n            background: #34495e;\n            color: white;\n            padding: 12px 15px;\n            font-weight: bold;\n            cursor: pointer;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            transition: background-color 0.2s;\n        }\n        \n        .group-header:hover {\n            background: #2c3e50;\n        }\n        \n        .group-header.selected {\n            background: #e74c3c;\n        }\n        \n        .group-info {\n            display: flex;\n            flex-direction: column;\n            gap: 2px;\n        }\n        \n        .group-title {\n            font-size: 14px;\n        }\n        \n        .group-subtitle {\n            font-size: 11px;\n            opacity: 0.8;\n        }\n        \n        .group-toggle {\n            font-size: 14px;\n            transition: transform 0.3s;\n        }\n        \n        .group-toggle.expanded {\n            transform: rotate(90deg);\n        }\n        \n        .event-list {\n            display: none;\n            background: #f8f9fa;\n        }\n        \n        .event-list.expanded {\n            display: block;\n        }\n        \n        .event-item {\n            padding: 12px 15px;\n            border-bottom: 1px solid #e9ecef;\n            cursor: pointer;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            transition: all 0.2s;\n        }\n        \n        .event-item:hover {\n            background: #e3f2fd;\n        }\n        \n        .event-item.selected {\n            background: #bbdefb;\n            border-left: 4px solid #2196f3;\n        }\n        \n        .event-item:last-child {\n            border-bottom: none;\n        }\n        \n        .event-info {\n            flex: 1;\n        }\n        \n        .event-number {\n            font-weight: bold;\n            color: #2c3e50;\n            margin-bottom: 3px;\n            font-size: 14px;\n        }\n        \n        .event-desc {\n            font-size: 11px;\n            color: #666;\n            line-height: 1.3;\n            margin-bottom: 2px;\n        }\n        \n        .event-dances {\n            font-size: 10px;\n            color: #888;\n            font-style: italic;\n        }\n        \n        .event-status {\n            font-size: 10px;\n            padding: 3px 8px;\n            border-radius: 12px;\n            font-weight: bold;\n            text-align: center;\n            min-width: 50px;\n        }\n        \n        .status-final {\n            background: #d4edda;\n            color: #155724;\n        }\n        \n        .status-semi {\n            background: #fff3cd;\n            color: #856404;\n        }\n        \n        .status-prelim {\n            background: #f8d7da;\n            color: #721c24;\n        }\n        \n        .right-header {\n            background: #34495e;\n            color: white;\n            padding: 15px 20px;\n        }\n        \n        .right-title {\n            font-size: 20px;\n            font-weight: bold;\n            margin-bottom: 10px;\n        }\n        \n        .event-info-row {\n            display: grid;\n            grid-template-columns: 80px 80px 80px 1fr;\n            gap: 20px;\n            align-items: center;\n            font-size: 12px;\n        }\n        \n        .info-item {\n            display: flex;\n            flex-direction: column;\n            gap: 2px;\n        }\n        \n        .info-label {\n            font-weight: bold;\n            color: #bdc3c7;\n            font-size: 10px;\n            text-transform: uppercase;\n            letter-spacing: 0.5px;\n        }\n        \n        .info-value {\n            color: white;\n            font-size: 12px;\n        }\n        \n        .dance-sequence-value {\n            color: #3498db;\n            font-weight: 500;\n            cursor: pointer;\n            display: flex;\n            align-items: center;\n            gap: 4px;\n        }\n        \n        .dance-sequence-value:hover {\n            text-decoration: underline;\n        }\n        \n        .dance-edit-icon {\n            font-size: 10px;\n            opacity: 0.7;\n        }\n        \n        .right-subtitle {\n            font-size: 12px;\n            opacity: 0.8;\n        }\n        \n        .group-info-header {\n            background: #f8f9fa;\n            padding: 15px 20px;\n            border-bottom: 1px solid #dee2e6;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n        \n        .group-title {\n            font-size: 16px;\n            font-weight: bold;\n            color: #2c3e50;\n            display: flex;\n            align-items: center;\n            gap: 8px;\n            flex-wrap: wrap;\n        }\n        \n        .group-subtitle {\n            font-size: 12px;\n            color: #666;\n            line-height: 1.4;\n        }\n        \n        .event-details {\n            display: flex;\n            gap: 4px;\n            flex-wrap: wrap;\n            font-size: 10px;\n            color: #666;\n        }\n        \n        .event-detail-item {\n            background: #e9ecef;\n            padding: 2px 6px;\n            border-radius: 10px;\n            white-space: nowrap;\n        }\n        \n        .dance-sequence {\n            color: #2196f3;\n            font-weight: 500;\n        }\n        \n        .dance-sequence-editable {\n            cursor: pointer;\n            padding: 4px 8px;\n            border-radius: 4px;\n            transition: background-color 0.2s;\n        }\n        \n        .dance-sequence-editable:hover {\n            background: rgba(33, 150, 243, 0.1);\n        }\n        \n        .dance-edit-icon {\n            margin-left: 5px;\n            font-size: 10px;\n            opacity: 0.7;\n        }\n        \n        .dance-edit-modal {\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background: rgba(0,0,0,0.5);\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            z-index: 1000;\n        }\n        \n        .dance-edit-content {\n            background: white;\n            padding: 20px;\n            border-radius: 8px;\n            width: 80%;\n            max-width: 600px;\n            max-height: 80vh;\n            overflow-y: auto;\n        }\n        \n        .dance-edit-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 20px;\n            padding-bottom: 10px;\n            border-bottom: 1px solid #dee2e6;\n        }\n        \n        .dance-edit-title {\n            font-size: 18px;\n            font-weight: bold;\n            color: #2c3e50;\n        }\n        \n        .dance-edit-close {\n            background: none;\n            border: none;\n            font-size: 24px;\n            cursor: pointer;\n            color: #666;\n        }\n        \n        .dance-list-container {\n            margin-bottom: 20px;\n        }\n        \n        .dance-item {\n            display: flex;\n            align-items: center;\n            gap: 10px;\n            padding: 10px;\n            border: 1px solid #dee2e6;\n            border-radius: 6px;\n            margin-bottom: 8px;\n            background: #f8f9fa;\n        }\n        \n        .dance-item.dragging {\n            opacity: 0.5;\n        }\n        \n        .dance-drag-handle {\n            cursor: move;\n            color: #666;\n            font-size: 16px;\n        }\n        \n        .dance-number {\n            background: #2196f3;\n            color: white;\n            width: 24px;\n            height: 24px;\n            border-radius: 50%;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            font-size: 12px;\n            font-weight: bold;\n        }\n        \n        .dance-info {\n            flex: 1;\n        }\n        \n        .dance-name {\n            font-weight: 500;\n            color: #2c3e50;\n        }\n        \n        .dance-events {\n            font-size: 12px;\n            color: #666;\n        }\n        \n        .dance-actions {\n            display: flex;\n            gap: 5px;\n        }\n        \n        .dance-action-btn {\n            width: 24px;\n            height: 24px;\n            border: none;\n            border-radius: 4px;\n            cursor: pointer;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            font-size: 12px;\n        }\n        \n        .dance-remove-btn {\n            background: #dc3545;\n            color: white;\n        }\n        \n        .dance-remove-btn:hover {\n            background: #c82333;\n        }\n        \n        .dance-edit-buttons {\n            display: flex;\n            gap: 10px;\n            justify-content: flex-end;\n        }\n        \n        .btn-save {\n            background: #28a745;\n            color: white;\n            border: none;\n            padding: 8px 16px;\n            border-radius: 4px;\n            cursor: pointer;\n        }\n        \n        .btn-cancel {\n            background: #6c757d;\n            color: white;\n            border: none;\n            padding: 8px 16px;\n            border-radius: 4px;\n            cursor: pointer;\n        }\n        \n        .event-cards-container {\n            padding: 20px;\n            min-height: 400px;\n        }\n        \n        .event-cards-grid {\n            display: grid;\n            grid-template-columns: repeat(2, 1fr);\n            gap: 20px;\n            margin-bottom: 20px;\n        }\n        \n        .event-card {\n            background: white;\n            border: 1px solid #dee2e6;\n            border-radius: 8px;\n            padding: 0;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n            transition: all 0.3s;\n            cursor: pointer;\n            overflow: hidden;\n        }\n        \n        .event-card:hover {\n            box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n            transform: translateY(-2px);\n        }\n        \n        .event-card.selected {\n            border-color: #2196f3;\n            box-shadow: 0 4px 12px rgba(33, 150, 243, 0.2);\n            transform: translateY(-2px);\n        }\n        \n        \n        .event-card-body {\n            display: flex;\n            min-height: 400px;\n            padding-top: 15px;\n        }\n        \n        .event-card-left {\n            flex: 1;\n            padding: 15px;\n            border-right: 1px solid #dee2e6;\n            background: #fafbfc;\n        }\n        \n        .event-card-right {\n            flex: 1;\n            padding: 15px;\n            background: white;\n        }\n        \n        .event-card-title {\n            font-size: 14px;\n            font-weight: 500;\n            color: #2c3e50;\n            margin-bottom: 12px;\n            line-height: 1.4;\n        }\n        \n        .event-card-details {\n            margin-bottom: 15px;\n        }\n        \n        .event-card-detail-row {\n            display: flex;\n            justify-content: space-between;\n            margin-bottom: 5px;\n            font-size: 12px;\n        }\n        \n        .event-card-detail-label {\n            color: #666;\n            font-weight: 500;\n        }\n        \n        .event-card-detail-value {\n            color: #2c3e50;\n        }\n        \n        .event-card-dances {\n            background: #f8f9fa;\n            padding: 8px 12px;\n            border-radius: 6px;\n            font-size: 11px;\n            color: #666;\n            margin-bottom: 15px;\n        }\n        \n        .event-card-judges {\n            height: 100%;\n        }\n        \n        .judges-header {\n            margin-bottom: 12px;\n            padding-bottom: 8px;\n            border-bottom: 1px solid #dee2e6;\n        }\n        \n        .event-title {\n            font-size: 14px;\n            font-weight: bold;\n            color: #2c3e50;\n            margin-bottom: 8px;\n        }\n        \n        .event-number {\n            color: #007bff;\n            font-weight: bold;\n            margin-right: 8px;\n        }\n        \n        .judges-info {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            font-size: 12px;\n            font-weight: bold;\n            color: #2c3e50;\n        }\n        \n        .judges-progress {\n            font-size: 10px;\n            color: #666;\n            background: #e9ecef;\n            padding: 2px 6px;\n            border-radius: 10px;\n        }\n        \n        .judges-list {\n            display: flex;\n            flex-direction: column;\n            gap: 4px;\n        }\n        \n        .judge-item {\n            display: flex;\n            align-items: center;\n            justify-content: space-between;\n            padding: 6px 8px;\n            border-radius: 4px;\n            font-size: 10px;\n            font-weight: 500;\n            transition: background-color 0.2s;\n        }\n        \n        .judge-item:hover {\n            background: rgba(0,0,0,0.05);\n        }\n        \n        .judge-info {\n            display: flex;\n            align-items: center;\n            gap: 8px;\n        }\n        \n        .judge-status-waiting {\n            background: #f8f9fa;\n            color: #6c757d;\n            border: 1px solid #e9ecef;\n        }\n        \n        .judge-status-scoring {\n            background: #fff3cd;\n            color: #856404;\n            border: 1px solid #ffeaa7;\n        }\n        \n        .judge-status-completed {\n            background: #d4edda;\n            color: #155724;\n            border: 1px solid #c3e6cb;\n        }\n        \n        /* ì‹¬ì‚¬ìœ„ì› ìƒíƒœ í‘œì‹œ (ë°±ì—… íŒŒì¼ ë°©ì‹) */\n        .judge-status {\n            font-size: 0.8em;\n            padding: 2px 6px;\n            border-radius: 10px;\n            font-weight: bold;\n            text-align: center;\n            min-width: 40px;\n        }\n        .judge-status.scoring {\n            background: #28a745;\n            color: white;\n        }\n        .judge-status.completed {\n            background: #007bff;\n            color: white;\n        }\n        .judge-status.waiting {\n            background: #ffc107;\n            color: #333;\n        }\n        .judge-status.offline {\n            background: #6c757d;\n            color: white;\n        }\n        \n        .judge-dot {\n            width: 8px;\n            height: 8px;\n            border-radius: 50%;\n            flex-shrink: 0;\n        }\n        \n        .judge-dot-waiting {\n            background: #6c757d;\n        }\n        \n        .judge-dot-scoring {\n            background: #ffc107;\n        }\n        \n        .judge-dot-completed {\n            background: #28a745;\n        }\n        \n        .judge-name {\n            font-weight: 600;\n            min-width: 20px;\n            font-size: 10px;\n        }\n        \n        .judge-progress {\n            font-size: 9px;\n            color: #666;\n            background: rgba(255,255,255,0.7);\n            padding: 1px 4px;\n            border-radius: 3px;\n        }\n        \n        .judge-actions {\n            display: flex;\n            gap: 4px;\n            align-items: center;\n        }\n        \n        .judge-btn {\n            width: 20px;\n            height: 20px;\n            border: none;\n            border-radius: 3px;\n            cursor: pointer;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            font-size: 10px;\n            transition: all 0.2s;\n        }\n        \n        .judge-btn:hover {\n            transform: scale(1.1);\n        }\n        \n        .judge-btn-edit {\n            background: #2196f3;\n            color: white;\n        }\n        \n        .judge-btn-edit:hover {\n            background: #1976d2;\n        }\n        \n        .judge-btn-view {\n            background: #6c757d;\n            color: white;\n        }\n        \n        .judge-btn-view:hover {\n            background: #5a6268;\n        }\n        \n        .judge-btn-exclude {\n            background: #dc3545;\n            color: white;\n        }\n        \n        .judge-btn-exclude:hover {\n            background: #c82333;\n        }\n        \n        .event-card-players {\n                    margin-bottom: 15px;\n                }\n        \n        .players-header {\n            font-size: 11px;\n                    font-weight: bold;\n            color: #2c3e50;\n            margin-bottom: 8px;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n        \n        .players-count {\n            font-size: 10px;\n            color: #666;\n        }\n        \n        .players-list {\n            display: flex;\n            flex-direction: column;\n            gap: 4px;\n            max-height: 200px;\n            overflow-y: auto;\n        }\n        \n        .player-item {\n            display: flex;\n            align-items: center;\n            gap: 8px;\n            padding: 6px 8px;\n            background: #f8f9fa;\n            border-radius: 6px;\n            border: 1px solid #e9ecef;\n            transition: background-color 0.2s;\n        }\n        \n        .player-item:hover {\n            background: #e3f2fd;\n            border-color: #bbdefb;\n        }\n        \n        .player-number {\n            background: #2196f3;\n            color: white;\n            font-size: 10px;\n            padding: 2px 6px;\n            border-radius: 10px;\n            font-weight: bold;\n            min-width: 25px;\n            text-align: center;\n        }\n        \n        .player-name {\n            font-size: 11px;\n            color: #2c3e50;\n            font-weight: 500;\n            flex: 1;\n            line-height: 1.2;\n        }\n        \n        .player-gender {\n            font-size: 9px;\n            color: #666;\n            background: #e9ecef;\n            padding: 2px 6px;\n            border-radius: 10px;\n            font-weight: 500;\n            min-width: 30px;\n            text-align: center;\n        }\n        \n        .event-card-actions {\n            display: flex;\n            gap: 6px;\n            flex-wrap: wrap;\n        }\n        \n        .event-card-btn {\n            padding: 8px 12px;\n            border: none;\n            border-radius: 6px;\n            cursor: pointer;\n            font-size: 11px;\n            font-weight: 500;\n            transition: all 0.2s;\n            flex: 1;\n            min-width: 70px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 4px;\n        }\n        \n        .event-card-btn:hover {\n            transform: translateY(-1px);\n            box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n        }\n        \n        .event-card-btn-scores {\n            background: #17a2b8;\n            color: white;\n        }\n        \n        .event-card-btn-scores:hover {\n            background: #138496;\n        }\n        \n        .event-card-btn-aggregation {\n            background: #28a745;\n            color: white;\n        }\n        \n        .event-card-btn-aggregation:hover {\n            background: #218838;\n        }\n        \n        .event-card-btn-awards {\n            background: #ffc107;\n            color: #212529;\n        }\n        \n        .event-card-btn-players {\n            background: #17a2b8;\n            color: white;\n        }\n        \n        .event-card-btn-awards:hover {\n            background: #e0a800;\n        }\n        \n        .event-card-btn-players:hover {\n            background: #138496;\n        }\n        \n        .single-event-view {\n            padding: 20px;\n            min-height: 400px;\n        }\n        \n        .event-details {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 20px;\n            margin-bottom: 20px;\n        }\n        \n        .detail-card {\n            background: #f8f9fa;\n            padding: 15px;\n            border-radius: 8px;\n            border-left: 4px solid #2196f3;\n        }\n        \n        .detail-title {\n            font-weight: bold;\n            color: #2c3e50;\n            margin-bottom: 8px;\n        }\n        \n        .detail-content {\n            font-size: 14px;\n            color: #666;\n        }\n        \n        .action-buttons {\n            display: flex;\n            gap: 10px;\n            margin-top: 20px;\n        }\n        \n        .btn {\n            padding: 10px 20px;\n            border: none;\n            border-radius: 6px;\n            cursor: pointer;\n            font-size: 14px;\n            font-weight: 500;\n            transition: all 0.2s;\n        }\n        \n        .btn-primary {\n            background: #2196f3;\n            color: white;\n        }\n        \n        .btn-primary:hover {\n            background: #1976d2;\n        }\n        \n        .btn-secondary {\n            background: #6c757d;\n            color: white;\n        }\n        \n        .btn-secondary:hover {\n            background: #5a6268;\n        }\n        \n        .btn-success {\n            background: #28a745;\n            color: white;\n        }\n        \n        .btn-success:hover {\n            background: #218838;\n        }\n        \n        .no-selection {\n            text-align: center;\n            padding: 60px 20px;\n            color: #666;\n        }\n        \n        .no-selection h3 {\n            color: #2c3e50;\n            margin-bottom: 10px;\n        }\n        \n        .multi-event-indicator {\n            display: inline-block;\n            background: #ff9800;\n            color: white;\n            font-size: 10px;\n            padding: 2px 6px;\n            border-radius: 10px;\n            margin-left: 5px;\n        }\n        \n        .group-actions {\n            display: flex;\n            gap: 8px;\n            align-items: center;\n        }\n        \n        .group-complete-btn {\n            background: #28a745;\n            color: white;\n            border: none;\n            padding: 4px 8px;\n            border-radius: 4px;\n            font-size: 10px;\n            cursor: pointer;\n            transition: background-color 0.2s;\n        }\n        \n        .group-complete-btn:hover {\n            background: #218838;\n        }\n        \n        .group-complete-btn.completed {\n            background: #6c757d;\n        }\n        \n        .group-complete-btn.completed:hover {\n            background: #5a6268;\n        }\n        \n        .event-group.completed {\n            opacity: 0.5;\n            background: #f8f9fa;\n        }\n        \n        .event-group.completed .group-header {\n            background: #6c757d;\n        }\n        \n        .list-controls {\n            background: #e9ecef;\n            padding: 10px 15px;\n            border-bottom: 1px solid #dee2e6;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n        \n        .list-toggle-btn {\n            background: #007bff;\n            color: white;\n            border: none;\n            padding: 6px 12px;\n            border-radius: 4px;\n            font-size: 12px;\n            cursor: pointer;\n            transition: background-color 0.2s;\n        }\n        \n        .list-toggle-btn:hover {\n            background: #0056b3;\n        }\n        \n        .list-toggle-btn.hidden {\n            background: #6c757d;\n        }\n        \n        .list-toggle-btn.hidden:hover {\n            background: #5a6268;\n        }\n        \n        .event-group.hidden {\n            display: none;\n        }\n        \n        /* ì§‘ê³„ ê²°ê³¼ ìŠ¤íƒ€ì¼ */\n        .aggregation-result {\n            padding: 20px;\n            background: #f8f9fa;\n            border-radius: 8px;\n            margin: 20px 0;\n        }\n        \n        .aggregation-result h2 {\n            color: #2c3e50;\n            border-bottom: 2px solid #3498db;\n            padding-bottom: 10px;\n            margin-bottom: 20px;\n        }\n        \n        .aggregation-result h3 {\n            color: #34495e;\n            margin-top: 20px;\n            margin-bottom: 10px;\n        }\n        \n        .event-info {\n            background: white;\n            padding: 15px;\n            border-radius: 5px;\n            margin-bottom: 20px;\n            border-left: 4px solid #3498db;\n        }\n        \n        .event-info p {\n            margin: 5px 0;\n        }\n        \n        .rankings-table {\n            width: 100%;\n            border-collapse: collapse;\n            background: white;\n            border-radius: 5px;\n            overflow: hidden;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n        }\n        \n        .rankings-table th {\n            background: #3498db;\n            color: white;\n            padding: 12px;\n            text-align: center;\n            font-weight: bold;\n        }\n        \n        .rankings-table td {\n            padding: 10px 12px;\n            text-align: center;\n            border-bottom: 1px solid #ecf0f1;\n        }\n        \n        .rankings-table tr:nth-child(even) {\n            background: #f8f9fa;\n        }\n        \n        .rankings-table tr:hover {\n            background: #e8f4f8;\n        }\n        \n        .players-info {\n            background: white;\n            padding: 15px;\n            border-radius: 5px;\n            border-left: 4px solid #27ae60;\n        }\n        \n        .players-info ul {\n            list-style: none;\n            padding: 0;\n        }\n        \n        .players-info li {\n            padding: 5px 0;\n            border-bottom: 1px solid #ecf0f1;\n        }\n        \n        .players-info li:last-child {\n            border-bottom: none;\n        }\n        \n        /* ì§‘ê³„ ì˜¤ë¥˜ ìŠ¤íƒ€ì¼ */\n        .aggregation-error {\n            padding: 20px;\n            background: #f8d7da;\n            border: 1px solid #f5c6cb;\n            border-radius: 8px;\n            margin: 20px 0;\n            color: #721c24;\n        }\n        \n        .aggregation-error h2 {\n            color: #721c24;\n            margin-bottom: 15px;\n        }\n        \n        .aggregation-error p {\n            margin: 5px 0;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <!-- ì™¼ìª½ ì´ë²¤íŠ¸ ë¦¬ìŠ¤íŠ¸ íŒ¨ë„ -->\n        <div class=\"left-panel\">\n            <div class=\"panel-header\">\n                ğŸ“‹ ì´ë²¤íŠ¸ ë¦¬ìŠ¤íŠ¸\n            </div>\n            \n            <div class=\"list-controls\">\n                <span style=\"font-size: 12px; color: #666;\">ë¦¬ìŠ¤íŠ¸ ê´€ë¦¬</span>\n                <button class=\"list-toggle-btn\" onclick=\"toggleCompletedGroups()\" id=\"toggleCompletedBtn\">\n                    ì™„ë£Œëœ ì´ë²¤íŠ¸ ìˆ¨ê¸°ê¸°\n                </button>\n            </div>\n        \n            <?php foreach ($event_groups as $group): ?>\n            <div class=\"event-group\" data-group=\"<?=h($group['group_no'])?>\">\n                <div class=\"group-header\" onclick=\"toggleGroup('<?=h($group['group_no'])?>')\">\n                    <div class=\"group-info\">\n                        <div class=\"group-title\">\n                            í†µí•©ì´ë²¤íŠ¸ <?=h($group['group_no'])?>\n                            <?php if (count($group['events']) > 1): ?>\n                                <span class=\"multi-event-indicator\">ë©€í‹°</span>\n                            <?php endif; ?>\n                        </div>\n                        <div class=\"group-subtitle\"><?=h($group['group_name'])?></div>\n                    </div>\n                    <div class=\"group-actions\">\n                        <button class=\"group-complete-btn\" onclick=\"event.stopPropagation(); toggleGroupComplete('<?=h($group['group_no'])?>')\" \n                                data-group=\"<?=h($group['group_no'])?>\">\n                            ì™„ë£Œ\n                        </button>\n                        <span class=\"group-toggle\">â–¶</span>\n                    </div>\n                </div>\n            \n                <div class=\"event-list\" id=\"group-<?=h($group['group_no'])?>\">\n                    <?php foreach ($group['events'] as $event): ?>\n                    <div class=\"event-item\" \n                         data-event=\"<?=h($event['detail_no'] ?: $event['no'])?>\"\n                         data-group=\"<?=h($group['group_no'])?>\"\n                         <?php if ($group['is_multi']): ?>\n                         onclick=\"selectEvent('<?=h($group['group_no'])?>', '<?=h($group['group_no'])?>', this)\"\n                         <?php else: ?>\n                         onclick=\"selectEvent('<?=h($event['detail_no'] ?: $event['no'])?>', '<?=h($group['group_no'])?>', this)\"\n                         <?php endif; ?>>\n                        <div class=\"event-info\">\n                            <div class=\"event-number\">\n                                <?=h($event['detail_no'] ?: $event['no'])?>\n                    </div>\n                            <div class=\"event-desc\">\n                                <?=h($event['desc'])?>\n        </div>\n                            <?php if (!empty($event['dance_names'])): ?>\n                            <div class=\"event-dances\">\n                                ëŒ„ìŠ¤: <?=h(implode(', ', $event['dance_names']))?>\n                            </div>\n                            <?php elseif (!empty($event['dances'])): ?>\n                            <div class=\"event-dances\">\n                                ëŒ„ìŠ¤: <?=h(implode(', ', $event['dances']))?>\n                            </div>\n                            <?php endif; ?>\n    </div>\n                        <div class=\"event-status status-<?=strtolower($event['round'])?>\">\n                            <?=h($event['round'])?>\n                </div>\n            </div>\n                    <?php endforeach; ?>\n                </div>\n            </div>\n            <?php endforeach; ?>\n        </div>\n        \n        <!-- ì˜¤ë¥¸ìª½ ë©”ì¸ íŒ¨ë„ -->\n        <div class=\"right-panel\">\n            \n            <div id=\"right-content\">\n                <?php if ($view_mode === 'aggregation'): ?>\n                <?php if ($aggregation_result): ?>\n                <!-- ì§‘ê³„ ê²°ê³¼ í‘œì‹œ -->\n                <div class=\"aggregation-result\">\n                    <h2>ğŸ“Š ì§‘ê³„ ê²°ê³¼ - <?=h($aggregation_result['event_info']['desc'] ?? 'ì•Œ ìˆ˜ ì—†ëŠ” ì´ë²¤íŠ¸')?></h2>\n                    \n                    <!-- ë””ë²„ê¹… ì •ë³´ -->\n                    <div style=\"background: #f0f0f0; padding: 10px; margin: 10px 0; border-radius: 5px; font-size: 12px;\">\n                        <strong>ë””ë²„ê¹… ì •ë³´:</strong><br>\n                        ì§‘ê³„ ê²°ê³¼ íƒ€ì…: <?=gettype($aggregation_result)?><br>\n                        ì§‘ê³„ ê²°ê³¼ í‚¤: <?=implode(', ', array_keys($aggregation_result))?><br>\n                        ì´ë²¤íŠ¸ ì •ë³´: <?=json_encode($aggregation_result['event_info'] ?? 'ì—†ìŒ')?><br>\n                        ìµœì¢… ìˆœìœ„ ìˆ˜: <?=count($aggregation_result['final_rankings'] ?? [])?>\n                    </div>\n                    \n                    <div class=\"event-info\">\n                        <h3>ì´ë²¤íŠ¸ ì •ë³´</h3>\n                        <p><strong>ì´ë²¤íŠ¸ ë²ˆí˜¸:</strong> <?=h($aggregation_result['event_info']['event_no'] ?? '')?></p>\n                        <p><strong>ë¼ìš´ë“œ:</strong> <?=h($aggregation_result['event_info']['round'] ?? '')?></p>\n                        <p><strong>íŒ¨ë„:</strong> <?=h($aggregation_result['event_info']['panel'] ?? '')?></p>\n                        <p><strong>ëŒ„ìŠ¤:</strong> <?=implode(', ', $aggregation_result['event_info']['dances'] ?? [])?></p>\n                    </div>\n                    \n                    <div class=\"final-rankings\">\n                        <h3>ğŸ† ìµœì¢… ìˆœìœ„</h3>\n                        <table class=\"rankings-table\">\n                            <thead>\n                                <tr>\n                                    <th>ìˆœìœ„</th>\n                                    <th>ì„ ìˆ˜ ë²ˆí˜¸</th>\n                                    <th>í•©ê³„</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                <?php foreach ($aggregation_result['final_rankings'] ?? [] as $ranking): ?>\n                                <tr>\n                                    <td><?=h($ranking['final_rank'])?></td>\n                                    <td><?=h($ranking['player_no'])?></td>\n                                    <td><?=h($ranking['sum_of_places'])?></td>\n                                </tr>\n                                <?php endforeach; ?>\n                            </tbody>\n                        </table>\n                    </div>\n                    \n                    <div class=\"players-info\">\n                        <h3>ğŸ‘¥ ì°¸ê°€ ì„ ìˆ˜</h3>\n                        <ul>\n                            <?php foreach ($aggregation_result['players'] ?? [] as $player): ?>\n                            <li>ì„ ìˆ˜ ë²ˆí˜¸: <?=h($player['number'])?></li>\n                            <?php endforeach; ?>\n                        </ul>\n                    </div>\n                </div>\n                <?php else: ?>\n                <!-- ì§‘ê³„ ê²°ê³¼ ë¡œë“œ ì‹¤íŒ¨ -->\n                <div class=\"aggregation-error\">\n                    <h2>âŒ ì§‘ê³„ ê²°ê³¼ ë¡œë“œ ì‹¤íŒ¨</h2>\n                    <p><strong>ì´ë²¤íŠ¸:</strong> <?=h($view_event_no)?></p>\n                    <p><strong>ì»´í”¼í‹°ì…˜ ID:</strong> <?=h($comp_id)?></p>\n                    <p>ì§‘ê³„ APIì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>\n                    <div style=\"background: #f8f9fa; padding: 10px; margin: 10px 0; border-radius: 5px;\">\n                        <strong>ë””ë²„ê¹… ì •ë³´:</strong><br>\n                        URL: <?=h($aggregation_url ?? '')?><br>\n                        ë°ì´í„° ê¸¸ì´: <?=strlen($aggregation_data ?? '')?><br>\n                        ì˜¤ë¥˜: <?=error_get_last()['message'] ?? 'ì—†ìŒ'?>\n                    </div>\n                </div>\n                <?php endif; ?>\n                <?php else: ?>\n                <div class=\"no-selection\">\n                    <h3>ì´ë²¤íŠ¸ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</h3>\n                    <p>ì™¼ìª½ì—ì„œ ì´ë²¤íŠ¸ë¥¼ ì„ íƒí•˜ë©´ ì—¬ê¸°ì— ìƒì„¸ ì •ë³´ê°€ í‘œì‹œë©ë‹ˆë‹¤.</p>\n                <?php endif; ?>\n                    <?php if (isset($_GET['debug'])): ?>\n                    <div style=\"background: #f0f0f0; padding: 10px; margin: 10px 0; font-size: 12px;\">\n                        <strong>ë””ë²„ê·¸ ì •ë³´:</strong><br>\n                        ì´ë²¤íŠ¸ ê·¸ë£¹ ìˆ˜: <?=count($event_groups)?><br>\n                        ì²« ë²ˆì§¸ ê·¸ë£¹: <?=json_encode($event_groups[0] ?? 'ì—†ìŒ')?>\n            </div>\n                    <?php endif; ?>\n        </div>\n            </div>\n        </div>\n    </div>\n\n    <!-- ì„ ìˆ˜ ê´€ë¦¬ ëª¨ë‹¬ -->\n    <div class=\"modal-bg\" id=\"playerModalBg\" style=\"display:none; position:fixed; left:0; top:0; width:100vw; height:100vh; background:rgba(0,0,0,0.3); align-items:center; justify-content:center; z-index:100;\">\n        <div class=\"modal\" style=\"background:#fff; border-radius:10px; padding:2em 2.2em; box-shadow:0 10px 40px #0002; min-width:400px;\">\n            <div class=\"modal-title\">ì„ ìˆ˜ ê´€ë¦¬<br><span style=\"font-size:0.9em;color:#888;\">ë“±ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: 10, 23, 10~18)</span></div>\n            <div style=\"display:flex; gap:0.5em; margin:1em 0;\">\n                <input type=\"text\" id=\"playerInput\" placeholder=\"ë“±ë²ˆí˜¸ë‚˜ ë²”ìœ„ë¥¼ ì…ë ¥í•˜ì„¸ìš”\" style=\"font-size:1.1em; padding:0.3em 0.6em; border:1.5px solid #aaa; flex:1;\" autocomplete=\"off\">\n                <button onclick=\"addPlayers()\" style=\"background:#007bff; color:white; border:none; padding:0.3em 1em; border-radius:4px; cursor:pointer;\">ì¶”ê°€</button>\n            </div>\n            <div id=\"currentPlayers\" style=\"margin:1em 0; max-height:200px; overflow-y:auto; border:1px solid #ddd; padding:0.5em; border-radius:4px;\">\n                <div style=\"font-weight:bold; margin-bottom:0.5em;\">í˜„ì¬ ì„ ìˆ˜ ëª©ë¡:</div>\n                <div id=\"playersList\"></div>\n            </div>\n            <div class=\"modal-btns\" style=\"margin-top:1em; text-align:right;\">\n                <button type=\"button\" onclick=\"closePlayerModal()\" style=\"font-size:1.08em; margin-left:0.9em; border-radius:4px; padding:0.29em 1.3em;\">ë‹«ê¸°</button>\n                <button type=\"button\" onclick=\"savePlayers()\" style=\"font-size:1.08em; margin-left:0.9em; border-radius:4px; padding:0.29em 1.3em; background:#28a745; color:white; border:none;\">ì €ì¥</button>\n            </div>\n        </div>\n    </div>\n\n    <script>\n        let selectedEvent = null;\n        let selectedGroup = null;\n        \n        // ì „ì—­ ê·¸ë£¹ ë°ì´í„°\n        const groupData = <?=json_encode($event_groups)?>;\n        let expandedGroups = new Set();\n        let completedGroups = new Set();\n        let hideCompleted = false;\n        let currentEventForPlayerModal = null;\n        let currentPlayers = [];\n        let disabledJudgesByEvent = {};\n        \n        function toggleGroup(groupNo) {\n            const group = document.querySelector(`[data-group=\"${groupNo}\"]`);\n            const eventList = document.getElementById(`group-${groupNo}`);\n            const toggle = group.querySelector('.group-toggle');\n            \n            if (expandedGroups.has(groupNo)) {\n                eventList.classList.remove('expanded');\n                toggle.classList.remove('expanded');\n                expandedGroups.delete(groupNo);\n            } else {\n                eventList.classList.add('expanded');\n                toggle.classList.add('expanded');\n                expandedGroups.add(groupNo);\n            }\n        }\n        \n        function toggleGroupComplete(groupNo) {\n            const group = document.querySelector(`[data-group=\"${groupNo}\"]`);\n            const completeBtn = group.querySelector('.group-complete-btn');\n            \n            if (completedGroups.has(groupNo)) {\n                // ì™„ë£Œ í•´ì œ\n                group.classList.remove('completed');\n                completeBtn.classList.remove('completed');\n                completeBtn.textContent = 'ì™„ë£Œ';\n                completedGroups.delete(groupNo);\n            } else {\n                // ì™„ë£Œ ì²˜ë¦¬\n                group.classList.add('completed');\n                completeBtn.classList.add('completed');\n                completeBtn.textContent = 'ì™„ë£Œë¨';\n                completedGroups.add(groupNo);\n            }\n            \n            // ìˆ¨ê¹€ ëª¨ë“œê°€ í™œì„±í™”ë˜ì–´ ìˆìœ¼ë©´ ì—…ë°ì´íŠ¸\n            if (hideCompleted) {\n                updateGroupVisibility();\n            }\n        }\n        \n        function toggleCompletedGroups() {\n            const toggleBtn = document.getElementById('toggleCompletedBtn');\n            hideCompleted = !hideCompleted;\n            \n            if (hideCompleted) {\n                toggleBtn.textContent = 'ì™„ë£Œëœ ì´ë²¤íŠ¸ ë³´ê¸°';\n                toggleBtn.classList.add('hidden');\n            } else {\n                toggleBtn.textContent = 'ì™„ë£Œëœ ì´ë²¤íŠ¸ ìˆ¨ê¸°ê¸°';\n                toggleBtn.classList.remove('hidden');\n            }\n            \n            updateGroupVisibility();\n        }\n        \n        function updateGroupVisibility() {\n            const groups = document.querySelectorAll('.event-group');\n            groups.forEach(group => {\n                const groupNo = group.dataset.group;\n                if (hideCompleted && completedGroups.has(groupNo)) {\n                    group.classList.add('hidden');\n                } else {\n                    group.classList.remove('hidden');\n                }\n            });\n        }\n        \n        function selectEvent(eventId, groupId, element) {\n            console.log('selectEvent called:', {eventId, groupId});\n            \n            // ì´ì „ ì„ íƒ í•´ì œ\n            document.querySelectorAll('.event-item.selected').forEach(item => {\n                item.classList.remove('selected');\n            });\n            document.querySelectorAll('.group-header.selected').forEach(header => {\n                header.classList.remove('selected');\n            });\n            \n            // í˜„ì¬ ì„ íƒ\n            element.classList.add('selected');\n            element.closest('.event-group').querySelector('.group-header').classList.add('selected');\n            \n            selectedEvent = eventId;\n            selectedGroup = groupId;\n            \n            console.log('selectedEvent set to:', selectedEvent);\n            console.log('selectedGroup set to:', selectedGroup);\n            \n            // ì˜¤ë¥¸ìª½ íŒ¨ë„ ì—…ë°ì´íŠ¸\n            updateRightPanel(eventId, groupId);\n        }\n        \n        function updateRightPanel(eventId, groupId) {\n            console.log('updateRightPanel called:', {eventId, groupId});\n            const rightContent = document.getElementById('right-content');\n            \n            console.log('GroupData:', groupData);\n            console.log('Looking for groupId:', groupId);\n            \n            const group = groupData.find(g => g.group_no == groupId);\n            console.log('Found group:', group);\n            \n            if (!group) {\n                console.error('Group not found for groupId:', groupId);\n                return;\n            }\n            \n            const event = group.events.find(e => (e.detail_no || e.no) === eventId);\n            console.log('Found event:', event);\n            \n            if (!event) {\n                console.error('Event not found for eventId:', eventId);\n            return;\n        }\n        \n            const isMultiEvent = group.events.length > 1;\n            console.log('isMultiEvent:', isMultiEvent);\n            console.log('group.events.length:', group.events.length);\n            \n            let content = `\n                <div class=\"right-header\">\n                    <div class=\"right-title\">í†µí•©ì´ë²¤íŠ¸ ${groupId}</div>\n                    <div class=\"event-info-row\">\n                        <div class=\"info-item\">\n                            <div class=\"info-label\">ìœ í˜•</div>\n                            <div class=\"info-value\">${isMultiEvent ? 'ë©€í‹° ì´ë²¤íŠ¸' : 'ì‹±ê¸€ ì´ë²¤íŠ¸'}</div>\n                        </div>\n                        <div class=\"info-item\">\n                            <div class=\"info-label\">ì´ë²¤íŠ¸ìˆ˜</div>\n                            <div class=\"info-value\">${group.events.length}ê°œ</div>\n                        </div>\n                        <div class=\"info-item\">\n                            <div class=\"info-label\">íŒ¨ë„</div>\n                            <div class=\"info-value\">${group.events[0].panel || 'N/A'}</div>\n                        </div>\n                        <div class=\"info-item\">\n                            <div class=\"info-label\">ëŒ„ìŠ¤ìˆœì„œ</div>\n                            <div class=\"dance-sequence-value\" \n                                 onclick=\"openDanceEditModal('${groupId}')\"\n                                 title=\"ëŒ„ìŠ¤ ìˆœì„œ ìˆ˜ì •\">\n                                ${getDanceSequenceDisplay(group.dance_sequence)}\n                                <span class=\"dance-edit-icon\">âœï¸</span>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            `;\n            \n            if (isMultiEvent) {\n                // ë©€í‹° ì´ë²¤íŠ¸ì¸ ê²½ìš° ì¹´ë“œ ê·¸ë¦¬ë“œ í‘œì‹œ\n                content += `\n                    <div class=\"event-cards-container\">\n                        <div class=\"event-cards-grid\">\n                `;\n                \n                group.events.forEach(evt => {\n                    const isSelected = (evt.detail_no || evt.no) === eventId;\n                    const statusClass = evt.round.toLowerCase().includes('final') ? 'status-final' : \n                                      evt.round.toLowerCase().includes('semi') ? 'status-semi' : 'status-prelim';\n                    \n                    // ì´ë²¤íŠ¸ í‚¤ ìƒì„±\n                    const eventKey = evt.detail_no || evt.no;\n                    \n        // PHPì—ì„œ ë¯¸ë¦¬ ê³„ì‚°ëœ ë°ì´í„° ì‚¬ìš©\n        let eventJudges = evt.judges || [];\n        const eventPlayers = evt.players || [];\n        \n        // ì œì™¸ëœ ì‹¬ì‚¬ìœ„ì› í•„í„°ë§\n        const disabledJudges = disabledJudgesByEvent[evt.detail_no || evt.no] || [];\n        eventJudges = eventJudges.filter(judge => !disabledJudges.includes(judge.code));\n                    \n                    // ì´ë²¤íŠ¸ ì œëª© ê°€ì ¸ì˜¤ê¸°\n                    const eventTitle = evt.name || evt.title || `ì´ë²¤íŠ¸ ${evt.detail_no || evt.no}`;\n                    \n                    content += `\n                        <div class=\"event-card ${isSelected ? 'selected' : ''}\" \n                             data-event=\"${evt.detail_no || evt.no}\"\n                             onclick=\"selectEventFromCard('${evt.detail_no || evt.no}', '${groupId}')\">\n                            <div class=\"event-card-body\">\n                                <!-- ì™¼ìª½: ì‹¬ì‚¬ìœ„ì› ë¦¬ìŠ¤íŠ¸ -->\n                                <div class=\"event-card-left\">\n                                    <div class=\"event-card-judges\">\n                                        <div class=\"judges-header\">\n                                            <div class=\"event-title\">\n                                                <span class=\"event-number\">${evt.detail_no || evt.no}</span>\n                                                ${eventTitle}\n                                            </div>\n                                            <div class=\"judges-info\">\n                                                <span>ì‹¬ì‚¬ìœ„ì› í˜„í™©</span>\n                                                <span class=\"judges-progress\">\n                                                    ${eventJudges.filter(j => j.status === 'completed').length}/${eventJudges.length} ì™„ë£Œ\n                                                </span>\n                                            </div>\n                                        </div>\n                                        <div class=\"judges-list\">\n                                            ${eventJudges.map(judge => `\n                                                <div class=\"judge-item\" data-judge-code=\"${judge.code}\">\n                                                    <div class=\"judge-info\">\n                                                        <span class=\"judge-status waiting\" id=\"judge-status-${judge.code}\" data-judge-code=\"${judge.code}\">ëŒ€ê¸°</span>\n                                                        <span class=\"judge-name\">${judge.code}</span>\n                                                    </div>\n                                                    <div class=\"judge-actions\">\n                                                        <button class=\"judge-btn judge-btn-exclude\" \n                                                                onclick=\"event.stopPropagation(); toggleAdjudicator('${evt.detail_no || evt.no}', '${judge.code}')\"\n                                                                title=\"ì´ ì´ë²¤íŠ¸ì—ì„œ ì‹¬ì‚¬ìœ„ì› ì œì™¸\">\n                                                            X\n                                                        </button>\n                                                        <button class=\"judge-btn judge-btn-edit\" \n                                                                onclick=\"event.stopPropagation(); openJudgeScoring('${evt.detail_no || evt.no}', '${judge.code}')\"\n                                                                title=\"ì±„ì í•˜ê¸°\">\n                                                            âœï¸\n                                                        </button>\n                                                    </div>\n                                                </div>\n                                            `).join('')}\n        </div>\n        </div>\n    </div>\n                                \n                                <!-- ì˜¤ë¥¸ìª½: ë‚˜ë¨¸ì§€ ì •ë³´ -->\n                                <div class=\"event-card-right\">\n                                    <div class=\"event-card-title\">${evt.desc}</div>\n                                    \n                                    <div class=\"event-card-details\">\n                                        <div class=\"event-card-detail-row\">\n                                            <span class=\"event-card-detail-label\">ë¼ìš´ë“œ:</span>\n                                            <span class=\"event-card-detail-value\">${evt.round}</span>\n</div>\n                                        <div class=\"event-card-detail-row\">\n                                            <span class=\"event-card-detail-label\">ëŒ„ìŠ¤:</span>\n                                            <span class=\"event-card-detail-value\">${evt.dance_names ? evt.dance_names.join(', ') : (evt.dances ? evt.dances.join(', ') : 'N/A')}</span>\n                                        </div>\n</div>\n                                    \n                                    <!-- ì¶œì „ ì„ ìˆ˜ ë“±ë²ˆ -->\n                                    <div class=\"event-card-players\">\n                                        <div class=\"players-header\">\n                                            <span>ì¶œì „ ì„ ìˆ˜</span>\n                                            <span class=\"players-count\">${eventPlayers.length}ëª…</span>\n    </div>\n                                        <div class=\"players-list\">\n                                            ${eventPlayers.map(player => `\n                                                <div class=\"player-item\">\n                                                    <div class=\"player-number\">${player.number}</div>\n                                                    <div class=\"player-name\">${player.name || `ì„ ìˆ˜ ${player.number}`}</div>\n                                                    <div class=\"player-gender\">\n                                                        ${player.type === 'couple' ? 'ì»¤í”Œ' : 'ì‹±ê¸€'}\n            </div>\n            </div>\n                                            `).join('')}\n            </div>\n            </div>\n                                    \n                                    <div class=\"event-card-actions\">\n                                        <button class=\"event-card-btn event-card-btn-players\" onclick=\"event.stopPropagation(); openPlayerModal('${evt.detail_no || evt.no}')\">\n                                            ğŸ‘¥ ì„ ìˆ˜\n                                        </button>\n                                        <button class=\"event-card-btn event-card-btn-scores\" onclick=\"event.stopPropagation(); viewScores('${evt.detail_no || evt.no}')\">\n                                            ğŸ“Š ì ìˆ˜\n                                        </button>\n                                        <button class=\"event-card-btn event-card-btn-aggregation\" onclick=\"event.stopPropagation(); openAggregation('${evt.detail_no || evt.no}')\">\n                                            ğŸ“ˆ ì§‘ê³„\n                                        </button>\n                                        <button class=\"event-card-btn event-card-btn-awards\" onclick=\"event.stopPropagation(); openAwards('${evt.detail_no || evt.no}')\">\n                                            ğŸ† ìƒì¥\n                                        </button>\n        </div>\n    </div>\n    </div>\n                        </div>\n                    `;\n                });\n                \n                content += `\n                        </div>\n                    </div>\n                `;\n    } else {\n                // ì‹±ê¸€ ì´ë²¤íŠ¸ì¸ ê²½ìš° ê¸°ì¡´ ìƒì„¸ ì •ë³´ í‘œì‹œ\n                content += `\n                    <div class=\"group-info-header\">\n                        <div>\n                            <div class=\"group-title\">ì‹±ê¸€ ì´ë²¤íŠ¸ ìƒì„¸ ì •ë³´</div>\n                            <div class=\"group-subtitle\">\n                                <strong>íŒ¨ë„:</strong> ${event.panel || 'N/A'} | \n                                <strong>ëŒ„ìŠ¤:</strong> \n                                <span class=\"dance-sequence\">\n                                    ${event.dance_names ? event.dance_names.join(' â†’ ') : (event.dances ? event.dances.join(' â†’ ') : 'N/A')}\n                                </span>\n</div>\n</div>\n</div>\n                    <div class=\"single-event-view\">\n                        <div class=\"event-details\">\n                            <div class=\"detail-card\">\n                                <div class=\"detail-title\">ì´ë²¤íŠ¸ ì •ë³´</div>\n                                <div class=\"detail-content\">\n                                    <strong>ì´ë²¤íŠ¸ ë²ˆí˜¸:</strong> ${eventId}<br>\n                                    <strong>ë¼ìš´ë“œ:</strong> ${event.round}<br>\n                                    <strong>ì¹´í…Œê³ ë¦¬:</strong> ${group.group_name}\n                                </div>\n                            </div>\n                            \n                            <div class=\"detail-card\">\n                                <div class=\"detail-title\">ê·¸ë£¹ ì •ë³´</div>\n                                <div class=\"detail-content\">\n                                    <strong>ê·¸ë£¹ ë²ˆí˜¸:</strong> ${groupId}<br>\n                                    <strong>ì´ ì´ë²¤íŠ¸:</strong> ${group.events.length}ê°œ<br>\n                                    <strong>íƒ€ì…:</strong> ì‹±ê¸€ ì´ë²¤íŠ¸\n                                </div>\n                            </div>\n                        </div>\n                        \n                        <div class=\"action-buttons\">\n                            <button class=\"btn btn-info\" onclick=\"viewScores('${eventId}')\">\n                                ğŸ“Š ì ìˆ˜ ë³´ê¸°\n                            </button>\n                            <button class=\"btn btn-success\" onclick=\"openAggregation('${eventId}')\">\n                                ğŸ“ˆ ê²°ê³¼ ì§‘ê³„\n                            </button>\n                            <button class=\"btn btn-warning\" onclick=\"openAwards('${eventId}')\">\n                                ğŸ† ìƒì¥ ë°œê¸‰\n                            </button>\n                        </div>\n                </div>\n            `;\n            }\n            \n            rightContent.innerHTML = content;\n            \n            // ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ëŠ” startJudgeStatusMonitoringì—ì„œ ì²˜ë¦¬\n        }\n        \n        function selectEventFromCard(eventId, groupId) {\n            // ì™¼ìª½ íŒ¨ë„ì˜ í•´ë‹¹ ì´ë²¤íŠ¸ë„ ì„ íƒ ìƒíƒœë¡œ ì—…ë°ì´íŠ¸\n            const eventElement = document.querySelector(`[data-event=\"${eventId}\"]`);\n            if (eventElement) {\n                // ì´ì „ ì„ íƒ í•´ì œ\n                document.querySelectorAll('.event-item.selected').forEach(item => {\n                    item.classList.remove('selected');\n                });\n                document.querySelectorAll('.group-header.selected').forEach(header => {\n                    header.classList.remove('selected');\n                });\n                \n                // í˜„ì¬ ì„ íƒ\n                eventElement.classList.add('selected');\n                eventElement.closest('.event-group').querySelector('.group-header').classList.add('selected');\n                \n                selectedEvent = eventId;\n                selectedGroup = groupId;\n                \n                // ì˜¤ë¥¸ìª½ íŒ¨ë„ ì—…ë°ì´íŠ¸\n                updateRightPanel(eventId, groupId);\n            }\n        }\n        \n        function openJudgeScoring(eventId, judgeCode) {\n            if (!eventId || !judgeCode) {\n                alert('ì´ë²¤íŠ¸ì™€ ì‹¬ì‚¬ìœ„ì›ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');\n                return;\n            }\n            \n            // ë””ë²„ê·¸: ì „ë‹¬ë°›ì€ ë§¤ê°œë³€ìˆ˜ í™•ì¸\n            console.log('openJudgeScoring called:', {\n                eventId: eventId,\n                judgeCode: judgeCode,\n                type: typeof judgeCode\n            });\n            \n            // ë§¤ê°œë³€ìˆ˜ ìœ íš¨ì„± ê²€ì‚¬\n            if (!eventId || eventId === 'undefined' || eventId === 'null') {\n                alert('ì´ë²¤íŠ¸ IDê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤: ' + eventId);\n                return;\n            }\n            if (!judgeCode || judgeCode === 'undefined' || judgeCode === 'null') {\n                alert('ì‹¬ì‚¬ìœ„ì› ì½”ë“œê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤: ' + judgeCode);\n                return;\n            }\n            \n            const compId = '<?=$comp_id?>';\n            \n            // ì—¬ëŸ¬ URL ì˜µì…˜ ì‹œë„\n            const urls = [\n                `judge_scoring.php?comp_id=${compId}&event_no=${eventId}&judge_code=${judgeCode}&admin_mode=1`,\n                `./judge_scoring.php?comp_id=${compId}&event_no=${eventId}&judge_code=${judgeCode}&admin_mode=1`,\n                `https://www.danceoffice.net/comp/judge_scoring.php?comp_id=${compId}&event_no=${eventId}&judge_code=${judgeCode}&admin_mode=1`\n            ];\n            \n            // ì²« ë²ˆì§¸ URL ì‹œë„\n            const url = urls[0];\n            console.log('Opening URL:', url);\n            console.log('Full URL details:', {\n                compId: compId,\n                eventId: eventId,\n                judgeCode: judgeCode,\n                baseUrl: window.location.origin + window.location.pathname.substring(0, window.location.pathname.lastIndexOf('/')),\n                finalUrl: url\n            });\n            \n            // URLì´ ì˜¬ë°”ë¥¸ì§€ í™•ì¸\n            if (url.includes('undefined') || url.includes('null')) {\n                alert('URLì— ì˜ëª»ëœ ê°’ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤: ' + url);\n                return;\n            }\n            \n            // ìƒˆ ì°½ ì—´ê¸°\n            const newWindow = window.open(url, '_blank', 'width=1200,height=800,scrollbars=yes,resizable=yes');\n            \n            // ìƒˆ ì°½ì´ ì œëŒ€ë¡œ ì—´ë ¸ëŠ”ì§€ í™•ì¸\n            if (!newWindow || newWindow.closed || typeof newWindow.closed == 'undefined') {\n                console.error('íŒì—…ì´ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤. íŒì—… ì°¨ë‹¨ì„ í•´ì œí•´ì£¼ì„¸ìš”.');\n                alert('íŒì—…ì´ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì„¤ì •ì—ì„œ íŒì—…ì„ í—ˆìš©í•´ì£¼ì„¸ìš”.');\n            } else {\n                // 2ì´ˆ í›„ í˜ì´ì§€ ë¡œë“œ í™•ì¸\n                setTimeout(() => {\n                    try {\n                        if (newWindow.location.href === 'about:blank' || newWindow.location.href.includes('danceoffice.net')) {\n                            console.log('ì±„ì  í˜ì´ì§€ê°€ ì •ìƒì ìœ¼ë¡œ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.');\n                        } else {\n                            console.warn('ì˜ˆìƒê³¼ ë‹¤ë¥¸ í˜ì´ì§€ê°€ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤:', newWindow.location.href);\n                        }\n                    } catch (e) {\n                        console.log('í¬ë¡œìŠ¤ ì˜¤ë¦¬ì§„ ì •ì±…ìœ¼ë¡œ ì¸í•´ í˜ì´ì§€ ë‚´ìš©ì„ í™•ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');\n                    }\n                }, 2000);\n            }\n        }\n        \n        function viewJudgeScores(eventId, judgeCode) {\n            if (!eventId || !judgeCode) {\n                alert('ì´ë²¤íŠ¸ì™€ ì‹¬ì‚¬ìœ„ì›ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');\n            return;\n            }\n            \n            // ì ìˆ˜ ë³´ê¸° (ê¸°ì¡´ viewScores í•¨ìˆ˜ í™œìš©)\n            viewScores(eventId);\n        }\n        \n        function viewScores(eventId) {\n            if (!eventId) {\n                alert('ì´ë²¤íŠ¸ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');\n                return;\n            }\n            \n            const compId = '<?=$comp_id?>';\n            const url = `https://www.danceoffice.net/comp/live_panel.php?comp_id=${compId}&view=scores&event_no=${eventId}`;\n            \n            console.log('Opening scores URL:', url);\n            \n            // ìƒˆ ì°½ì—ì„œ ì ìˆ˜ ë³´ê¸°\n            window.open(url, '_blank', 'width=1000,height=700,scrollbars=yes,resizable=yes');\n        }\n        \n        function openAggregation(eventId) {\n            if (!eventId) {\n                alert('ì´ë²¤íŠ¸ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');\n                return;\n            }\n            \n            const compId = '<?=$comp_id?>';\n            \n            console.log('ì§‘ê³„ ì‹œì‘:', {eventId, compId});\n            \n            // ì§‘ê³„ ê²°ê³¼ í˜ì´ì§€ë¡œ ì§ì ‘ ì´ë™ (API í˜¸ì¶œ ì—†ì´)\n            const url = `https://www.danceoffice.net/comp/live_panel.php?comp_id=${compId}&view=aggregation&event_no=${eventId}`;\n            console.log('ì§‘ê³„ ê²°ê³¼ í˜ì´ì§€ë¡œ ì´ë™:', url);\n            \n            // ìƒˆ ì°½ì—ì„œ ì§‘ê³„ ê²°ê³¼ í‘œì‹œ\n            const newWindow = window.open(url, '_blank', 'width=1200,height=800,scrollbars=yes,resizable=yes');\n            \n            // ìƒˆ ì°½ì´ ì œëŒ€ë¡œ ì—´ë ¸ëŠ”ì§€ í™•ì¸\n            if (!newWindow || newWindow.closed || typeof newWindow.closed == 'undefined') {\n                console.error('íŒì—…ì´ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤. íŒì—… ì°¨ë‹¨ì„ í•´ì œí•´ì£¼ì„¸ìš”.');\n                alert('íŒì—…ì´ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì„¤ì •ì—ì„œ íŒì—…ì„ í—ˆìš©í•´ì£¼ì„¸ìš”.');\n            } else {\n                console.log('ì§‘ê³„ ê²°ê³¼ ì°½ì´ ì—´ë ¸ìŠµë‹ˆë‹¤.');\n            }\n        }\n        \n        function openAwards(eventId) {\n            if (!eventId) {\n                alert('ì´ë²¤íŠ¸ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');\n                return;\n            }\n            \n            const compId = '<?=$comp_id?>';\n            const url = `https://www.danceoffice.net/comp/live_panel.php?comp_id=${compId}&view=awards&event_no=${eventId}`;\n            \n            console.log('Opening awards URL:', url);\n            \n            // ìƒˆ ì°½ì—ì„œ ìƒì¥ ë°œê¸‰\n            window.open(url, '_blank', 'width=1000,height=700,scrollbars=yes,resizable=yes');\n        }\n        \n        function getDanceSequenceDisplay(danceSequence) {\n            if (!danceSequence || danceSequence.length === 0) return 'N/A';\n            \n            return danceSequence.map(item => {\n                const typeLabel = item.type === 'common' ? '(ê³µë™)' : \n                                 item.type === 'individual' ? '(ê°œë³„)' : '';\n                return `${item.dance_name || item.dance}${typeLabel}`;\n            }).join(' â†’ ');\n        }\n        \n        function openDanceEditModal(groupId) {\n            const group = groupData.find(g => g.group_no == groupId);\n            \n            if (!group || !group.dance_sequence) {\n                alert('ëŒ„ìŠ¤ ìˆœì„œ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');\n        return;\n    }\n    \n            const modal = document.createElement('div');\n            modal.className = 'dance-edit-modal';\n            modal.innerHTML = `\n                <div class=\"dance-edit-content\">\n                    <div class=\"dance-edit-header\">\n                        <div class=\"dance-edit-title\">ëŒ„ìŠ¤ ìˆœì„œ ìˆ˜ì • - í†µí•©ì´ë²¤íŠ¸ ${groupId}</div>\n                        <button class=\"dance-edit-close\" onclick=\"closeDanceEditModal()\">&times;</button>\n                    </div>\n                    \n                    <div class=\"dance-list-container\" id=\"dance-list-container\">\n                        ${group.dance_sequence.map((item, index) => `\n                            <div class=\"dance-item\" data-index=\"${index}\" draggable=\"true\">\n                                <div class=\"dance-drag-handle\">â‹®â‹®</div>\n                                <div class=\"dance-number\">${index + 1}</div>\n                                <div class=\"dance-info\">\n                                    <div class=\"dance-name\">${item.dance_name || item.dance}</div>\n                                    <div class=\"dance-events\">\n                                        ${item.type === 'common' ? 'ê³µë™ ëŒ„ìŠ¤' : \n                                          item.type === 'individual' ? 'ê°œë³„ ëŒ„ìŠ¤' : 'ì‹±ê¸€ ëŒ„ìŠ¤'} \n                                        (ì´ë²¤íŠ¸: ${item.events.join(', ')})\n                                    </div>\n                                </div>\n                                <div class=\"dance-actions\">\n                                    <button class=\"dance-action-btn dance-remove-btn\" \n                                            onclick=\"removeDanceItem(${index})\" title=\"ì œê±°\">Ã—</button>\n                                </div>\n                            </div>\n                        `).join('')}\n                    </div>\n                    \n                    <div class=\"dance-edit-buttons\">\n                        <button class=\"btn-cancel\" onclick=\"closeDanceEditModal()\">ì·¨ì†Œ</button>\n                        <button class=\"btn-save\" onclick=\"saveDanceSequence('${groupId}')\">ì €ì¥</button>\n        </div>\n        </div>\n            `;\n            \n            document.body.appendChild(modal);\n            \n            // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ê¸°ëŠ¥ ì¶”ê°€\n            makeDanceListSortable();\n        }\n        \n        function makeDanceListSortable() {\n            const container = document.getElementById('dance-list-container');\n            let draggedElement = null;\n            \n            container.addEventListener('dragstart', function(e) {\n                if (e.target.classList.contains('dance-drag-handle')) {\n                    draggedElement = e.target.closest('.dance-item');\n                    draggedElement.classList.add('dragging');\n                }\n            });\n            \n            container.addEventListener('dragend', function(e) {\n                if (draggedElement) {\n                    draggedElement.classList.remove('dragging');\n                    draggedElement = null;\n                }\n            });\n            \n            container.addEventListener('dragover', function(e) {\n                e.preventDefault();\n            });\n            \n            container.addEventListener('drop', function(e) {\n                e.preventDefault();\n                if (draggedElement) {\n                    const afterElement = getDragAfterElement(container, e.clientY);\n                    if (afterElement == null) {\n                        container.appendChild(draggedElement);\n        } else {\n                        container.insertBefore(draggedElement, afterElement);\n                    }\n                    updateDanceNumbers();\n                }\n            });\n        }\n        \n        function getDragAfterElement(container, y) {\n            const draggableElements = [...container.querySelectorAll('.dance-item:not(.dragging)')];\n            \n            return draggableElements.reduce((closest, child) => {\n                const box = child.getBoundingClientRect();\n                const offset = y - box.top - box.height / 2;\n                \n                if (offset < 0 && offset > closest.offset) {\n                    return { offset: offset, element: child };\n    } else {\n                    return closest;\n                }\n            }, { offset: Number.NEGATIVE_INFINITY }).element;\n        }\n        \n        function updateDanceNumbers() {\n            const items = document.querySelectorAll('.dance-item');\n            items.forEach((item, index) => {\n                const numberElement = item.querySelector('.dance-number');\n                numberElement.textContent = index + 1;\n            });\n        }\n        \n        function removeDanceItem(index) {\n            const item = document.querySelector(`[data-index=\"${index}\"]`);\n            if (item) {\n                item.remove();\n                updateDanceNumbers();\n            }\n        }\n        \n        function saveDanceSequence(groupId) {\n            const items = document.querySelectorAll('.dance-item');\n            const newSequence = Array.from(items).map((item, index) => {\n                const danceName = item.querySelector('.dance-name').textContent;\n                const eventsText = item.querySelector('.dance-events').textContent;\n                const events = eventsText.match(/ì´ë²¤íŠ¸: ([^)]+)/);\n                \n                return {\n                    dance: danceName,\n                    events: events ? events[1].split(', ') : [],\n                    type: eventsText.includes('ê³µë™') ? 'common' : \n                          eventsText.includes('ê°œë³„') ? 'individual' : 'single'\n                };\n            });\n            \n            // ì‹¤ì œ ì €ì¥ ë¡œì§ (ì„œë²„ë¡œ ì „ì†¡)\n            console.log('ìƒˆë¡œìš´ ëŒ„ìŠ¤ ìˆœì„œ:', newSequence);\n            alert('ëŒ„ìŠ¤ ìˆœì„œê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');\n            closeDanceEditModal();\n        }\n        \n        function closeDanceEditModal() {\n            const modal = document.querySelector('.dance-edit-modal');\n            if (modal) {\n                modal.remove();\n            }\n        }\n        \n        // ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ ê¸°ëŠ¥\n        function startRealTimeUpdates() {\n            // 5ì´ˆë§ˆë‹¤ ì‹¬ì‚¬ìœ„ì› ìƒíƒœ ì—…ë°ì´íŠ¸\n            setInterval(() => {\n                updateAllJudgeStatus();\n            }, 5000);\n        }\n        \n        function updateAllJudgeStatus() {\n            // ëª¨ë“  ì´ë²¤íŠ¸ì˜ ì‹¬ì‚¬ìœ„ì› ìƒíƒœ ì—…ë°ì´íŠ¸\n            const eventCards = document.querySelectorAll('.event-card');\n            eventCards.forEach(card => {\n                const eventId = card.dataset.event;\n                if (eventId) {\n                    updateEventJudgeStatus(eventId);\n        }\n    });\n}\n\n        function updateEventJudgeStatus(eventId) {\n            // ì„œë²„ì—ì„œ ìµœì‹  ì‹¬ì‚¬ìœ„ì› ìƒíƒœ ê°€ì ¸ì˜¤ê¸°\n            const compId = '<?=$comp_id?>';\n            fetch(`https://www.danceoffice.net/comp/api/get_judge_status.php?comp_id=${compId}&event=${eventId}`)\n                .then(response => response.json())\n        .then(data => {\n                    if (data.success) {\n                        updateJudgeStatusDisplay(eventId, data.judges);\n                    }\n                })\n                .catch(error => {\n                    console.log('ì‹¬ì‚¬ìœ„ì› ìƒíƒœ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);\n                });\n        }\n        \n        function updateJudgeStatusDisplay(eventId, judges) {\n            const card = document.querySelector(`[data-event=\"${eventId}\"]`);\n            if (!card) return;\n            \n            const judgesList = card.querySelector('.judges-list');\n            if (!judgesList) return;\n            \n            // ì‹¬ì‚¬ìœ„ì› ìƒíƒœ ì—…ë°ì´íŠ¸\n            judges.forEach(judge => {\n                const judgeItem = judgesList.querySelector(`[data-judge=\"${judge.code}\"]`);\n                if (judgeItem) {\n                    const statusDot = judgeItem.querySelector('.judge-dot');\n                    const progressText = judgeItem.querySelector('.judge-progress');\n                    \n                    if (statusDot) {\n                        statusDot.className = `judge-dot judge-dot-${judge.status}`;\n                    }\n                    \n                    if (progressText) {\n                        progressText.textContent = `${judge.completed}/${judge.total}`;\n                    }\n                }\n            });\n        }\n        \n        // ì‹¬ì‚¬ìœ„ì› ìƒíƒœ ëª¨ë‹ˆí„°ë§ í•¨ìˆ˜ (ë©€í‹° ì´ë²¤íŠ¸ ì§€ì›)\n        function updateJudgeStatus(eventNo) {\n            // í˜„ì¬ ì´ë²¤íŠ¸ì˜ ì‹¬ì‚¬ìœ„ì›ë“¤ ìƒíƒœ í™•ì¸\n            if (!eventNo) return;\n            \n            console.log('updateJudgeStatus called for:', eventNo);\n            \n            fetch(`https://www.danceoffice.net/comp/get_judge_status.php?comp_id=<?=urlencode($comp_id)?>&event_no=${eventNo}&${Date.now()}`)\n                .then(r => r.ok ? r.json() : {success: false, status: {}})\n                .then(data => {\n                    console.log('Judge status response for', eventNo, ':', data);\n                    \n                    if (data.success && data.status) {\n                        // í•´ë‹¹ ì´ë²¤íŠ¸ì˜ ì¹´ë“œ ë‚´ì—ì„œë§Œ ìƒíƒœ ì—…ë°ì´íŠ¸\n                        const eventCard = document.querySelector(`.event-card[data-event=\"${eventNo}\"]`);\n                        console.log('Found event card:', eventCard);\n                        \n                        if (eventCard) {\n                            let completedCount = 0;\n                            let totalCount = 0;\n                            \n                            Object.keys(data.status).forEach(judgeCode => {\n                                let statusElement = eventCard.querySelector(`#judge-status-${judgeCode}`);\n                                if (statusElement) {\n                                    let status = data.status[judgeCode];\n                                    statusElement.className = `judge-status ${status.class}`;\n                                    statusElement.textContent = status.text;\n                                    \n                                    // ì™„ë£Œëœ ì‹¬ì‚¬ìœ„ì› ìˆ˜ ê³„ì‚°\n                                    if (status.class === 'completed') {\n                                        completedCount++;\n                                    }\n                                    totalCount++;\n                                }\n                            });\n                            \n                            // ì‹¬ì‚¬ìœ„ì› í˜„í™© ì§„í–‰ë¥  ì—…ë°ì´íŠ¸\n                            const progressElement = eventCard.querySelector('.judges-progress');\n                            if (progressElement) {\n                                progressElement.textContent = `${completedCount}/${totalCount} ì™„ë£Œ`;\n                                console.log('Updated progress:', `${completedCount}/${totalCount} ì™„ë£Œ`);\n                            }\n                        }\n                    }\n                })\n                .catch(err => {\n                    console.warn('ì‹¬ì‚¬ìœ„ì› ìƒíƒœ ë¡œë“œ ì˜¤ë¥˜:', err);\n                });\n        }\n        \n        // ì‹¤ì‹œê°„ ì‹¬ì‚¬ìœ„ì› ìƒíƒœ ëª¨ë‹ˆí„°ë§ ì‹œì‘\n        function startJudgeStatusMonitoring() {\n            // 2ì´ˆë§ˆë‹¤ ì‹¬ì‚¬ìœ„ì› ìƒíƒœ ì—…ë°ì´íŠ¸\n            setInterval(() => {\n                if (selectedEvent && selectedGroup) {\n                    // í˜„ì¬ ì„ íƒëœ ê·¸ë£¹ì´ ë©€í‹° ì´ë²¤íŠ¸ì¸ì§€ í™•ì¸\n                    const group = groupData.find(g => g.group_no == selectedGroup);\n                    if (group && group.is_multi) {\n                        // ë©€í‹° ì´ë²¤íŠ¸ì¸ ê²½ìš° ê° ì´ë²¤íŠ¸ë³„ë¡œ ê°œë³„ ì—…ë°ì´íŠ¸\n                        group.events.forEach(evt => {\n                            const eventKey = evt.detail_no || evt.no;\n                            updateJudgeStatus(eventKey);\n                        });\n                    } else {\n                        // ì‹±ê¸€ ì´ë²¤íŠ¸ì¸ ê²½ìš° í˜„ì¬ ì´ë²¤íŠ¸ë§Œ ì—…ë°ì´íŠ¸\n                        updateJudgeStatus(selectedEvent);\n                    }\n                }\n            }, 2000);\n        }\n        \n        // ì„ ìˆ˜ ê´€ë¦¬ ëª¨ë‹¬ ì—´ê¸°\n        function openPlayerModal(eventId) {\n            currentEventForPlayerModal = eventId;\n            document.getElementById('playerModalBg').style.display = 'flex';\n            \n            // í˜„ì¬ ì„ ìˆ˜ ëª©ë¡ ë¡œë“œ\n            loadCurrentPlayers(eventId);\n        }\n        \n        // ì„ ìˆ˜ ê´€ë¦¬ ëª¨ë‹¬ ë‹«ê¸°\n        function closePlayerModal() {\n            document.getElementById('playerModalBg').style.display = 'none';\n            currentEventForPlayerModal = null;\n            currentPlayers = [];\n        }\n        \n        // í˜„ì¬ ì„ ìˆ˜ ëª©ë¡ ë¡œë“œ\n        function loadCurrentPlayers(eventId) {\n            const compId = '<?=$comp_id?>';\n            fetch(`https://www.danceoffice.net/comp/get_players.php?comp_id=${compId}&event_no=${eventId}`)\n                .then(response => response.json())\n                .then(data => {\n                    if (data.success) {\n                        currentPlayers = data.players || [];\n                        updatePlayersList();\n                    }\n                })\n                .catch(error => {\n                    console.error('Error loading players:', error);\n                    currentPlayers = [];\n                    updatePlayersList();\n                });\n        }\n        \n        // ì„ ìˆ˜ ëª©ë¡ ì—…ë°ì´íŠ¸\n        function updatePlayersList() {\n            const playersList = document.getElementById('playersList');\n            if (currentPlayers.length === 0) {\n                playersList.innerHTML = '<div style=\"color:#666; font-style:italic;\">ë“±ë¡ëœ ì„ ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';\n            } else {\n                playersList.innerHTML = currentPlayers.map(player => `\n                    <div style=\"display:flex; justify-content:space-between; align-items:center; padding:0.3em; border-bottom:1px solid #eee;\">\n                        <span>${player.number} (${player.type === 'couple' ? 'ì»¤í”Œ' : 'ì‹±ê¸€'})</span>\n                        <button onclick=\"removePlayer(${player.number})\" style=\"background:#dc3545; color:white; border:none; padding:0.2em 0.5em; border-radius:3px; cursor:pointer;\">X</button>\n                    </div>\n                `).join('');\n            }\n        }\n        \n        // ì„ ìˆ˜ ì œê±°\n        function removePlayer(playerNumber) {\n            currentPlayers = currentPlayers.filter(p => p.number != playerNumber);\n            updatePlayersList();\n        }\n        \n        // ì„ ìˆ˜ ì¶”ê°€ (ì…ë ¥ ì²˜ë¦¬)\n        function addPlayers() {\n            const input = document.getElementById('playerInput').value.trim();\n            if (!input) return;\n            \n            const newPlayers = parsePlayerInput(input);\n            newPlayers.forEach(playerNum => {\n                if (!currentPlayers.find(p => p.number == playerNum)) {\n                    // ì„ ìˆ˜ ë²ˆí˜¸ë¡œ ì „ì²´ ì„ ìˆ˜ ë°ì´í„°ì—ì„œ ì •ë³´ ì°¾ê¸°\n                    const allPlayers = <?=json_encode($all_players)?>;\n                    const playerData = allPlayers[playerNum];\n                    \n                    let playerName = `ì„ ìˆ˜ ${playerNum}`;\n                    let playerType = 'single';\n                    \n                    if (playerData) {\n                        const isCouple = playerData.female && playerData.female.trim() !== '';\n                        playerName = playerData.male + (playerData.female ? ' & ' + playerData.female : '');\n                        playerType = isCouple ? 'couple' : 'single';\n                    }\n                    \n                    currentPlayers.push({\n                        number: playerNum,\n                        name: playerName,\n                        type: playerType\n                    });\n                }\n            });\n            \n            document.getElementById('playerInput').value = '';\n            updatePlayersList();\n        }\n        \n        // ì„ ìˆ˜ ì…ë ¥ íŒŒì‹± (ë²”ìœ„ ì§€ì›)\n        function parsePlayerInput(input) {\n            const players = [];\n            const parts = input.split(',');\n            \n            parts.forEach(part => {\n                part = part.trim();\n                if (part.includes('~')) {\n                    const [start, end] = part.split('~').map(n => parseInt(n.trim()));\n                    if (!isNaN(start) && !isNaN(end)) {\n                        for (let i = start; i <= end; i++) {\n                            players.push(i);\n                        }\n                    }\n                } else {\n                    const num = parseInt(part);\n                    if (!isNaN(num)) {\n                        players.push(num);\n                    }\n                }\n            });\n            \n            return players;\n        }\n        \n        // ì„ ìˆ˜ ì €ì¥\n        function savePlayers() {\n            if (!currentEventForPlayerModal) return;\n            \n            const compId = '<?=$comp_id?>';\n            const formData = new FormData();\n            formData.append('comp_id', compId);\n            formData.append('event_no', currentEventForPlayerModal);\n            formData.append('players', JSON.stringify(currentPlayers));\n            \n            fetch('https://www.danceoffice.net/comp/save_players.php', {\n                method: 'POST',\n                body: formData\n            })\n            .then(response => response.json())\n            .then(data => {\n                if (data.success) {\n                    alert('ì„ ìˆ˜ ëª©ë¡ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');\n                    closePlayerModal();\n                    // ì¹´ë“œ ìƒˆë¡œê³ ì¹¨\n                    if (selectedEvent) {\n                        updateRightPanel(selectedEvent, selectedGroup);\n                    }\n                } else {\n                    alert('ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + (data.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));\n                }\n            })\n            .catch(error => {\n                console.error('Error saving players:', error);\n                alert('ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n            });\n        }\n        \n        // ì‹¬ì‚¬ìœ„ì› ì œì™¸/í¬í•¨ í† ê¸€\n        function toggleAdjudicator(eventNo, judgeCode) {\n            if (!disabledJudgesByEvent[eventNo]) {\n                disabledJudgesByEvent[eventNo] = [];\n            }\n            const arr = disabledJudgesByEvent[eventNo];\n            const idx = arr.indexOf(judgeCode);\n            if (idx === -1) {\n                arr.push(judgeCode);\n            } else {\n                arr.splice(idx, 1);\n            }\n            \n            // í•´ë‹¹ ì´ë²¤íŠ¸ì˜ ì¹´ë“œ ìƒˆë¡œê³ ì¹¨\n            if (selectedEvent === eventNo) {\n                updateRightPanel(selectedEvent, selectedGroup);\n            }\n        }\n        \n        \n        // ì…ë ¥ í•„ë“œì—ì„œ Enter í‚¤ ì²˜ë¦¬\n        document.addEventListener('DOMContentLoaded', function() {\n            const playerInput = document.getElementById('playerInput');\n            if (playerInput) {\n                playerInput.addEventListener('keypress', function(e) {\n                    if (e.key === 'Enter') {\n                        addPlayers();\n                    }\n                });\n            }\n        });\n        \n\n        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì²« ë²ˆì§¸ ê·¸ë£¹ í™•ì¥ ë° ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ ì‹œì‘\n        document.addEventListener('DOMContentLoaded', function() {\n            const firstGroup = document.querySelector('.event-group');\n            if (firstGroup) {\n                const groupNo = firstGroup.dataset.group;\n                toggleGroup(groupNo);\n                \n                // ì²« ë²ˆì§¸ ì´ë²¤íŠ¸ ìë™ ì„ íƒ\n                const firstEvent = firstGroup.querySelector('.event-item');\n                if (firstEvent) {\n                    const eventId = firstEvent.dataset.event;\n                    const groupId = firstEvent.dataset.group;\n                    selectEvent(eventId, groupId, firstEvent);\n                }\n            }\n\n            // ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ ì‹œì‘\n            startJudgeStatusMonitoring();\n        });\n</script>\n</body>\n</html>\n","size_bytes":99558},"comp/live_panel_mc.php":{"content":"<?php\n$comp_id = $_GET['comp_id'] ?? '';\n$data_dir = __DIR__ . \"/data/$comp_id\";\n$info_file = \"$data_dir/info.json\";\n$runorder_file = \"$data_dir/RunOrder_Tablet.txt\";\n$adjudicator_file = \"$data_dir/adjudicators.txt\";\n$panel_map_file = \"$data_dir/panel_list.json\";\n$dancename_file = \"$data_dir/DanceName.txt\";\n\nrequire_once 'detail_numbers_manager.php';\n\n// --- ëŒ„ìŠ¤ì¢…ëª© ì•½ì–´->ì´ë¦„ ë§¤í•‘ (DanceName.txt ê¸°ì¤€) ---\n$dance_map_en = [];\nif (is_file($dancename_file)) {\n    foreach (file($dancename_file) as $line) {\n        $cols = array_map('trim', explode(',', $line));\n        if (count($cols) < 3 || $cols[2] == '-' || $cols[2] == '') continue;\n        $dance_map_en[$cols[2]] = $cols[1];\n    }\n}\n\n// ëŒ€íšŒ ì •ë³´ ë¡œë“œ\nif (!preg_match('/^\\d{8}-\\d+$/', $comp_id) || !is_file($info_file)) {\n    echo \"<h1>ì˜ëª»ëœ ëŒ€íšŒ ID ë˜ëŠ” ëŒ€íšŒ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</h1>\";\n    exit;\n}\n$info = json_decode(file_get_contents($info_file), true);\n\n// --- ì´ë²¤íŠ¸ ëª©ë¡/íŒ¨ë„ ì •ë³´ ë° ì¢…ëª© ---\n$events = [];\nif (file_exists($runorder_file)) {\n    $lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        if (preg_match('/^bom/', $line)) continue;\n        $cols = array_map('trim', explode(',', $line));\n        $no = $cols[0] ?? '';\n        $desc = $cols[1] ?? '';\n        $roundtype = $cols[2] ?? '';\n        $panel = isset($cols[11]) ? strtoupper($cols[11]) : '';\n        $recall = $cols[4] ?? '';\n        $heats = $cols[12] ?? '';\n        // 6ë²ˆì§¸ í•„ë“œëŠ” \"5\" ë“± ìˆ«ìì´ë¯€ë¡œ, 7~11ë²ˆì§¸(W,T,V,S,Q ë“±)ë§Œ ì¶”ì¶œ\n        $dance_codes = [];\n        for ($i=6; $i<=10; $i++) {\n            if (isset($cols[$i]) && preg_match('/^[A-Z\\.]{1,6}$/', $cols[$i]) && $cols[$i]!='AD' && $cols[$i]!='2') {\n                // BOM ì œê±°\n                $codestr = $cols[$i];\n                if (substr($codestr, 0, 3) === \"\\xEF\\xBB\\xBF\") $codestr = substr($codestr, 3);\n                $dance_codes[] = $codestr;\n            }\n        }\n        $events[] = [\n            'no' => $no,\n            'desc' => $desc,\n            'round' => $roundtype,\n            'panel' => $panel,\n            'recall' => $recall,\n            'heats' => $heats,\n            'dances' => $dance_codes\n        ];\n    }\n}\n\n// ì„¸ë¶€ë²ˆí˜¸ ì¶”ê°€\nforeach ($events as $idx => &$event) {\n    $event['detail_no'] = getDetailNumber($comp_id, $event['no'], $event['desc']);\n}\n\n// íŒ€ìˆ˜ ìë™ ê³„ì‚° í•¨ìˆ˜ (ì„¸ë¶€ë²ˆí˜¸ë³„)\nfunction calculateTeamCountByDetail($comp_id, $detail_no) {\n    // ì„¸ë¶€ë²ˆí˜¸ë³„ ì„ ìˆ˜ ë°ì´í„° í™•ì¸\n    $players = getPlayersByDetailNumber($comp_id, $detail_no);\n    if (!empty($players)) {\n        return count($players);\n    }\n    \n    // players_{detail_no}.txt íŒŒì¼ì—ì„œ ì„ ìˆ˜ ìˆ˜ ê³„ì‚°\n    $players_file = __DIR__ . \"/data/$comp_id/players_{$detail_no}.txt\";\n    if (file_exists($players_file)) {\n        $lines = file($players_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n        $count = 0;\n        foreach ($lines as $line) {\n            $line = trim($line);\n            if (!empty($line)) {\n                $count++;\n            }\n        }\n        return $count > 0 ? $count : '-';\n    }\n    \n    return '-';\n}\n\n// ê¸°ì¡´ í•¨ìˆ˜ (í•˜ìœ„ í˜¸í™˜ì„± ìœ ì§€)\nfunction calculateTeamCount($comp_id, $event_no, $players_by_event) {\n    // ì„ ìˆ˜ ë°ì´í„°ê°€ ìˆìœ¼ë©´ ì„ ìˆ˜ ìˆ˜ ë°˜í™˜\n    if (isset($players_by_event[$event_no]) && !empty($players_by_event[$event_no])) {\n        return count($players_by_event[$event_no]);\n    }\n    \n    // players_{event_no}.txt íŒŒì¼ì—ì„œ ì„ ìˆ˜ ìˆ˜ ê³„ì‚°\n    $players_file = __DIR__ . \"/data/$comp_id/players_{$event_no}.txt\";\n    if (file_exists($players_file)) {\n        $lines = file($players_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n        $count = 0;\n        foreach ($lines as $line) {\n            $line = trim($line);\n            if (!empty($line)) {\n                $count++;\n            }\n        }\n        return $count > 0 ? $count : '-';\n    }\n    \n    // í´ë°±: ì „ì²´ players.txtì—ì„œ ê³„ì‚°\n    $players_file = __DIR__ . \"/data/$comp_id/players.txt\";\n    if (file_exists($players_file)) {\n        $lines = file($players_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n        $count = 0;\n        foreach ($lines as $line) {\n            $cols = array_map('trim', explode(',', $line));\n            if (count($cols) >= 3 && !empty($cols[1]) && !empty($cols[2])) {\n                $count++;\n            }\n        }\n        return $count > 0 ? $count : '-';\n    }\n    \n    return '-';\n}\n\n// --- ì‹¬ì‚¬ìœ„ì› ìƒì„¸ ëª©ë¡ adjudicators.txt (ë²ˆí˜¸,ì´ë¦„,êµ­ê°€,ID) ---\n$adjudicator_dict = [];\nif (file_exists($adjudicator_file)) {\n    $lines = file($adjudicator_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        $cols = array_map('trim', explode(',', $line));\n        if (count($cols) < 2) continue;\n        $code = (string)$cols[0];\n        $adjudicator_dict[$code] = [\n            'code' => $cols[0],\n            'name' => $cols[1],\n            'nation' => $cols[2] ?? '',\n            'id' => $cols[3] ?? ''\n        ];\n    }\n}\n\n// --- íŒ¨ë„-ì‹¬ì‚¬ìœ„ì› ë§¤í•‘ panel_list.json [{panel_code, adj_code}] ---\n$panel_map = [];\nif (file_exists($panel_map_file)) {\n    $panel_map = json_decode(file_get_contents($panel_map_file), true);\n}\n\n// --- ì„ ìˆ˜ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° (ì´ë²¤íŠ¸ë³„) ---\n$players_by_event = [];\nforeach ($events as $ev) {\n    $eno = $ev['no'];\n    // BOM ì œê±°\n    if (substr($eno, 0, 3) === \"\\xEF\\xBB\\xBF\") $eno = substr($eno, 3);\n    $pfile = \"$data_dir/players_$eno.txt\";\n    if (is_file($pfile)) {\n        $players_by_event[$eno] = array_filter(array_map('trim', file($pfile)));\n    } else {\n        $players_by_event[$eno] = [];\n    }\n}\n\n// --- ì „ì²´ ì„ ìˆ˜ëª…ë‹¨ players.txt (ë“±ë²ˆí˜¸,ë‚¨ì,ì—¬ì) ---\n$players_file = \"$data_dir/players.txt\";\n$all_players = [];\nif (file_exists($players_file)) {\n    $lines = file($players_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        $cols = array_map('trim', explode(',', $line));\n        $all_players[$cols[0]] = [\n            'male' => $cols[1] ?? '',\n            'female' => $cols[2] ?? '',\n        ];\n    }\n}\n\nfunction h($s) { return htmlspecialchars($s ?? ''); }\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title><?= h($info['title']) ?> ì‚¬íšŒì ì»¨íŠ¸ë¡¤ íŒ¨ë„</title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\n    <style>\n        html, body { height:100%; margin:0; padding:0; }\n        body { background:#1a1a1a; font-family:sans-serif; margin:0; height:100vh; }\n        .live-root { width:100vw; height:100vh; min-height:100vh; min-width:100vw; background:#bdbdbd; margin:0; padding:0; display: flex; flex-direction:column; align-items:stretch; justify-content:stretch; }\n        .live-frame { width:100vw; height:100vh; min-height:100vh; min-width:100vw; background: #fff; border: 0; box-sizing: border-box; display: flex; flex-direction: row; overflow: hidden; border-radius: 0; box-shadow: none; }\n        .side-events {\n            flex: 0 0 25vw;\n            min-width: 220px;\n            max-width: 35vw;\n            background: #ededed;\n            border-right: 3px solid #071d6e;\n            overflow-y: auto;\n            padding: 0.7em 0.2em 0.7em 0.7em;\n            box-sizing: border-box;\n        }\n        .side-events h2 { font-size: 1.09em; margin: 0.2em 0 0.5em 0.2em; color: #071d6e; letter-spacing:0.1em;}\n        .event-list { width: 100%; border-collapse: collapse; font-size: 1em;}\n        .event-list tr.selected { background: #d0e6ff; }\n        .event-list tr:hover { background: #e6f1ff; cursor:pointer;}\n        .event-list td { border-bottom: 1px solid #c7d1e0; padding: 0.28em 0.3em; color: #222; font-size: 0.96em;}\n        .main-panel { flex: 1 1 0; display: flex; flex-direction: column; background: #0d2c96; padding: 0; width: 75vw; min-width:0; }\n        .event-header-panel {\n            background: #bdbdbd;\n            border: 3px solid #071d6e;\n            border-radius: 0 0 16px 16px;\n            padding: 0.8em 1.2em;\n            margin: 0 0 1.2em 0;\n            display: flex;\n            flex-direction: row;\n            align-items: center;\n            justify-content: center;\n            gap: 0.8em;\n            width: 100%;\n            box-sizing: border-box;\n            min-height: 130px;\n        }\n        .event-header-box { background: #bdbdbd; border: 3px solid #071d6e; border-radius: 6px; padding: 0.5em 0.8em; width: 100%; max-width: 900px; min-width: 300px; font-family: Arial, sans-serif; margin-right: 0; box-sizing: border-box;}\n        .event-row1, .event-row2 { display: flex; align-items: center; gap: 0.6em; margin-bottom: 0.25em;}\n        .event-row2 {margin-bottom: 0;}\n        .ev-arrow-btn { width: 1.8em; height: 1.8em; background: #fff; border: 2px solid #333; border-radius: 3px; padding: 0; margin: 0; font-size: 1.05em; font-weight: 700; display: flex; align-items: center; justify-content: center; cursor: pointer;}\n        .ev-arrow-btn:active {background:#dfdfdf;}\n        .ev-idx {width: 2.2em; text-align: center; font-size: 1.15em; border: 1.5px solid #333; border-radius: 2px; background:#fff;}\n        .ev-title {flex:1; font-size: 1.02em; font-weight: 600; background:#fff; border:1.5px solid #333; border-radius:6px; padding:0.18em 0.6em; min-height: 2em;}\n        .ev-refresh-btn { background: #fff; border:2px solid #071d6e; border-radius: 8px; width:2.6em; height:2.6em; display:flex; align-items:center; justify-content:center; cursor:pointer; font-size:1.6em; margin-left:0;}\n        .ev-refresh-btn:active {background:#e5e5e5;}\n        .ev-fromto, .ev-recall, .ev-heats { background:#fff; border:1px solid #222; border-radius:6px; font-size:0.95em; width:3.0em; text-align:center; padding:0.18em 0.28em;}\n        .ev-fromto {width:3.2em;}\n        .ev-label-bold {font-weight:700;}\n        .ev-ctrl-btn {background:none;border:none;padding:0;margin:0;}\n        .ev-row2-label {font-size: 0.9em; min-width: 2.4em; color:#0d2c96; font-weight:600;}\n        .event-row2 { flex-wrap: wrap; }\n        .main-content-row { display: flex; flex-direction: row; gap: 1.2em; height: 93%;}\n        .adjudicator-list-panel { flex: 1.3; background: #eaf0ff; border-radius: 8px; margin-top: 0.2em; padding: 1em 1em 1em 1em; min-width: 220px; max-width: 340px; box-sizing: border-box; display: flex; flex-direction: column; align-items: stretch;}\n        .adjudicator-list-panel h3 { font-size: 1.1em; color: #0d2c96; margin: 0 0 0.6em 0;}\n        .adjudicator-list { list-style: none; padding:0; margin:0;}\n        .adjudicator-list li { margin-bottom: 0.28em; padding: 0.13em 0.2em; background: #fff; border-radius: 4px; font-size: 0.97em; color: #282828; display: flex; align-items: center; justify-content: space-between;}\n        .adjudicator-list li.disabled { color: #aaa; text-decoration: line-through; background: #f5f5f5;}\n        .adjudicator-x-btn { background:#dc3232;color:#fff;border:none;border-radius:3px;padding:2px 8px;font-size:1em;cursor:pointer;margin-left:0.5em;}\n        .adjudicator-x-btn:disabled {background:#ccc; color:#888; cursor:default;}\n        .adjudicator-list-panel .empty {color:#888; margin-top:0.7em; font-size:0.98em;}\n        .player-dance-row { display: flex; flex-direction: row; gap: 2.2em; align-items: flex-start;}\n        .player-list-panel { flex: 1.1; background: #f5f5fa; border-radius: 8px; margin-top: 0.2em; padding: 1em 1em 1em 1em; min-width: 180px; max-width: 260px; box-sizing: border-box; display: flex; flex-direction: column; align-items: stretch;}\n        .player-list-panel h3 { font-size:1.1em; color:#0d2c96; margin:0 0 0.6em 0;}\n        .player-list-panel .player-controls-row {\n            display: flex;\n            gap: 0.6em;\n            margin-bottom: 0.8em;\n            align-items: center;\n            flex-wrap: wrap;\n        }\n        .player-list {list-style:none; padding:0; margin:0;}\n        .player-list li {margin-bottom:0.3em; padding:0.17em 0.3em; background:#fff; border-radius:4px; font-size:1.04em; display:flex; align-items:center; justify-content:space-between;}\n        .add-player-btn, .show-entry-list-btn {\n            background: #1c7aee;\n            color: #fff;\n            border: none;\n            border-radius: 4px;\n            padding: 0.37em 1.15em;\n            font-size: 1em;\n            font-weight: 500;\n            cursor: pointer;\n            height: 2.3em;\n            box-sizing: border-box;\n            transition: background 0.13s;\n            display:inline-flex; align-items:center; justify-content:center;\n        }\n        .add-player-btn:active, .show-entry-list-btn:active {background:#155cb0;}\n        .show-entry-list-btn {\n            background: #29a950;\n        }\n        .show-entry-list-btn:active {\n            background: #176c32;\n        }\n        .player-x-btn { background:#dc3232;color:#fff;border:none;border-radius:3px;padding:2px 8px;font-size:1em;cursor:pointer;margin-left:0.5em;}\n        .dance-block {\n            background: #fff;\n            border: 2px solid #e9b200;\n            border-radius: 8px;\n            padding: 1em 1.6em;\n            font-size: 1.12em;\n            color: #b36b00;\n            font-weight: 600;\n            min-width: 180px;\n            min-height: 120px;\n            box-shadow: 0 4px 24px #ffe09460;\n            display: flex;\n            flex-direction: column;\n            align-items: flex-start;\n            gap: 0.15em;\n        }\n        .dance-block .dance-title {\n            font-size: 1.08em;\n            color: #e9b200;\n            font-weight: bold;\n            margin-bottom: 0.55em;\n            letter-spacing: 0.05em;\n        }\n        .dance-block .dance-list {\n            margin-left: 0.2em;\n            width: 100%;\n        }\n        .dance-block .dance-item {\n            font-size: 1.05em;\n            color: #885e00;\n            margin-bottom: 0.12em;\n            line-height: 1.6;\n            display: flex;\n            align-items: center;\n            justify-content: space-between;\n            gap: 0.7em;\n            width: 100%;\n        }\n        .done-btn {\n            margin-left:0.7em; padding:0.2em 1.1em; border-radius:5px; border:1.5px solid #e9b200; font-weight:bold;\n            background:#fff; color:#b36b00; cursor:pointer; font-size:1em;\n        }\n        .done-btn.done {\n            background: #ffe082;\n            color: #b36b00;\n        }\n        @media (max-width: 860px) {\n            .event-header-panel { flex-direction: column; align-items: stretch; gap: 0.8em; min-height: unset; }\n            .ev-refresh-btn { align-self: center; }\n        }\n    </style>\n</head>\n<body>\n<div class=\"live-root\">\n    <div class=\"live-frame\">\n        <!-- ì´ë²¤íŠ¸ ë¦¬ìŠ¤íŠ¸ (ì¢Œì¸¡) -->\n        <div class=\"side-events\">\n            <h2>ì´ë²¤íŠ¸ ë¦¬ìŠ¤íŠ¸</h2>\n            <table class=\"event-list\" id=\"event-table\">\n                <thead>\n                    <tr>\n                        <th style=\"width:3em;\">ë²ˆí˜¸</th>\n                        <th style=\"min-width:6em;\">ì´ë²¤íŠ¸ëª…</th>\n                        <th style=\"width:6em;\">ë¼ìš´ë“œ</th>\n                        <th style=\"width:3em;\">íŒ€ìˆ˜</th>\n                    </tr>\n                </thead>\n                <tbody>\n                <?php foreach($events as $ix=>$evt): ?>\n                    <tr data-idx=\"<?=$ix?>\">\n                        <td><?=h($evt['detail_no'])?></td>\n                        <td><?=h($evt['desc'])?></td>\n                        <td><?=h($evt['round'])?></td>\n                        <td><?=h(calculateTeamCountByDetail($comp_id, $evt['detail_no']))?></td>\n                    </tr>\n                <?php endforeach; ?>\n                </tbody>\n            </table>\n        </div>\n        <!-- ë©”ì¸ ì»¨íŠ¸ë¡¤ (ê°€ìš´ë°) -->\n        <div class=\"main-panel\">\n            <!-- ìƒë‹¨: ì´ë²¤íŠ¸ í—¤ë” -->\n            <div class=\"event-header-panel\">\n                <div class=\"event-header-box\">\n                    <div class=\"event-row1\">\n                        <button class=\"ev-arrow-btn\" id=\"evtPrev\" title=\"ì´ì „ ì´ë²¤íŠ¸\"><span style=\"font-size:1.1em;\">â–²</span></button>\n                        <input type=\"text\" class=\"ev-idx\" id=\"evtNo\" readonly>\n                        <input type=\"text\" class=\"ev-title\" id=\"evtName\" readonly>\n                        <button class=\"ev-arrow-btn\" id=\"evtNext\" title=\"ë‹¤ìŒ ì´ë²¤íŠ¸\"><span style=\"font-size:1.1em;\">â–¼</span></button>\n                    </div>\n                    <div class=\"event-row2\">\n                        <span class=\"ev-row2-label\">From</span>\n                        <input type=\"text\" class=\"ev-fromto\" id=\"evtFrom\" value=\"\">\n                        <span class=\"ev-row2-label\">To</span>\n                        <input type=\"text\" class=\"ev-fromto\" id=\"evtTo\" value=\"\">\n                        <button class=\"ev-ctrl-btn\" id=\"evtRangeMove\" title=\"ë²”ìœ„ ì´ë™\" style=\"margin-right:0.6em;\"><span style=\"font-size:1.2em;\">â©</span></button>\n                        <span class=\"ev-row2-label\">Recall</span>\n                        <input type=\"text\" class=\"ev-recall\" id=\"evtRecall\" value=\"\">\n                        <span class=\"ev-row2-label\" style=\"margin-left:0.4em;\">Heats</span>\n                        <input type=\"text\" class=\"ev-heats\" id=\"evtHeats\" value=\"\">\n                    </div>\n                </div>\n                <button class=\"ev-refresh-btn\" id=\"evtRefresh\" title=\"ìƒˆë¡œê³ ì¹¨\">â†»</button>\n            </div>\n            <!-- ì¤‘ë‹¨: ì‹¬ì‚¬ìœ„ì›/ì„ ìˆ˜+ì¢…ëª© -->\n            <div class=\"main-content-row\">\n                <!-- ì‹¬ì‚¬ìœ„ì› ë¦¬ìŠ¤íŠ¸ (ì¢Œ) -->\n                <div class=\"adjudicator-list-panel\" id=\"adjudicator-list-panel\">\n                    <h3>ì‹¬ì‚¬ìœ„ì›</h3>\n                    <table style=\"width:100%;\">\n                        <thead>\n                            <tr>\n                                <th style=\"width:2.1em;\">#</th>\n                                <th style=\"width:3.2em;\">ì½”ë“œ</th>\n                                <th style=\"min-width:6em;\">ì‹¬ì‚¬ìœ„ì›ëª…</th>\n                                <th style=\"width:2.2em;\">êµ­ê°€</th>\n                                <th style=\"width:2.2em;\">X</th>\n                            </tr>\n                        </thead>\n                        <tbody id=\"adjudicator-list\">\n                            <!-- ì‹¬ì‚¬ìœ„ì› í–‰ì´ JSë¡œ ë“¤ì–´ê° -->\n                        </tbody>\n                    </table>\n                    <div class=\"empty\" id=\"judge-empty\" style=\"display:none;\">ì‹¬ì‚¬ìœ„ì›ì´ ì—†ìŠµë‹ˆë‹¤</div>\n                </div>\n                <!-- ì„ ìˆ˜+ì¢…ëª© (ìš°) -->\n                <div class=\"player-dance-row\">\n                    <div class=\"player-list-panel\" id=\"player-list-panel\">\n                        <h3>ì„ ìˆ˜</h3>\n                        <div class=\"player-controls-row\">\n                            <button class=\"add-player-btn\" onclick=\"openPlayerModal()\">ì„ ìˆ˜ ì¶”ê°€</button>\n                            <button class=\"show-entry-list-btn\" onclick=\"showEntryPlayers()\">ì¶œì „ì„ ìˆ˜</button>\n                        </div>\n                        <ul class=\"player-list\" id=\"player-list\"></ul>\n                    </div>\n                </div>\n                <!-- ì§„í–‰ì¢…ëª©(ëŒ„ìŠ¤) ì™„ë£Œ ì²´í¬ UI -->\n            <div class=\"dance-block\" id=\"dance-block\">\n                <div class=\"dance-title\">ì§„í–‰ì¢…ëª©</div>\n                <div class=\"dance-list\" id=\"dance-list\"></div>\n            </div>\n            </div>\n        </div>\n    </div>\n    <!-- ì„ ìˆ˜ ì¶”ê°€ ëª¨ë‹¬ -->\n    <div class=\"modal-bg\" id=\"playerModalBg\" style=\"display:none; position:fixed; left:0; top:0; width:100vw; height:100vh; background:rgba(0,0,0,0.3); align-items:center; justify-content:center; z-index:100;\">\n        <div class=\"modal\" style=\"background:#fff; border-radius:10px; padding:2em 2.2em; box-shadow:0 10px 40px #0002; min-width:260px;\">\n            <div class=\"modal-title\">ì„ ìˆ˜ ë“±ë²ˆí˜¸ ì¶”ê°€<br><span style=\"font-size:0.9em;color:#888;\">(ì˜ˆ: 10, 23, 10~18 ì…ë ¥ ê°€ëŠ¥)</span></div>\n            <input type=\"text\" id=\"playerInput\" placeholder=\"ë“±ë²ˆí˜¸ë‚˜ ë²”ìœ„ë¥¼ ì…ë ¥í•˜ì„¸ìš”\" style=\"font-size:1.1em; padding:0.3em 0.6em; border:1.5px solid #aaa;\" autocomplete=\"off\">\n            <div class=\"modal-btns\" style=\"margin-top:1em; text-align:right;\">\n                <button type=\"button\" onclick=\"closePlayerModal()\" style=\"font-size:1.08em; margin-left:0.9em; border-radius:4px; padding:0.29em 1.3em;\">ë‹«ê¸°</button>\n                <button type=\"button\" onclick=\"saveAndClosePlayerModal()\" style=\"font-size:1.08em; margin-left:0.9em; border-radius:4px; padding:0.29em 1.3em;\">ì €ì¥</button>\n            </div>\n        </div>\n    </div>\n    <!-- ì¶œì „ì„ ìˆ˜ ëª¨ë‹¬ -->\n    <div class=\"modal-bg\" id=\"entryPlayersModalBg\" style=\"display:none; position:fixed; left:0; top:0; width:100vw; height:100vh; background:rgba(0,0,0,0.3); align-items:center; justify-content:center; z-index:100;\">\n        <div class=\"modal\" style=\"background:#fff; border-radius:10px; padding:2em 2.2em; box-shadow:0 10px 40px #0002; min-width:340px;\">\n            <div class=\"modal-title\">ì¶œì „ì„ ìˆ˜ ë¦¬ìŠ¤íŠ¸</div>\n            <table style=\"margin-top:1em; width:100%; border-collapse:collapse;\" id=\"entryPlayersTable\">\n                <thead>\n                    <tr>\n                        <th style=\"width:4em\">ë“±ë²ˆí˜¸</th>\n                        <th>ë‚¨ìì„ ìˆ˜</th>\n                        <th>ì—¬ìì„ ìˆ˜</th>\n                    </tr>\n                </thead>\n                <tbody></tbody>\n            </table>\n            <div style=\"margin-top:1em; text-align:right;\">\n                <button onclick=\"closeEntryPlayersModal()\" style=\"font-size:1.08em; border-radius:4px; padding:0.29em 1.3em;\">ë‹«ê¸°</button>\n            </div>\n        </div>\n        \n    </div>\n\n</div>\n<script>\nconst events = <?=json_encode($events, JSON_UNESCAPED_UNICODE)?>;\nconst panelMap = <?=json_encode($panel_map, JSON_UNESCAPED_UNICODE)?>;\nconst allAdjudicators = <?=json_encode($adjudicator_dict, JSON_UNESCAPED_UNICODE)?>;\nconst allPlayers = <?=json_encode($all_players, JSON_UNESCAPED_UNICODE)?>;\nconst danceMapEn = <?=json_encode($dance_map_en, JSON_UNESCAPED_UNICODE)?>;\nlet curIdx = 0;\nlet disabledJudgesByEvent = {};\nlet playersByEvent = <?=json_encode($players_by_event, JSON_UNESCAPED_UNICODE)?>;\n\n// ì§„í–‰ì¢…ëª©(ëŒ„ìŠ¤) ì™„ë£Œ ì²´í¬ ì¶”ê°€\nlet danceDone = {};\nfunction fetchDanceDone(eventNo) {\n    if (typeof eventNo === \"string\") eventNo = eventNo.replace(/^\\uFEFF/, \"\");\n    fetch(`get_dance_done.php?comp_id=<?=urlencode($comp_id)?>&event_no=${encodeURIComponent(eventNo)}&${Date.now()}`)\n        .then(r => {\n            if (!r.ok) {\n                throw new Error(`HTTP ${r.status}: ${r.statusText}`);\n            }\n            return r.json();\n        })\n        .then(obj => {\n            danceDone = (typeof obj === 'object' && obj !== null) ? obj : {};\n            renderDanceBlock(curIdx);\n        })\n        .catch(err => {\n            console.error('dance_done fetch error:', err);\n            danceDone = {};\n            renderDanceBlock(curIdx);\n        });\n}\nfunction toggleDanceDone(danceCode) {\n    let eventNo = events[curIdx].no;\n    if (typeof eventNo === \"string\") eventNo = eventNo.replace(/^\\uFEFF/, \"\");\n    const newDone = !(danceDone[danceCode] === true);\n    \n    // ì¦‰ì‹œ UI ì—…ë°ì´íŠ¸ (ë‚™ê´€ì  ì—…ë°ì´íŠ¸)\n    danceDone[danceCode] = newDone;\n    renderDanceBlock(curIdx);\n    \n    fetch('dance_done_update.php', {\n        method: 'POST',\n        headers: {'Content-Type':'application/x-www-form-urlencoded'},\n        body: `comp_id=<?=urlencode($comp_id)?>&event_no=${encodeURIComponent(eventNo)}&dance_code=${encodeURIComponent(danceCode)}&done=${newDone}`\n    })\n    .then(r => r.json())\n    .then(res => {\n        if (!res.success) {\n            // ì‹¤íŒ¨ ì‹œ ì›ë˜ ìƒíƒœë¡œ ë˜ëŒë¦¼\n            danceDone[danceCode] = !newDone;\n            renderDanceBlock(curIdx);\n            alert(\"ì €ì¥ ì‹¤íŒ¨: \" + (res.error || \"\"));\n        }\n    })\n    .catch(err => {\n        // ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ì‹œ ì›ë˜ ìƒíƒœë¡œ ë˜ëŒë¦¼\n        danceDone[danceCode] = !newDone;\n        renderDanceBlock(curIdx);\n        console.error('dance_done update error:', err);\n        alert(\"ì €ì¥ ì‹¤íŒ¨: ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜\");\n    });\n}\n\nfunction renderDanceBlock(eventIdx) {\n    const ev = events[eventIdx];\n    const danceListDiv = document.getElementById('dance-list');\n    let danceNames = [];\n    if (ev.dances && ev.dances.length > 0) {\n        danceNames = ev.dances.map(code => ({\n            code,\n            name: danceMapEn[code] || code,\n            done: !!danceDone[code]\n        }));\n    }\n    if (danceNames.length) {\n        danceListDiv.innerHTML = danceNames.map((d, i) =>\n            `<div class=\"dance-item\">\n                <span>${i+1}. ${d.name}</span>\n                <button class=\"done-btn${d.done?' done':''}\" onclick=\"toggleDanceDone('${d.code}')\">\n                    ${d.done?'âœ” ì™„ë£Œ':'ì™„ë£Œ'}\n                </button>\n            </div>`\n        ).join('');\n    } else {\n        danceListDiv.innerHTML = `<div class=\"dance-item\">-</div>`;\n    }\n}\n\nfunction renderAdjudicatorList(panelCode, eventNo) {\n    const judgeLinks = panelMap.filter(m => (m.panel_code||\"\").toUpperCase() === (panelCode||\"\").toUpperCase());\n    const judgeArr = judgeLinks.map(m => allAdjudicators[m.adj_code]).filter(j=>j);\n    const tbody = document.getElementById(\"adjudicator-list\");\n    const empty = document.getElementById(\"judge-empty\");\n    tbody.innerHTML = \"\";\n    if (!panelCode || judgeArr.length === 0) {\n        empty.style.display = \"\";\n        return;\n    }\n    empty.style.display = \"none\";\n    const disabled = disabledJudgesByEvent[eventNo] || [];\n    judgeArr.forEach((j, i) => {\n        const isDisabled = disabled.includes(j.code);\n        let tr = document.createElement(\"tr\");\n        tr.className = isDisabled ? \"disabled\" : \"\";\n        tr.innerHTML = `<td>${i+1}</td>\n            <td>${j.code}</td>\n            <td>${j.name}</td>\n            <td>${j.nation || ''}</td>\n            <td><button class=\"adjudicator-x-btn\" onclick=\"toggleAdjudicator('${eventNo}','${j.code}')\" title=\"ì´ ì´ë²¤íŠ¸ì—ì„œ ì‹¬ì‚¬ìœ„ì› ì œì™¸\" ${isDisabled ? 'disabled' : ''}>X</button></td>`;\n        tbody.appendChild(tr);\n    });\n}\nfunction toggleAdjudicator(eventNo, judgeCode) {\n    if(!disabledJudgesByEvent[eventNo]) disabledJudgesByEvent[eventNo] = [];\n    const arr = disabledJudgesByEvent[eventNo];\n    const idx = arr.indexOf(judgeCode);\n    if(idx === -1) arr.push(judgeCode);\n    else arr.splice(idx,1);\n    renderAdjudicatorList(events[curIdx].panel, events[curIdx].no);\n}\nfunction renderPlayerList(eventNo) {\n    const ul = document.getElementById(\"player-list\");\n    let arr = playersByEvent[eventNo] || [];\n    let sorted = arr.slice().sort((a, b) => Number(a) - Number(b));\n    ul.innerHTML = \"\";\n    if (!sorted.length) {\n        ul.innerHTML = \"<li style='color:#aaa;'>ì„ ìˆ˜ ë“±ë²ˆí˜¸ ì—†ìŒ</li>\";\n        return;\n    }\n    sorted.forEach((bib, idx) => {\n        let li = document.createElement(\"li\");\n        li.innerHTML = `${bib} <button class=\"player-x-btn\" onclick=\"removePlayer('${bib}')\">X</button>`;\n        ul.appendChild(li);\n    });\n}\nfunction openPlayerModal() {\n    document.getElementById('playerInput').value = '';\n    document.getElementById('playerModalBg').style.display = 'flex';\n    setTimeout(()=>{document.getElementById('playerInput').focus();}, 180);\n}\nfunction closePlayerModal() {\n    document.getElementById('playerModalBg').style.display = 'none';\n}\ndocument.getElementById('playerInput').onkeydown = function(e){\n    if (e.key === 'Enter') {\n        submitPlayerModal(false);\n        e.preventDefault();\n    }\n    if (e.key === 'Escape') {\n        closePlayerModal();\n    }\n};\nfunction saveAndClosePlayerModal() {\n    submitPlayerModal(true);\n}\nfunction parseBibsFromInput(input) {\n    let result = [];\n    input.split(',').forEach(part=>{\n        part = part.trim();\n        if (/^\\d+\\s*~\\s*\\d+$/.test(part)) {\n            let [start, end] = part.split('~').map(x=>parseInt(x.trim(),10));\n            if (start && end && start <= end && end-start<100) {\n                for (let i=start; i<=end; i++) result.push(String(i));\n            }\n        } else if (/^\\d+$/.test(part)) {\n            result.push(part);\n        }\n    });\n    return result;\n}\nfunction submitPlayerModal(closeAfter) {\n    let val = document.getElementById('playerInput').value.trim();\n    if (!val) {\n        if (closeAfter) closePlayerModal();\n        return;\n    }\n    let eventNo = events[curIdx].no;\n    if (typeof eventNo === \"string\") eventNo = eventNo.replace(/^\\uFEFF/, \"\");\n    if (!playersByEvent[eventNo]) playersByEvent[eventNo] = [];\n    let bibs = parseBibsFromInput(val);\n    let added = 0;\n    bibs.forEach(bib=>{\n        if (!playersByEvent[eventNo].includes(bib)) {\n            playersByEvent[eventNo].push(bib);\n            added++;\n        }\n    });\n    if (added>0) {\n        playersByEvent[eventNo] = playersByEvent[eventNo].slice().sort((a, b) => Number(a) - Number(b));\n        renderPlayerList(eventNo);\n        savePlayersToServer(eventNo);\n    }\n    if (closeAfter) {\n        closePlayerModal();\n    } else {\n        document.getElementById('playerInput').value = '';\n        setTimeout(()=>{document.getElementById('playerInput').focus();}, 100);\n    }\n}\nfunction savePlayersToServer(eventNo) {\n    fetch('save_players.php?comp_id=<?=urlencode($comp_id)?>', {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({eventNo: eventNo, players: playersByEvent[eventNo]})\n    })\n    .then(res => res.json())\n    .then(data => {\n        if(!data.success) alert(\"ì„ ìˆ˜ ì €ì¥ ì‹¤íŒ¨: \" + (data.error||\"\"));\n    });\n}\nfunction removePlayer(bib) {\n    let eventNo = events[curIdx].no;\n    if (typeof eventNo === \"string\") eventNo = eventNo.replace(/^\\uFEFF/, \"\");\n    let arr = playersByEvent[eventNo] || [];\n    playersByEvent[eventNo] = arr.filter(x => x !== bib);\n    renderPlayerList(eventNo);\n    savePlayersToServer(eventNo);\n}\nfunction showEntryPlayers() {\n    let eventNo = events[curIdx].no;\n    if (typeof eventNo === \"string\") eventNo = eventNo.replace(/^\\uFEFF/, \"\");\n    let entryBibs = playersByEvent[eventNo] || [];\n    let sorted = entryBibs.slice().sort((a,b)=>Number(a)-Number(b));\n    let tbody = document.querySelector('#entryPlayersTable tbody');\n    tbody.innerHTML = '';\n    if (!sorted.length) {\n        tbody.innerHTML = '<tr><td colspan=\"3\" style=\"color:#aaa;\">ì¶œì „ì„ ìˆ˜ ì—†ìŒ</td></tr>';\n    } else {\n        sorted.forEach(bib => {\n            let p = allPlayers[bib] || {};\n            let male = p.male || '';\n            let female = p.female || '';\n            let tr = document.createElement('tr');\n            tr.innerHTML = `<td>${bib}</td><td>${male}</td><td>${female}</td>`;\n            tbody.appendChild(tr);\n        });\n    }\n    document.getElementById('entryPlayersModalBg').style.display = 'flex';\n}\nfunction closeEntryPlayersModal() {\n    document.getElementById('entryPlayersModalBg').style.display = 'none';\n}\nfunction updatePanel(idx) {\n    if (idx < 0) idx = 0;\n    if (idx > events.length-1) idx = events.length-1;\n    curIdx = idx;\n    let ev = events[curIdx];\n    let eventNo = ev.no;\n    if (typeof eventNo === \"string\") eventNo = eventNo.replace(/^\\uFEFF/, \"\");\n    document.getElementById('evtNo').value = ev.no || '';\n    document.getElementById('evtName').value = ev.desc || '';\n    document.getElementById('evtRecall').value = ev.recall || '';\n    document.getElementById('evtHeats').value = ev.heats || '';\n    document.getElementById('evtFrom').value = '';\n    document.getElementById('evtTo').value = '';\n    document.querySelectorAll('#event-table tr').forEach(tr=>tr.classList.remove('selected'));\n    let tr = document.querySelector('#event-table tr[data-idx=\"'+curIdx+'\"]');\n    if (tr) tr.classList.add('selected');\n    renderAdjudicatorList(ev.panel, ev.no);\n    renderPlayerList(eventNo);\n    \n    // ì™„ë£Œ ìƒíƒœë¥¼ ë¨¼ì € ì´ˆê¸°í™”í•˜ê³  ì„œë²„ì—ì„œ ë¡œë“œ\n    danceDone = {};\n    fetchDanceDone(eventNo);\n}\ndocument.addEventListener(\"DOMContentLoaded\", function(){\n    document.getElementById('evtPrev').onclick = ()=>updatePanel(curIdx-1);\n    document.getElementById('evtNext').onclick = ()=>updatePanel(curIdx+1);\n    document.getElementById('evtRefresh').onclick = ()=>updatePanel(curIdx);\n    document.getElementById('evtRangeMove').onclick = ()=>{ alert('ë²”ìœ„ ì´ë™ ê¸°ëŠ¥(From~To): êµ¬í˜„ í•„ìš”'); };\n    document.querySelectorAll('#event-table tr[data-idx]').forEach(function(row) {\n        row.addEventListener('click', function(){\n            updatePanel(parseInt(this.dataset.idx));\n        });\n    });\n    if(events.length) updatePanel(0);\n});\nwindow.addEventListener('keydown', function(e){\n    if(e.key === 'Escape') closePlayerModal();\n});\n</script>\n</body>\n</html>","size_bytes":33111},"comp/login.php":{"content":"<?php\nsession_start();\nrequire_once 'auth.php';\n\n// ì´ë¯¸ ë¡œê·¸ì¸ëœ ê²½ìš° ë¦¬ë‹¤ì´ë ‰íŠ¸\nif (isset($_SESSION['user'])) {\n    $user = $_SESSION['user'];\n    if (hasPermission($user, 'create_comp')) {\n        header(\"Location: index.php\");\n    } else {\n        header(\"Location: senior_dashboard.php\");\n    }\n    exit;\n}\n\n$error = '';\n\nif ($_SERVER['REQUEST_METHOD'] === 'POST') {\n    $username = trim($_POST['username'] ?? '');\n    $password = trim($_POST['password'] ?? '');\n    \n    if ($username && $password) {\n        $user = authenticateUser($username, $password);\n        if ($user) {\n            $_SESSION['user'] = $user;\n            if (hasPermission($user, 'create_comp')) {\n                header(\"Location: index.php\");\n            } else {\n                header(\"Location: senior_dashboard.php\");\n            }\n            exit;\n        } else {\n            $error = \"ì‚¬ìš©ìëª… ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.\";\n        }\n    } else {\n        $error = \"ì‚¬ìš©ìëª…ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.\";\n    }\n}\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>ë¡œê·¸ì¸ - danceoffice.net</title>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <link href=\"https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded\" rel=\"stylesheet\" />\n    <style>\n        body {\n            background: #181B20;\n            min-height: 100vh;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            margin: 0;\n            padding: 0;\n            font-family: 'Noto Sans KR', sans-serif;\n        }\n        .login-container {\n            background: linear-gradient(135deg, #1a1d21 0%, #181B20 100%);\n            border-radius: 20px;\n            padding: 40px;\n            box-shadow: 0 20px 40px rgba(3, 199, 90, 0.2);\n            border: 2px solid #03C75A;\n            text-align: center;\n            max-width: 400px;\n            width: 90%;\n        }\n        .login-title {\n            color: #03C75A;\n            font-size: 24px;\n            margin-bottom: 10px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 10px;\n        }\n        .login-subtitle {\n            color: #00BFAE;\n            font-size: 16px;\n            margin-bottom: 30px;\n        }\n        .form-group {\n            margin-bottom: 20px;\n            text-align: left;\n        }\n        .form-group label {\n            display: block;\n            color: #F5F7FA;\n            font-size: 14px;\n            margin-bottom: 8px;\n            font-weight: 600;\n        }\n        .form-group input {\n            width: 100%;\n            padding: 12px;\n            border: 1px solid #31343a;\n            border-radius: 10px;\n            background: #222;\n            color: #F5F7FA;\n            font-size: 14px;\n            box-sizing: border-box;\n        }\n        .btn {\n            background: linear-gradient(90deg, #03C75A 70%, #00BFAE 100%);\n            color: #222;\n            border: none;\n            padding: 12px 30px;\n            border-radius: 25px;\n            font-weight: 600;\n            font-size: 14px;\n            cursor: pointer;\n            transition: all 0.3s ease;\n            width: 100%;\n        }\n        .btn:hover {\n            background: linear-gradient(90deg, #00BFAE 60%, #03C75A 100%);\n            color: white;\n            transform: translateY(-2px);\n        }\n        .error {\n            color: #ff4444;\n            background: rgba(255, 68, 68, 0.1);\n            padding: 10px;\n            border-radius: 8px;\n            margin-bottom: 15px;\n            font-size: 13px;\n        }\n        .role-info {\n            background: rgba(3, 199, 90, 0.1);\n            border-radius: 8px;\n            padding: 15px;\n            margin-top: 20px;\n            font-size: 12px;\n            color: #B0B3B8;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"login-container\">\n        <h1 class=\"login-title\">\n            <span class=\"material-symbols-rounded\">login</span>\n            ë¡œê·¸ì¸\n        </h1>\n        <p class=\"login-subtitle\">danceoffice.net ê´€ë¦¬ ì‹œìŠ¤í…œ</p>\n        <form method=\"post\">\n            <?php if ($error): ?>\n                <div class=\"error\"><?= htmlspecialchars($error) ?></div>\n            <?php endif; ?>\n            <div class=\"form-group\">\n                <label for=\"username\">ì‚¬ìš©ìëª…</label>\n                <input type=\"text\" id=\"username\" name=\"username\" placeholder=\"ì‚¬ìš©ìëª…ì„ ì…ë ¥í•˜ì„¸ìš”\" required>\n            </div>\n            <div class=\"form-group\">\n                <label for=\"password\">ë¹„ë°€ë²ˆí˜¸</label>\n                <input type=\"password\" id=\"password\" name=\"password\" placeholder=\"ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”\" required>\n            </div>\n            <button type=\"submit\" class=\"btn\">ë¡œê·¸ì¸</button>\n        </form>\n        <div class=\"role-info\">\n            <strong>ê¶Œí•œ ì•ˆë‚´:</strong><br>\n            â€¢ <strong>ì˜¤ë„ˆ</strong>: ëŒ€íšŒ ìƒì„± ë° ëª¨ë“  ê´€ë¦¬<br>\n            â€¢ <strong>ì„ ì„ê´€ë¦¬ì</strong>: ë“±ë¡ëœ ëŒ€íšŒ ê´€ë¦¬<br>\n            â€¢ <strong>ê´€ë¦¬ì</strong>: ì½˜í…ì¸  ê´€ë¦¬\n        </div>\n    </div>\n</body>\n</html>\n\n\n\n\n\n\n","size_bytes":5259},"comp/logout.php":{"content":"<?php\nsession_start();\nsession_destroy();\nheader(\"Location: login.php\");\nexit;\n?>\n\n\n\n","size_bytes":85},"comp/manage_adjudicator_panels.php":{"content":"<?php\n$comp_id = $_GET['comp_id'] ?? '';\n$data_dir = __DIR__ . \"/data/$comp_id\";\n$info_file = \"$data_dir/info.json\";\n$adjs_file = \"$data_dir/adjudicators.txt\";\n$panel_file = \"$data_dir/panel_list.json\"; // íŒ¨ë„ì½”ë“œ-ì‹¬ì‚¬ìœ„ì› json\n\nif (!preg_match('/^\\d{8}-\\d+$/', $comp_id) || !is_file($info_file)) {\n    echo \"<h1>ì˜ëª»ëœ ëŒ€íšŒ ID ë˜ëŠ” ëŒ€íšŒ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</h1>\";\n    exit;\n}\n$info = json_decode(file_get_contents($info_file), true);\n\n// ì‹¬ì‚¬ìœ„ì› ëª…ë‹¨ ë¶ˆëŸ¬ì˜¤ê¸°\n$adjudicators = [];\nif (file_exists($adjs_file)) {\n    foreach (file($adjs_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES) as $line) {\n        $parts = array_map('trim', explode(',', $line));\n        $adjudicators[] = [\n            'code' => $parts[0] ?? '',\n            'name' => $parts[1] ?? '',\n            'nation' => $parts[2] ?? '',\n            'password' => $parts[3] ?? ''\n        ];\n    }\n}\n\n// íŒ¨ë„ì½”ë“œ-ì‹¬ì‚¬ìœ„ì› ë¶ˆëŸ¬ì˜¤ê¸°\n$panel_list = [];\nif (file_exists($panel_file)) {\n    $panel_list = json_decode(file_get_contents($panel_file), true);\n    if (!is_array($panel_list)) $panel_list = [];\n}\n\n// íŒ¨ë„ì½”ë“œìˆœ ì •ë ¬\nusort($panel_list, fn($a, $b) => strcmp($a['panel_code'], $b['panel_code']));\n\n// ë©”ì‹œì§€\n$msg = \"\";\n\nif ($_SERVER['REQUEST_METHOD'] === 'POST') {\n    // íŒ¨ë„ì½”ë“œ-ì‹¬ì‚¬ìœ„ì› ì²˜ë¦¬\n    if (isset($_POST['save_panel'])) {\n        $panel_list = [];\n        foreach ($_POST['panel'] as $row) {\n            if (empty($row['panel_code']) || empty($row['adj_code'])) continue;\n            $panel_list[] = [\n                'panel_code' => trim($row['panel_code']),\n                'adj_code'   => trim($row['adj_code'])\n            ];\n        }\n        file_put_contents($panel_file, json_encode($panel_list, JSON_UNESCAPED_UNICODE|JSON_PRETTY_PRINT));\n        $msg = \"íŒ¨ë„ì½”ë“œ-ì‹¬ì‚¬ìœ„ì› ì§€ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.\";\n    }\n    // íŒ¨ë„ì½”ë“œ íŒŒì¼ ì—…ë¡œë“œ (txt/csv, panel_code,ì‹¬ì‚¬ìœ„ì›ì½”ë“œ)\n    if (isset($_POST['upload_panel_csv']) && isset($_FILES['panelfile']) && $_FILES['panelfile']['error'] == UPLOAD_ERR_OK) {\n        $lines = file($_FILES['panelfile']['tmp_name'], FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n        $new_panel_list = [];\n        foreach ($lines as $line) {\n            $parts = array_map('trim', explode(',', $line));\n            if (count($parts)<2) continue;\n            $panel_code = $parts[0];\n            $adj_code = $parts[1];\n            if ($panel_code && $adj_code) {\n                $new_panel_list[] = ['panel_code'=>$panel_code, 'adj_code'=>$adj_code];\n            }\n        }\n        $panel_list = $new_panel_list;\n        file_put_contents($panel_file, json_encode($panel_list, JSON_UNESCAPED_UNICODE|JSON_PRETTY_PRINT));\n        $msg = \"íŒ¨ë„ì½”ë“œ-ì‹¬ì‚¬ìœ„ì› ì—…ë¡œë“œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.\";\n    }\n    header(\"Location: manage_adjudicator_panels.php?comp_id=\" . urlencode($comp_id) . \"&msg=\" . urlencode($msg));\n    exit;\n}\nif (isset($_GET['msg'])) $msg = $_GET['msg'];\n\nfunction h($s) { return htmlspecialchars($s ?? ''); }\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title><?= h($info['title']) ?> ì‹¬ì‚¬ìœ„ì› íŒ¨ë„ì½”ë“œ ê´€ë¦¬ | danceoffice.net COMP</title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\n    <style>\n        body { background:#f7fafd; font-family:sans-serif; margin:0;}\n        .mainbox { max-width:950px; margin:3vh auto 0 auto; background:#fff; border-radius:18px; box-shadow:0 6px 32px #00339911; padding:2.2em 1.5em 2em 1.5em;}\n        h1 { color:#003399; font-size:1.15em; margin-bottom:0.6em;}\n        .desc {margin-bottom:1.3em; color:#333;}\n        table { width:100%; border-collapse:collapse; background:#fff;}\n        th, td { padding:0.3em 0.2em; text-align:center; font-size:0.96em;}\n        th { background:#f0f4fa; color:#003399; font-weight:700;}\n        td { color:#333;}\n        tr:not(:last-child) td { border-bottom:1px solid #eee;}\n        .panel-form-table input[type=\"text\"], .panel-form-table select {\n            padding: 0.2em 0.4em;\n            font-size: 0.97em;\n            height: 2em;\n        }\n        .panel-btns {\n            display: flex;\n            gap: 0.3em;\n            justify-content: center;\n            align-items: center;\n        }\n        .panel-add-btn, .panel-del-btn {\n            padding: 0.15em 0.7em;\n            font-size: 0.97em;\n            height: 2em;\n            min-width: 2em;\n            border-radius: 7px;\n        }\n        .panel-add-btn { background:#03C75A; color:#fff; border:none; font-weight:700; cursor:pointer;}\n        .panel-del-btn { background:#ec3b28; color:#fff; border:none; font-weight:700; cursor:pointer;}\n        .panel-add-btn:hover { background:#00BFAE;}\n        .panel-del-btn:hover { background:#b31e06;}\n        .panel-upload-form { margin:0 0 1.2em 0; display:flex; align-items:center; gap:0.7em;}\n        .panel-upload-form input[type=\"file\"] { border-radius:7px; border:1px solid #bbb; padding:0.3em;}\n        .panel-upload-form button { background:#003399; color:#fff; border:none; border-radius:8px; padding:0.4em 1.6em; font-weight:700; cursor:pointer;}\n        .panel-upload-form button:hover { background:#2222aa;}\n        .small {font-size:0.93em; color:#888; margin-left:0.8em;}\n        .goto-dash {display:inline-block; margin-bottom:1.1em; color:#888;}\n        .goto-dash:hover {color:#003399;}\n        .goto-data {color:#03C75A; margin-left:1em;}\n        .goto-data:hover {color:#009c85;}\n        .goto-adj {\n            display:inline-block; margin-left:1em; font-size:1em; color:#003399; background:#eaf3ff;\n            padding:0.38em 1.2em; border-radius:7px; text-decoration:none; font-weight:600; transition:background 0.15s;\n        }\n        .goto-adj:hover { background:#d3e9ff; color:#021b75;}\n        .print-btn { background:#666; color:#fff; font-weight:600; border:none; border-radius:8px; padding:0.3em 1.5em; margin-left:1em; cursor:pointer;}\n        .print-btn:hover { background:#003399; }\n        .print-adj-name { display:none; }\n        @media (max-width:1000px) {\n            .mainbox { max-width:99vw; padding:1.1em 0.3em;}\n            .panel-form-table input[type=\"text\"] {min-width:70px;}\n        }\n        @media print {\n            .print-btn, .panel-btns, .panel-upload-form, .goto-dash, .goto-data, .goto-adj, .msg, .desc, h1, footer { display:none !important; }\n            .mainbox { box-shadow:none !important; padding:0; }\n            table, th, td { font-size:1em; }\n            body { background:#fff !important; }\n            select { display: none !important; }\n            .print-adj-name { display: inline !important; }\n        }\n        footer {\n            position: relative;\n            width: 100%;\n            min-height: 45px;\n            margin-top: 3em;\n            background: none;\n            text-align: center;\n            font-size: 0.95em;\n            color: #aaa;\n            padding: 1em 0 1em 0;\n            box-sizing: border-box;\n            z-index: 2;\n        }\n    </style>\n    <script>\n    // ë™ì ìœ¼ë¡œ íŒ¨ë„ í–‰ ì¶”ê°€/ì‚­ì œ\n    function addPanelRow() {\n        const tb = document.getElementById('panel-table-body');\n        const row = tb.rows[0].cloneNode(true);\n        row.querySelectorAll('input,select').forEach(el => {\n            if (el.tagName === 'INPUT') el.value='';\n            if (el.tagName === 'SELECT') el.selectedIndex=0;\n        });\n        row.querySelector('.print-adj-name').textContent = '';\n        tb.appendChild(row);\n    }\n    function removePanelRow(btn) {\n        const tb = document.getElementById('panel-table-body');\n        if (tb.rows.length>1) btn.closest('tr').remove();\n        else alert(\"ìµœì†Œ 1í–‰ì€ í•„ìš”í•©ë‹ˆë‹¤.\");\n    }\n    </script>\n</head>\n<body>\n<div class=\"mainbox\">\n    <div style=\"display:flex; justify-content:space-between; align-items:center; margin-bottom:1.2em;\">\n        <div>\n            <a href=\"dashboard.php?comp_id=<?= urlencode($comp_id) ?>\" class=\"goto-dash\">&lt; ëŒ€ì‹œë³´ë“œë¡œ</a>\n            <a href=\"data_manage.php?comp_id=<?= urlencode($comp_id) ?>\" class=\"goto-data\">ë°ì´í„° ê´€ë¦¬ë¡œ &gt;</a>\n        </div>\n        <div>\n            <a href=\"manage_adjudicators.php?comp_id=<?= urlencode($comp_id) ?>\" class=\"goto-adj\">ì‹¬ì‚¬ìœ„ì› ê´€ë¦¬ë¡œ ì´ë™ &gt;</a>\n            <button type=\"button\" onclick=\"window.print()\" class=\"print-btn\">ëª…ë‹¨ ì¸ì‡„</button>\n        </div>\n    </div>\n    <h1><?= h($info['title']) ?> ì‹¬ì‚¬ìœ„ì› íŒ¨ë„ì½”ë“œ ê´€ë¦¬</h1>\n    <div class=\"desc\">\n        íŒ¨ë„ì½”ë“œì™€ ì‹¬ì‚¬ìœ„ì›ì„ ì¡°í•©í•˜ì—¬ íŒ¨ë„ì„ ë“±ë¡í•˜ì„¸ìš”.<br>\n        (ì´ë²¤íŠ¸ë³„ ë°°ì •ì€ í•„ìš”ì‹œ ë³„ë„ êµ¬í˜„)\n    </div>\n    <?php if ($msg): ?><div class=\"msg\" style=\"color:#03C75A; margin-bottom:1em;\"><?= h($msg) ?></div><?php endif; ?>\n\n    <form class=\"panel-upload-form\" method=\"post\" enctype=\"multipart/form-data\" onsubmit=\"return confirm('íŒ¨ë„ì½”ë“œ-ì‹¬ì‚¬ìœ„ì›ì½”ë“œ txt/csv íŒŒì¼ë¡œ íŒ¨ë„ì„ ì¼ê´„ ì—…ë¡œë“œí•©ë‹ˆë‹¤. ì§„í–‰í• ê¹Œìš”?');\">\n        <input type=\"file\" name=\"panelfile\" accept=\".txt,.csv\" required>\n        <button type=\"submit\" name=\"upload_panel_csv\" value=\"1\">íŒ¨ë„ TXT ì—…ë¡œë“œ</button>\n        <span class=\"small\">í˜•ì‹: íŒ¨ë„ì½”ë“œ,ì‹¬ì‚¬ìœ„ì›ì½”ë“œ (í•œ ì¤„ì— í•œ íŒ¨ë„)</span>\n    </form>\n\n    <form method=\"post\">\n    <table class=\"panel-form-table\" style=\"margin-bottom:1.8em;\">\n        <thead>\n            <tr>\n                <th style=\"width:110px;\">íŒ¨ë„ì½”ë“œ</th>\n                <th>ì‹¬ì‚¬ìœ„ì›</th>\n                <th style=\"width:80px;\">ê´€ë¦¬</th>\n            </tr>\n        </thead>\n        <tbody id=\"panel-table-body\">\n        <?php if (empty($panel_list)): ?>\n            <tr>\n                <td><input type=\"text\" name=\"panel[0][panel_code]\" value=\"\" placeholder=\"ì˜ˆ: PA\"></td>\n                <td>\n                    <select name=\"panel[0][adj_code]\" style=\"min-width:120px;\">\n                        <option value=\"\">-- ì‹¬ì‚¬ìœ„ì› ì„ íƒ --</option>\n                        <?php foreach ($adjudicators as $adj): ?>\n                        <option value=\"<?=h($adj['code'])?>\"><?=h($adj['name'])?> (<?=h($adj['code'])?>)</option>\n                        <?php endforeach; ?>\n                    </select>\n                    <span class=\"print-adj-name\"></span>\n                </td>\n                <td>\n                    <div class=\"panel-btns\">\n                        <button type=\"button\" class=\"panel-add-btn\" onclick=\"addPanelRow()\">+</button>\n                        <button type=\"button\" class=\"panel-del-btn\" onclick=\"removePanelRow(this)\">-</button>\n                    </div>\n                </td>\n            </tr>\n        <?php else: foreach ($panel_list as $i=>$row): ?>\n            <tr>\n                <td>\n                    <input type=\"text\" name=\"panel[<?=$i?>][panel_code]\" value=\"<?=h($row['panel_code'])?>\" placeholder=\"ì˜ˆ: PA\">\n                </td>\n                <td>\n                    <select name=\"panel[<?=$i?>][adj_code]\" style=\"min-width:120px;\">\n                        <option value=\"\">-- ì‹¬ì‚¬ìœ„ì› ì„ íƒ --</option>\n                        <?php foreach ($adjudicators as $adj): ?>\n                        <option value=\"<?=h($adj['code'])?>\"<?=($row['adj_code']==$adj['code']?' selected':'')?>>\n                            <?=h($adj['name'])?> (<?=h($adj['code'])?>)\n                        </option>\n                        <?php endforeach; ?>\n                    </select>\n                    <span class=\"print-adj-name\" style=\"display:none;\">\n                        <?php\n                        $found = array_filter($adjudicators, fn($a) => $a['code']==$row['adj_code']);\n                        $adj = $found ? array_values($found)[0] : null;\n                        echo $adj ? h($adj['name'].' ('.$adj['code'].')') : '';\n                        ?>\n                    </span>\n                </td>\n                <td>\n                    <div class=\"panel-btns\">\n                        <button type=\"button\" class=\"panel-add-btn\" onclick=\"addPanelRow()\">+</button>\n                        <button type=\"button\" class=\"panel-del-btn\" onclick=\"removePanelRow(this)\">-</button>\n                    </div>\n                </td>\n            </tr>\n        <?php endforeach; endif; ?>\n        </tbody>\n    </table>\n    <button type=\"submit\" name=\"save_panel\" value=\"1\" class=\"panel-add-btn\" style=\"padding:0.5em 2em;\">íŒ¨ë„ ì €ì¥</button>\n    </form>\n</div>\n<footer>\n    2025 danceoffice.net | Powered by Seyoung Lee\n</footer>\n</body>\n</html>","size_bytes":12525},"comp/manage_adjudicators.php":{"content":"<?php\n$comp_id = $_GET['comp_id'] ?? '';\n$data_dir = __DIR__ . \"/data/$comp_id\";\n$info_file = \"$data_dir/info.json\";\n$adjs_file = \"$data_dir/adjudicators.txt\";\n\nif (!preg_match('/^\\d{8}-\\d+$/', $comp_id) || !is_file($info_file)) {\n    echo \"<h1>ì˜ëª»ëœ ëŒ€íšŒ ID ë˜ëŠ” ëŒ€íšŒ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</h1>\";\n    exit;\n}\n$info = json_decode(file_get_contents($info_file), true);\n\n// ì‹¬ì‚¬ìœ„ì› ëª…ë‹¨ ë¶ˆëŸ¬ì˜¤ê¸°\n$adjudicators = [];\nif (file_exists($adjs_file)) {\n    foreach (file($adjs_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES) as $line) {\n        $parts = array_map('trim', explode(',', $line));\n        $adjudicators[] = [\n            'code' => $parts[0] ?? '',\n            'name' => $parts[1] ?? '',\n            'nation' => $parts[2] ?? '',\n            'password' => $parts[3] ?? ''\n        ];\n    }\n}\n\n$msg = '';\nif ($_SERVER['REQUEST_METHOD'] === 'POST') {\n    // ì‹¬ì‚¬ìœ„ì› ëª…ë‹¨ íŒŒì¼ ì—…ë¡œë“œ\n    if (isset($_POST['upload']) && isset($_FILES['adjsfile']) && $_FILES['adjsfile']['error'] == UPLOAD_ERR_OK) {\n        $lines = file($_FILES['adjsfile']['tmp_name'], FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n        $added = 0; $skipped = 0;\n        $existing_codes = array_column($adjudicators, 'code');\n        foreach ($lines as $line) {\n            $parts = array_map('trim', explode(',', $line));\n            if (!$parts[0] || !$parts[1]) continue; // ì½”ë“œ, ì„±ëª… í•„ìˆ˜\n            if (in_array($parts[0], $existing_codes)) { $skipped++; continue;}\n            $adjudicators[] = [\n                'code' => $parts[0],\n                'name' => $parts[1],\n                'nation' => $parts[2] ?? '',\n                'password' => $parts[3] ?? ''\n            ];\n            $added++;\n        }\n        $msg = \"ì—…ë¡œë“œ ì™„ë£Œ! {$added}ëª… ì¶”ê°€, {$skipped}ëª…(ì¤‘ë³µ) ê±´ë„ˆëœ€\";\n    }\n    // ì‹¬ì‚¬ìœ„ì› ì¶”ê°€\n    if (isset($_POST['add']) && $_POST['code'] && $_POST['name']) {\n        $adjudicators[] = [\n            'code' => trim($_POST['code']),\n            'name' => trim($_POST['name']),\n            'nation' => trim($_POST['nation']),\n            'password' => trim($_POST['password'])\n        ];\n        $msg = \"ì‹¬ì‚¬ìœ„ì›ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.\";\n    }\n    // ì‚­ì œ\n    if (isset($_POST['delete']) && isset($_POST['idx'])) {\n        unset($adjudicators[$_POST['idx']]);\n        $msg = \"ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.\";\n    }\n    // adjudicators.txt ì €ì¥\n    $lines = [];\n    foreach ($adjudicators as $a) {\n        $lines[] = implode(',', [$a['code'], $a['name'], $a['nation'], $a['password']]);\n    }\n    file_put_contents($adjs_file, implode(\"\\n\", $lines));\n    header(\"Location: manage_adjudicators.php?comp_id=\" . urlencode($comp_id) . \"&msg=\" . urlencode($msg));\n    exit;\n}\n\nif (isset($_GET['msg'])) $msg = $_GET['msg'];\n\nfunction h($s) { return htmlspecialchars($s ?? ''); }\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title><?= h($info['title']) ?> ì‹¬ì‚¬ìœ„ì› ëª…ë‹¨ ê´€ë¦¬ | danceoffice.net COMP</title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\n    <style>\n        body { background:#f7fafd; font-family:sans-serif; margin:0;}\n        .mainbox { max-width:950px; margin:3vh auto 0 auto; background:#fff; border-radius:18px; box-shadow:0 6px 32px #00339911; padding:2.2em 1.5em 2em 1.5em;}\n        h1 { color:#003399; font-size:1.15em; margin-bottom:0.6em;}\n        .desc {margin-bottom:1.3em; color:#333;}\n        table { width:100%; border-collapse:collapse; background:#fff;}\n        th, td { padding:0.6em 0.3em; text-align:center;}\n        th { background:#f0f4fa; color:#003399; font-weight:700;}\n        td { color:#333;}\n        tr:not(:last-child) td { border-bottom:1px solid #eee;}\n        .del-btn { background:#ec3b28; color:#fff; border:none; border-radius:8px; padding:0.3em 1em; font-weight:700; cursor:pointer;}\n        .del-btn:hover { background:#b31e06;}\n        .add-form { margin:1.5em 0 1em 0; display:flex; gap:0.6em; flex-wrap:wrap;}\n        .add-form input { padding:0.4em 0.6em; border-radius:7px; border:1px solid #bbb; font-size:1em; min-width:100px;}\n        .add-form button { background:#03C75A; color:#fff; border:none; border-radius:8px; padding:0.4em 1.5em; font-weight:700; cursor:pointer;}\n        .add-form button:hover { background:#00BFAE;}\n        .msg { color:#03C75A; margin-bottom:1em;}\n        .goto-dash {display:inline-block; margin-bottom:1.1em; color:#888;}\n        .goto-dash:hover {color:#003399;}\n        .goto-data {color:#03C75A; margin-left:1em;}\n        .goto-data:hover {color:#009c85;}\n        .panel-link {\n            display:inline-block; margin-left:1em; font-size:1em; color:#003399; background:#eaf3ff;\n            padding:0.38em 1.2em; border-radius:7px; text-decoration:none; font-weight:600;\n            transition:background 0.15s;\n        }\n        .panel-link:hover { background:#d3e9ff; color:#021b75;}\n        .upload-form { margin:0 0 1.2em 0; display:flex; align-items:center; gap:0.7em; }\n        .upload-form input[type=\"file\"] { border-radius:7px; border:1px solid #bbb; padding:0.3em; }\n        .upload-form button { background:#003399; color:#fff; border:none; border-radius:8px; padding:0.4em 1.6em; font-weight:700; cursor:pointer;}\n        .upload-form button:hover { background:#2222aa;}\n        .small {font-size:0.93em; color:#888; margin-left:0.8em;}\n        .nation-th {min-width:80px;}\n        .print-btn { background:#666; color:#fff; font-weight:600; border:none; border-radius:8px; padding:0.3em 1.5em; margin-left:1em; cursor:pointer;}\n        .print-btn:hover { background:#003399; }\n        @media (max-width:1000px) {\n            .mainbox { max-width:99vw; padding:1.1em 0.3em;}\n            .add-form input {min-width:70px;}\n        }\n        @media (max-width:730px) {\n            .add-form {flex-direction:column;}\n            .add-form input {width:100%;}\n            .upload-form {flex-direction:column; align-items:flex-start;}\n        }\n        /* ì¸ì‡„ì‹œ ëª…ë‹¨ í‘œë§Œ */\n        @media print {\n            .print-btn, .add-form, .upload-form, .goto-dash, .goto-data, .msg, .panel-link, .desc, h1, footer { display:none !important; }\n            table { margin-top:0 !important; }\n            body { background:#fff !important; }\n            .mainbox { box-shadow:none !important; padding:0; }\n            table, th, td { font-size:1em; }\n        }\n        footer {\n            position: relative;\n            width: 100%;\n            min-height: 45px;\n            margin-top: 3em;\n            background: none;\n            text-align: center;\n            font-size: 0.95em;\n            color: #aaa;\n            padding: 1em 0 1em 0;\n            box-sizing: border-box;\n            z-index: 2;\n        }\n    </style>\n</head>\n<body>\n<div class=\"mainbox\">\n    <div style=\"display:flex; justify-content:space-between; align-items:center; margin-bottom:1.2em;\">\n        <div>\n            <a href=\"dashboard.php?comp_id=<?= urlencode($comp_id) ?>\" class=\"goto-dash\">&lt; ëŒ€ì‹œë³´ë“œë¡œ</a>\n            <a href=\"data_manage.php?comp_id=<?= urlencode($comp_id) ?>\" class=\"goto-data\">ë°ì´í„° ê´€ë¦¬ë¡œ &gt;</a>\n        </div>\n        <div>\n            <a href=\"manage_adjudicator_panels.php?comp_id=<?= urlencode($comp_id) ?>\" class=\"panel-link\">íŒ¨ë„ ì„¤ì •ìœ¼ë¡œ ì´ë™ &gt;</a>\n            <button type=\"button\" onclick=\"window.print()\" class=\"print-btn\">ëª…ë‹¨ ì¸ì‡„</button>\n        </div>\n    </div>\n    <h1><?= h($info['title']) ?> ì‹¬ì‚¬ìœ„ì› ëª…ë‹¨ ê´€ë¦¬</h1>\n    <div class=\"desc\">\n        ì‹¬ì‚¬ìœ„ì›ì€ ì½”ë“œ, ì„±ëª…, êµ­ì  í•„ìˆ˜, ë¹„ë°€ë²ˆí˜¸ëŠ” ì„ íƒì…ë‹ˆë‹¤.<br>\n        ì‹¬ì‚¬ìœ„ì›ì„ ëª¨ë‘ ë“±ë¡í•œ í›„ <b>íŒ¨ë„ ì„¤ì •ìœ¼ë¡œ ì´ë™</b>í•˜ì—¬ íŒ¨ë„êµ¬ì„± ë° ì´ë²¤íŠ¸ ë°°ì •ì„ í•˜ì„¸ìš”.\n    </div>\n    <?php if ($msg): ?><div class=\"msg\"><?= h($msg) ?></div><?php endif; ?>\n    <form class=\"upload-form\" method=\"post\" enctype=\"multipart/form-data\" onsubmit=\"return confirm('ì—…ë¡œë“œëœ txt/csv íŒŒì¼ì˜ ì‹¬ì‚¬ìœ„ì› ì •ë³´ê°€ ì¶”ê°€ë©ë‹ˆë‹¤. ì§„í–‰í• ê¹Œìš”?');\">\n        <input type=\"file\" name=\"adjsfile\" accept=\".txt,.csv\" required>\n        <button type=\"submit\" name=\"upload\" value=\"1\">TXT ì—…ë¡œë“œ</button>\n        <span class=\"small\">í˜•ì‹: ì½”ë“œ,ì´ë¦„,êµ­ì ,ë¹„ë°€ë²ˆí˜¸ (ë¹„ë°€ë²ˆí˜¸ ìƒëµ ê°€ëŠ¥, ê¸°ì¡´ ì½”ë“œ ë¬´ì‹œ)</span>\n    </form>\n    <form class=\"add-form\" method=\"post\" autocomplete=\"off\">\n        <input name=\"code\" placeholder=\"ì½”ë“œ\" required>\n        <input name=\"name\" placeholder=\"ì‹¬ì‚¬ìœ„ì›ëª…\" required>\n        <input name=\"nation\" placeholder=\"êµ­ì \">\n        <input name=\"password\" placeholder=\"ë¹„ë°€ë²ˆí˜¸\">\n        <button type=\"submit\" name=\"add\" value=\"1\">ì¶”ê°€</button>\n    </form>\n    <table>\n        <tr>\n            <th>ì½”ë“œ</th>\n            <th>ì„±ëª…</th>\n            <th class=\"nation-th\">êµ­ì </th>\n            <th>ë¹„ë°€ë²ˆí˜¸</th>\n            <th>ê´€ë¦¬</th>\n        </tr>\n        <?php foreach ($adjudicators as $i => $a): ?>\n            <tr>\n                <td><?= h($a['code']) ?></td>\n                <td><?= h($a['name']) ?></td>\n                <td><?= h($a['nation']) ?></td>\n                <td><?= h($a['password']) ?></td>\n                <td>\n                    <form method=\"post\" style=\"display:inline;\">\n                        <input type=\"hidden\" name=\"idx\" value=\"<?= $i ?>\">\n                        <button type=\"submit\" name=\"delete\" value=\"1\" class=\"del-btn\" onclick=\"return confirm('ì •ë§ ì‚­ì œí• ê¹Œìš”?');\">ì‚­ì œ</button>\n                    </form>\n                </td>\n            </tr>\n        <?php endforeach; ?>\n        <?php if (empty($adjudicators)): ?>\n            <tr><td colspan=\"5\" style=\"color:#aaa;\">ë“±ë¡ëœ ì‹¬ì‚¬ìœ„ì›ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>\n        <?php endif; ?>\n    </table>\n</div>\n<footer>\n    2025 danceoffice.net | Powered by Seyoung Lee\n</footer>\n</body>\n</html>","size_bytes":9843},"comp/manage_competitors.php":{"content":"<?php\n$comp_id = $_GET['comp_id'] ?? '';\n$data_dir = __DIR__ . \"/data/$comp_id\";\n$info_file = \"$data_dir/info.json\";\n$players_file = \"$data_dir/players.txt\";\n\nif (!preg_match('/^\\d{8}-\\d+$/', $comp_id) || !is_file($info_file)) {\n    echo \"<h1>ì˜ëª»ëœ ëŒ€íšŒ ID ë˜ëŠ” ëŒ€íšŒ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</h1>\";\n    exit;\n}\n$info = json_decode(file_get_contents($info_file), true);\n\n// ì„ ìˆ˜ëª…ë‹¨ ë¶ˆëŸ¬ì˜¤ê¸°\n$players = [];\nif (file_exists($players_file)) {\n    foreach (file($players_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES) as $line) {\n        $parts = array_map('trim', explode(',', $line));\n        $players[] = [\n            'number' => $parts[0] ?? '',\n            'name' => $parts[1] ?? '',\n            'partner' => $parts[2] ?? '',\n            'club' => $parts[3] ?? '',\n            'nation' => $parts[4] ?? '',\n        ];\n    }\n}\n\n$msg = '';\n\n// ë“±ë¡/ì‚­ì œ/ì—…ë¡œë“œ ì²˜ë¦¬\nif ($_SERVER['REQUEST_METHOD'] === 'POST') {\n    // ì—…ë¡œë“œ\n    if (isset($_POST['upload']) && isset($_FILES['txtfile']) && $_FILES['txtfile']['error'] == UPLOAD_ERR_OK) {\n        $lines = file($_FILES['txtfile']['tmp_name'], FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n        foreach ($lines as $line) {\n            $parts = array_map('trim', explode(',', $line));\n            if (!$parts[1]) continue; // ì´ë¦„ í•„ìˆ˜\n            $exists = false;\n            foreach ($players as $p) {\n                if ($p['number'] === ($parts[0] ?? '')) { $exists = true; break; }\n            }\n            if (!$exists) {\n                $players[] = [\n                    'number' => $parts[0] ?? '',\n                    'name' => $parts[1] ?? '',\n                    'partner' => $parts[2] ?? '',\n                    'club' => $parts[3] ?? '',\n                    'nation' => $parts[4] ?? '',\n                ];\n            }\n        }\n        $msg = \"ì—…ë¡œë“œ ì™„ë£Œ! (ì¤‘ë³µ ë“±ë²ˆí˜¸ ì œì™¸)\";\n    }\n    // ì¶”ê°€\n    if (isset($_POST['add']) && $_POST['name']) {\n        $players[] = [\n            'number' => trim($_POST['number']),\n            'name' => trim($_POST['name']),\n            'partner' => trim($_POST['partner']),\n            'club' => trim($_POST['club']),\n            'nation' => trim($_POST['nation']),\n        ];\n        $msg = \"ì„ ìˆ˜ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.\";\n    }\n    // ì‚­ì œ\n    if (isset($_POST['delete']) && isset($_POST['idx'])) {\n        unset($players[$_POST['idx']]);\n        $msg = \"ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.\";\n    }\n    // ì €ì¥\n    $lines = [];\n    foreach ($players as $p) {\n        $lines[] = implode(',', [\n            $p['number'], $p['name'], $p['partner'], $p['club'], $p['nation']\n        ]);\n    }\n    file_put_contents($players_file, implode(\"\\n\", $lines));\n    header(\"Location: manage_competitors.php?comp_id=\" . urlencode($comp_id) . \"&msg=\" . urlencode($msg));\n    exit;\n}\n\nif (isset($_GET['msg'])) $msg = $_GET['msg'];\n\nfunction h($s) { return htmlspecialchars($s ?? ''); }\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title><?= h($info['title']) ?> ì„ ìˆ˜ ëª…ë‹¨ ê´€ë¦¬ | danceoffice.net COMP</title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\n    <style>\n        body { background:#f7fafd; font-family:sans-serif; margin:0;}\n        .mainbox { max-width:900px; margin:3vh auto 0 auto; background:#fff; border-radius:18px; box-shadow:0 6px 32px #00339911; padding:2.2em 1.5em 2em 1.5em;}\n        h1 { color:#003399; font-size:1.15em; margin-bottom:0.9em;}\n        .desc {margin-bottom:1.3em; color:#333;}\n        table { width:100%; border-collapse:collapse; background:#fff; font-size:0.97em;}\n        th, td { padding:0.6em 0.3em; text-align:center;}\n        th { background:#f0f4fa; color:#003399; font-weight:700;}\n        td { color:#333;}\n        tr:not(:last-child) td { border-bottom:1px solid #eee;}\n        .del-btn { background:#ec3b28; color:#fff; border:none; border-radius:8px; padding:0.3em 1em; font-weight:700; cursor:pointer;}\n        .del-btn:hover { background:#b31e06;}\n        .add-form { margin:1.7em 0 1em 0; display:flex; gap:0.6em; flex-wrap:wrap;}\n        .add-form input { padding:0.4em 0.6em; border-radius:7px; border:1px solid #bbb; font-size:1em; min-width:120px;}\n        .add-form button { background:#03C75A; color:#fff; border:none; border-radius:8px; padding:0.4em 1.5em; font-weight:700; cursor:pointer;}\n        .add-form button:hover { background:#00BFAE;}\n        .upload-form { margin:0 0 1.3em 0; display:flex; align-items:center; gap:0.7em; }\n        .upload-form input[type=\"file\"] { border-radius:7px; border:1px solid #bbb; padding:0.3em; }\n        .upload-form button { background:#003399; color:#fff; border:none; border-radius:8px; padding:0.4em 1.6em; font-weight:700; cursor:pointer;}\n        .upload-form button:hover { background:#2222aa;}\n        .msg { color:#03C75A; margin-bottom:1em;}\n        .goto-dash {display:inline-block; margin-bottom:1.4em; color:#888;}\n        .goto-dash:hover {color:#003399;}\n        .small {font-size:0.93em; color:#888; margin-left:0.8em;}\n        @media (max-width:1000px) {\n            .mainbox { max-width:99vw; padding:1.1em 0.3em;}\n            .add-form input {min-width:80px;}\n        }\n        @media (max-width:600px) {\n            .add-form {flex-direction:column;}\n            .add-form input {width:100%;}\n            .upload-form {flex-direction:column; align-items:flex-start;}\n        }\n        .th-club {min-width:80px;}\n        .th-nation {min-width:80px;}\n        footer {\n            position: relative;\n            width: 100%;\n            min-height: 45px;\n            margin-top: 3em;\n            background: none;\n            text-align: center;\n            font-size: 0.95em;\n            color: #aaa;\n            padding: 1em 0 1em 0;\n            box-sizing: border-box;\n            z-index: 2;\n        }\n        .top-links {\n            display:flex; justify-content:space-between; align-items:center; margin-bottom:1.2em;\n        }\n        .top-links a { color:#888; font-size:1em; text-decoration:none;}\n        .top-links a.goto-dash:hover { color:#003399; }\n        .top-links a.goto-data { color:#03C75A; }\n        .top-links a.goto-data:hover { color:#009c85; }\n    </style>\n</head>\n<body>\n<div class=\"mainbox\">\n    <div class=\"top-links\">\n        <a href=\"dashboard.php?comp_id=<?= urlencode($comp_id) ?>\" class=\"goto-dash\">&lt; ëŒ€ì‹œë³´ë“œë¡œ</a>\n        <a href=\"data_manage.php?comp_id=<?= urlencode($comp_id) ?>\" class=\"goto-data\">ë°ì´í„° ê´€ë¦¬ë¡œ &gt;</a>\n    </div>\n    <h1><?= h($info['title']) ?> ì„ ìˆ˜ ëª…ë‹¨ ê´€ë¦¬</h1>\n    <div class=\"desc\">\n        ì‹±ê¸€ëŒ„ìŠ¤ì˜ ê²½ìš° ì´ë¦„ë§Œ ì…ë ¥í•´ë„ ë˜ê³ , íŒŒíŠ¸ë„ˆê°€ ìˆìœ¼ë©´ ì…ë ¥í•˜ì„¸ìš”. êµ­ê°€ ìŠ¹ì¸/êµ­ì œëŒ€íšŒìš©ìœ¼ë¡œ ì†Œì†, êµ­ì ì€ ì„ íƒ ì…ë ¥ì…ë‹ˆë‹¤.\n    </div>\n    <?php if ($msg): ?><div class=\"msg\"><?= h($msg) ?></div><?php endif; ?>\n    <form class=\"upload-form\" method=\"post\" enctype=\"multipart/form-data\" onsubmit=\"return confirm('ì—…ë¡œë“œëœ txt íŒŒì¼ì˜ ì„ ìˆ˜ì •ë³´ê°€ ì¶”ê°€ë©ë‹ˆë‹¤. ì§„í–‰í• ê¹Œìš”?');\">\n        <input type=\"file\" name=\"txtfile\" accept=\".txt,.csv\" required>\n        <button type=\"submit\" name=\"upload\" value=\"1\">TXT ì—…ë¡œë“œ</button>\n        <span class=\"small\">í˜•ì‹: ë“±ë²ˆí˜¸,ì´ë¦„,íŒŒíŠ¸ë„ˆ,ì†Œì†,êµ­ì  (íŒŒíŠ¸ë„ˆ/ì†Œì†/êµ­ì ì€ ìƒëµ ê°€ëŠ¥)</span>\n    </form>\n    <form class=\"add-form\" method=\"post\" autocomplete=\"off\">\n        <input name=\"number\" placeholder=\"ë“±ë²ˆí˜¸\">\n        <input name=\"name\" placeholder=\"ì´ë¦„\" required>\n        <input name=\"partner\" placeholder=\"íŒŒíŠ¸ë„ˆ\">\n        <input name=\"club\" placeholder=\"ì†Œì†\">\n        <input name=\"nation\" placeholder=\"êµ­ì \">\n        <button type=\"submit\" name=\"add\" value=\"1\">ì¶”ê°€</button>\n    </form>\n    <table>\n        <tr>\n            <th>ë“±ë²ˆí˜¸</th>\n            <th>ì´ë¦„</th>\n            <th>íŒŒíŠ¸ë„ˆ</th>\n            <th class=\"th-club\">ì†Œì†</th>\n            <th class=\"th-nation\">êµ­ì </th>\n            <th>ê´€ë¦¬</th>\n        </tr>\n        <?php foreach ($players as $i => $p): ?>\n            <tr>\n                <td><?= h($p['number']) ?></td>\n                <td><?= h($p['name']) ?></td>\n                <td><?= h($p['partner']) ?></td>\n                <td><?= h($p['club']) ?></td>\n                <td><?= h($p['nation']) ?></td>\n                <td>\n                    <form method=\"post\" style=\"display:inline;\">\n                        <input type=\"hidden\" name=\"idx\" value=\"<?= $i ?>\">\n                        <button type=\"submit\" name=\"delete\" value=\"1\" class=\"del-btn\" onclick=\"return confirm('ì •ë§ ì‚­ì œí• ê¹Œìš”?');\">ì‚­ì œ</button>\n                    </form>\n                </td>\n            </tr>\n        <?php endforeach; ?>\n        <?php if (empty($players)): ?>\n            <tr><td colspan=\"6\" style=\"color:#aaa;\">ë“±ë¡ëœ ì„ ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>\n        <?php endif; ?>\n    </table>\n</div>\n<footer>\n    2025 danceoffice.net | Powered by Seyoung Lee\n</footer>\n</body>\n</html>","size_bytes":8959},"comp/manage_events.php":{"content":"<?php\n$comp_id = $_GET['comp_id'] ?? '';\n$data_dir = __DIR__ . \"/data/$comp_id\";\n$info_file = \"$data_dir/info.json\";\n$runorder_file = \"$data_dir/RunOrder_Tablet.txt\";\n$dance_file = \"$data_dir/DanceName.txt\";\n$panel_file = \"$data_dir/panel_list.json\";\n\nrequire_once 'detail_numbers_manager.php';\n\n// ==== 1. ì˜ˆì œíŒŒì¼ ë‹¤ìš´ë¡œë“œìš© ìƒ˜í”Œ ë°ì´í„° ìƒì„± ====\n$example_csv = <<<CSV\nìˆœë²ˆ,ì´ë²¤íŠ¸ëª…,ë¼ìš´ë“œíƒ€ì…,ë¼ìš´ë“œì°¨ìˆ˜,ì§„ì¶œììˆ˜,ë‹¤ìŒë¼ìš´ë“œ,ëŒ„ìŠ¤1,ëŒ„ìŠ¤2,ëŒ„ìŠ¤3,ëŒ„ìŠ¤4,ëŒ„ìŠ¤5,íŒ¨ë„ì½”ë“œ,ì‹œê°„(ë¶„)\n1,Under 21 Open Latin,ì˜ˆì„ ì „,1,5,2,CCC,Samba,Rumba,Paso,,PA,1.5\n1,Under 21 Open Latin,ì˜ˆì„ ì „,2,3,3,CCC,Samba,Rumba,Paso,,PB,1.5\n1,Under 21 Open Latin,ì¤€ê²°ìŠ¹,,3,4,CCC,Samba,Rumba,Paso,,PC,1.5\n1,Under 21 Open Latin,ê²°ìŠ¹,,,,CCC,Samba,Rumba,Paso,,PD,1.5\n2,Break Time,,,,,,,,,,0.5\nCSV;\n\n// ==== 2. ì˜ˆì œíŒŒì¼ ë‹¤ìš´ë¡œë“œ ì²˜ë¦¬ ====\nif (isset($_GET['download_example'])) {\n    header('Content-Type: text/csv; charset=UTF-8');\n    header('Content-Disposition: attachment; filename=\"event_example.csv\"');\n    echo $example_csv;\n    exit;\n}\n\n// ==== 3. íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬ ====\n$msg = '';\nif (isset($_POST['upload_event']) && isset($_FILES['eventfile']) && $_FILES['eventfile']['error'] == UPLOAD_ERR_OK) {\n    $ext = strtolower(pathinfo($_FILES['eventfile']['name'], PATHINFO_EXTENSION));\n    if (!in_array($ext, ['csv','txt'])) {\n        $msg = \"CSV ë˜ëŠ” TXT íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.\";\n    } else {\n        move_uploaded_file($_FILES['eventfile']['tmp_name'], $runorder_file);\n        $msg = \"ì´ë²¤íŠ¸ ë°ì´í„°ê°€ ì—…ë¡œë“œ ë˜ì—ˆìŠµë‹ˆë‹¤.\";\n    }\n    header(\"Location: manage_events.php?comp_id=\" . urlencode($comp_id) . \"&msg=\" . urlencode($msg));\n    exit;\n}\nif (isset($_GET['msg'])) $msg = $_GET['msg'];\n\n// ==== 4. Dance ì¢…ë¥˜ ë°ì´í„°(ì¶•ì•½ëª… => ì •ì‹ëª…) ë¶ˆëŸ¬ì˜¤ê¸° ====\n$dance_types = [];\nif (file_exists($dance_file)) {\n    $lines = file($dance_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        if (preg_match('/^bom/', $line)) continue;\n        $cols = array_map('trim', explode(',', $line));\n        if (isset($cols[2]) && $cols[2] && isset($cols[1]) && $cols[1]) {\n            $dance_types[$cols[2]] = $cols[1]; // ì¶•ì•½ëª… => ì •ì‹ëª…\n        }\n    }\n}\n\n// ==== 5. íŒ¨ë„ì½”ë“œ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸° ====\n$panel_codes = [];\nif (file_exists($panel_file)) {\n    $panel_list = json_decode(file_get_contents($panel_file), true);\n    foreach ($panel_list as $row) {\n        if (!empty($row['panel_code'])) $panel_codes[$row['panel_code']] = true;\n    }\n    $panel_codes = array_keys($panel_codes); // ì¤‘ë³µì œê±°\n}\n\n// ==== 6. RunOrder íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸° ë° ë¶„ë¥˜ ====\n$events = [];\n$non_competition_events = [];\nif (file_exists($runorder_file)) {\n    $lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        if (preg_match('/^bom/', $line)) continue;\n        $cols = array_map('trim', explode(',', $line));\n        // ì»¬ëŸ¼ mapping: ìˆœë²ˆ,ì´ë²¤íŠ¸ëª…,ë¼ìš´ë“œíƒ€ì…,ë¼ìš´ë“œì°¨ìˆ˜,ì§„ì¶œììˆ˜,ë‹¤ìŒë¼ìš´ë“œ,ëŒ„ìŠ¤1~5,íŒ¨ë„ì½”ë“œ,ì‹œê°„(ë¶„),ì„¸ë¶€ë²ˆí˜¸\n        $panel_code = $cols[11] ?? '';\n        $music_time = isset($cols[12]) ? floatval($cols[12]) : 0.0;\n        $detail_no = $cols[13] ?? ''; // ì„¸ë¶€ë²ˆí˜¸ ì»¬ëŸ¼ ì¶”ê°€\n        $dance_abbr = [];\n        for ($i=6; $i<=10; $i++) {\n            if (isset($cols[$i]) && trim($cols[$i])!=='') $dance_abbr[] = $cols[$i];\n        }\n        // ê²½ê¸° ì™¸ ì´ë²¤íŠ¸: ëŒ„ìŠ¤ì»¬ëŸ¼ ëª¨ë‘ ë¹„ì—ˆìœ¼ë©´\n        if (count($dance_abbr) === 0) {\n            $non_competition_events[] = [\n                'raw_no' => $cols[0] ?? '',\n                'name'   => $cols[1] ?? '',\n                'music_time' => $music_time,\n            ];\n        } else {\n            // ëŒ„ìŠ¤ ì¢…ëª© ë²ˆí˜¸ë¥¼ ì´ë¦„ìœ¼ë¡œ ë³€í™˜\n            $converted_dances = convert_dance_numbers_to_names($dance_abbr, $dance_types);\n            // ëŒ„ìŠ¤ ì¢…ëª©ì„ ë²ˆí˜¸ ìˆœìœ¼ë¡œ ì •ë ¬\n            $sorted_dances = sort_dances_by_number($converted_dances, $dance_types);\n            \n            $events[] = [\n                'raw_no'      => $cols[0] ?? '',\n                'name'        => $cols[1] ?? '',\n                'round_type'  => $cols[2] ?? '',\n                'round_num'   => $cols[3] ?? '',\n                'next_qual'   => $cols[4] ?? '',\n                'next_event'  => $cols[5] ?? '',\n                'panel_code'  => $panel_code,\n                'music_time'  => $music_time,\n                'dances'      => $sorted_dances,\n                'detail_no'   => $detail_no, // ì„¸ë¶€ë²ˆí˜¸ ì¶”ê°€\n            ];\n        }\n    }\n}\n\n// ==== 7. ìˆœë²ˆ ê·¸ë£¹í™” ====\n$grouped_events = [];\nforeach ($events as $evt) {\n    if (preg_match('/^(\\d+)/', $evt['raw_no'], $m)) $grp = $m[1];\n    else $grp = $evt['raw_no'];\n    $grouped_events[$grp][] = $evt;\n}\n\n// ==== 7-1. ì„¸ë¶€ë²ˆí˜¸ ìë™ ìƒì„± ====\n// ëª¨ë“  ì´ë²¤íŠ¸ì— ëŒ€í•´ ì„¸ë¶€ë²ˆí˜¸ë¥¼ ìƒˆë¡œ ê³„ì‚°\nforeach ($events as $idx => &$event) {\n    // ê°™ì€ raw_noë¥¼ ê°€ì§„ ì´ë²¤íŠ¸ë“¤ ì°¾ê¸°\n    $same_raw_no_events = array_filter($events, function($e) use ($event) {\n        return $e['raw_no'] === $event['raw_no'];\n    });\n    $event_count = count($same_raw_no_events);\n    \n    // ì´ë²¤íŠ¸ê°€ 2ê°œ ì´ìƒì¸ ê²½ìš°ì—ë§Œ ì„¸ë¶€ë²ˆí˜¸ í• ë‹¹\n    if ($event_count > 1) {\n        // ê°™ì€ raw_noë¥¼ ê°€ì§„ ì´ë²¤íŠ¸ë“¤ì„ ìˆœì„œëŒ€ë¡œ ì •ë ¬\n        $sorted_events = $same_raw_no_events;\n        usort($sorted_events, function($a, $b) {\n            return strcmp($a['name'], $b['name']);\n        });\n        \n        $event_index = array_search($event, $sorted_events);\n        if ($event_index !== false) {\n            $event['detail_no'] = $event['raw_no'] . '-' . ($event_index + 1);\n        }\n    } else {\n        // ì´ë²¤íŠ¸ê°€ 1ê°œì¸ ê²½ìš° ì„¸ë¶€ë²ˆí˜¸ë¥¼ ë¹ˆ ë¬¸ìì—´ë¡œ ì„¤ì •\n        $event['detail_no'] = '';\n    }\n}\n\n// ì„¸ë¶€ë²ˆí˜¸ë¥¼ RunOrder_Tablet.txtì— ì €ì¥\n$updated_lines = [];\nif (file_exists($runorder_file)) {\n    $lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    $event_counter = 0; // ì‹¤ì œ ì´ë²¤íŠ¸ ì¹´ìš´í„°\n    \n    foreach ($lines as $line_idx => $line) {\n        if (preg_match('/^bom/', $line)) {\n            $updated_lines[] = $line;\n            continue;\n        }\n        \n        $cols = array_map('trim', explode(',', $line));\n        \n        // í•´ë‹¹ ì´ë²¤íŠ¸ì˜ ì„¸ë¶€ë²ˆí˜¸ ì°¾ê¸°\n        $detail_no = '';\n        if (isset($events[$event_counter])) {\n            $event = $events[$event_counter];\n            $raw_no = $event['raw_no'];\n            \n            // ê°™ì€ ìˆœë²ˆì˜ ì´ë²¤íŠ¸ ê°œìˆ˜ í™•ì¸\n            $same_raw_no_events = array_filter($events, function($e) use ($raw_no) {\n                return $e['raw_no'] === $raw_no;\n            });\n            $event_count = count($same_raw_no_events);\n            \n            // ì´ë²¤íŠ¸ê°€ 2ê°œ ì´ìƒì¸ ê²½ìš°ì—ë§Œ ì„¸ë¶€ë²ˆí˜¸ ì‚¬ìš©\n            if ($event_count > 1) {\n                $detail_no = $event['detail_no'];\n            }\n            // ì´ë²¤íŠ¸ê°€ 1ê°œì¸ ê²½ìš° ì„¸ë¶€ë²ˆí˜¸ëŠ” ë¹ˆ ë¬¸ìì—´\n        }\n        \n        // ì„¸ë¶€ë²ˆí˜¸ ì»¬ëŸ¼ì´ ì—†ìœ¼ë©´ ì¶”ê°€, ìˆìœ¼ë©´ ì—…ë°ì´íŠ¸\n        if (count($cols) < 14) {\n            // ì„¸ë¶€ë²ˆí˜¸ ì»¬ëŸ¼ì´ ì—†ìœ¼ë©´ ì¶”ê°€\n            $cols[] = $detail_no;\n        } else {\n            // ì„¸ë¶€ë²ˆí˜¸ ì»¬ëŸ¼ì´ ìˆìœ¼ë©´ ì—…ë°ì´íŠ¸\n            $cols[13] = $detail_no;\n        }\n        \n        // ë‹¤ìŒ ì´ë²¤íŠ¸ ë²ˆí˜¸ ì—…ë°ì´íŠ¸ (5ë²ˆì§¸ ì»¬ëŸ¼)\n        if (isset($events[$event_counter])) {\n            $next_event = $events[$event_counter]['next_event'] ?? '';\n            $cols[5] = $next_event;\n        }\n        \n        $updated_lines[] = implode(',', $cols);\n        $event_counter++; // ì‹¤ì œ ì´ë²¤íŠ¸ë§Œ ì¹´ìš´íŠ¸\n    }\n    \n    // íŒŒì¼ ì €ì¥\n    file_put_contents($runorder_file, implode(\"\\n\", $updated_lines) . \"\\n\");\n}\n\n// ==== 7-1. ë¼ìš´ë“œ ìë™ ê³„ì‚° í•¨ìˆ˜ ====\nfunction calculateRoundInfo($events) {\n    // ì´ë²¤íŠ¸ëª…ë³„ë¡œ ê·¸ë£¹í™”\n    $name_groups = [];\n    foreach ($events as $idx => $evt) {\n        $name = $evt['name'];\n        if (!isset($name_groups[$name])) {\n            $name_groups[$name] = [];\n        }\n        $name_groups[$name][] = ['idx' => $idx, 'event' => $evt];\n    }\n    \n    // ê° ê·¸ë£¹ë³„ë¡œ ë¼ìš´ë“œ ì •ë³´ ê³„ì‚°\n    $round_info = [];\n    $next_event_info = []; // ë‹¤ìŒ ì´ë²¤íŠ¸ ë²ˆí˜¸ ì •ë³´\n    \n    foreach ($name_groups as $name => $group) {\n        $total_events = count($group);\n        \n        // ê°™ì€ ì´ë²¤íŠ¸ëª…ì„ ê°€ì§„ ì´ë²¤íŠ¸ë“¤ì„ ìˆœë²ˆ ìˆœìœ¼ë¡œ ì •ë ¬\n        usort($group, function($a, $b) {\n            $raw_no_a = intval($a['event']['raw_no']);\n            $raw_no_b = intval($b['event']['raw_no']);\n            \n            // ìˆœë²ˆì´ ê°™ìœ¼ë©´ ì´ë²¤íŠ¸ëª…ìœ¼ë¡œ ì •ë ¬\n            if ($raw_no_a === $raw_no_b) {\n                return strcmp($a['event']['name'], $b['event']['name']);\n            }\n            \n            return $raw_no_a - $raw_no_b;\n        });\n        \n        foreach ($group as $pos => $item) {\n            $idx = $item['idx'];\n            $stage_text = '';\n            \n            if ($total_events === 1) {\n                $stage_text = 'Final';\n            } else if ($total_events === 2) {\n                if ($pos === 0) $stage_text = 'Semi-Final';\n                else $stage_text = 'Final';\n            } else if ($total_events === 3) {\n                if ($pos === 0) $stage_text = 'Round 1';\n                else if ($pos === 1) $stage_text = 'Semi-Final';\n                else $stage_text = 'Final';\n            } else if ($total_events === 4) {\n                if ($pos === 0) $stage_text = 'Round 1';\n                else if ($pos === 1) $stage_text = 'Round 2';\n                else if ($pos === 2) $stage_text = 'Semi-Final';\n                else $stage_text = 'Final';\n            } else if ($total_events === 5) {\n                if ($pos === 0) $stage_text = 'Round 1';\n                else if ($pos === 1) $stage_text = 'Round 2';\n                else if ($pos === 2) $stage_text = 'Round 3';\n                else if ($pos === 3) $stage_text = 'Semi-Final';\n                else $stage_text = 'Final';\n            } else {\n                $stage_text = ($pos + 1) . '/' . $total_events;\n            }\n            \n            $round_info[$idx] = $stage_text;\n            \n            // ë‹¤ìŒ ì´ë²¤íŠ¸ ë²ˆí˜¸ ìë™ ê³„ì‚°\n            if ($pos < $total_events - 1) {\n                // ë‹¤ìŒ ë¼ìš´ë“œê°€ ìˆëŠ” ê²½ìš°\n                $next_item = $group[$pos + 1];\n                $next_event_info[$idx] = $next_item['event']['raw_no'];\n            } else {\n                // ë§ˆì§€ë§‰ ë¼ìš´ë“œì¸ ê²½ìš°\n                $next_event_info[$idx] = '';\n            }\n        }\n    }\n    \n    return ['round_info' => $round_info, 'next_event_info' => $next_event_info];\n}\n\n// ë¼ìš´ë“œ ì •ë³´ ê³„ì‚°\n$round_calculation = calculateRoundInfo($events);\n$round_info = $round_calculation['round_info'];\n$next_event_info = $round_calculation['next_event_info'];\n\n// ë‹¤ìŒ ì´ë²¤íŠ¸ ë²ˆí˜¸ë¥¼ ì´ë²¤íŠ¸ì— ì ìš©\nforeach ($events as $idx => &$event) {\n    if (isset($next_event_info[$idx])) {\n        $event['next_event'] = $next_event_info[$idx];\n    }\n}\n\n// RunOrder_Tablet.txtì—ì„œ ì½ì–´ì˜¨ ë¼ìš´ë“œ ì •ë³´ë¥¼ ì‚¬ìš©\nforeach ($events as $idx => &$event) {\n    // RunOrder_Tablet.txtì—ì„œ ì½ì–´ì˜¨ ë¼ìš´ë“œ ì •ë³´ê°€ ìˆìœ¼ë©´ ì‚¬ìš©\n    if (!empty($event['round_type'])) {\n        $round_info[$idx] = $event['round_type'];\n    }\n    // RunOrder_Tablet.txtì—ì„œ ì½ì–´ì˜¨ ë‹¤ìŒ ì´ë²¤íŠ¸ ë²ˆí˜¸ê°€ ìˆìœ¼ë©´ ì‚¬ìš©\n    if (!empty($event['next_event'])) {\n        $next_event_info[$idx] = $event['next_event'];\n    }\n}\n\n// ==== 8. ì§ì ‘ ì…ë ¥ ì²˜ë¦¬ ë° \"ë‹¤ìŒë¼ìš´ë“œ ìë™ ìƒì„±\" ====\nif ($_SERVER['REQUEST_METHOD']==='POST' && isset($_POST['add_event_inline'])) {\n    $fields = [\n        $_POST['raw_no'] ?? '',\n        $_POST['name'] ?? '',\n        $_POST['round_type'] ?? '',\n        $_POST['round_num'] ?? '',\n        $_POST['next_qual'] ?? '',\n        $_POST['next_event'] ?? '',\n        $_POST['dance1'] ?? '',\n        $_POST['dance2'] ?? '',\n        $_POST['dance3'] ?? '',\n        $_POST['dance4'] ?? '',\n        $_POST['dance5'] ?? '',\n        $_POST['panel_code'] ?? '',\n        $_POST['music_time'] ?? '',\n    ];\n    $line = implode(',', array_map(fn($s)=>str_replace([\",\",\"\\n\",\"\\r\"],['',' ',''],$s), $fields));\n    $line .= \"\\n\";\n    file_put_contents($runorder_file, $line, FILE_APPEND);\n\n    // ìë™ ë‹¤ìŒë¼ìš´ë“œ ìƒì„±\n    $next_event = trim($_POST['next_event'] ?? '');\n    $existing_nums = array_column($events, 'raw_no');\n    if ($next_event !== \"\" && !in_array($next_event, $existing_nums)) {\n        // ìë™ ë¼ìš´ë“œíƒ€ì… ì¦ê°€\n        $now_round_type = $_POST['round_type'];\n        $next_round_type = $now_round_type;\n        if ($now_round_type === \"Round 1\") {\n            $next_round_type = \"Round 2\";\n            // Round 1ì´ ì—¬ëŸ¬ ë²ˆì´ë©´ Round 2ë¶€í„°ëŠ” Semi-Final, ê·¸ ì´í›„ Final\n            $exist_same = array_filter($events, fn($e) => $e['name']==$_POST['name'] && $e['round_type']==\"Round 1\");\n            if (count($exist_same) >= 2) {\n                $next_round_type = \"Semi-Final\";\n            }\n        } elseif ($now_round_type === \"Round 2\") {\n            $next_round_type = \"Semi-Final\";\n        } elseif ($now_round_type === \"Round 3\") {\n            $next_round_type = \"Semi-Final\";\n        } elseif ($now_round_type === \"Semi-Final\") {\n            $next_round_type = \"Final\";\n        }\n        // ëŒ„ìŠ¤ ì¢…ëª© ë²ˆí˜¸ë¥¼ ì´ë¦„ìœ¼ë¡œ ë³€í™˜\n        $dance_abbrs = array_filter([\n            $_POST['dance1'] ?? '',\n            $_POST['dance2'] ?? '',\n            $_POST['dance3'] ?? '',\n            $_POST['dance4'] ?? '',\n            $_POST['dance5'] ?? ''\n        ]);\n        $converted_dances = convert_dance_numbers_to_names($dance_abbrs, $dance_types);\n        $sorted_dances = sort_dances_by_number($converted_dances, $dance_types);\n        \n        $next_fields = [\n            $next_event,\n            $_POST['name'],\n            $next_round_type,\n            $next_round_num,\n            \"\", // ì§„ì¶œììˆ˜\n            \"\", // ë‹¤ìŒë¼ìš´ë“œ\n            $sorted_dances[0] ?? '',\n            $sorted_dances[1] ?? '',\n            $sorted_dances[2] ?? '',\n            $sorted_dances[3] ?? '',\n            $sorted_dances[4] ?? '',\n            $_POST['panel_code'] ?? '',\n            $_POST['music_time'] ?? '',\n        ];\n        $next_line = implode(',', array_map(fn($s)=>str_replace([\",\",\"\\n\",\"\\r\"],['',' ',''],$s), $next_fields));\n        $next_line .= \"\\n\";\n        file_put_contents($runorder_file, $next_line, FILE_APPEND);\n    }\n    header(\"Location: manage_events.php?comp_id=\" . urlencode($comp_id) . \"&msg=\" . urlencode(\"í•œ ì¤„ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.\"));\n    exit;\n}\n\n// ==== 9. ì‚­ì œ ì²˜ë¦¬ ====\nif (isset($_GET['delete']) && is_numeric($_GET['delete'])) {\n    $delete_idx = intval($_GET['delete']);\n    // RunOrder íŒŒì¼ ë‹¤ì‹œ ì½ê¸°\n    if (file_exists($runorder_file)) {\n        $lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n        if (isset($lines[$delete_idx])) {\n            unset($lines[$delete_idx]);\n            file_put_contents($runorder_file, implode(\"\\n\", $lines) . \"\\n\");\n            \n            // ì„¸ë¶€ë²ˆí˜¸ë„ ì¬ìƒì„±\n            $detail_numbers = generateDetailNumbers($events);\n            saveDetailNumbers($comp_id, $detail_numbers);\n            \n            header(\"Location: manage_events.php?comp_id=\" . urlencode($comp_id) . \"&msg=ì´ë²¤íŠ¸ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.\");\n            exit;\n        }\n    }\n}\n\n// ==== 9-1. ì„¸ë¶€ë²ˆí˜¸ ìˆ˜ì • ì²˜ë¦¬ ====\nif ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['update_detail_numbers'])) {\n    $detail_updates = $_POST['detail_numbers'] ?? [];\n    $updated = false;\n    \n    foreach ($detail_updates as $key => $new_detail_no) {\n        list($raw_no, $name) = explode('|', $key, 2);\n        $raw_no = trim($raw_no); // ê³µë°± ë¬¸ì ì œê±°\n        if (updateDetailNumber($comp_id, $raw_no, $name, $new_detail_no)) {\n            $updated = true;\n        }\n    }\n    \n    if ($updated) {\n        // RunOrder_Tablet.txt íŒŒì¼ ì—…ë°ì´íŠ¸\n        $updated_lines = [];\n        if (file_exists($runorder_file)) {\n            $lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n            $event_counter = 0;\n            \n            foreach ($lines as $line_idx => $line) {\n                if (preg_match('/^bom/', $line)) {\n                    $updated_lines[] = $line;\n                    continue;\n                }\n                \n                $cols = array_map('trim', explode(',', $line));\n                \n                // í•´ë‹¹ ì´ë²¤íŠ¸ì˜ ì„¸ë¶€ë²ˆí˜¸ ì°¾ê¸°\n                $detail_no = '';\n                if (isset($events[$event_counter])) {\n                    $event = $events[$event_counter];\n                    $raw_no = $event['raw_no'];\n                    \n                    // ê°™ì€ ìˆœë²ˆì˜ ì´ë²¤íŠ¸ ê°œìˆ˜ í™•ì¸\n                    $same_raw_no_events = array_filter($events, function($e) use ($raw_no) {\n                        return $e['raw_no'] === $raw_no;\n                    });\n                    $event_count = count($same_raw_no_events);\n                    \n                    // ì´ë²¤íŠ¸ê°€ 2ê°œ ì´ìƒì¸ ê²½ìš°ì—ë§Œ ì„¸ë¶€ë²ˆí˜¸ ì‚¬ìš©\n                    if ($event_count > 1) {\n                        $detail_no = $event['detail_no'];\n                    }\n                }\n                \n                // ì„¸ë¶€ë²ˆí˜¸ ì»¬ëŸ¼ì´ ì—†ìœ¼ë©´ ì¶”ê°€, ìˆìœ¼ë©´ ì—…ë°ì´íŠ¸\n                if (count($cols) < 14) {\n                    $cols[] = $detail_no;\n                } else {\n                    $cols[13] = $detail_no;\n                }\n                \n                $updated_lines[] = implode(',', $cols);\n                $event_counter++;\n            }\n            \n            // íŒŒì¼ ì €ì¥\n            file_put_contents($runorder_file, implode(\"\\n\", $updated_lines) . \"\\n\");\n        }\n        \n        $msg = \"ì„¸ë¶€ë²ˆí˜¸ê°€ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.\";\n    } else {\n        $msg = \"ì„¸ë¶€ë²ˆí˜¸ ì—…ë°ì´íŠ¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\";\n    }\n    \n    header(\"Location: manage_events.php?comp_id=\" . urlencode($comp_id) . \"&msg=\" . urlencode($msg));\n    exit;\n}\n\n// ==== 10. ìˆ˜ì • í¼ ì œì¶œ ì²˜ë¦¬ (ìˆ˜ì •ì‹œì—ë„ ë‹¤ìŒë¼ìš´ë“œ ìë™ìƒì„± ì§€ì›) ====\nif (isset($_POST['edit_idx']) && is_numeric($_POST['edit_idx'])) {\n    $edit_idx = intval($_POST['edit_idx']);\n    if (file_exists($runorder_file)) {\n        $lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n        if (isset($lines[$edit_idx])) {\n            $fields = [\n                $_POST['raw_no'] ?? '',\n                $_POST['name'] ?? '',\n                $_POST['round_type'] ?? '',\n                $_POST['round_num'] ?? '',\n                $_POST['next_qual'] ?? '',\n                $_POST['next_event'] ?? '',\n                $_POST['dance1'] ?? '',\n                $_POST['dance2'] ?? '',\n                $_POST['dance3'] ?? '',\n                $_POST['dance4'] ?? '',\n                $_POST['dance5'] ?? '',\n                $_POST['panel_code'] ?? '',\n                $_POST['music_time'] ?? '',\n            ];\n            $line = implode(',', array_map(fn($s)=>str_replace([\",\",\"\\n\",\"\\r\"],['',' ',''],$s), $fields));\n            $lines[$edit_idx] = $line;\n\n            // === ë‹¤ìŒë¼ìš´ë“œ ìë™ ìƒì„± (ìˆ˜ì •ì‹œì—ë„) ===\n            $next_event = trim($_POST['next_event'] ?? '');\n            // lines ì „ì²´ì—ì„œ ì²«ë²ˆì§¸ ì»¬ëŸ¼(ìˆœë²ˆ)ë§Œ ì¶”ì¶œ\n            $existing_nums = [];\n            foreach ($lines as $l) {\n                $cols = array_map('trim', explode(',', $l));\n                $existing_nums[] = $cols[0] ?? '';\n            }\n            if ($next_event !== \"\" && !in_array($next_event, $existing_nums)) {\n                // ë¼ìš´ë“œíƒ€ì… ì¦ê°€ ë¡œì§\n                $now_round_type = $_POST['round_type'];\n                $next_round_type = $now_round_type;\n                if ($now_round_type === \"Round 1\") {\n                    $next_round_type = \"Round 2\";\n                    // Round 1 ì—¬ëŸ¬ ë²ˆ ìˆìœ¼ë©´ Semi-Final ì „í™˜\n                    $exist_same = 0;\n                    foreach ($lines as $l) {\n                        $cols = array_map('trim', explode(',', $l));\n                        if (($cols[1]??'')==$_POST['name'] && ($cols[2]??'')==\"Round 1\") $exist_same++;\n                    }\n                    if ($exist_same >= 2) {\n                        $next_round_type = \"Semi-Final\";\n                    }\n                } elseif ($now_round_type === \"Round 2\") {\n                    $next_round_type = \"Semi-Final\";\n                } elseif ($now_round_type === \"Round 3\") {\n                    $next_round_type = \"Semi-Final\";\n                } elseif ($now_round_type === \"Semi-Final\") {\n                    $next_round_type = \"Final\";\n                }\n                // ëŒ„ìŠ¤ ì¢…ëª© ë²ˆí˜¸ë¥¼ ì´ë¦„ìœ¼ë¡œ ë³€í™˜\n                $dance_abbrs = array_filter([\n                    $_POST['dance1'] ?? '',\n                    $_POST['dance2'] ?? '',\n                    $_POST['dance3'] ?? '',\n                    $_POST['dance4'] ?? '',\n                    $_POST['dance5'] ?? ''\n                ]);\n                $converted_dances = convert_dance_numbers_to_names($dance_abbrs, $dance_types);\n                $sorted_dances = sort_dances_by_number($converted_dances, $dance_types);\n                \n                $next_fields = [\n                    $next_event,\n                    $_POST['name'],\n                    $next_round_type,\n                    $next_round_num,\n                    \"\", // ì§„ì¶œììˆ˜\n                    \"\", // ë‹¤ìŒë¼ìš´ë“œ\n                    $sorted_dances[0] ?? '',\n                    $sorted_dances[1] ?? '',\n                    $sorted_dances[2] ?? '',\n                    $sorted_dances[3] ?? '',\n                    $sorted_dances[4] ?? '',\n                    $_POST['panel_code'] ?? '',\n                    $_POST['music_time'] ?? '',\n                ];\n                $next_line = implode(',', array_map(fn($s)=>str_replace([\",\",\"\\n\",\"\\r\"],['',' ',''],$s), $next_fields));\n                $lines[] = $next_line;\n            }\n            // ì €ì¥\n            file_put_contents($runorder_file, implode(\"\\n\", $lines) . \"\\n\");\n            header(\"Location: manage_events.php?comp_id=\" . urlencode($comp_id) . \"&msg=ì´ë²¤íŠ¸ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.\");\n            exit;\n        }\n    }\n}\n\nfunction h($s) { return htmlspecialchars($s ?? ''); }\nfunction get_round_label($round_type, $round_num) {\n    if ($round_type === \"Round 1\") return \"Round 1\";\n    if ($round_type === \"Round 2\") return \"Round 2\";\n    if ($round_type === \"Round 3\") return \"Round 3\";\n    if ($round_type === \"Semi-Final\") return \"Semi-Final\";\n    if ($round_type === \"Final\") return \"Final\";\n    return h($round_type);\n}\nfunction render_dances($abbrs, $dance_types) {\n    $out = [];\n    foreach ($abbrs as $ab) {\n        // None, 0, ë¹ˆ ë¬¸ìì—´, '?' ë“± ë¬´íš¨í•œ ê°’ ì œì™¸\n        if (empty($ab) || $ab === '0' || $ab === 'None' || $ab === '?' || $ab === '-') {\n            continue;\n        }\n        \n        if (isset($dance_types[$ab])) {\n            // ì´ë¦„ë§Œ í‘œì‹œ (ì˜ˆ: Waltz)\n            $dance_info = get_dance_info_by_abbr($ab, $dance_types);\n            $out[] = $dance_info['name'];\n        } else {\n            // ë§¤ì¹­ë˜ì§€ ì•ŠëŠ” ê²½ìš° ì›ë³¸ í‘œì‹œ (ìœ íš¨í•œ ê²½ìš°ë§Œ)\n            if (!empty($ab) && $ab !== '0' && $ab !== 'None' && $ab !== '?' && $ab !== '-') {\n                $out[] = $ab;\n            }\n        }\n    }\n    return implode(', ', $out);\n}\n\nfunction get_dance_info_by_abbr($abbr, $dance_types) {\n    // DanceName.txtì—ì„œ ë²ˆí˜¸ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ íŒŒì¼ì„ ë‹¤ì‹œ ì½ìŒ\n    $dance_file = __DIR__ . \"/data/{$_GET['comp_id']}/DanceName.txt\";\n    $dance_data = [];\n    \n    if (file_exists($dance_file)) {\n        $lines = file($dance_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n        foreach ($lines as $line) {\n            if (preg_match('/^bom/', $line)) continue;\n            $cols = array_map('trim', explode(',', $line));\n            if (count($cols) >= 3 && is_numeric($cols[0])) {\n                $dance_data[$cols[2]] = [\n                    'number' => $cols[0],\n                    'name' => $cols[1],\n                    'abbr' => $cols[2]\n                ];\n            }\n        }\n    }\n    \n    return $dance_data[$abbr] ?? ['number' => '?', 'name' => $abbr, 'abbr' => $abbr];\n}\n\nfunction sort_dances_by_number($dance_abbrs, $dance_types) {\n    $dance_file = __DIR__ . \"/data/{$_GET['comp_id']}/DanceName.txt\";\n    $dance_data = [];\n    \n    if (file_exists($dance_file)) {\n        $lines = file($dance_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n        foreach ($lines as $line) {\n            if (preg_match('/^bom/', $line)) continue;\n            $cols = array_map('trim', explode(',', $line));\n            if (count($cols) >= 3 && is_numeric($cols[0])) {\n                $dance_data[$cols[2]] = intval($cols[0]);\n            }\n        }\n    }\n    \n    // ë²ˆí˜¸ ìˆœìœ¼ë¡œ ì •ë ¬\n    usort($dance_abbrs, function($a, $b) use ($dance_data) {\n        $num_a = $dance_data[$a] ?? 999; // ë§¤ì¹­ë˜ì§€ ì•ŠëŠ” ê²½ìš° ë§¨ ë’¤ë¡œ\n        $num_b = $dance_data[$b] ?? 999;\n        return $num_a - $num_b;\n    });\n    \n    return $dance_abbrs;\n}\n\nfunction convert_dance_numbers_to_names($dance_abbrs, $dance_types) {\n    $dance_file = __DIR__ . \"/data/{$_GET['comp_id']}/DanceName.txt\";\n    $dance_data = [];\n    \n    if (file_exists($dance_file)) {\n        $lines = file($dance_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n        foreach ($lines as $line) {\n            if (preg_match('/^bom/', $line)) continue;\n            $cols = array_map('trim', explode(',', $line));\n            if (count($cols) >= 3 && is_numeric($cols[0])) {\n                $dance_data[intval($cols[0])] = [\n                    'name' => $cols[1],\n                    'abbr' => $cols[2]\n                ];\n            }\n        }\n    }\n    \n    $converted_dances = [];\n    foreach ($dance_abbrs as $abbr) {\n        // ìˆ«ìì¸ ê²½ìš° ë²ˆí˜¸ë¡œ ë³€í™˜\n        if (is_numeric($abbr) && isset($dance_data[intval($abbr)])) {\n            $converted_dances[] = $dance_data[intval($abbr)]['abbr'];\n        } else {\n            $converted_dances[] = $abbr;\n        }\n    }\n    \n    return $converted_dances;\n}\nfunction sum_minutes($list) {\n    $total = 0.0;\n    foreach ($list as $e) $total += floatval($e['music_time']);\n    return $total;\n}\n\n// ==== 11. ìˆ˜ì • ì§„ì… ì‹œ ë°ì´í„° ì¤€ë¹„ ====\n$edit_mode = false;\n$edit_fields = [];\nif (isset($_GET['edit']) && is_numeric($_GET['edit'])) {\n    $edit_mode = true;\n    $edit_idx = intval($_GET['edit']);\n    if (file_exists($runorder_file)) {\n        $lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n        if (isset($lines[$edit_idx])) {\n            $edit_fields = array_map('trim', explode(',', $lines[$edit_idx]));\n        }\n    }\n}\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>ì´ë²¤íŠ¸ ê´€ë¦¬ | danceoffice.net COMP</title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\n    <style>\n        body { background:#f7fafd; font-family:sans-serif; margin:0;}\n        .mainbox { max-width:1200px; margin:3vh auto 0 auto; background:#fff; border-radius:18px; box-shadow:0 6px 32px #00339911; padding:2.2em 1.3em 2em 1.3em;}\n        h1 { color:#003399; font-size:1.15em; margin-bottom:0.6em;}\n        .desc {margin-bottom:1.3em; color:#333;}\n        table { width:100%; border-collapse:collapse; background:#fff; }\n        th, td { padding:0.45em 0.3em; text-align:center; font-size:0.98em;}\n        th { background:#f0f4fa; color:#003399; font-weight:700;}\n        td { color:#333;}\n        tr:not(:last-child) td { border-bottom:1px solid #eee;}\n        .edit-btn, .del-btn {\n            border:none; border-radius:8px; padding:0.28em 1em; font-weight:700; cursor:pointer;\n        }\n        .edit-btn { background:#03C75A; color:#fff;}\n        .edit-btn:hover { background:#00BFAE;}\n        .del-btn { background:#ec3b28; color:#fff;}\n        .del-btn:hover { background:#b31e06;}\n        .goto-dash {display:inline-block; margin-bottom:1.1em; color:#888;}\n        .goto-dash:hover {color:#003399;}\n        .event-group-row { background:#f8fafd; }\n        .event-dances { font-size:0.96em; color:#225; }\n        .panel-code-cell { font-weight:600; color:#155; }\n        .time-table { margin-top:2.5em;}\n        .noncomp-title { color:#003399; font-size:1.07em; margin:1em 0 0.5em 0; font-weight:700;}\n        .addbox {margin:1.2em 0 1.5em 0;}\n        @media (max-width:900px) {\n            .mainbox { max-width:99vw; padding:1.1em 0.2em;}\n            th, td { font-size:0.95em;}\n        }\n    </style>\n    <script>\n    document.addEventListener('DOMContentLoaded', function() {\n        const danceMap = {\n            <?php foreach ($dance_types as $abbr => $fullname): ?>\n            \"<?=strtoupper($abbr)?>\": \"<?=h($fullname)?> (<?=h($abbr)?>)\",\n            <?php endforeach; ?>\n        };\n        document.querySelectorAll('.dance-input').forEach(function(input){\n            input.addEventListener('input', function(e) {\n                const v = input.value.trim().toUpperCase();\n                if(danceMap[v]) {\n                    input.value = v;\n                }\n            });\n        });\n        \n        // ëŒ„ìŠ¤ ì…ë ¥ ì‹œ ìë™ ì •ë ¬ ê¸°ëŠ¥\n        function autoSortDances() {\n            const danceInputs = document.querySelectorAll('.dance-input');\n            const danceValues = Array.from(danceInputs).map(input => input.value.trim()).filter(v => v);\n            \n            // ë²ˆí˜¸ë¥¼ ì•½ì–´ë¡œ ë³€í™˜\n            const numberToAbbr = {\n                '1': 'W', '2': 'T', '3': 'V', '4': 'S', '5': 'Q',\n                '6': 'SA', '7': 'C', '8': 'R', '9': 'P', '10': 'J',\n                '11': 'F', '12': 'SW', '13': 'AT', '14': 'HAND.', '15': 'FO'\n            };\n            \n            // ìˆ«ìì¸ ê²½ìš° ì•½ì–´ë¡œ ë³€í™˜\n            const convertedValues = danceValues.map(val => {\n                if (numberToAbbr[val]) {\n                    return numberToAbbr[val];\n                }\n                return val.toUpperCase();\n            });\n            \n            // DanceName.txtì˜ ë²ˆí˜¸ ìˆœì„œëŒ€ë¡œ ì •ë ¬\n            const danceOrder = {\n                'W': 1, 'T': 2, 'V': 3, 'S': 4, 'Q': 5,\n                'SA': 6, 'C': 7, 'R': 8, 'P': 9, 'J': 10,\n                'F': 11, 'SW': 12, 'AT': 13, 'HAND.': 14, 'FO': 15\n            };\n            \n            convertedValues.sort((a, b) => {\n                const orderA = danceOrder[a] || 999;\n                const orderB = danceOrder[b] || 999;\n                return orderA - orderB;\n            });\n            \n            // ì •ë ¬ëœ ê°’ìœ¼ë¡œ ì…ë ¥ í•„ë“œ ì—…ë°ì´íŠ¸\n            danceInputs.forEach((input, index) => {\n                input.value = convertedValues[index] || '';\n            });\n        }\n        \n        // ëŒ„ìŠ¤ ì…ë ¥ í•„ë“œì— ì •ë ¬ ë²„íŠ¼ ì¶”ê°€\n        document.addEventListener('DOMContentLoaded', function() {\n            const addForm = document.querySelector('form[method=\"post\"]');\n            if (addForm) {\n                const sortButton = document.createElement('button');\n                sortButton.type = 'button';\n                sortButton.textContent = 'ëŒ„ìŠ¤ ì •ë ¬';\n                sortButton.style.cssText = 'background:#FF6B35; color:#fff; border:none; border-radius:8px; padding:0.4em 1em; font-weight:700; cursor:pointer; margin-left:0.5em;';\n                sortButton.onclick = autoSortDances;\n                \n                const addButton = addForm.querySelector('button[type=\"submit\"]');\n                if (addButton) {\n                    addButton.parentNode.insertBefore(sortButton, addButton.nextSibling);\n                }\n            }\n        });\n        \n        // ì‚­ì œ í™•ì¸\n        window.deleteEvent = function(idx) {\n            if(confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {\n                location.href = \"?comp_id=<?=h($comp_id)?>&delete=\" + idx;\n            }\n        };\n        // ìˆ˜ì • ì§„ì…\n        window.editEvent = function(idx) {\n            location.href = \"?comp_id=<?=h($comp_id)?>&edit=\" + idx;\n        };\n        \n        // ë¼ìš´ë“œ ì •ë³´ ì €ì¥\n        window.saveRoundInfo = function() {\n            if(confirm('ë¼ìš´ë“œ ì •ë³´ë¥¼ ë°ì´í„° íŒŒì¼ì— ì €ì¥í•˜ì‹œê² ìŠµë‹ˆê¹Œ? íƒ€ì„í…Œì´ë¸”ì—ì„œë„ ë°”ë¡œ ì ìš©ë©ë‹ˆë‹¤.')) {\n                fetch(`save_round_info.php?comp_id=<?=h($comp_id)?>`)\n                    .then(response => response.json())\n                    .then(data => {\n                        if (data.success) {\n                            alert('ë¼ìš´ë“œ ì •ë³´ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');\n                        } else {\n                            alert('ì €ì¥ ì‹¤íŒ¨: ' + (data.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));\n                        }\n                    })\n                    .catch(error => {\n                        alert('ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error);\n                    });\n            }\n        };\n    });\n    \n    // ì„¸ë¶€ë²ˆí˜¸ ìë™ ìƒì„± ê¸°ëŠ¥ (ì „ì—­ í•¨ìˆ˜)\n    window.autoGenerateDetailNumbers = function() {\n        console.log('ìë™ ìƒì„± í•¨ìˆ˜ ì‹œì‘');\n        const inputs = document.querySelectorAll('input[name^=\"detail_numbers[\"]');\n        console.log('ì°¾ì€ ì…ë ¥ í•„ë“œ ìˆ˜:', inputs.length);\n        \n        const groupCounters = {};\n        \n        inputs.forEach((input, index) => {\n            const name = input.getAttribute('name');\n            console.log(`ì…ë ¥ í•„ë“œ ${index}:`, name);\n            \n            // ë” ìœ ì—°í•œ ì •ê·œì‹ íŒ¨í„´ ì‚¬ìš© (ìˆ«ìê°€ ì•„ë‹Œ raw_noë„ ì²˜ë¦¬)\n            const match = name.match(/detail_numbers\\[([^|]+)\\|/);\n            \n            if (match && match.length > 1 && match[1]) {\n                const rawNo = match[1].trim(); // ê³µë°± ë¬¸ì ì œê±°\n                console.log(`ë§¤ì¹­ëœ raw_no: \"${rawNo}\" (ê¸¸ì´: ${rawNo.length})`);\n                \n                // raw_noê°€ \"1\"ì¸ ê²½ìš° íŠ¹ë³„íˆ ë””ë²„ê¹…\n                if (rawNo === \"1\" || rawNo.includes(\"1\")) {\n                    console.log(`raw_no \"1\" ë°œê²¬:`, {\n                        original: match[1],\n                        trimmed: rawNo,\n                        charCodes: Array.from(rawNo).map(c => c.charCodeAt(0))\n                    });\n                }\n                \n                if (!groupCounters[rawNo]) {\n                    groupCounters[rawNo] = 0;\n                }\n                groupCounters[rawNo]++;\n                \n                const newValue = rawNo + '-' + groupCounters[rawNo];\n                input.value = newValue;\n                console.log(`ì„¤ì •ëœ ê°’: ${newValue}`);\n            } else {\n                console.warn('ì„¸ë¶€ë²ˆí˜¸ ì…ë ¥ í•„ë“œì˜ name ì†ì„±ì„ íŒŒì‹±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤:', name);\n                console.log('Input element:', input);\n            }\n        });\n        \n        console.log('ìë™ ìƒì„± ì™„ë£Œ. ê·¸ë£¹ë³„ ì¹´ìš´í„°:', groupCounters);\n        \n        // ìë™ ìƒì„± í›„ ìë™ìœ¼ë¡œ ì €ì¥\n        setTimeout(() => {\n            saveDetailNumbers();\n        }, 100);\n    };\n    \n    // ì„¸ë¶€ë²ˆí˜¸ ì €ì¥ í›„ ê°’ ìœ ì§€ë¥¼ ìœ„í•œ í•¨ìˆ˜\n    window.saveDetailNumbers = function() {\n        const inputs = document.querySelectorAll('input[name^=\"detail_numbers[\"]');\n        const formData = new FormData();\n        \n        // ì„¸ë¶€ë²ˆí˜¸ ë°ì´í„° ìˆ˜ì§‘\n        inputs.forEach(input => {\n            const name = input.getAttribute('name');\n            const value = input.value.trim();\n            if (value) {\n                formData.append(name, value);\n            }\n        });\n        \n        // ì„œë²„ì— ì €ì¥ ìš”ì²­\n        fetch('manage_events.php?comp_id=<?= urlencode($comp_id) ?>', {\n            method: 'POST',\n            body: formData\n        })\n        .then(response => {\n            if (response.ok) {\n                // ì„±ê³µ ì‹œ ì„±ê³µ ë©”ì‹œì§€ì™€ í•¨ê»˜ í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨\n                alert('ì„¸ë¶€ë²ˆí˜¸ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');\n                // ì•½ê°„ì˜ ì§€ì—° í›„ ìƒˆë¡œê³ ì¹¨í•˜ì—¬ ì„œë²„ ì²˜ë¦¬ ì™„ë£Œ ë³´ì¥\n                setTimeout(() => {\n                    window.location.reload();\n                }, 500);\n            } else {\n                alert('ì„¸ë¶€ë²ˆí˜¸ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n            }\n        })\n        .catch(error => {\n            console.error('Error:', error);\n            alert('ì„¸ë¶€ë²ˆí˜¸ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n        });\n    };\n    </script>\n</head>\n<body>\n<div class=\"mainbox\">\n\n    <div style=\"margin-bottom:1.2em;\">\n        <a href=\"dashboard.php?comp_id=<?= urlencode($comp_id) ?>\" class=\"goto-dash\">&lt; ëŒ€ì‹œë³´ë“œë¡œ</a>\n    </div>\n    <h1>ì´ë²¤íŠ¸ ê´€ë¦¬</h1>\n    \n    <?php if ($msg): ?>\n        <div style=\"color:#03c75a; margin-bottom:1em;\"><?= h($msg) ?></div>\n    <?php endif; ?>\n\n    <!-- ì˜ˆì œíŒŒì¼ ë‹¤ìš´ë¡œë“œ & ì—…ë¡œë“œ í¼ -->\n    <div style=\"margin-bottom:1.2em; display:flex; gap:1.2em; align-items:center; flex-wrap:wrap;\">\n        <a href=\"?comp_id=<?=urlencode($comp_id)?>&download_example=1\" \n           style=\"display:inline-block; background:#003399; color:#fff; border-radius:8px; padding:0.4em 1.5em; font-weight:700; text-decoration:none;\">\n           ì´ë²¤íŠ¸ ì˜ˆì œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ\n        </a>\n        <form method=\"post\" enctype=\"multipart/form-data\" style=\"display:inline-block;\">\n            <input type=\"file\" name=\"eventfile\" accept=\".csv,.txt\" required>\n            <button type=\"submit\" name=\"upload_event\" value=\"1\" style=\"background:#03C75A; color:#fff; border:none; border-radius:8px; padding:0.4em 1.5em; font-weight:700; cursor:pointer;\">ì´ë²¤íŠ¸ íŒŒì¼ ì—…ë¡œë“œ</button>\n        </form>\n        <button onclick=\"saveRoundInfo()\" style=\"background:#FF6B35; color:#fff; border:none; border-radius:8px; padding:0.4em 1.5em; font-weight:700; cursor:pointer;\">\n            ë¼ìš´ë“œ ì •ë³´ ì €ì¥\n        </button>\n    </div>\n    \n    <!-- ì›¹ ì§ì ‘ ì…ë ¥: í•œ ì¤„ ì¶”ê°€ í¼ ë˜ëŠ” ìˆ˜ì • í¼ -->\n    <?php if ($edit_mode): ?>\n    <form method=\"post\" action=\"\" style=\"margin-bottom:2em;\">\n        <fieldset class=\"addbox\" style=\"border:1px solid #bbe; border-radius:8px; padding:0.8em 1em;\">\n            <legend style=\"color:#003399;font-weight:700;\">ì´ë²¤íŠ¸ ìˆ˜ì •</legend>\n            <input type=\"hidden\" name=\"edit_idx\" value=\"<?=h($edit_idx)?>\">\n            <input type=\"text\" name=\"raw_no\" placeholder=\"ìˆœë²ˆ\" style=\"width:4em;\" value=\"<?=h($edit_fields[0]??'')?>\">\n            <input type=\"text\" name=\"name\" placeholder=\"ì´ë²¤íŠ¸ëª…\" style=\"width:12em;\" value=\"<?=h($edit_fields[1]??'')?>\">\n            <select name=\"round_type\" required>\n                <option value=\"\">ë¼ìš´ë“œ</option>\n                <option value=\"Round 1\" <?=($edit_fields[2]??'')==\"Round 1\"?'selected':''?>>Round 1</option>\n                <option value=\"Round 2\" <?=($edit_fields[2]??'')==\"Round 2\"?'selected':''?>>Round 2</option>\n                <option value=\"Round 3\" <?=($edit_fields[2]??'')==\"Round 3\"?'selected':''?>>Round 3</option>\n                <option value=\"Semi-Final\" <?=($edit_fields[2]??'')==\"Semi-Final\"?'selected':''?>>Semi-Final</option>\n                <option value=\"Final\" <?=($edit_fields[2]??'')==\"Final\"?'selected':''?>>Final</option>\n            </select>\n            <input type=\"number\" step=\"1\" name=\"next_qual\" placeholder=\"ì§„ì¶œììˆ˜\" style=\"width:5em;\" value=\"<?=h($edit_fields[4]??'')?>\">\n            <input type=\"text\" name=\"next_event\" placeholder=\"ë‹¤ìŒë¼ìš´ë“œ\" style=\"width:7em;\" value=\"<?=h($edit_fields[5]??'')?>\">\n            <?php for($i=1;$i<=5;$i++): ?>\n                <input class=\"dance-input\" list=\"dance-list\" name=\"dance<?=$i?>\" placeholder=\"ëŒ„ìŠ¤<?=$i?> or ì•½ì–´\" value=\"<?=h($edit_fields[5+$i]??'')?>\">\n            <?php endfor; ?>\n            <datalist id=\"dance-list\">\n                <?php foreach ($dance_types as $abbr => $fullname): ?>\n                    <option value=\"<?=h($abbr)?>\"><?=h($fullname)?> (<?=h($abbr)?>)</option>\n                <?php endforeach; ?>\n            </datalist>\n            <input type=\"text\" name=\"panel_code\" placeholder=\"íŒ¨ë„ì½”ë“œ\" style=\"width:6em;\" value=\"<?=h($edit_fields[11]??'')?>\">\n            <input type=\"number\" step=\"0.1\" name=\"music_time\" placeholder=\"ì‹œê°„(ë¶„)\" style=\"width:5em;\" value=\"<?=h($edit_fields[12]??'')?>\">\n            <button type=\"submit\" style=\"background:#03C75A; color:#fff; border:none; border-radius:8px; padding:0.4em 1.3em; font-weight:700; cursor:pointer;\">\n                ì €ì¥\n            </button>\n            <a href=\"?comp_id=<?=h($comp_id)?>\" style=\"margin-left:0.7em;color:#888;\">ì·¨ì†Œ</a>\n        </fieldset>\n    </form>\n    <?php else: ?>\n    <form method=\"post\" action=\"\" style=\"margin-bottom:2em;\">\n        <fieldset class=\"addbox\" style=\"border:1px solid #bbe; border-radius:8px; padding:0.8em 1em;\">\n            <legend style=\"color:#003399;font-weight:700;\">ìƒˆ ì´ë²¤íŠ¸ ì§ì ‘ ì…ë ¥</legend>\n            <input type=\"text\" name=\"raw_no\" placeholder=\"ìˆœë²ˆ\" style=\"width:4em;\">\n            <input type=\"text\" name=\"name\" placeholder=\"ì´ë²¤íŠ¸ëª…\" style=\"width:12em;\">\n            <select name=\"round_type\" required>\n                <option value=\"\">ë¼ìš´ë“œ</option>\n                <option value=\"Round 1\">Round 1</option>\n                <option value=\"Round 2\">Round 2</option>\n                <option value=\"Round 3\">Round 3</option>\n                <option value=\"Semi-Final\">Semi-Final</option>\n                <option value=\"Final\">Final</option>\n            </select>\n            <input type=\"number\" step=\"1\" name=\"next_qual\" placeholder=\"ì§„ì¶œììˆ˜\" style=\"width:5em;\">\n            <input type=\"text\" name=\"next_event\" placeholder=\"ë‹¤ìŒë¼ìš´ë“œ\" style=\"width:7em;\">\n            <?php for($i=1;$i<=5;$i++): ?>\n                <input class=\"dance-input\" list=\"dance-list\" name=\"dance<?=$i?>\" placeholder=\"ëŒ„ìŠ¤<?=$i?> or ì•½ì–´\">\n            <?php endfor; ?>\n            <datalist id=\"dance-list\">\n                <?php foreach ($dance_types as $abbr => $fullname): ?>\n                    <option value=\"<?=h($abbr)?>\"><?=h($fullname)?> (<?=h($abbr)?>)</option>\n                <?php endforeach; ?>\n            </datalist>\n            <input type=\"text\" name=\"panel_code\" placeholder=\"íŒ¨ë„ì½”ë“œ\" style=\"width:6em;\">\n            <input type=\"number\" step=\"0.1\" name=\"music_time\" placeholder=\"ì‹œê°„(ë¶„)\" style=\"width:5em;\">\n            <button type=\"submit\" name=\"add_event_inline\" value=\"1\" style=\"background:#003399; color:#fff; border:none; border-radius:8px; padding:0.4em 1.3em; font-weight:700; cursor:pointer;\">\n                ì¶”ê°€\n            </button>\n            <span class=\"small\" style=\"color:#888;\">ì˜ˆ: Round 1, Semi-Final, Final, ê²½ê¸°ì™¸(ëŒ„ìŠ¤ ì…ë ¥ X)ë„ ê°€ëŠ¥. <b>ë‹¤ìŒë¼ìš´ë“œ ë²ˆí˜¸ ì…ë ¥ì‹œ ìë™ ìƒì„±</b><br>\n            ëŒ„ìŠ¤ ì…ë ¥: ë²ˆí˜¸(1,2,3...) ë˜ëŠ” ì•½ì–´(W,T,V...) ëª¨ë‘ ê°€ëŠ¥. <b>ëŒ„ìŠ¤ ì •ë ¬ ë²„íŠ¼ìœ¼ë¡œ ìë™ ì •ë ¬</b></span>\n        </fieldset>\n    </form>\n    <?php endif; ?>\n\n    <div class=\"desc\">\n        <b>ë¼ìš´ë“œ ì»¬ëŸ¼ì€ ê°™ì€ ì´ë²¤íŠ¸ëª…ì„ ê°€ì§„ ì´ë²¤íŠ¸ë“¤ì„ ìë™ìœ¼ë¡œ ê·¸ë£¹í™”í•˜ì—¬ Round 1, Round 2, Semi-Final, Final ìˆœì„œë¡œ ê³„ì‚°ë©ë‹ˆë‹¤.</b><br>\n        <b>ê²½ê¸° ì™¸ ì´ë²¤íŠ¸(ë¸Œë ˆì´í¬, ê°œíšŒì‹, ì‹œìƒ ë“±)ëŠ” ë³„ë„ í‘œë¡œ ì •ë¦¬ë˜ì–´ ì‹œê°„í‘œ ê³„ì‚°ì— ì‚¬ìš©ë©ë‹ˆë‹¤.</b><br>\n        ê° ê²½ê¸° ì´ë²¤íŠ¸ì—ëŠ” ìŒì•… ì‹œê°„(ë¶„), ì‹¬ì‚¬ìœ„ì› íŒ¨ë„ ì½”ë“œ, ì¢…ëª© ë“±ì´ í‘œì‹œë©ë‹ˆë‹¤.<br>\n        <span style=\"color:#03c75a;\">ë™ì‹œì§„í–‰ ê·¸ë£¹</span>ì€ 1-1, 1-2, ... í˜•ì‹ìœ¼ë¡œ ë¬¶ì–´ì„œ ë³´ì—¬ì¤ë‹ˆë‹¤.<br>\n        <b>ì„¸ë¶€ë²ˆí˜¸ëŠ” ë©€í‹°ì´ë²¤íŠ¸ ê²°ìŠ¹ì „ì—ì„œ ì‚¬ìš©ë˜ë©°, ìë™ ìƒì„±ë˜ì§€ë§Œ ìˆ˜ì • ê°€ëŠ¥í•©ë‹ˆë‹¤.</b>\n    </div>\n    \n    <!-- ì„¸ë¶€ë²ˆí˜¸ ìˆ˜ì • í¼ -->\n    <div style=\"margin-bottom:20px; background:#f8f9fa; padding:15px; border-radius:8px; border:1px solid #dee2e6;\">\n        <h4 style=\"color:#495057; margin:0 0 15px 0; display:flex; align-items:center; gap:10px;\">\n            <span class=\"material-symbols-rounded\" style=\"font-size:20px;\">edit</span>\n            ì„¸ë¶€ë²ˆí˜¸ ìˆ˜ì •\n        </h4>\n        <form method=\"post\">\n            <div style=\"display:grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap:10px; max-height:300px; overflow-y:auto;\">\n                <?php foreach ($events as $evt): ?>\n                    <div style=\"display:flex; align-items:center; gap:10px; padding:8px; background:white; border-radius:4px; border:1px solid #e9ecef;\">\n                        <label style=\"min-width:60px; font-size:12px; color:#495057; font-weight:600;\">\n                            <?= h($evt['raw_no']) ?>\n                        </label>\n                        <div style=\"flex:1; font-size:11px; color:#6c757d; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;\">\n                            <?= h($evt['name']) ?>\n                        </div>\n                        <input type=\"text\" \n                               name=\"detail_numbers[<?= h(trim($evt['raw_no'])) ?>|<?= h($evt['name']) ?>]\" \n                               value=\"<?= h($evt['detail_no']) ?>\" \n                               style=\"width:70px; padding:4px 6px; border:1px solid #ced4da; border-radius:4px; font-size:12px; text-align:center;\"\n                               placeholder=\"1-1\">\n                    </div>\n                <?php endforeach; ?>\n            </div>\n            <div style=\"margin-top:15px; text-align:center; display:flex; gap:10px; justify-content:center;\">\n                <button type=\"button\" onclick=\"autoGenerateDetailNumbers()\" \n                        style=\"background:#28a745; color:white; border:none; padding:8px 15px; border-radius:4px; font-weight:600; cursor:pointer; font-size:12px;\">\n                    ìë™ ìƒì„±\n                </button>\n                <button type=\"button\" onclick=\"saveDetailNumbers()\" \n                        style=\"background:#ff6b35; color:white; border:none; padding:8px 20px; border-radius:4px; font-weight:600; cursor:pointer; font-size:12px;\">\n                    ì„¸ë¶€ë²ˆí˜¸ ì €ì¥\n                </button>\n            </div>\n        </form>\n    </div>\n    <table>\n        <tr>\n            <th>ìˆœë²ˆ<br>(ê·¸ë£¹)</th>\n            <th>ì„¸ë¶€ë²ˆí˜¸<br>(ë™ì‹œì§„í–‰)</th>\n            <th>ì´ë²¤íŠ¸ëª…</th>\n            <th>ë¼ìš´ë“œ<br>(ìë™ê³„ì‚°)</th>\n            <th>ì§„ì¶œììˆ˜<br>(ê²°ìŠ¹ì œì™¸)</th>\n            <th>ë‹¤ìŒë¼ìš´ë“œ<br>ìˆœë²ˆ(ê²°ìŠ¹ì œì™¸)</th>\n            <th>ëŒ„ìŠ¤(ì¢…ëª©)<br><small>ë²ˆí˜¸.ì´ë¦„ ìˆœ</small></th>\n            <th>ì‹¬ì‚¬ìœ„ì›<br>íŒ¨ë„ì½”ë“œ</th>\n            <th>ì‹œê°„<br>(ë¶„)</th>\n            <th>ê´€ë¦¬</th>\n        </tr>\n        <?php\n        // RunOrder ì¤„ ë²ˆí˜¸ ê¸°ë¡\n        $row_idx = 0;\n        foreach ($grouped_events as $grp_no => $evts):\n            foreach ($evts as $k => $e):\n                // ì´ë²¤íŠ¸ì˜ ì›ë³¸ ì¸ë±ìŠ¤ ì°¾ê¸°\n                $original_idx = null;\n                foreach ($events as $orig_idx => $orig_evt) {\n                    if ($orig_evt['raw_no'] === $e['raw_no'] && $orig_evt['name'] === $e['name']) {\n                        $original_idx = $orig_idx;\n                        break;\n                    }\n                }\n                $calculated_round = $original_idx !== null ? ($round_info[$original_idx] ?? '-') : '-';\n        ?>\n            <tr<?=($k==0 && count($evts)>1?' class=\"event-group-row\"':'')?>>\n                <?php if ($k==0): ?>\n                    <td rowspan=\"<?=count($evts)?>\" style=\"font-weight:bold;\"><?=h($grp_no)?></td>\n                <?php endif; ?>\n                <td><?= h($e['detail_no']) ?></td>\n                <td><?= h($e['name']) ?></td>\n                <td style=\"font-weight:600; color:#0d2c96;\"><?= h($calculated_round) ?></td>\n                <?php if (!($e['round_type']===\"ê²°ìŠ¹\")): ?>\n                    <td><?= h($e['next_qual']) ?></td>\n                    <td><?= h($e['next_event']) ?></td>\n                <?php else: ?>\n                    <td>-</td>\n                    <td>-</td>\n                <?php endif; ?>\n                <td class=\"event-dances\">\n                    <?= render_dances($e['dances'], $dance_types); ?>\n                </td>\n                <td class=\"panel-code-cell\">\n                    <?= h($e['panel_code']) ?>\n                </td>\n                <td>\n                    <?= $e['music_time'] ? number_format($e['music_time'], 1) : '-' ?>\n                </td>\n                <td>\n                    <button class=\"edit-btn\" onclick=\"editEvent(<?=$row_idx?>)\">ìˆ˜ì •</button>\n                    <button class=\"del-btn\" onclick=\"deleteEvent(<?=$row_idx?>)\">ì‚­ì œ</button>\n                </td>\n            </tr>\n        <?php\n            $row_idx++;\n            endforeach;\n        endforeach;\n        if ($row_idx === 0):\n        ?>\n            <tr><td colspan=\"10\" style=\"color:#aaa;\">ì´ë²¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>\n        <?php endif; ?>\n    </table>\n\n    <?php if (!empty($non_competition_events)): ?>\n        <div class=\"noncomp-title\">ê²½ê¸° ì™¸ ì´ë²¤íŠ¸(ì‹œê°„ ê³„ì‚°ìš©)</div>\n        <table class=\"time-table\">\n            <tr>\n                <th>ìˆœë²ˆ</th>\n                <th>ì´ë²¤íŠ¸ëª…</th>\n                <th>ì‹œê°„(ë¶„)</th>\n            </tr>\n            <?php foreach ($non_competition_events as $e): ?>\n            <tr>\n                <td><?= h($e['raw_no']) ?></td>\n                <td><?= h($e['name']) ?></td>\n                <td><?= $e['music_time'] ? number_format($e['music_time'],1) : '-' ?></td>\n            </tr>\n            <?php endforeach; ?>\n            <tr>\n                <td colspan=\"2\" style=\"text-align:right;color:#003399;font-weight:700;\">í•©ê³„</td>\n                <td style=\"font-weight:700;\"><?= number_format(sum_minutes($non_competition_events),1) ?></td>\n            </tr>\n        </table>\n    <?php endif; ?>\n</div>\n</body>\n</html>","size_bytes":50345},"comp/manage_judges.php":{"content":"<?php\nsession_start();\nrequire_once 'auth.php';\nrequire_once 'judge_manager.php';\n\n// ì˜¤ë„ˆ ê¶Œí•œë§Œ ì ‘ê·¼ ê°€ëŠ¥\nrequirePermission('manage_users');\n\n$user = $_SESSION['user'];\n$message = '';\n$error = '';\n\n// ì‹¬ì‚¬ìœ„ì› ì¶”ê°€ ì²˜ë¦¬\nif ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['add_judge'])) {\n    $name = trim($_POST['name'] ?? '');\n    $organization = trim($_POST['organization'] ?? '');\n    $region = trim($_POST['region'] ?? '');\n    $phone = trim($_POST['phone'] ?? '');\n    $email = trim($_POST['email'] ?? '');\n    $specialty = trim($_POST['specialty'] ?? '');\n    \n    if ($name && $organization && $region && $phone && $email && $specialty) {\n        // ì‚¬ì§„ ì—…ë¡œë“œ ì²˜ë¦¬\n        $photo = '';\n        if (isset($_FILES['photo']) && $_FILES['photo']['size'] > 0) {\n            $upload_dir = __DIR__ . '/judges_photos/';\n            if (!is_dir($upload_dir)) {\n                mkdir($upload_dir, 0777, true);\n            }\n            \n            $file_extension = pathinfo($_FILES['photo']['name'], PATHINFO_EXTENSION);\n            $photo = generateJudgeId() . '.' . $file_extension;\n            $upload_path = $upload_dir . $photo;\n            \n            if (move_uploaded_file($_FILES['photo']['tmp_name'], $upload_path)) {\n                // ì‚¬ì§„ ì—…ë¡œë“œ ì„±ê³µ\n            } else {\n                $error = \"ì‚¬ì§„ ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\";\n            }\n        }\n        \n        if (!$error) {\n            $judge_data = [\n                'name' => $name,\n                'organization' => $organization,\n                'region' => $region,\n                'phone' => $phone,\n                'email' => $email,\n                'photo' => $photo,\n                'specialty' => $specialty\n            ];\n            \n            addJudge($judge_data);\n            $message = \"ì‹¬ì‚¬ìœ„ì› '{$name}'ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.\";\n        }\n    } else {\n        $error = \"ëª¨ë“  í•„ìˆ˜ í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.\";\n    }\n}\n\n// ì‹¬ì‚¬ìœ„ì› ì‚­ì œ ì²˜ë¦¬\nif (isset($_GET['delete']) && $_GET['delete']) {\n    $judge_id = $_GET['delete'];\n    $judge = getJudgeById($judge_id);\n    if ($judge) {\n        deleteJudge($judge_id);\n        $message = \"ì‹¬ì‚¬ìœ„ì› '{$judge['name']}'ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.\";\n    }\n}\n\n$judges = loadJudges();\n$regions = getRegions();\n$specialties = getSpecialties();\n\nfunction h($s) { return htmlspecialchars($s ?? ''); }\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>ì‹¬ì‚¬ìœ„ì› ê´€ë¦¬ | danceoffice.net</title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\n    <link href=\"https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded\" rel=\"stylesheet\" />\n    <style>\n        body {\n            background: #181B20;\n            min-height: 100vh;\n            font-size: 14px;\n            line-height: 1.5;\n            margin: 0;\n            padding: 0;\n            font-family: 'Noto Sans KR', sans-serif;\n        }\n        \n        .container {\n            max-width: 1400px;\n            margin: 0 auto;\n            padding: 20px;\n        }\n        \n        .header {\n            background: linear-gradient(135deg, #1a1d21 0%, #181B20 100%);\n            border-radius: 15px;\n            padding: 25px;\n            margin-bottom: 20px;\n            box-shadow: 0 8px 25px rgba(3, 199, 90, 0.15);\n            border: 2px solid #03C75A;\n            text-align: center;\n        }\n        \n        .header h1 {\n            color: #03C75A;\n            font-size: 24px;\n            margin: 0 0 10px 0;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 10px;\n        }\n        \n        .header p {\n            color: #00BFAE;\n            font-size: 16px;\n            margin: 0;\n        }\n        \n        .nav {\n            display: flex;\n            gap: 15px;\n            margin-top: 20px;\n            justify-content: center;\n            flex-wrap: wrap;\n        }\n        \n        .nav a {\n            color: white;\n            text-decoration: none;\n            font-weight: 600;\n            font-size: 14px;\n            padding: 10px 20px;\n            border-radius: 20px;\n            background: rgba(3, 199, 90, 0.1);\n            backdrop-filter: blur(10px);\n            transition: all 0.3s ease;\n            display: flex;\n            align-items: center;\n            gap: 5px;\n        }\n        \n        .nav a:hover {\n            background: #03C75A;\n            color: #222;\n            transform: translateY(-2px);\n        }\n        \n        .card {\n            background: #222;\n            border-radius: 15px;\n            padding: 25px;\n            margin-bottom: 20px;\n            box-shadow: 0 8px 25px rgba(3, 199, 90, 0.08);\n            border: 1px solid #31343a;\n        }\n        \n        .card h3 {\n            color: #03C75A;\n            font-size: 18px;\n            margin: 0 0 20px 0;\n            display: flex;\n            align-items: center;\n            gap: 10px;\n        }\n        \n        .form-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n            gap: 20px;\n        }\n        \n        .form-group {\n            margin-bottom: 15px;\n        }\n        \n        .form-group label {\n            display: block;\n            color: #F5F7FA;\n            font-size: 13px;\n            margin-bottom: 5px;\n            font-weight: 600;\n        }\n        \n        .form-group input,\n        .form-group select {\n            width: 100%;\n            padding: 10px;\n            border: 1px solid #31343a;\n            border-radius: 8px;\n            background: #181B20;\n            color: #F5F7FA;\n            font-size: 13px;\n            box-sizing: border-box;\n        }\n        \n        .form-group select {\n            cursor: pointer;\n        }\n        \n        .form-group select option {\n            background: #181B20;\n            color: #F5F7FA;\n        }\n        \n        .btn {\n            background: linear-gradient(90deg, #03C75A 70%, #00BFAE 100%);\n            color: #222;\n            border: none;\n            padding: 10px 20px;\n            border-radius: 20px;\n            font-weight: 600;\n            font-size: 13px;\n            cursor: pointer;\n            transition: all 0.3s ease;\n        }\n        \n        .btn:hover {\n            background: linear-gradient(90deg, #00BFAE 60%, #03C75A 100%);\n            color: white;\n            transform: translateY(-2px);\n        }\n        \n        .btn-danger {\n            background: linear-gradient(90deg, #ff4444 70%, #cc0000 100%);\n            color: white;\n        }\n        \n        .btn-danger:hover {\n            background: linear-gradient(90deg, #cc0000 60%, #ff4444 100%);\n        }\n        \n        .btn-small {\n            padding: 6px 12px;\n            font-size: 11px;\n        }\n        \n        .message {\n            color: #03C75A;\n            background: rgba(3, 199, 90, 0.1);\n            padding: 10px;\n            border-radius: 8px;\n            margin-bottom: 15px;\n            font-size: 13px;\n        }\n        \n        .error {\n            color: #ff4444;\n            background: rgba(255, 68, 68, 0.1);\n            padding: 10px;\n            border-radius: 8px;\n            margin-bottom: 15px;\n            font-size: 13px;\n        }\n        \n        .judges-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\n            gap: 20px;\n        }\n        \n        .judge-card {\n            background: #181B20;\n            border-radius: 12px;\n            padding: 20px;\n            border: 1px solid #31343a;\n            transition: all 0.3s ease;\n        }\n        \n        .judge-card:hover {\n            border-color: #03C75A;\n            box-shadow: 0 4px 15px rgba(3, 199, 90, 0.1);\n        }\n        \n        .judge-photo {\n            width: 80px;\n            height: 80px;\n            border-radius: 50%;\n            object-fit: cover;\n            margin: 0 auto 15px auto;\n            display: block;\n            border: 2px solid #03C75A;\n        }\n        \n        .judge-name {\n            color: #03C75A;\n            font-size: 16px;\n            font-weight: 600;\n            text-align: center;\n            margin-bottom: 10px;\n        }\n        \n        .judge-info {\n            color: #F5F7FA;\n            font-size: 12px;\n            margin-bottom: 8px;\n        }\n        \n        .judge-info strong {\n            color: #00BFAE;\n        }\n        \n        .judge-actions {\n            display: flex;\n            gap: 8px;\n            margin-top: 15px;\n            justify-content: center;\n        }\n        \n        .empty-state {\n            text-align: center;\n            color: #8A8D93;\n            font-size: 14px;\n            padding: 40px 20px;\n            grid-column: 1 / -1;\n        }\n        \n        .stats {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n            gap: 15px;\n            margin-bottom: 20px;\n        }\n        \n        .stat-card {\n            background: #181B20;\n            border-radius: 10px;\n            padding: 15px;\n            text-align: center;\n            border: 1px solid #31343a;\n        }\n        \n        .stat-number {\n            color: #03C75A;\n            font-size: 24px;\n            font-weight: 600;\n            margin-bottom: 5px;\n        }\n        \n        .stat-label {\n            color: #8A8D93;\n            font-size: 12px;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <header class=\"header\">\n            <h1>\n                <span class=\"material-symbols-rounded\">group</span>\n                ì‹¬ì‚¬ìœ„ì› ì¸ëª…ì‚¬ì „\n            </h1>\n            <p>êµ­ë‚´ ì‹¬ì‚¬ìœ„ì› ì •ë³´ ê´€ë¦¬ ì‹œìŠ¤í…œ</p>\n            <nav class=\"nav\">\n                <a href=\"index.php\">\n                    <span class=\"material-symbols-rounded\">sports</span>\n                    ëŒ€íšŒ ê´€ë¦¬\n                </a>\n                <a href=\"manage_users.php\">\n                    <span class=\"material-symbols-rounded\">admin_panel_settings</span>\n                    ì‚¬ìš©ì ê´€ë¦¬\n                </a>\n                <a href=\"logout.php\">\n                    <span class=\"material-symbols-rounded\">logout</span>\n                    ë¡œê·¸ì•„ì›ƒ\n                </a>\n            </nav>\n        </header>\n        \n        <div class=\"stats\">\n            <div class=\"stat-card\">\n                <div class=\"stat-number\"><?= count($judges) ?></div>\n                <div class=\"stat-label\">ì´ ì‹¬ì‚¬ìœ„ì›</div>\n            </div>\n            <div class=\"stat-card\">\n                <div class=\"stat-number\"><?= count(array_unique(array_column($judges, 'region'))) ?></div>\n                <div class=\"stat-label\">ì§€ì—­ ìˆ˜</div>\n            </div>\n            <div class=\"stat-card\">\n                <div class=\"stat-number\"><?= count(array_unique(array_column($judges, 'specialty'))) ?></div>\n                <div class=\"stat-label\">ì „ë¬¸ ë¶„ì•¼</div>\n            </div>\n        </div>\n        \n        <div class=\"card\">\n            <h3>\n                <span class=\"material-symbols-rounded\">person_add</span>\n                ì‹¬ì‚¬ìœ„ì› ì¶”ê°€\n            </h3>\n            <?php if ($message): ?>\n                <div class=\"message\"><?= h($message) ?></div>\n            <?php endif; ?>\n            <?php if ($error): ?>\n                <div class=\"error\"><?= h($error) ?></div>\n            <?php endif; ?>\n            <form method=\"post\" enctype=\"multipart/form-data\">\n                <div class=\"form-grid\">\n                    <div class=\"form-group\">\n                        <label for=\"name\">ì´ë¦„ *</label>\n                        <input type=\"text\" id=\"name\" name=\"name\" placeholder=\"ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”\" required>\n                    </div>\n                    <div class=\"form-group\">\n                        <label for=\"organization\">ì†Œì† *</label>\n                        <input type=\"text\" id=\"organization\" name=\"organization\" placeholder=\"ì†Œì†ì„ ì…ë ¥í•˜ì„¸ìš”\" required>\n                    </div>\n                    <div class=\"form-group\">\n                        <label for=\"region\">ì§€ì—­ *</label>\n                        <select id=\"region\" name=\"region\" required>\n                            <option value=\"\">ì§€ì—­ì„ ì„ íƒí•˜ì„¸ìš”</option>\n                            <?php foreach ($regions as $region): ?>\n                                <option value=\"<?= h($region) ?>\"><?= h($region) ?></option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                    <div class=\"form-group\">\n                        <label for=\"phone\">ì—°ë½ì²˜ *</label>\n                        <input type=\"tel\" id=\"phone\" name=\"phone\" placeholder=\"010-1234-5678\" required>\n                    </div>\n                    <div class=\"form-group\">\n                        <label for=\"email\">ì´ë©”ì¼ *</label>\n                        <input type=\"email\" id=\"email\" name=\"email\" placeholder=\"email@example.com\" required>\n                    </div>\n                    <div class=\"form-group\">\n                        <label for=\"specialty\">ì „ë¬¸ ë¶„ì•¼ *</label>\n                        <select id=\"specialty\" name=\"specialty\" required>\n                            <option value=\"\">ì „ë¬¸ ë¶„ì•¼ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>\n                            <?php foreach ($specialties as $specialty): ?>\n                                <option value=\"<?= h($specialty) ?>\"><?= h($specialty) ?></option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                    <div class=\"form-group\">\n                        <label for=\"photo\">ì¦ëª…ì‚¬ì§„</label>\n                        <input type=\"file\" id=\"photo\" name=\"photo\" accept=\"image/*\">\n                    </div>\n                </div>\n                <button type=\"submit\" name=\"add_judge\" class=\"btn\">\n                    <span class=\"material-symbols-rounded\">add</span>\n                    ì‹¬ì‚¬ìœ„ì› ì¶”ê°€\n                </button>\n            </form>\n        </div>\n        \n        <div class=\"card\">\n            <h3>\n                <span class=\"material-symbols-rounded\">list</span>\n                ì‹¬ì‚¬ìœ„ì› ëª©ë¡\n            </h3>\n            <?php if (empty($judges)): ?>\n                <div class=\"empty-state\">ë“±ë¡ëœ ì‹¬ì‚¬ìœ„ì›ì´ ì—†ìŠµë‹ˆë‹¤.</div>\n            <?php else: ?>\n                <div class=\"judges-grid\">\n                    <?php foreach ($judges as $judge): ?>\n                        <div class=\"judge-card\">\n                            <?php if ($judge['photo'] && file_exists(__DIR__ . '/judges_photos/' . $judge['photo'])): ?>\n                                <img src=\"judges_photos/<?= h($judge['photo']) ?>\" class=\"judge-photo\" alt=\"<?= h($judge['name']) ?>\">\n                            <?php else: ?>\n                                <div class=\"judge-photo\" style=\"background: #31343a; display: flex; align-items: center; justify-content: center; color: #8A8D93;\">\n                                    <span class=\"material-symbols-rounded\">person</span>\n                                </div>\n                            <?php endif; ?>\n                            \n                            <div class=\"judge-name\"><?= h($judge['name']) ?></div>\n                            \n                            <div class=\"judge-info\">\n                                <strong>ì†Œì†:</strong> <?= h($judge['organization']) ?>\n                            </div>\n                            <div class=\"judge-info\">\n                                <strong>ì§€ì—­:</strong> <?= h($judge['region']) ?>\n                            </div>\n                            <div class=\"judge-info\">\n                                <strong>ì—°ë½ì²˜:</strong> <?= h($judge['phone']) ?>\n                            </div>\n                            <div class=\"judge-info\">\n                                <strong>ì´ë©”ì¼:</strong> <?= h($judge['email']) ?>\n                            </div>\n                            <div class=\"judge-info\">\n                                <strong>ì „ë¬¸ë¶„ì•¼:</strong> <?= h($judge['specialty']) ?>\n                            </div>\n                            \n                            <div class=\"judge-actions\">\n                                <a href=\"?delete=<?= urlencode($judge['id']) ?>\" \n                                   class=\"btn btn-danger btn-small\" \n                                   onclick=\"return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')\">\n                                    <span class=\"material-symbols-rounded\">delete</span>\n                                    ì‚­ì œ\n                                </a>\n                            </div>\n                        </div>\n                    <?php endforeach; ?>\n                </div>\n            <?php endif; ?>\n        </div>\n    </div>\n</body>\n</html>\n\n\n\n\n\n\n","size_bytes":17022},"comp/manage_timetable.php":{"content":"<?php\n$comp_id = $_GET['comp_id'] ?? '';\n$data_dir = __DIR__ . \"/data/$comp_id\";\n$info_file = \"$data_dir/info.json\";\n$runorder_file = \"$data_dir/RunOrder_Tablet.txt\";\n$dance_file = \"$data_dir/DanceName.txt\";\n\n// ëŒ€íšŒ ì •ë³´ ë¡œë“œ\nif (!preg_match('/^\\d{8}-\\d+$/', $comp_id) || !is_file($info_file)) {\n    echo \"<h1>ì˜ëª»ëœ ëŒ€íšŒ ID ë˜ëŠ” ëŒ€íšŒ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</h1>\";\n    exit;\n}\n$info = json_decode(file_get_contents($info_file), true);\n\n// ëŒ„ìŠ¤ ì•½ì–´ => í’€ë„¤ì„ ë§¤í•‘\n$dance_types = [];\nif (file_exists($dance_file)) {\n    $lines = file($dance_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        if (preg_match('/^bom/', $line)) continue;\n        $cols = array_map('trim', explode(',', $line));\n        if (isset($cols[2]) && $cols[2] && isset($cols[1]) && $cols[1]) {\n            $dance_types[strtoupper($cols[2])] = $cols[1]; // ì•½ì(ëŒ€ë¬¸ì) => í’€ë„¤ì„\n        }\n    }\n}\n\n// ì‹œê°„ ì…ë ¥ ì²˜ë¦¬\nfunction padzero($n) { return str_pad($n, 2, \"0\", STR_PAD_LEFT); }\nfunction to_time($s) {\n    if (strpos($s, ':') !== false) {\n        [$h, $m] = explode(':', $s);\n        return intval($h) * 60 + intval($m);\n    }\n    return intval($s);\n}\nfunction to_hm($m) {\n    $h = floor($m / 60);\n    $m = (int)$m % 60;\n    return padzero($h) . ':' . padzero($m);\n}\n$start_time_str = $_POST['start_time'] ?? '09:00';\n$opening_time_str = $_POST['opening_time'] ?? '10:30';\n$start_time_min = to_time($start_time_str);\n$opening_time_min = to_time($opening_time_str);\n\n// ì¶”ê°€ ì‹œê°„ ì €ì¥ ì²˜ë¦¬\nif (isset($_POST['save_extra_times']) && isset($_POST['extra_times'])) {\n    $extra_times = $_POST['extra_times'];\n    $lines = file($runorder_file, FILE_IGNORE_NEW_LINES);\n    $new_lines = [];\n    \n    foreach ($lines as $line) {\n        if (preg_match('/^bom/', $line)) {\n            $new_lines[] = $line;\n            continue;\n        }\n        \n        $cols = explode(\",\", $line);\n        if (count($cols) >= 14) {\n            $event_no = $cols[0];\n            $extra_time = isset($extra_times[$event_no]) ? intval($extra_times[$event_no]) : 0;\n            \n            // 15ë²ˆì§¸ ì»¬ëŸ¼ì´ ì—†ìœ¼ë©´ ì¶”ê°€\n            while (count($cols) < 15) {\n                $cols[] = '';\n            }\n            $cols[14] = $extra_time; // 15ë²ˆì§¸ ì»¬ëŸ¼ì— ì¶”ê°€ ì‹œê°„ ì €ì¥\n            $new_lines[] = implode(\",\", $cols);\n        } else {\n            $new_lines[] = $line;\n        }\n    }\n    \n    file_put_contents($runorder_file, implode(\"\\n\", $new_lines));\n    header(\"Location: manage_timetable.php?comp_id=\" . urlencode($comp_id));\n    exit;\n}\n\n// íŠ¹ë³„ ì´ë²¤íŠ¸ ì €ì¥ ì²˜ë¦¬\nif (isset($_POST['save_special_events'])) {\n    $special_events = $_POST['special_events'] ?? [];\n    $special_events_file = \"$data_dir/special_events.json\";\n    file_put_contents($special_events_file, json_encode($special_events, JSON_UNESCAPED_UNICODE));\n    header(\"Location: manage_timetable.php?comp_id=\" . urlencode($comp_id));\n    exit;\n}\n\n// íŠ¹ë³„ ì´ë²¤íŠ¸ ì¶”ê°€ ì²˜ë¦¬\nif (isset($_POST['add_special_event'])) {\n    $name = trim($_POST['special_event_name'] ?? '');\n    $after_event = intval($_POST['special_event_after'] ?? 1);\n    $duration = intval($_POST['special_event_duration'] ?? 10);\n    \n    if (!empty($name) && $duration > 0) {\n        $special_events_file = \"$data_dir/special_events.json\";\n        $special_events = [];\n        if (file_exists($special_events_file)) {\n            $special_events = json_decode(file_get_contents($special_events_file), true) ?? [];\n        }\n        \n        $event_id = uniqid();\n        $special_events[$event_id] = [\n            'name' => $name,\n            'after_event' => $after_event,\n            'duration' => $duration\n        ];\n        \n        file_put_contents($special_events_file, json_encode($special_events, JSON_UNESCAPED_UNICODE));\n    }\n    header(\"Location: manage_timetable.php?comp_id=\" . urlencode($comp_id));\n    exit;\n}\n\n// íŠ¹ë³„ ì´ë²¤íŠ¸ ì‚­ì œ ì²˜ë¦¬\nif (isset($_POST['delete_special_event'])) {\n    $event_id = $_POST['event_id'];\n    $special_events_file = \"$data_dir/special_events.json\";\n    if (file_exists($special_events_file)) {\n        $special_events = json_decode(file_get_contents($special_events_file), true) ?? [];\n        unset($special_events[$event_id]);\n        file_put_contents($special_events_file, json_encode($special_events, JSON_UNESCAPED_UNICODE));\n    }\n    header(\"Location: manage_timetable.php?comp_id=\" . urlencode($comp_id));\n    exit;\n}\n\n// ì €ì¥ëœ ì¶”ê°€ ì‹œê°„ ë¶ˆëŸ¬ì˜¤ê¸°\n$extra_times = [];\nif (file_exists($runorder_file)) {\n    $lines = file($runorder_file, FILE_IGNORE_NEW_LINES);\n    foreach ($lines as $line) {\n        if (preg_match('/^bom/', $line)) continue;\n        $cols = explode(\",\", $line);\n        if (count($cols) >= 15) {\n            $event_no = $cols[0];\n            $extra_time = !empty($cols[14]) ? intval($cols[14]) : 0;\n            $extra_times[$event_no] = $extra_time;\n            if ($event_no == '1') {\n                echo \"<!-- ë””ë²„ê¹… extra_times ì½ê¸°: ìˆœë²ˆ 1, cols[14]=\" . $cols[14] . \", extra_time=$extra_time -->\";\n            }\n        }\n    }\n}\n\n// ì €ì¥ëœ íŠ¹ë³„ ì´ë²¤íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸°\n$special_events = [];\n$special_events_file = \"$data_dir/special_events.json\";\nif (file_exists($special_events_file)) {\n    $special_events = json_decode(file_get_contents($special_events_file), true) ?? [];\n}\n\n// ì €ì¥ëœ ë¼ìš´ë“œ ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸°\n$round_info = [];\n$round_info_file = \"$data_dir/round_info.json\";\nif (file_exists($round_info_file)) {\n    $round_data = json_decode(file_get_contents($round_info_file), true);\n    if ($round_data && isset($round_data['round_info'])) {\n        $round_info = $round_data['round_info'];\n    }\n}\n\n// RunOrderì—ì„œ ì´ë²¤íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸°\n$events = [];\n$raw_no_groups = []; // raw_noë³„ë¡œ ê·¸ë£¹í™”\n\nif (file_exists($runorder_file)) {\n    $lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        if (preg_match('/^bom/', $line)) continue;\n        $cols = array_map('trim', explode(',', $line));\n        // ìˆœë²ˆ,ì´ë²¤íŠ¸ëª…,ë¼ìš´ë“œíƒ€ì…,ë¼ìš´ë“œì°¨ìˆ˜,ì§„ì¶œììˆ˜,ë‹¤ìŒë¼ìš´ë“œ,ëŒ„ìŠ¤1~5,íŒ¨ë„ì½”ë“œ,ì‹œê°„(ë¶„),ì„¸ë¶€ë²ˆí˜¸\n        $no = $cols[0] ?? '';\n        $desc = $cols[1] ?? '';\n        $roundtype = $cols[2] ?? '';\n        $roundnum = $cols[3] ?? '';\n        $detail_no = $cols[13] ?? ''; // ì„¸ë¶€ë²ˆí˜¸ ì¶”ê°€\n        $dances = [];\n        for ($i = 6; $i <= 10; $i++) {\n            if (!empty($cols[$i])) $dances[] = $cols[$i];\n        }\n        if (count($dances) === 0) continue; // ê²½ê¸° ì™¸ ì´ë²¤íŠ¸ëŠ” íƒ€ì„í…Œì´ë¸”ì—ì„œ ì œì™¸\n        \n        $dances_full = [];\n        foreach ($dances as $abbr) {\n            // ìˆ«ìë¡œ ëœ ëŒ„ìŠ¤ ì½”ë“œë¥¼ ì²˜ë¦¬\n            if (is_numeric($abbr)) {\n                $dance_num = intval($abbr);\n                // DanceName.txtì—ì„œ í•´ë‹¹ ë²ˆí˜¸ì˜ ëŒ„ìŠ¤ ì°¾ê¸°\n                $found_dance = '';\n                if (file_exists($dance_file)) {\n                    $lines = file($dance_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n                    foreach ($lines as $line) {\n                        if (preg_match('/^bom/', $line)) continue;\n                        $cols = array_map('trim', explode(',', $line));\n                        if (isset($cols[0]) && intval($cols[0]) === $dance_num) {\n                            $found_dance = $cols[1] ?? '';\n                            break;\n                        }\n                    }\n                }\n                $dances_full[] = $found_dance ?: $abbr;\n            } else {\n                // ì•½ì–´ë¡œ ëœ ëŒ„ìŠ¤ ì½”ë“œë¥¼ ì²˜ë¦¬\n                $abbr_up = strtoupper($abbr);\n                $dances_full[] = isset($dance_types[$abbr_up]) ? $dance_types[$abbr_up] : $abbr;\n            }\n        }\n        \n        // raw_noë³„ë¡œ ê·¸ë£¹í™”\n        if (!isset($raw_no_groups[$no])) {\n            $raw_no_groups[$no] = [];\n        }\n        $extra_time = isset($cols[14]) && !empty($cols[14]) ? intval($cols[14]) : 0;\n        if ($no == '1') {\n            echo \"<!-- ë””ë²„ê¹… ìˆœë²ˆ 1: cols[14]=\" . (isset($cols[14]) ? $cols[14] : 'ì—†ìŒ') . \", extra_time=$extra_time -->\";\n        }\n        $raw_no_groups[$no][] = [\n            'no' => $no,\n            'desc' => $desc,\n            'roundtype' => $roundtype,\n            'roundnum' => $roundnum,\n            'detail_no' => $detail_no,\n            'dances' => $dances_full,\n            'dance_count' => count($dances_full),\n            'extra_time' => $extra_time\n        ];\n    }\n}\n\n// ê° raw_no ê·¸ë£¹ì—ì„œ ëŒ„ìŠ¤ ìˆ˜ê°€ ê°€ì¥ ë§ì€ ì´ë²¤íŠ¸ë¥¼ ì°¾ì•„ ì‹œê°„ ê³„ì‚°ìš©ìœ¼ë¡œ ì‚¬ìš©\nforeach ($raw_no_groups as $raw_no => $group) {\n    // ëŒ„ìŠ¤ ìˆ˜ê°€ ê°€ì¥ ë§ì€ ì´ë²¤íŠ¸ ì°¾ê¸° (ì‹œê°„ ê³„ì‚°ìš©)\n    $max_dance_count = 0;\n    $selected_event = null;\n    \n    foreach ($group as $event) {\n        if ($event['dance_count'] > $max_dance_count) {\n            $max_dance_count = $event['dance_count'];\n            $selected_event = $event;\n        }\n    }\n    \n    if ($selected_event) {\n        $base_time = 1.5; // ê¸°ë³¸ ì‹œê°„ (ë¶„)\n        $duration = $base_time * $max_dance_count; // ì¢…ëª©ìˆ˜ë§Œí¼ ê³±í•˜ê¸°!\n        \n        // ì €ì¥ëœ ë¼ìš´ë“œ ì •ë³´ê°€ ìˆìœ¼ë©´ ì‚¬ìš©, ì—†ìœ¼ë©´ ê¸°ì¡´ ë°©ì‹ ì‚¬ìš©\n        $event_idx = count($events);\n        $calculated_round = isset($round_info[$event_idx]) ? $round_info[$event_idx] : \n                           ($selected_event['roundtype'] . ($selected_event['roundtype'] === 'ì˜ˆì„ ì „' && $selected_event['roundnum'] ? \" $selected_event[roundnum]ì°¨\" : ''));\n        \n        // ë©€í‹°ì´ë²¤íŠ¸ì˜ ê²½ìš° raw_no ê¸°ì¤€ìœ¼ë¡œ ì¶”ê°€ ì‹œê°„ ì‚¬ìš©\n        $extra_time = isset($extra_times[$raw_no]) ? $extra_times[$raw_no] : 0;\n        \n        $events[] = [\n            'no' => $selected_event['no'],\n            'desc' => $selected_event['desc'],\n            'round' => $calculated_round,\n            'dances' => $selected_event['dances'],\n            'duration' => $duration,\n            'detail_no' => $selected_event['detail_no'],\n            'extra_time' => $extra_time, // raw_no ê¸°ì¤€ìœ¼ë¡œ ì¶”ê°€ ì‹œê°„ ì„¤ì •\n            'group_events' => $group, // ë©€í‹°ì´ë²¤íŠ¸ ì •ë³´ ì €ì¥ (ëª¨ë“  ì´ë²¤íŠ¸ í¬í•¨)\n        ];\n        \n        // ë””ë²„ê¹…: ìˆœë²ˆ 1ì˜ ì¶”ê°€ ì‹œê°„ í™•ì¸\n        if ($selected_event['no'] == '1') {\n            echo \"<!-- ë””ë²„ê¹… ì´ë²¤íŠ¸ ë°°ì—´: ìˆœë²ˆ 1, extra_time=\" . $extra_time . \" -->\";\n        }\n    }\n}\n\n// íƒ€ì„í…Œì´ë¸” ê³„ì‚°: ê° ì´ë²¤íŠ¸ì˜ ì‹œì‘/ì¢…ë£Œ ì‹œê°„ êµ¬í•˜ê¸°\n$rows = [];\n$cur_min = $start_time_min;\n$opening_row_idx = null;\n\nfor ($i = 0; $i < count($events); $i++) {\n    // ê°œíšŒì‹ ì‹œê° ë„ë‹¬ ì „ì´ë©´ ê³„ì† ì§„í–‰\n    if ($cur_min < $opening_time_min && $cur_min + $events[$i]['duration'] >= $opening_time_min && $opening_row_idx === null) {\n        // ê°œíšŒì‹ ì‚½ì…\n        $rows[] = [\n            'no' => '',\n            'desc' => 'ê°œíšŒì‹',\n            'round' => '',\n            'dances' => [],\n            'start' => $opening_time_min,\n            'end' => $opening_time_min + 20, // ê¸°ë³¸ 20ë¶„ ì˜ˆì‹œ\n            'is_opening' => true\n        ];\n        $cur_min = $opening_time_min + 20;\n        $opening_row_idx = count($rows) - 1;\n    }\n    \n    // íŠ¹ë³„ ì´ë²¤íŠ¸ í™•ì¸ (í˜„ì¬ ì´ë²¤íŠ¸ ë²ˆí˜¸ í›„ì— ì‚½ì…í•  íŠ¹ë³„ ì´ë²¤íŠ¸)\n    $event_no = $events[$i]['no'];\n    foreach ($special_events as $special_event) {\n        if ($special_event['after_event'] == $event_no) {\n            $special_duration = intval($special_event['duration']);\n            $rows[] = [\n                'no' => '',\n                'desc' => $special_event['name'],\n                'round' => '',\n                'dances' => [],\n                'start' => $cur_min,\n                'end' => $cur_min + $special_duration,\n                'is_special' => true,\n                'special_type' => $special_event['name']\n            ];\n            $cur_min += $special_duration;\n        }\n    }\n    \n    // ì¶”ê°€ ì‹œê°„ ì ìš©\n    $extra_time = $events[$i]['extra_time'] ?? 0;\n    $total_duration = $events[$i]['duration'] + $extra_time;\n    \n    $rows[] = [\n        'no' => $events[$i]['no'],\n        'desc' => $events[$i]['desc'],\n        'round' => $events[$i]['round'],\n        'dances' => $events[$i]['dances'],\n        'detail_no' => $events[$i]['detail_no'], // ì„¸ë¶€ë²ˆí˜¸ ì¶”ê°€\n        'start' => $cur_min,\n        'end' => $cur_min + $total_duration,\n        'is_opening' => false,\n        'group_events' => $events[$i]['group_events'] ?? [], // ë©€í‹°ì´ë²¤íŠ¸ ì •ë³´ ì¶”ê°€\n        'extra_time' => $extra_time, // ì¶”ê°€ ì‹œê°„ ì •ë³´\n    ];\n    $cur_min += $total_duration;\n}\n\n// ê°œíšŒì‹ ì „ ì´ë²¤íŠ¸ ì‹œê°„ ë¶€ì¡±/ì´ˆê³¼ ì²´í¬\n$total_pre_opening = 0;\nforeach ($rows as $r) {\n    if (isset($r['is_opening']) && $r['is_opening']) break;\n    $total_pre_opening += ($r['end'] - $r['start']);\n}\n$warning = '';\nif ($total_pre_opening < ($opening_time_min - $start_time_min)) {\n    $lack = ($opening_time_min - $start_time_min) - $total_pre_opening;\n    $warning = \"ê°œíšŒì‹ ì „ ì´ë²¤íŠ¸ ì‹œê°„ì´ \" . intval($lack) . \"ë¶„ ë¶€ì¡±í•©ë‹ˆë‹¤.\";\n} elseif ($total_pre_opening > ($opening_time_min - $start_time_min)) {\n    $over = $total_pre_opening - ($opening_time_min - $start_time_min);\n    $warning = \"ê°œíšŒì‹ ì „ ì´ë²¤íŠ¸ ì‹œê°„ì´ \" . intval($over) . \"ë¶„ ì´ˆê³¼í•©ë‹ˆë‹¤.\";\n}\n\nfunction h($s) { return htmlspecialchars($s ?? ''); }\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title><?= h($info['title']) ?> íƒ€ì„í…Œì´ë¸” | danceoffice.net COMP</title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\n    <style>\n        body { background:#1a1a1a; font-family:sans-serif; margin:0;}\n        .ttbox { max-width:1200px; margin:3vh auto 0 auto; background:#222; border-radius:18px; box-shadow:0 6px 32px #00339922; padding:2.7em 2em 2.2em 2em;}\n        h1 { color:#03C75A; font-size:1.25em; margin-bottom:0.6em;}\n        table { width:100%; border-collapse:collapse; background:#222; }\n        th, td { padding:0.45em 0.3em; text-align:center; font-size:0.98em;}\n        th { background:#202433; color:#03C75A; font-weight:700;}\n        td { color:#eee;}\n        tr:not(:last-child) td { border-bottom:1px solid #393a4a;}\n        .opening-row { background:#e4f7ff !important; color:#0079b8 !important;}\n        .warn { color:#ec3b28; font-weight:700; margin-bottom:1em;}\n        .ttform {margin-bottom:1.5em;}\n        input[type=\"time\"] {padding:0.3em 0.9em; font-size:1em;}\n        .ttform label {margin-right:1.1em;}\n        .ttform button {background:#03C75A;color:#fff;border:none;border-radius:8px;padding:0.5em 1.5em;font-weight:700;font-size:1.07em;cursor:pointer;}\n        .ttform button:hover {background:#009f5d;}\n        .goto-dash {display:inline-block;margin-bottom:1.2em;color:#bbb;}\n        .goto-dash:hover {color:#03C75A;}\n        @media (max-width:1050px) {\n            .ttbox {max-width:99vw;}\n        }\n        @media (max-width:700px) {\n            .ttbox {padding:1.3em 0.2em;}\n        }\n    </style>\n    <script>\n        function saveExtraTime(eventNo, value) {\n            console.log('saveExtraTime í˜¸ì¶œë¨:', eventNo, value);\n            \n            // í¼ ìƒì„±\n            const form = document.createElement('form');\n            form.method = 'post';\n            form.style.display = 'none';\n            \n            // ì¶”ê°€ ì‹œê°„ ë°ì´í„° ì¶”ê°€\n            const extraTimeInput = document.createElement('input');\n            extraTimeInput.type = 'hidden';\n            extraTimeInput.name = 'extra_times[' + eventNo + ']';\n            extraTimeInput.value = value;\n            form.appendChild(extraTimeInput);\n            \n            // ì €ì¥ í”Œë˜ê·¸ ì¶”ê°€\n            const saveFlag = document.createElement('input');\n            saveFlag.type = 'hidden';\n            saveFlag.name = 'save_extra_times';\n            saveFlag.value = '1';\n            form.appendChild(saveFlag);\n            \n            console.log('í¼ ë°ì´í„°:', {\n                eventNo: eventNo,\n                value: value,\n                formHTML: form.outerHTML\n            });\n            \n            // í¼ì„ bodyì— ì¶”ê°€í•˜ê³  ì œì¶œ\n            document.body.appendChild(form);\n            console.log('í¼ ì œì¶œ ì „');\n            form.submit();\n        }\n        \n        // ëŒ€íšŒ ëŒ€ì‰¬ë³´ë“œë¡œ í‘¸ì‹œí•˜ëŠ” í•¨ìˆ˜\n        function pushTimetableToDashboard() {\n            if (!confirm('íƒ€ì„í…Œì´ë¸”ì„ ëŒ€íšŒ ëŒ€ì‰¬ë³´ë“œì— í‘¸ì‹œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {\n                return;\n            }\n            \n            const button = event.target;\n            const originalText = button.innerHTML;\n            button.innerHTML = 'â³ í‘¸ì‹œ ì¤‘...';\n            button.disabled = true;\n            \n            const formData = new FormData();\n            formData.append('comp_id', '<?= h($comp_id) ?>');\n            \n            fetch('push_timetable.php', {\n                method: 'POST',\n                body: formData\n            })\n            .then(response => response.json())\n            .then(data => {\n                if (data.success) {\n                    alert('âœ… ' + data.message + '\\n\\n' +\n                          'ëŒ€íšŒëª…: ' + data.data.competition_title + '\\n' +\n                          'ì´ë²¤íŠ¸ ìˆ˜: ' + data.data.events_count + 'ê°œ\\n' +\n                          'íŠ¹ë³„ ì´ë²¤íŠ¸: ' + data.data.special_events_count + 'ê°œ\\n' +\n                          'í‘¸ì‹œ ì™„ë£Œ: ' + data.data.pushed_at);\n                    \n                    // ì„±ê³µ ì‹œ ë²„íŠ¼ ìƒ‰ìƒ ë³€ê²½\n                    button.style.background = '#10b981';\n                    button.innerHTML = 'âœ… í‘¸ì‹œ ì™„ë£Œ';\n                    \n                    // 3ì´ˆ í›„ ì›ë˜ ìƒíƒœë¡œ\n                    setTimeout(() => {\n                        button.style.background = '#3b82f6';\n                        button.innerHTML = originalText;\n                        button.disabled = false;\n                    }, 3000);\n                } else {\n                    alert('âŒ ' + data.message);\n                    button.innerHTML = originalText;\n                    button.disabled = false;\n                }\n            })\n            .catch(error => {\n                console.error('Error:', error);\n                alert('âŒ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n                button.innerHTML = originalText;\n                button.disabled = false;\n            });\n        }\n        \n        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë””ë²„ê¹… ì •ë³´ ì¶œë ¥\n        window.addEventListener('load', function() {\n            console.log('í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ - í‘¸ì‹œ ê¸°ëŠ¥ ì¶”ê°€ë¨');\n        });\n    </script>\n</head>\n<body>\n<div class=\"ttbox\">\n    <a href=\"dashboard.php?comp_id=<?= urlencode($comp_id) ?>\" class=\"goto-dash\">&lt; ëŒ€ì‹œë³´ë“œë¡œ</a>\n    <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;\">\n        <h1><?= h($info['title']) ?> <span style=\"font-size:0.85em;color:#03c75a;\">íƒ€ì„í…Œì´ë¸”</span></h1>\n        <div style=\"display: flex; gap: 10px;\">\n            <a href=\"export_timetable.php?comp=<?=h($comp_id)?>\" class=\"btn\" style=\"background: #e74c3c; color: white; padding: 8px 16px; text-decoration: none; border-radius: 4px; font-size: 14px;\" target=\"_blank\">\n                ğŸ“„ PDF ë‚´ë³´ë‚´ê¸°\n            </a>\n            <a href=\"export_excel.php?comp=<?=h($comp_id)?>\" class=\"btn\" style=\"background: #27ae60; color: white; padding: 8px 16px; text-decoration: none; border-radius: 4px; font-size: 14px;\">\n                ğŸ“Š ì—‘ì…€ ë‚´ë³´ë‚´ê¸°\n            </a>\n            <button onclick=\"pushTimetableToDashboard()\" class=\"btn\" style=\"background: #3b82f6; color: white; padding: 8px 16px; border: none; border-radius: 4px; font-size: 14px; cursor: pointer;\">\n                ğŸš€ ëŒ€íšŒ ëŒ€ì‰¬ë³´ë“œì— í‘¸ì‹œ\n            </button>\n        </div>\n    </div>\n    <div class=\"compinfo\" style=\"color:#bbb; margin-bottom:1.2em;\">\n        <b>ì¼ì:</b> <?= h($info['date']) ?> &nbsp; <b>ì¥ì†Œ:</b> <?= h($info['place']) ?> &nbsp; <b>ì£¼ìµœ/ì£¼ê´€:</b> <?= h($info['host']) ?>\n    </div>\n    <form method=\"post\" class=\"ttform\">\n        <div style=\"margin-bottom: 15px;\">\n            <label>\n                ëŒ€íšŒ ì‹œì‘ ì‹œê°„: <input type=\"time\" name=\"start_time\" value=\"<?=h($start_time_str)?>\">\n            </label>\n            <label>\n                ê°œíšŒì‹ ì‹œê°„: <input type=\"time\" name=\"opening_time\" value=\"<?=h($opening_time_str)?>\">\n            </label>\n        </div>\n        \n        <button type=\"submit\">íƒ€ì„í…Œì´ë¸” ìƒì„±</button>\n    </form>\n    \n    \n    <!-- íŠ¹ë³„ ì´ë²¤íŠ¸ ì„¤ì • -->\n    <div style=\"margin: 20px 0; padding: 15px; background: #333; border-radius: 5px;\">\n        <h3 style=\"color: #03C75A; margin: 0 0 15px 0;\">íŠ¹ë³„ ì´ë²¤íŠ¸ ì„¤ì •</h3>\n        <form method=\"post\" id=\"special-event-form\">\n            <div style=\"margin-bottom: 15px;\">\n                <div style=\"display: flex; gap: 10px; align-items: center; margin-bottom: 10px;\">\n                    <input type=\"text\" name=\"special_event_name\" placeholder=\"ì´ë²¤íŠ¸ëª… (ì˜ˆ: ë¸Œë ˆì´í¬ íƒ€ì„, ì‹œìƒì‹ ë“±)\" style=\"flex: 1; padding: 8px;\">\n                    <span>ìˆœë²ˆ</span>\n                    <input type=\"number\" name=\"special_event_after\" value=\"1\" min=\"1\" style=\"width: 80px; padding: 8px;\">\n                    <span>í›„</span>\n                    <input type=\"number\" name=\"special_event_duration\" value=\"10\" min=\"1\" style=\"width: 80px; padding: 8px;\">\n                    <span>ë¶„</span>\n                    <button type=\"submit\" name=\"add_special_event\" style=\"background: #03C75A; color: white; border: none; padding: 8px 15px; border-radius: 3px;\">ì¶”ê°€</button>\n                </div>\n            </div>\n        </form>\n        \n        <!-- ì €ì¥ëœ íŠ¹ë³„ ì´ë²¤íŠ¸ ëª©ë¡ -->\n        <?php if (!empty($special_events)): ?>\n            <div style=\"margin-top: 15px;\">\n                <h4 style=\"color: #90EE90; margin: 0 0 10px 0;\">ë“±ë¡ëœ íŠ¹ë³„ ì´ë²¤íŠ¸</h4>\n                <?php foreach ($special_events as $id => $event): ?>\n                    <div style=\"display: flex; align-items: center; gap: 10px; padding: 8px; background: #444; border-radius: 3px; margin-bottom: 5px;\">\n                        <span style=\"color: #eee;\"><?=h($event['name'])?></span>\n                        <span style=\"color: #ccc;\">ìˆœë²ˆ <?=h($event['after_event'])?> í›„</span>\n                        <span style=\"color: #ccc;\"><?=h($event['duration'])?>ë¶„</span>\n                        <form method=\"post\" style=\"margin: 0;\">\n                            <input type=\"hidden\" name=\"event_id\" value=\"<?=h($id)?>\">\n                            <button type=\"submit\" name=\"delete_special_event\" style=\"background: #ff4444; color: white; border: none; padding: 5px 10px; border-radius: 3px; font-size: 12px;\">ì‚­ì œ</button>\n                        </form>\n                    </div>\n                <?php endforeach; ?>\n            </div>\n        <?php endif; ?>\n    </div>\n    <?php if($warning): ?>\n        <div class=\"warn\"><?=h($warning)?></div>\n    <?php endif; ?>\n    <table>\n        <tr>\n            <th>Ext. Time</th>\n            <th>Start</th>\n            <th>End</th>\n            <th>No.</th>\n            <th>Detail No.</th>\n            <th>Description</th>\n            <th>Round</th>\n            <th colspan=\"6\">Dances</th>\n        </tr>\n        <?php foreach ($rows as $row): ?>\n            <?php if (!empty($row['is_opening'])): ?>\n                <tr class=\"opening-row\">\n                    <td></td>\n                    <td><?=to_hm($row['start'])?></td>\n                    <td><?=to_hm($row['end'])?></td>\n                    <td colspan=\"10\"><b>ê°œíšŒì‹</b></td>\n                </tr>\n            <?php elseif (!empty($row['is_special'])): ?>\n                <tr style=\"background: #2a4d3a; color: #90EE90;\">\n                    <td></td>\n                    <td><?=to_hm($row['start'])?></td>\n                    <td><?=to_hm($row['end'])?></td>\n                    <td colspan=\"10\"><b><?=h($row['special_type'])?></b></td>\n                </tr>\n            <?php else: ?>\n                <?php if (isset($row['group_events']) && count($row['group_events']) > 1): ?>\n                    <!-- ë©€í‹°ì´ë²¤íŠ¸: ì²« ë²ˆì§¸ í–‰ -->\n                    <tr>\n                        <td rowspan=\"<?=count($row['group_events'])?>\">\n                            <input type=\"number\" id=\"extra_<?=h($row['no'])?>\" value=\"<?=h($row['extra_time'])?>\" min=\"0\" style=\"width: 50px; padding: 2px; text-align: center;\">\n                            <button type=\"button\" onclick=\"saveExtraTime('<?=h($row['no'])?>', document.getElementById('extra_<?=h($row['no'])?>').value)\" style=\"padding: 2px 5px; font-size: 10px;\">ì €ì¥</button>\n                        </td>\n                        <td rowspan=\"<?=count($row['group_events'])?>\"><?=to_hm($row['start'])?></td>\n                        <td rowspan=\"<?=count($row['group_events'])?>\"><?=to_hm($row['end'])?></td>\n                        <td rowspan=\"<?=count($row['group_events'])?>\"><?=h($row['no'])?></td>\n                        <td><?=h($row['group_events'][0]['detail_no'])?></td>\n                        <td><?=h($row['group_events'][0]['desc'])?></td>\n                        <td rowspan=\"<?=count($row['group_events'])?>\"><?=h($row['round'])?></td>\n                        <?php for($i=0;$i<6;$i++): ?>\n                            <td><?=isset($row['group_events'][0]['dances'][$i]) ? h($row['group_events'][0]['dances'][$i]) : ''?></td>\n                        <?php endfor; ?>\n                    </tr>\n                    <!-- ë©€í‹°ì´ë²¤íŠ¸: ë‚˜ë¨¸ì§€ í–‰ë“¤ -->\n                    <?php for($j=1; $j<count($row['group_events']); $j++): ?>\n                        <tr>\n                            <td><?=h($row['group_events'][$j]['detail_no'])?></td>\n                            <td><?=h($row['group_events'][$j]['desc'])?></td>\n                            <?php for($i=0;$i<6;$i++): ?>\n                                <td><?=isset($row['group_events'][$j]['dances'][$i]) ? h($row['group_events'][$j]['dances'][$i]) : ''?></td>\n                            <?php endfor; ?>\n                        </tr>\n                    <?php endfor; ?>\n                <?php else: ?>\n                    <!-- ë‹¨ì¼ ì´ë²¤íŠ¸ -->\n                    <tr>\n                        <td>\n                            <input type=\"number\" id=\"extra_<?=h($row['no'])?>\" value=\"<?=h($row['extra_time'])?>\" min=\"0\" style=\"width: 50px; padding: 2px; text-align: center;\">\n                            <button type=\"button\" onclick=\"saveExtraTime('<?=h($row['no'])?>', document.getElementById('extra_<?=h($row['no'])?>').value)\" style=\"padding: 2px 5px; font-size: 10px;\">ì €ì¥</button>\n                        </td>\n                        <td><?=to_hm($row['start'])?></td>\n                        <td><?=to_hm($row['end'])?></td>\n                        <td><?=h($row['no'])?></td>\n                        <td><?=h($row['detail_no'])?></td>\n                        <td><?=h($row['desc'])?></td>\n                        <td><?=h($row['round'])?></td>\n                        <?php for($i=0;$i<6;$i++): ?>\n                            <td><?=isset($row['dances'][$i]) ? h($row['dances'][$i]) : ''?></td>\n                        <?php endfor; ?>\n                    </tr>\n                <?php endif; ?>\n            <?php endif; ?>\n        <?php endforeach; ?>\n    </table>\n</div>\n</body>\n</html>","size_bytes":27615},"comp/manage_users.php":{"content":"<?php\nsession_start();\nrequire_once 'auth.php';\n\n// ì˜¤ë„ˆ ê¶Œí•œë§Œ ì ‘ê·¼ ê°€ëŠ¥\nrequirePermission('manage_users');\n\n$user = $_SESSION['user'];\n$message = '';\n$error = '';\n\n// ì„ ì„ê´€ë¦¬ì ì¶”ê°€ ì²˜ë¦¬\nif ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['add_senior'])) {\n    $username = trim($_POST['username'] ?? '');\n    $password = trim($_POST['password'] ?? '');\n    \n    if ($username && $password) {\n        $users = loadUsers();\n        \n        // ì¤‘ë³µ í™•ì¸\n        $exists = false;\n        foreach ($users as $u) {\n            if ($u['username'] === $username) {\n                $exists = true;\n                break;\n            }\n        }\n        \n        if (!$exists) {\n            $users[] = [\n                'username' => $username,\n                'password' => $password,\n                'role' => 'senior_admin',\n                'created_by' => $user['username'],\n                'created_at' => date('Y-m-d H:i:s')\n            ];\n            saveUsers($users);\n            $message = \"ì„ ì„ê´€ë¦¬ì '{$username}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.\";\n        } else {\n            $error = \"ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì‚¬ìš©ìëª…ì…ë‹ˆë‹¤.\";\n        }\n    } else {\n        $error = \"ì‚¬ìš©ìëª…ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.\";\n    }\n}\n\n// ì‚¬ìš©ì ì‚­ì œ ì²˜ë¦¬\nif (isset($_GET['delete']) && $_GET['delete']) {\n    $delete_username = $_GET['delete'];\n    $users = loadUsers();\n    $users = array_filter($users, function($u) use ($delete_username) {\n        return $u['username'] !== $delete_username;\n    });\n    saveUsers($users);\n    $message = \"ì‚¬ìš©ì '{$delete_username}'ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.\";\n}\n\n$users = loadUsers();\n$senior_admins = array_filter($users, function($u) {\n    return $u['role'] === 'senior_admin';\n});\n\nfunction h($s) { return htmlspecialchars($s ?? ''); }\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>ì‚¬ìš©ì ê´€ë¦¬ | danceoffice.net</title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\n    <link href=\"https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded\" rel=\"stylesheet\" />\n    <style>\n        body {\n            background: #181B20;\n            min-height: 100vh;\n            font-size: 14px;\n            line-height: 1.5;\n            margin: 0;\n            padding: 0;\n            font-family: 'Noto Sans KR', sans-serif;\n        }\n        \n        .container {\n            max-width: 1000px;\n            margin: 0 auto;\n            padding: 20px;\n        }\n        \n        .header {\n            background: linear-gradient(135deg, #1a1d21 0%, #181B20 100%);\n            border-radius: 15px;\n            padding: 25px;\n            margin-bottom: 20px;\n            box-shadow: 0 8px 25px rgba(3, 199, 90, 0.15);\n            border: 2px solid #03C75A;\n            text-align: center;\n        }\n        \n        .header h1 {\n            color: #03C75A;\n            font-size: 24px;\n            margin: 0 0 10px 0;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 10px;\n        }\n        \n        .header p {\n            color: #00BFAE;\n            font-size: 16px;\n            margin: 0;\n        }\n        \n        .nav {\n            display: flex;\n            gap: 15px;\n            margin-top: 20px;\n            justify-content: center;\n        }\n        \n        .nav a {\n            color: white;\n            text-decoration: none;\n            font-weight: 600;\n            font-size: 14px;\n            padding: 10px 20px;\n            border-radius: 20px;\n            background: rgba(3, 199, 90, 0.1);\n            backdrop-filter: blur(10px);\n            transition: all 0.3s ease;\n            display: flex;\n            align-items: center;\n            gap: 5px;\n        }\n        \n        .nav a:hover {\n            background: #03C75A;\n            color: #222;\n            transform: translateY(-2px);\n        }\n        \n        .card {\n            background: #222;\n            border-radius: 15px;\n            padding: 25px;\n            margin-bottom: 20px;\n            box-shadow: 0 8px 25px rgba(3, 199, 90, 0.08);\n            border: 1px solid #31343a;\n        }\n        \n        .card h3 {\n            color: #03C75A;\n            font-size: 18px;\n            margin: 0 0 20px 0;\n            display: flex;\n            align-items: center;\n            gap: 10px;\n        }\n        \n        .form-group {\n            margin-bottom: 15px;\n        }\n        \n        .form-group label {\n            display: block;\n            color: #F5F7FA;\n            font-size: 13px;\n            margin-bottom: 5px;\n            font-weight: 600;\n        }\n        \n        .form-group input {\n            width: 100%;\n            padding: 10px;\n            border: 1px solid #31343a;\n            border-radius: 8px;\n            background: #181B20;\n            color: #F5F7FA;\n            font-size: 13px;\n            box-sizing: border-box;\n        }\n        \n        .btn {\n            background: linear-gradient(90deg, #03C75A 70%, #00BFAE 100%);\n            color: #222;\n            border: none;\n            padding: 10px 20px;\n            border-radius: 20px;\n            font-weight: 600;\n            font-size: 13px;\n            cursor: pointer;\n            transition: all 0.3s ease;\n        }\n        \n        .btn:hover {\n            background: linear-gradient(90deg, #00BFAE 60%, #03C75A 100%);\n            color: white;\n            transform: translateY(-2px);\n        }\n        \n        .btn-danger {\n            background: linear-gradient(90deg, #ff4444 70%, #cc0000 100%);\n            color: white;\n        }\n        \n        .btn-danger:hover {\n            background: linear-gradient(90deg, #cc0000 60%, #ff4444 100%);\n        }\n        \n        .message {\n            color: #03C75A;\n            background: rgba(3, 199, 90, 0.1);\n            padding: 10px;\n            border-radius: 8px;\n            margin-bottom: 15px;\n            font-size: 13px;\n        }\n        \n        .error {\n            color: #ff4444;\n            background: rgba(255, 68, 68, 0.1);\n            padding: 10px;\n            border-radius: 8px;\n            margin-bottom: 15px;\n            font-size: 13px;\n        }\n        \n        .users-table {\n            width: 100%;\n            border-collapse: collapse;\n            background: #181B20;\n            border-radius: 8px;\n            overflow: hidden;\n        }\n        \n        .users-table th {\n            background: #1E2126;\n            color: #03C75A;\n            font-weight: 600;\n            font-size: 13px;\n            padding: 15px 10px;\n            text-align: center;\n            border-bottom: 1px solid #31343a;\n        }\n        \n        .users-table td {\n            color: #F5F7FA;\n            font-size: 13px;\n            padding: 15px 10px;\n            text-align: center;\n            border-bottom: 1px solid #31343a;\n        }\n        \n        .users-table tr:last-child td {\n            border-bottom: none;\n        }\n        \n        .role-badge {\n            display: inline-block;\n            padding: 4px 8px;\n            border-radius: 4px;\n            font-size: 11px;\n            font-weight: 600;\n        }\n        \n        .role-owner {\n            background: #ffd700;\n            color: #000;\n        }\n        \n        .role-senior_admin {\n            background: #03C75A;\n            color: #222;\n        }\n        \n        .role-admin {\n            background: #17a2b8;\n            color: white;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <header class=\"header\">\n            <h1>\n                <span class=\"material-symbols-rounded\">group</span>\n                ì‚¬ìš©ì ê´€ë¦¬\n            </h1>\n            <p>ì„ ì„ê´€ë¦¬ì ì¶”ê°€ ë° ê´€ë¦¬</p>\n            <nav class=\"nav\">\n                <a href=\"index.php\">\n                    <span class=\"material-symbols-rounded\">sports</span>\n                    ëŒ€íšŒ ê´€ë¦¬\n                </a>\n                <a href=\"senior_dashboard.php\">\n                    <span class=\"material-symbols-rounded\">admin_panel_settings</span>\n                    ì„ ì„ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ\n                </a>\n                <a href=\"logout.php\">\n                    <span class=\"material-symbols-rounded\">logout</span>\n                    ë¡œê·¸ì•„ì›ƒ\n                </a>\n            </nav>\n        </header>\n        \n        <div class=\"card\">\n            <h3>\n                <span class=\"material-symbols-rounded\">person_add</span>\n                ì„ ì„ê´€ë¦¬ì ì¶”ê°€\n            </h3>\n            <?php if ($message): ?>\n                <div class=\"message\"><?= h($message) ?></div>\n            <?php endif; ?>\n            <?php if ($error): ?>\n                <div class=\"error\"><?= h($error) ?></div>\n            <?php endif; ?>\n            <form method=\"post\">\n                <div class=\"form-group\">\n                    <label for=\"username\">ì‚¬ìš©ìëª…</label>\n                    <input type=\"text\" id=\"username\" name=\"username\" placeholder=\"ì‚¬ìš©ìëª…ì„ ì…ë ¥í•˜ì„¸ìš”\" required>\n                </div>\n                <div class=\"form-group\">\n                    <label for=\"password\">ë¹„ë°€ë²ˆí˜¸</label>\n                    <input type=\"password\" id=\"password\" name=\"password\" placeholder=\"ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”\" required>\n                </div>\n                <button type=\"submit\" name=\"add_senior\" class=\"btn\">\n                    <span class=\"material-symbols-rounded\">add</span>\n                    ì„ ì„ê´€ë¦¬ì ì¶”ê°€\n                </button>\n            </form>\n        </div>\n        \n        <div class=\"card\">\n            <h3>\n                <span class=\"material-symbols-rounded\">group</span>\n                ë“±ë¡ëœ ì‚¬ìš©ì ëª©ë¡\n            </h3>\n            <table class=\"users-table\">\n                <thead>\n                    <tr>\n                        <th>ì‚¬ìš©ìëª…</th>\n                        <th>ì—­í• </th>\n                        <th>ìƒì„±ì</th>\n                        <th>ìƒì„±ì¼</th>\n                        <th>ê´€ë¦¬</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    <?php foreach ($users as $u): ?>\n                        <tr>\n                            <td><?= h($u['username']) ?></td>\n                            <td>\n                                <span class=\"role-badge role-<?= $u['role'] ?>\">\n                                    <?= getRoleDisplayName($u['role']) ?>\n                                </span>\n                            </td>\n                            <td><?= h($u['created_by']) ?></td>\n                            <td><?= h($u['created_at']) ?></td>\n                            <td>\n                                <?php if ($u['role'] !== 'owner' && $u['username'] !== $user['username']): ?>\n                                    <a href=\"?delete=<?= urlencode($u['username']) ?>\" \n                                       class=\"btn btn-danger\" \n                                       onclick=\"return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')\">\n                                        <span class=\"material-symbols-rounded\">delete</span>\n                                        ì‚­ì œ\n                                    </a>\n                                <?php else: ?>\n                                    <span style=\"color: #8A8D93; font-size: 12px;\">-</span>\n                                <?php endif; ?>\n                            </td>\n                        </tr>\n                    <?php endforeach; ?>\n                </tbody>\n            </table>\n        </div>\n    </div>\n</body>\n</html>\n\n\n\n\n\n\n","size_bytes":11655},"comp/monitor_control.php":{"content":"<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>ëª¨ë‹ˆí„°ë§ ì œì–´</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            max-width: 800px;\n            margin: 50px auto;\n            padding: 20px;\n            background: #f5f5f5;\n        }\n        .container {\n            background: white;\n            padding: 30px;\n            border-radius: 10px;\n            box-shadow: 0 0 20px rgba(0,0,0,0.1);\n        }\n        h1 {\n            color: #333;\n            text-align: center;\n            margin-bottom: 30px;\n        }\n        .btn {\n            background: #007bff;\n            color: white;\n            border: none;\n            padding: 15px 30px;\n            border-radius: 5px;\n            cursor: pointer;\n            font-size: 16px;\n            margin: 10px;\n            transition: background 0.3s;\n        }\n        .btn:hover {\n            background: #0056b3;\n        }\n        .btn-success {\n            background: #28a745;\n        }\n        .btn-success:hover {\n            background: #1e7e34;\n        }\n        .btn-danger {\n            background: #dc3545;\n        }\n        .btn-danger:hover {\n            background: #c82333;\n        }\n        .status {\n            margin: 20px 0;\n            padding: 15px;\n            border-radius: 5px;\n            font-weight: bold;\n        }\n        .status.online {\n            background: #d4edda;\n            color: #155724;\n            border: 1px solid #c3e6cb;\n        }\n        .status.offline {\n            background: #f8d7da;\n            color: #721c24;\n            border: 1px solid #f5c6cb;\n        }\n        .log-container {\n            background: #f8f9fa;\n            border: 1px solid #dee2e6;\n            border-radius: 5px;\n            padding: 15px;\n            margin-top: 20px;\n            max-height: 300px;\n            overflow-y: auto;\n            font-family: monospace;\n            font-size: 12px;\n        }\n        .controls {\n            text-align: center;\n            margin: 20px 0;\n        }\n        .info {\n            background: #d1ecf1;\n            color: #0c5460;\n            padding: 15px;\n            border-radius: 5px;\n            margin: 20px 0;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>ğŸ” ëŒ„ìŠ¤ìŠ¤ì½”ì–´ ê²°ê³¼ ëª¨ë‹ˆí„°ë§ ì œì–´</h1>\n        \n        <div class=\"info\">\n            <strong>ì‚¬ìš©ë²•:</strong><br>\n            1. \"ëª¨ë‹ˆí„°ë§ ì‹œì‘\" ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ Y:/results í´ë”ë¥¼ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§í•©ë‹ˆë‹¤.<br>\n            2. \"ëŒ€ì‹œë³´ë“œ ì—´ê¸°\" ë²„íŠ¼ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œë¥¼ ì—½ë‹ˆë‹¤.<br>\n            3. \"í…ŒìŠ¤íŠ¸ í˜ì´ì§€\" ë²„íŠ¼ìœ¼ë¡œ í˜„ì¬ íŒŒì¼ë“¤ì„ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤.<br>\n            4. \"ìƒíƒœ í™•ì¸\" ë²„íŠ¼ìœ¼ë¡œ í˜„ì¬ ëª¨ë‹ˆí„°ë§ ìƒíƒœë¥¼ í™•ì¸í•©ë‹ˆë‹¤.\n        </div>\n        \n        <div class=\"controls\">\n            <button class=\"btn btn-success\" onclick=\"startMonitoring()\">â–¶ï¸ ëª¨ë‹ˆí„°ë§ ì‹œì‘</button>\n            <button class=\"btn\" onclick=\"openDashboard()\">ğŸ“Š ëŒ€ì‹œë³´ë“œ ì—´ê¸°</button>\n            <button class=\"btn\" onclick=\"openTestPage()\">ğŸ§ª í…ŒìŠ¤íŠ¸ í˜ì´ì§€</button>\n            <button class=\"btn btn-primary\" onclick=\"openEventUpload()\">ğŸ“ ì´ë²¤íŠ¸ ì—…ë¡œë“œ</button>\n            <button class=\"btn btn-info\" onclick=\"openCompetitionSettings()\">ğŸ† ëŒ€íšŒ ì„¤ì •</button>\n            <button class=\"btn\" onclick=\"openEventControl()\">ğŸ¯ ì´ë²¤íŠ¸ ì œì–´</button>\n            <button class=\"btn\" onclick=\"openEventMonitor()\">ğŸ–¥ï¸ ì´ë²¤íŠ¸ ëª¨ë‹ˆí„°ë§</button>\n            <button class=\"btn\" onclick=\"openEventMonitorV2()\">ğŸ“º ê·¸ë£¹ ëª¨ë‹ˆí„°ë§</button>\n            <button class=\"btn\" onclick=\"openDebugEvents()\">ğŸ” ì´ë²¤íŠ¸ ë””ë²„ê¹…</button>\n            <button class=\"btn\" onclick=\"checkStatus()\">ğŸ” ìƒíƒœ í™•ì¸</button>\n            <button class=\"btn btn-danger\" onclick=\"stopMonitoring()\">â¹ï¸ ëª¨ë‹ˆí„°ë§ ì¤‘ì§€</button>\n        </div>\n        \n        <div id=\"status\" class=\"status offline\">\n            ëª¨ë‹ˆí„°ë§ ìƒíƒœë¥¼ í™•ì¸í•˜ì„¸ìš”.\n        </div>\n        \n        <div class=\"log-container\" id=\"logContainer\">\n            ë¡œê·¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...\n        </div>\n    </div>\n\n    <script>\n        function startMonitoring() {\n            fetch('result_watcher.php?action=start')\n                .then(response => response.json())\n                .then(data => {\n                    if (data.success) {\n                        updateStatus('ëª¨ë‹ˆí„°ë§ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.', 'online');\n                        addLog('ëª¨ë‹ˆí„°ë§ ì‹œì‘ë¨');\n                    } else {\n                        updateStatus('ëª¨ë‹ˆí„°ë§ ì‹œì‘ ì‹¤íŒ¨: ' + data.message, 'offline');\n                        addLog('ëª¨ë‹ˆí„°ë§ ì‹œì‘ ì‹¤íŒ¨: ' + data.message);\n                    }\n                })\n                .catch(error => {\n                    updateStatus('ì˜¤ë¥˜ ë°œìƒ: ' + error.message, 'offline');\n                    addLog('ì˜¤ë¥˜: ' + error.message);\n                });\n        }\n        \n        function stopMonitoring() {\n            fetch('result_watcher.php?action=stop')\n                .then(response => response.json())\n                .then(data => {\n                    if (data.success) {\n                        updateStatus('ëª¨ë‹ˆí„°ë§ì´ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.', 'offline');\n                        addLog('ëª¨ë‹ˆí„°ë§ ì¤‘ì§€ë¨');\n                    } else {\n                        updateStatus('ëª¨ë‹ˆí„°ë§ ì¤‘ì§€ ì‹¤íŒ¨: ' + data.message, 'offline');\n                        addLog('ëª¨ë‹ˆí„°ë§ ì¤‘ì§€ ì‹¤íŒ¨: ' + data.message);\n                    }\n                })\n                .catch(error => {\n                    updateStatus('ì˜¤ë¥˜ ë°œìƒ: ' + error.message, 'offline');\n                    addLog('ì˜¤ë¥˜: ' + error.message);\n                });\n        }\n        \n        function checkStatus() {\n            fetch('result_watcher.php?action=status')\n                .then(response => response.json())\n                .then(data => {\n                    if (data.success) {\n                        updateStatus('ëª¨ë‹ˆí„°ë§ ìƒíƒœ í™•ì¸ë¨', 'online');\n                        if (data.logs) {\n                            displayLogs(data.logs);\n                        }\n                    } else {\n                        updateStatus('ìƒíƒœ í™•ì¸ ì‹¤íŒ¨: ' + data.message, 'offline');\n                        addLog('ìƒíƒœ í™•ì¸ ì‹¤íŒ¨: ' + data.message);\n                    }\n                })\n                .catch(error => {\n                    updateStatus('ì˜¤ë¥˜ ë°œìƒ: ' + error.message, 'offline');\n                    addLog('ì˜¤ë¥˜: ' + error.message);\n                });\n        }\n        \n        function openDashboard() {\n            window.open('result_dashboard.php', '_blank');\n        }\n        \n        function openTestPage() {\n            window.open('test_results.php', '_blank');\n        }\n        \n        function openFullscreenMonitor() {\n            window.open('fullscreen_monitor.php', '_blank');\n        }\n        \n        function openSimpleFullscreen() {\n            window.open('simple_fullscreen.php', '_blank');\n        }\n        \n        function openEventControl() {\n            window.open('event_control.php', '_blank');\n        }\n        \n        function openSmartFullscreen() {\n            window.open('smart_fullscreen.php', '_blank');\n        }\n        \n        function openEventUpload() {\n            window.open('event_upload.php', '_blank');\n        }\n        \n        function openEventMonitor() {\n            window.open('event_monitor_v2.php', '_blank');\n        }\n        \n        function openCompetitionSettings() {\n            window.open('competition_settings.php', '_blank');\n        }\n        \n        function openEventMonitorV2() {\n            window.open('event_monitor_v2.php', '_blank');\n        }\n        \n        function openDebugEvents() {\n            window.open('debug_events.php', '_blank');\n        }\n        \n        function updateStatus(message, type) {\n            const statusDiv = document.getElementById('status');\n            statusDiv.textContent = message;\n            statusDiv.className = 'status ' + type;\n        }\n        \n        function addLog(message) {\n            const logContainer = document.getElementById('logContainer');\n            const timestamp = new Date().toLocaleTimeString();\n            const logEntry = document.createElement('div');\n            logEntry.textContent = `[${timestamp}] ${message}`;\n            logContainer.appendChild(logEntry);\n            logContainer.scrollTop = logContainer.scrollHeight;\n        }\n        \n        function displayLogs(logs) {\n            const logContainer = document.getElementById('logContainer');\n            logContainer.innerHTML = '';\n            logs.forEach(log => {\n                if (log.trim()) {\n                    const logEntry = document.createElement('div');\n                    logEntry.textContent = log;\n                    logContainer.appendChild(logEntry);\n                }\n            });\n            logContainer.scrollTop = logContainer.scrollHeight;\n        }\n        \n        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìƒíƒœ í™•ì¸\n        window.onload = function() {\n            checkStatus();\n        };\n    </script>\n</body>\n</html>\n","size_bytes":9407},"comp/multievent_scoring.php":{"content":"<?php\nsession_start();\n\n$comp_id = $_GET['comp_id'] ?? '';\n$event_group = $_GET['event_group'] ?? '';\n\n// Remove BOM and normalize\n$comp_id = preg_replace('/\\x{FEFF}/u', '', $comp_id);\n$event_group = preg_replace('/\\x{FEFF}/u', '', $event_group);\n\n// Language setting\n$lang = $_GET['lang'] ?? 'ko';\nif (!in_array($lang, ['ko', 'en', 'zh', 'ja'])) {\n    $lang = 'ko';\n}\n\n// Language texts\n$texts = [\n    'ko' => [\n        'title' => 'ë©€í‹°ì´ë²¤íŠ¸ ì±„ì  ì‹œìŠ¤í…œ',\n        'judge_info' => 'ì‹¬ì‚¬ìœ„ì›',\n        'event_info' => 'ì´ë²¤íŠ¸ ì •ë³´',\n        'round' => 'ë¼ìš´ë“œ',\n        'dances' => 'ì¢…ëª©',\n        'players' => 'ì¶œì „ ì„ ìˆ˜',\n        'submit' => 'ì œì¶œ',\n        'no_data' => 'ì´ë²¤íŠ¸ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.',\n        'invalid_data' => 'ì˜ëª»ëœ ëŒ€íšŒ ID ë˜ëŠ” ì´ë²¤íŠ¸ ê·¸ë£¹ì…ë‹ˆë‹¤.'\n    ],\n    'en' => [\n        'title' => 'Multi-Event Scoring System',\n        'judge_info' => 'Judge',\n        'event_info' => 'Event Information',\n        'round' => 'Round',\n        'dances' => 'Dances',\n        'players' => 'Competitors',\n        'submit' => 'Submit',\n        'no_data' => 'Event data not found.',\n        'invalid_data' => 'Invalid competition ID or event group.'\n    ]\n];\n\n$t = $texts[$lang];\n\n// Check if judge is logged in\nif (!isset($_SESSION['scoring_logged_in']) || !$_SESSION['scoring_logged_in'] || $_SESSION['scoring_comp_id'] !== $comp_id) {\n    header(\"Location: scoring_login.php?comp_id=\" . urlencode($comp_id) . \"&lang=\" . urlencode($lang));\n    exit;\n}\n\nif (!$comp_id || !$event_group) {\n    echo \"<h1>\" . $t['invalid_data'] . \"</h1>\";\n    exit;\n}\n\n// Load event data\n$data_dir = __DIR__ . \"/data/$comp_id\";\n$runorder_file = \"$data_dir/RunOrder_Tablet.txt\";\n$dance_name_file = \"$data_dir/DanceName.txt\";\n\n$events = [];\n$dance_mapping = [];\n\n// Load dance name mapping\nif (file_exists($dance_name_file)) {\n    $lines = file($dance_name_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        $line = preg_replace('/\\x{FEFF}/u', '', $line);\n        $cols = array_map('trim', explode(',', $line));\n        if (count($cols) >= 3 && !empty($cols[1]) && is_numeric($cols[0])) {\n            $dance_mapping[$cols[0]] = $cols[1];\n        }\n    }\n}\n\n// Load events from RunOrder_Tablet.txt\nif (file_exists($runorder_file)) {\n    $lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        $line = preg_replace('/\\x{FEFF}/u', '', $line);\n        $line = str_replace([\"\\xEF\\xBB\\xBF\", \"\\xFEFF\", \"\\uFEFF\"], '', $line);\n        $line = preg_replace('/[\\x00-\\x1F\\x7F-\\x9F]/', '', $line);\n        \n        if (preg_match('/^bom/', $line)) continue;\n        $cols = array_map('trim', explode(',', $line));\n        \n        // Check if it's a competition event (has dances)\n        $has_dance = false;\n        for ($i = 6; $i <= 10; $i++) {\n            if (isset($cols[$i]) && $cols[$i] !== '') {\n                $has_dance = true;\n                break;\n            }\n        }\n        \n        if ($has_dance) {\n            $base_no_raw = $cols[0] ?? '';\n            $detail_no = trim($cols[13] ?? '');\n            $event_no = !empty($detail_no) ? $detail_no : $base_no_raw; // use detail_no when present\n            $event_base = preg_replace('/\\D+/', '', $base_no_raw); // numeric base number for grouping\n            \n            $event_data = [\n                'no' => $event_no,\n                'base_no' => $event_base,\n                'name' => $cols[1],\n                'round_type' => $cols[2],\n                'round_num' => $cols[3],\n                'recall_count' => intval($cols[4] ?? 0),\n                'detail_no' => $detail_no,\n                'dances' => []\n            ];\n            \n            for ($i = 6; $i <= 10; $i++) {\n                if (!empty($cols[$i])) $event_data['dances'][] = $cols[$i];\n            }\n            \n            $events[] = $event_data;\n        }\n    }\n}\n\n// Filter events by group\n$filtered_events = [];\nif ($event_group) {\n    // Find events that belong to the same group (same base event number)\n    $base_event_no = $event_group; // event_group is already the base number like \"1\"\n    foreach ($events as $event) {\n        if ($event['base_no'] === $base_event_no) {\n            $filtered_events[] = $event;\n        }\n    }\n    // Debug: log filtered events\n    error_log(\"Event group: $event_group, Filtered events: \" . print_r(array_map(function($e) { return $e['no'] . ' (' . $e['name'] . ')'; }, $filtered_events), true));\n} else {\n    $filtered_events = $events;\n}\n\n$event_count = count($filtered_events);\n\n// Load existing scores for current judge\n$judge_id = $_SESSION['scoring_judge_id'] ?? '';\n$existing_scores = [];\n\nif ($judge_id) {\n    foreach ($filtered_events as $event) {\n        $event_no = $event['no'];\n        foreach ($event['dances'] as $dance) {\n            $adj_file = \"$data_dir/{$event_no}_{$dance}_{$judge_id}.adj\";\n            error_log(\"Checking adj file: $adj_file (exists: \" . (file_exists($adj_file) ? 'yes' : 'no') . \")\");\n            \n            if (file_exists($adj_file)) {\n                $lines = file($adj_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n                $rankings = [];\n                \n                foreach ($lines as $line) {\n                    $line = trim($line);\n                    if (empty($line)) continue;\n                    \n                    if (strpos($line, ',') !== false) {\n                        // Final format: player,rank\n                        list($player, $rank) = explode(',', $line, 2);\n                        $player = trim($player, '\"');\n                        $rank = intval(trim($rank));\n                        if (is_numeric($player) && $rank > 0) {\n                            $rankings[$player] = $rank;\n                        }\n                    } else {\n                        // Recall format: \"player\" - store as selected (no rank)\n                        $player = trim($line, '\"');\n                        if (is_numeric($player)) {\n                            $rankings[$player] = 'selected'; // Mark as selected for recall\n                        }\n                    }\n                }\n                \n                if (!empty($rankings)) {\n                    if (!isset($existing_scores[$event_no])) {\n                        $existing_scores[$event_no] = [];\n                    }\n                    $existing_scores[$event_no][$dance] = $rankings;\n                    error_log(\"Loaded rankings for {$event_no}_{$dance}: \" . json_encode($rankings));\n                }\n            }\n        }\n    }\n}\n\n// Determine layout class based on event count\n$layout_class = 'multievent-2'; // default\nif ($event_count === 2) {\n    $layout_class = 'multievent-2';\n} elseif ($event_count === 3) {\n    $layout_class = 'multievent-3';\n} elseif ($event_count === 4) {\n    $layout_class = 'multievent-4';\n} elseif ($event_count === 5) {\n    $layout_class = 'multievent-5';\n} elseif ($event_count === 6) {\n    $layout_class = 'multievent-6';\n} elseif ($event_count > 6) {\n    $layout_class = 'multievent-6'; // fallback to 6-event layout\n}\n\nfunction h($s) { return htmlspecialchars($s ?? ''); }\n\n// Function to convert dance numbers to full names\nfunction getDanceNames($dances, $dance_mapping) {\n    $result = [];\n    foreach ($dances as $dance) {\n        $dance = trim($dance);\n        if (isset($dance_mapping[$dance])) {\n            $result[] = $dance_mapping[$dance];\n        } else {\n            $result[] = $dance;\n        }\n    }\n    return $result;\n}\n?>\n<!DOCTYPE html>\n<html lang=\"<?=h($lang)?>\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title><?=h($t['title'])?> | <?=h($comp_id)?></title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\n    <style>\n        body { \n            background: #1a1a1a; \n            font-family: sans-serif; \n            margin: 0; \n            padding: 10px;\n        }\n        \n        .multievent-container {\n            max-width: 100%;\n            margin: 0 auto;\n            background: #fff;\n            border-radius: 12px;\n            padding: 20px;\n            box-shadow: 0 4px 20px rgba(0,0,0,0.3);\n        }\n        \n        .header {\n            text-align: center;\n            margin-bottom: 30px;\n            padding: 20px;\n            background: linear-gradient(135deg, #003399, #0066cc);\n            color: white;\n            border-radius: 8px;\n        }\n        \n        .header h1 {\n            margin: 0 0 10px 0;\n            font-size: 28px;\n            font-weight: bold;\n        }\n        \n        .judge-info {\n            font-size: 16px;\n            opacity: 0.9;\n        }\n        \n        /* Multi-event Layouts */\n        .multievent-2 {\n            display: grid;\n            grid-template-columns: 1fr;\n            grid-template-rows: 1fr 1fr;\n            gap: 20px;\n            min-height: 80vh;\n        }\n        \n        .multievent-3 {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            grid-template-rows: 1fr 1fr;\n            gap: 20px;\n            min-height: 80vh;\n        }\n        \n        .multievent-3 .event-block:nth-child(3) {\n            grid-column: 1 / -1;\n        }\n        \n        .multievent-4 {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            grid-template-rows: 1fr 1fr;\n            gap: 20px;\n            min-height: 80vh;\n        }\n        \n        .multievent-5 {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            grid-template-rows: 1fr 1fr 1fr;\n            gap: 20px;\n            min-height: 80vh;\n        }\n        \n        .multievent-5 .event-block:nth-child(5) {\n            grid-column: 1 / -1;\n        }\n        \n        .multievent-6 {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            grid-template-rows: 1fr 1fr 1fr;\n            gap: 20px;\n            min-height: 80vh;\n        }\n        \n        .event-block {\n            background: #f8f9fa;\n            border: 3px solid #003399;\n            border-radius: 12px;\n            padding: 20px;\n            display: flex;\n            flex-direction: column;\n            position: relative;\n            transition: all 0.3s ease;\n            min-height: 200px;\n        }\n        \n        .event-block:hover {\n            transform: translateY(-2px);\n            box-shadow: 0 8px 25px rgba(0,51,153,0.2);\n        }\n        \n        .event-header {\n            background: #003399;\n            color: white;\n            padding: 15px;\n            border-radius: 8px;\n            margin-bottom: 20px;\n            text-align: left;\n        }\n        .event-title-row { display:flex; align-items:center; gap:10px; justify-content:flex-start; }\n        .event-number-badge {\n            background: #ff6b35;\n            color: white;\n            min-width: 40px;\n            height: 40px;\n            border-radius: 50%;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            font-weight: bold;\n            font-size: 16px;\n        }\n        /* Dance tabs per event */\n        .event-dances {\n            display: flex;\n            gap: 8px;\n            flex-wrap: wrap;\n            justify-content: center;\n            margin: 8px 0 14px 0;\n        }\n        .dance-btn {\n            background: #fff;\n            color: #003399;\n            border: 2px solid #003399;\n            border-radius: 16px;\n            padding: 6px 12px;\n            font-size: 12px;\n            font-weight: bold;\n            cursor: pointer;\n            transition: all 0.2s ease;\n        }\n        .dance-btn.active {\n            background: #003399;\n            color: #fff;\n        }\n        \n        .event-title {\n            font-size: 18px;\n            font-weight: bold;\n            margin: 0 0 5px 0;\n        }\n        \n        .event-details {\n            font-size: 14px;\n            opacity: 0.9;\n        }\n        \n        /* Removed top-right number; using left badge in title row */\n        \n        .scoring-area {\n            flex: 1;\n            display: flex;\n            flex-direction: column;\n            gap: 15px;\n        }\n        /* Touch-based final ranking layout */\n        .touch-scoring-container { display: flex; gap: 12px; }\n        .players-column, .ranking-column {\n            background: #fff;\n            border: 2px solid #ddd;\n            border-radius: 8px;\n            padding: 12px;\n            display: flex;\n            flex-direction: column;\n        }\n        .players-column { flex: 1; }\n        .ranking-column { flex: 0 0 190px; max-width: 200px; min-width: 160px; }\n        .players-column h4, .ranking-column h4 { margin: 0 0 8px 0; text-align: center; color:#003399; }\n        .players-list, .ranking-list { display: flex; flex-direction: column; gap: 8px; overflow-y: auto; }\n        .player-item {\n            background: #003399;\n            color: #fff;\n            border-radius: 8px;\n            text-align: center;\n            padding: 12px;\n            font-size: 18px;\n            font-weight: bold;\n            cursor: pointer;\n            user-select: none;\n        }\n        .player-item.selected { background: #28a745; }\n        .player-item.assigned { opacity: .35; background: #6c757d; cursor: not-allowed; }\n        .ranking-slot {\n            background: #f8f9fa;\n            border: 2px solid #ddd;\n            border-radius: 8px;\n            padding: 12px 12px 12px 40px; /* make room for rank label */\n            text-align: center;\n            min-height: 48px;\n            position: relative;\n        }\n        .ranking-slot::before {\n            content: attr(data-rank) \"ìœ„\";\n            position: absolute; left: 8px; top: 50%; transform: translateY(-50%);\n            background: #003399; color:#fff; padding: 2px 6px; font-size: 11px; border-radius: 10px;\n        }\n        .ranking-slot.assigned { border-color: #28a745; background: #f6fff6; }\n        .player-assigned { font-size: 20px; font-weight: 900; color: #28a745; }\n\n        /* Recall system styles */\n        .players-grid { \n            display: grid; \n            grid-template-columns: repeat(auto-fill, minmax(60px, 1fr)); \n            gap: 8px; \n            margin-bottom: 15px;\n        }\n        .player-card { \n            background: #fff; \n            border: 2px solid #ddd; \n            border-radius: 8px; \n            padding: 8px 4px; \n            text-align: center; \n            cursor: pointer; \n            transition: all 0.3s ease;\n            min-height: 60px;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n        }\n        .player-card:hover { \n            border-color: #4CAF50; \n            transform: translateY(-2px); \n            box-shadow: 0 4px 8px rgba(0,0,0,0.15);\n        }\n        .player-card.selected { \n            border-color: #4CAF50; \n            background: linear-gradient(135deg, #e8f5e8, #c8e6c9);\n            transform: scale(1.05);\n            box-shadow: 0 6px 12px rgba(76, 175, 80, 0.3);\n        }\n        .player-number { \n            font-size: 24px; \n            font-weight: 900; \n            color: #333;\n            margin: 0;\n            line-height: 1;\n        }\n        .player-card.selected .player-number {\n            color: #2e7d32;\n        }\n        .recall-checkbox { \n            display: none;\n        }\n\n        .recall-status {\n            text-align: center;\n            padding: 15px;\n            background: #f0f0f0;\n            border-radius: 8px;\n            font-weight: bold;\n            color: #333;\n            font-size: 14px;\n            margin: 10px 0;\n            border: 2px solid #ddd;\n        }\n        \n        .recall-status.complete {\n            background: linear-gradient(135deg, #d4edda, #c3e6cb);\n            color: #155724;\n            border: 3px solid #28a745;\n        }\n        \n        .recall-status.over {\n            background: linear-gradient(135deg, #f8d7da, #f5c6cb);\n            color: #721c24;\n            border: 3px solid #dc3545;\n        }\n        \n        .recall-status .selected-count {\n            font-size: 20px;\n            font-weight: 900;\n        }\n        \n        .submit-section {\n            text-align: center;\n            margin-top: auto;\n        }\n        \n        .submit-btn {\n            background: #4CAF50;\n            color: #fff;\n            border: none;\n            padding: 12px 24px;\n            font-size: 14px;\n            font-weight: bold;\n            border-radius: 8px;\n            cursor: pointer;\n            transition: all 0.3s ease;\n            display: none;\n        }\n        \n        .submit-btn:hover {\n            background: #45a049;\n            transform: translateY(-2px);\n        }\n        \n        .submit-btn:disabled {\n            background: #ccc;\n            cursor: not-allowed;\n            transform: none;\n        }\n        \n        .progress-overview {\n            background: #e7f3ff;\n            border: 2px solid #b3d9ff;\n            border-radius: 8px;\n            padding: 15px;\n            margin-bottom: 20px;\n            text-align: center;\n        }\n        \n        .progress-overview h3 {\n            margin: 0 0 10px 0;\n            color: #003399;\n            font-size: 18px;\n        }\n        \n        .progress-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));\n            gap: 10px;\n            margin-top: 10px;\n        }\n        \n        .progress-item {\n            background: #fff;\n            border: 2px solid #ddd;\n            border-radius: 6px;\n            padding: 8px;\n            text-align: center;\n            font-size: 12px;\n        }\n        \n        .progress-item.completed {\n            background: #d4edda;\n            border-color: #28a745;\n            color: #155724;\n        }\n        \n        .progress-item.current {\n            background: #fff3cd;\n            border-color: #ffc107;\n            color: #856404;\n        }\n        \n        /* Bottom Navigation */\n        .bottom-nav {\n            position: fixed;\n            bottom: 0;\n            left: 0;\n            right: 0;\n            background: #fff;\n            border-top: 2px solid #e0e0e0;\n            padding: 10px 20px;\n            display: flex;\n            justify-content: space-around;\n            align-items: center;\n            z-index: 1000;\n            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);\n        }\n        \n        .nav-button {\n            background: #f5f5f5;\n            color: #333;\n            border: none;\n            padding: 12px 20px;\n            border-radius: 8px;\n            cursor: pointer;\n            font-size: 14px;\n            font-weight: bold;\n            transition: all 0.3s ease;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            gap: 4px;\n            min-width: 80px;\n        }\n        \n        .nav-button:hover {\n            background: #e0e0e0;\n            transform: translateY(-2px);\n        }\n        \n        .nav-button.primary {\n            background: #2196F3;\n            color: #fff;\n        }\n        \n        .nav-button.primary:hover {\n            background: #1976D2;\n        }\n        \n        .nav-icon {\n            font-size: 18px;\n        }\n        \n        .nav-text {\n            font-size: 12px;\n        }\n        \n        /* Add bottom padding to body for navigation */\n        body {\n            padding-bottom: 80px;\n        }\n\n        /* Mobile responsive */\n        @media (max-width: 768px) {\n            .multievent-2,\n            .multievent-3,\n            .multievent-4,\n            .multievent-5,\n            .multievent-6 {\n                grid-template-columns: 1fr;\n                grid-template-rows: repeat(auto-fit, minmax(200px, 1fr));\n            }\n            \n            .multievent-3 .event-block:nth-child(3),\n            .multievent-5 .event-block:nth-child(5) {\n                grid-column: 1;\n            }\n            \n            .event-block {\n                min-height: 150px;\n            }\n            \n            .players-grid {\n                grid-template-columns: repeat(auto-fill, minmax(45px, 1fr));\n                gap: 6px;\n            }\n            \n            .player-card {\n                min-height: 45px;\n                padding: 6px 2px;\n            }\n            \n            .player-number {\n                font-size: 18px;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"multievent-container\">\n        <!-- Header -->\n        <div class=\"header\">\n            <h1><?=h($t['title'])?></h1>\n            <div class=\"judge-info\">\n                #<?=h($_SESSION['scoring_judge_id'])?> <?=h($_SESSION['scoring_judge_name'])?> (<?=h($_SESSION['scoring_judge_country'])?>)\n            </div>\n        </div>\n        \n        <!-- Progress Overview -->\n        <div class=\"progress-overview\">\n            <h3>ì „ì²´ ì§„í–‰ ìƒí™©</h3>\n            <div class=\"progress-grid\" id=\"progressGrid\">\n                <!-- Progress items will be populated by JavaScript -->\n            </div>\n        </div>\n        \n        <!-- Multi-Event Layout -->\n        <div class=\"<?=h($layout_class)?>\" id=\"multieventContainer\">\n            <?php foreach ($filtered_events as $index => $event): ?>\n                <?php \n                $dance_names = getDanceNames($event['dances'], $dance_mapping);\n                // Use detail_no (which is already reflected in no) to load player list per sub-event\n                $players_file = \"$data_dir/players_{$event['no']}.txt\";\n                $players = [];\n                \n                // Debug: log player file path\n                error_log(\"Loading players for event {$event['no']}: $players_file (exists: \" . (file_exists($players_file) ? 'yes' : 'no') . \")\");\n                \n                if (file_exists($players_file)) {\n                    $lines = file($players_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n                    foreach ($lines as $line) {\n                        $line = preg_replace('/\\x{FEFF}/u', '', $line);\n                        $line = str_replace([\"\\xEF\\xBB\\xBF\", \"\\xFEFF\", \"\\uFEFF\"], '', $line);\n                        $line = preg_replace('/[\\x00-\\x1F\\x7F-\\x9F]/', '', $line);\n                        $line = trim($line);\n                        if ($line && is_numeric($line)) {\n                            $players[] = $line;\n                        }\n                    }\n                }\n                ?>\n                <div class=\"event-block\" data-event=\"<?=h($event['no'])?>\" data-index=\"<?=$index?>\">\n                    <div class=\"event-header\">\n                        <div class=\"event-title-row\">\n                            <div class=\"event-number-badge\">#<?=h($event['no'])?></div>\n                            <div>\n                                <div class=\"event-title\"><?=h($event['name'])?></div>\n                                <div class=\"event-details\">\n                                    <?php\n                                    // RunOrder_Tablet.txtì˜ round_typeì„ ì§ì ‘ ì‚¬ìš©\n                                    $round_display = $event['round_type'] ?: 'Final';\n                                    \n                                    // ë””ë²„ê·¸: ë¼ìš´ë“œ ì •ë³´ í™•ì¸\n                                    error_log(\"Event {$event['no']}: round_type='{$event['round_type']}', round_display='{$round_display}'\");\n                                    ?>\n                                    <?=h($round_display)?> | <?=h(implode(', ', $dance_names))?> | <?=count($players)?> couples\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"event-dances\">\n                        <?php foreach ($event['dances'] as $di => $dance_code): $dance_label = isset($dance_mapping[$dance_code]) ? $dance_mapping[$dance_code] : $dance_code; ?>\n                            <button type=\"button\" class=\"dance-btn<?= $di===0 ? ' active' : '' ?>\" data-event=\"<?=h($event['no'])?>\" data-dance=\"<?=h($dance_code)?>\"><?=\n                                h($dance_label)\n                            ?></button>\n                        <?php endforeach; ?>\n                    </div>\n                    \n                    <div class=\"scoring-area\">\n                        <?php \n                        $totalPlayers = count($players);\n                        $is_final = ($round_display === 'Final');\n                        $recall_count = intval($event['recall_count'] ?? 0);\n                        ?>\n                        \n                        <?php if ($is_final): ?>\n                            <!-- Final Round: ë“±ìœ„ ì…ë ¥ ë°©ì‹ -->\n                            <div class=\"touch-scoring-container\">\n                                <div class=\"players-column\">\n                                    <h4>ì„ ìˆ˜</h4>\n                                    <div class=\"players-list\">\n                                        <?php foreach ($players as $player_no): ?>\n                                            <div class=\"player-item\" data-event=\"<?=h($event['no'])?>\" data-player=\"<?=h($player_no)?>\"><?=h($player_no)?></div>\n                                        <?php endforeach; ?>\n                                    </div>\n                                </div>\n                                <div class=\"ranking-column\">\n                                    <h4>ìˆœìœ„</h4>\n                                    <div class=\"ranking-list\">\n                                        <?php for ($i=1; $i<= $totalPlayers; $i++): ?>\n                                            <div class=\"ranking-slot\" data-event=\"<?=h($event['no'])?>\" data-rank=\"<?=$i?>\">\n                                                <span class=\"player-assigned\"></span>\n                                            </div>\n                                        <?php endfor; ?>\n                                    </div>\n                                </div>\n                            </div>\n                            <div class=\"recall-status\">\n                                <div>Final ë“±ìœ„ ì…ë ¥</div>\n                                <div class=\"selected-count\">0</div> / <?= $totalPlayers ?>ëª…\n                            </div>\n                            \n                            <div class=\"submit-section\">\n                                <button type=\"button\" \n                                        class=\"submit-btn\" \n                                        data-event=\"<?=h($event['no'])?>\"\n                                        data-total-count=\"<?= $totalPlayers ?>\"\n                                        data-type=\"final\">\n                                    <?=h($event['name'])?> ë“±ìœ„ ì œì¶œ\n                                </button>\n                            </div>\n                        <?php else: ?>\n                            <!-- Preliminary/Semi-Final Round: Recall ì²´í¬ë°•ìŠ¤ ë°©ì‹ -->\n                            <div class=\"players-grid\">\n                                <?php foreach ($players as $player_no): ?>\n                                    <div class=\"player-card\" data-event=\"<?=h($event['no'])?>\" data-player=\"<?=h($player_no)?>\" onclick=\"togglePlayerSelection(this)\">\n                                        <div class=\"player-number\"><?=h($player_no)?></div>\n                                        <input type=\"checkbox\" \n                                               class=\"recall-checkbox\"\n                                               data-event=\"<?=h($event['no'])?>\"\n                                               data-player=\"<?=h($player_no)?>\"\n                                               style=\"display: none;\">\n                                    </div>\n                                <?php endforeach; ?>\n                            </div>\n                            \n                            <div class=\"recall-status\">\n                                <div style=\"font-size:20px; margin-bottom:5px;\">ğŸ“Š Recall ì§„í–‰ ìƒí™©</div>\n                                <div style=\"font-size:28px; font-weight:900; color:#2e7d32;\">\n                                    <span class=\"selected-count\">0</span> / <?= $recall_count ?>ëª…\n                                </div>\n                                <div style=\"font-size:14px; margin-top:5px; opacity:0.8;\">\n                                    <?= $recall_count ?>ëª…ì„ ì„ íƒí•˜ë©´ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤\n                                </div>\n                            </div>\n                            \n                            <div class=\"submit-section\">\n                                <button type=\"button\" \n                                        class=\"submit-btn\" \n                                        data-event=\"<?=h($event['no'])?>\"\n                                        data-recall-count=\"<?= $recall_count ?>\"\n                                        data-type=\"recall\">\n                                    <?=h($event['name'])?> Recall ì œì¶œ\n                                </button>\n                            </div>\n                        <?php endif; ?>\n                    </div>\n                </div>\n            <?php endforeach; ?>\n        </div>\n    </div>\n\n    <script>\n    document.addEventListener('DOMContentLoaded', function() {\n        initializeMultiEventScoring();\n    });\n    \n    const CURRENT_JUDGE_ID = <?= json_encode($_SESSION['scoring_judge_id'] ?? '') ?>;\n    const ACTIVE_DANCE_BY_EVENT = {};\n    const EXISTING_SCORES = <?= json_encode($existing_scores) ?>;\n\n    const SELECTED_PLAYER_BY_EVENT = {};\n    const RANKINGS_BY_EVENT_AND_DANCE = {}; // { eventNo: { dance: { playerNo: rank } } }\n\n    function initializeMultiEventScoring() {\n        // ì…ë ¥ ìƒí˜¸ì‘ìš©: ë“±ìœ„ ì…ë ¥ í¬ì»¤ìŠ¤/ë³€ê²½ ì‹œ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸\n        document.querySelectorAll('.player-item').forEach(item => {\n            item.addEventListener('click', function() {\n                const ev = this.dataset.event;\n                // ì´ë¯¸ ë°°ì •ëœ ì„ ìˆ˜ë©´ ì„ íƒ ë¶ˆê°€\n                if (this.classList.contains('assigned')) return;\n                // í† ê¸€ ì„ íƒ\n                document.querySelectorAll(`.player-item[data-event=\"${ev}\"]`).forEach(it=>it.classList.remove('selected'));\n                this.classList.add('selected');\n                SELECTED_PLAYER_BY_EVENT[ev] = this.dataset.player;\n            });\n        });\n        document.querySelectorAll('.ranking-slot').forEach(slot => {\n            slot.addEventListener('click', function() {\n                const ev = this.dataset.event;\n                const dance = ACTIVE_DANCE_BY_EVENT[ev];\n                const selected = SELECTED_PLAYER_BY_EVENT[ev];\n                if (!dance) { alert('ì¢…ëª©ì„ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”.'); return; }\n                if (!selected) {\n                    // ì„ íƒëœ ì„ ìˆ˜ê°€ ì—†ìœ¼ë©´ ê¸°ì¡´ ë°°ì •ì„ ì·¨ì†Œ(í† ê¸€)\n                    if (this.classList.contains('assigned')) {\n                        const current = this.querySelector('.player-assigned').textContent;\n                        unassignPlayer(ev, dance, current, this);\n                        updateEventStatus(ev);\n                        updateProgressOverview();\n                    }\n                    return;\n                }\n                // ì´ë¯¸ ì´ ë­í¬ì— ë°°ì •ëœ ì„ ìˆ˜ê°€ ìˆìœ¼ë©´ ë¨¼ì € í•´ì œ\n                if (this.classList.contains('assigned')) {\n                    const current = this.querySelector('.player-assigned').textContent;\n                    if (current === selected) {\n                        // ê°™ì€ ì„ ìˆ˜ ì¬í„°ì¹˜ì‹œ í•´ì œ\n                        unassignPlayer(ev, dance, selected, this);\n                        updateEventStatus(ev);\n                        updateProgressOverview();\n                        return;\n                    } else {\n                        unassignPlayer(ev, dance, current, this);\n                    }\n                }\n                assignPlayerToRank(ev, dance, selected, this);\n                updateEventStatus(ev);\n                updateProgressOverview();\n            });\n        });\n        // ëŒ„ìŠ¤ íƒ­ ì´ˆê¸°í™” ë° í´ë¦­ í•¸ë“¤ëŸ¬ (ì´ë²¤íŠ¸ë³„ í™œì„± ëŒ„ìŠ¤ ì„¤ì •)\n        document.querySelectorAll('.dance-btn').forEach(btn => {\n            const ev = btn.dataset.event;\n            if (ACTIVE_DANCE_BY_EVENT[ev] === undefined) {\n                ACTIVE_DANCE_BY_EVENT[ev] = btn.dataset.dance;\n            }\n            btn.addEventListener('click', function() {\n                const eventNo = this.dataset.event;\n                const parent = this.parentElement;\n                parent.querySelectorAll('.dance-btn').forEach(b=>b.classList.remove('active'));\n                this.classList.add('active');\n                ACTIVE_DANCE_BY_EVENT[eventNo] = this.dataset.dance;\n                // ì„ íƒëœ ì¢…ëª© ìƒíƒœë¡œ UI ë°˜ì˜\n                renderRanksForEventDance(eventNo, this.dataset.dance);\n                updateEventStatus(eventNo);\n                updateProgressOverview();\n            });\n        });\n\n        // ì œì¶œ ë²„íŠ¼ í•¸ë“¤ëŸ¬\n        document.querySelectorAll('.submit-btn').forEach(btn => {\n            btn.addEventListener('click', function() {\n                submitEvent(this.dataset.event);\n            });\n        });\n        \n        // Load existing scores\n        loadExistingScores();\n        \n        updateProgressOverview();\n    }\n    \n    function loadExistingScores() {\n        console.log('Loading existing scores:', EXISTING_SCORES);\n        \n        Object.keys(EXISTING_SCORES).forEach(eventNo => {\n            const eventScores = EXISTING_SCORES[eventNo];\n            Object.keys(eventScores).forEach(dance => {\n                const rankings = eventScores[dance]; // { playerNo: rank }\n                \n                // Initialize RANKINGS_BY_EVENT_AND_DANCE structure\n                if (!RANKINGS_BY_EVENT_AND_DANCE[eventNo]) {\n                    RANKINGS_BY_EVENT_AND_DANCE[eventNo] = {};\n                }\n                if (!RANKINGS_BY_EVENT_AND_DANCE[eventNo][dance]) {\n                    RANKINGS_BY_EVENT_AND_DANCE[eventNo][dance] = {};\n                }\n                \n                // Store the rankings\n                Object.keys(rankings).forEach(playerNo => {\n                    const rank = rankings[playerNo];\n                    RANKINGS_BY_EVENT_AND_DANCE[eventNo][dance][playerNo] = rank;\n                });\n                \n                console.log(`Loaded scores for event ${eventNo}, dance ${dance}:`, rankings);\n            });\n        });\n        \n        // Update UI for all events with their first dance\n        document.querySelectorAll('.event-block').forEach(block => {\n            const eventNo = block.dataset.event;\n            const firstDanceBtn = block.querySelector('.dance-btn');\n            if (firstDanceBtn) {\n                const firstDance = firstDanceBtn.dataset.dance;\n                renderRanksForEventDance(eventNo, firstDance);\n                updateEventStatus(eventNo);\n            }\n        });\n    }\n    \n    function updateEventStatus(eventNo) {\n        const eventBlock = document.querySelector(`[data-event=\"${eventNo}\"]`);\n        const submitBtn = eventBlock.querySelector('.submit-btn');\n        const isRecall = submitBtn.dataset.type === 'recall';\n        const statusDiv = eventBlock.querySelector('.recall-status');\n        \n        if (isRecall) {\n            // Recall ë°©ì‹: ì²´í¬ë°•ìŠ¤ ê°œìˆ˜ í™•ì¸\n            const recallCount = parseInt(submitBtn.dataset.recallCount);\n            const checkboxes = eventBlock.querySelectorAll('.recall-checkbox:checked');\n            const selectedCount = checkboxes.length;\n            \n            statusDiv.querySelector('.selected-count').textContent = selectedCount;\n            statusDiv.classList.remove('complete', 'over');\n            \n            if (selectedCount === recallCount) {\n                statusDiv.classList.add('complete');\n                submitBtn.style.display = 'inline-block';\n                submitBtn.disabled = false;\n            } else if (selectedCount > recallCount) {\n                statusDiv.classList.add('over');\n                submitBtn.style.display = 'none';\n                submitBtn.disabled = true;\n            } else {\n                submitBtn.style.display = 'none';\n                submitBtn.disabled = true;\n            }\n        } else {\n            // Final ë°©ì‹: ìˆœìœ„ ê°œìˆ˜ í™•ì¸\n            const totalCount = parseInt(submitBtn.dataset.totalCount);\n            const dance = ACTIVE_DANCE_BY_EVENT[eventNo];\n            const ranks = getCurrentRanks(eventNo, dance);\n            const values = Object.values(ranks);\n            const filled = values.length;\n            const duplicate = (new Set(values)).size !== values.length;\n            \n            statusDiv.querySelector('.selected-count').textContent = filled;\n            statusDiv.classList.remove('complete', 'over');\n            \n            if (filled === totalCount && !duplicate) {\n                statusDiv.classList.add('complete');\n                submitBtn.style.display = 'inline-block';\n                submitBtn.disabled = false;\n            } else {\n                if (duplicate) statusDiv.classList.add('over');\n                submitBtn.style.display = 'none';\n                submitBtn.disabled = true;\n            }\n        }\n    }\n    \n    function updateProgressOverview() {\n        const progressGrid = document.getElementById('progressGrid');\n        const eventBlocks = document.querySelectorAll('.event-block');\n        progressGrid.innerHTML = '';\n        eventBlocks.forEach(block => {\n            const eventNo = block.dataset.event;\n            const inputs = block.querySelectorAll('.rank-input');\n            const totalCount = parseInt(block.querySelector('.submit-btn').dataset.totalCount);\n            let filled = 0;\n            inputs.forEach(inp => { if ((inp.value || '').trim()) filled++; });\n            const item = document.createElement('div');\n            item.className = 'progress-item';\n            if (filled === totalCount) {\n                item.classList.add('completed');\n                item.textContent = `ì´ë²¤íŠ¸ ${eventNo} ì™„ë£Œ`;\n            } else if (filled > 0) {\n                item.classList.add('current');\n                item.textContent = `ì´ë²¤íŠ¸ ${eventNo} ${filled}/${totalCount}`;\n            } else {\n                item.textContent = `ì´ë²¤íŠ¸ ${eventNo} ëŒ€ê¸°`;\n            }\n            progressGrid.appendChild(item);\n        });\n    }\n    \n    function submitEvent(eventNo) {\n        const eventBlock = document.querySelector(`[data-event=\"${eventNo}\"]`);\n        const submitBtn = eventBlock.querySelector('.submit-btn');\n        const submitType = submitBtn.dataset.type;\n        const dance = ACTIVE_DANCE_BY_EVENT[eventNo];\n        \n        if (!dance) { alert('ì¢…ëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”.'); return; }\n        \n        const formData = new FormData();\n        formData.append('comp_id', '<?=h($comp_id)?>');\n        formData.append('event_no', eventNo);\n        formData.append('dance', dance);\n        \n        if (submitType === 'final') {\n            // Final Round: ë“±ìœ„ ì œì¶œ\n            const totalCount = parseInt(submitBtn.dataset.totalCount);\n            const ranks = getCurrentRanks(eventNo, dance);\n            const values = Object.values(ranks);\n            if (values.length !== totalCount) { alert('ëª¨ë“  ìˆœìœ„ë¥¼ ë°°ì •í•´ì£¼ì„¸ìš”.'); return; }\n            const uniq = new Set(values);\n            if (uniq.size !== values.length) { alert('ì¤‘ë³µëœ ìˆœìœ„ê°€ ìˆìŠµë‹ˆë‹¤.'); return; }\n            \n            formData.append('is_final', '1');\n            const adjudicator_marks = {};\n            adjudicator_marks[CURRENT_JUDGE_ID] = ranks;\n            formData.append('adjudicator_marks', JSON.stringify(adjudicator_marks));\n        } else {\n            // Recall Round: ì²´í¬ë°•ìŠ¤ ì œì¶œ\n            const recallCount = parseInt(submitBtn.dataset.recallCount);\n            const checkboxes = eventBlock.querySelectorAll('.recall-checkbox:checked');\n            if (checkboxes.length !== recallCount) { \n                alert(`${recallCount}ëª…ì„ ì •í™•íˆ ì„ íƒí•´ì£¼ì„¸ìš”.`); \n                return; \n            }\n            \n            const selectedPlayers = Array.from(checkboxes).map(cb => cb.dataset.player);\n            const recallMarks = {};\n            recallMarks[dance] = selectedPlayers;\n            \n            formData.append('type', 'recall');\n            formData.append('recall_marks', JSON.stringify(recallMarks));\n        }\n        \n        const originalText = submitBtn.textContent;\n        submitBtn.textContent = 'ì „ì†¡ ì¤‘...';\n        submitBtn.disabled = true;\n        \n        fetch('scoring/save_multievent_scores.php', { method: 'POST', body: formData })\n        .then(r=>r.json())\n        .then(result=>{\n            if (result.success) {\n                submitBtn.textContent = 'ì™„ë£Œ';\n                submitBtn.style.background = '#28a745';\n                eventBlock.classList.add('completed');\n                updateProgressOverview();\n            } else {\n                alert('ì „ì†¡ ì‹¤íŒ¨: ' + (result.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));\n                submitBtn.textContent = originalText;\n                submitBtn.disabled = false;\n            }\n        })\n        .catch(err=>{\n            console.error(err);\n            alert('ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + err);\n            submitBtn.textContent = originalText;\n            submitBtn.disabled = false;\n        });\n    }\n\n    function renderRanksForEventDance(eventNo, dance) {\n        const eventBlock = document.querySelector(`[data-event=\"${eventNo}\"]`);\n        const submitBtn = eventBlock.querySelector('.submit-btn');\n        const isRecall = submitBtn.dataset.type === 'recall';\n        \n        if (isRecall) {\n            // Recall ë°©ì‹: ì²´í¬ë°•ìŠ¤ ë³µì›\n            document.querySelectorAll(`.event-block[data-event=\"${eventNo}\"] .player-card`).forEach(card => {\n                card.classList.remove('selected');\n                const checkbox = card.querySelector('.recall-checkbox');\n                if (checkbox) checkbox.checked = false;\n            });\n            \n            const ranks = getCurrentRanks(eventNo, dance);\n            Object.keys(ranks).forEach(playerNo => {\n                if (ranks[playerNo] === 'selected') {\n                    const card = document.querySelector(`.event-block[data-event=\"${eventNo}\"] .player-card[data-player=\"${playerNo}\"]`);\n                    if (card) {\n                        card.classList.add('selected');\n                        const checkbox = card.querySelector('.recall-checkbox');\n                        if (checkbox) checkbox.checked = true;\n                    }\n                }\n            });\n            \n            updateRecallStatus(eventNo);\n        } else {\n            // Final ë°©ì‹: ìˆœìœ„ ìŠ¬ë¡¯ ë³µì›\n            document.querySelectorAll(`.event-block[data-event=\"${eventNo}\"] .ranking-slot`).forEach(slot => {\n                slot.classList.remove('assigned');\n                const span = slot.querySelector('.player-assigned');\n                if (span) span.textContent = '';\n            });\n            document.querySelectorAll(`.player-item[data-event=\"${eventNo}\"]`).forEach(item => {\n                item.classList.remove('assigned');\n                item.classList.remove('selected');\n            });\n            \n            const ranks = getCurrentRanks(eventNo, dance);\n            Object.keys(ranks).forEach(playerNo => {\n                const rank = ranks[playerNo];\n                if (typeof rank === 'number') {\n                    const slot = document.querySelector(`.event-block[data-event=\"${eventNo}\"] .ranking-slot[data-rank=\"${rank}\"]`);\n                    if (slot) {\n                        slot.classList.add('assigned');\n                        const span = slot.querySelector('.player-assigned');\n                        if (span) span.textContent = playerNo;\n                    }\n                    const playerEl = document.querySelector(`.player-item[data-event=\"${eventNo}\"][data-player=\"${playerNo}\"]`);\n                    if (playerEl) playerEl.classList.add('assigned');\n                }\n            });\n            \n            updateEventStatus(eventNo);\n        }\n    }\n\n    function assignPlayerToRank(eventNo, dance, playerNo, rankSlotEl) {\n        // ë­í¬ì— í‘œì‹œ\n        rankSlotEl.classList.add('assigned');\n        rankSlotEl.querySelector('.player-assigned').textContent = playerNo;\n        // ì„ ìˆ˜ ë°°ì • ë§ˆí¬\n        const playerEl = document.querySelector(`.player-item[data-event=\"${eventNo}\"][data-player=\"${playerNo}\"]`);\n        if (playerEl) { playerEl.classList.add('assigned'); playerEl.classList.remove('selected'); }\n        // ìƒíƒœ ì €ì¥\n        if (!RANKINGS_BY_EVENT_AND_DANCE[eventNo]) RANKINGS_BY_EVENT_AND_DANCE[eventNo] = {};\n        if (!RANKINGS_BY_EVENT_AND_DANCE[eventNo][dance]) RANKINGS_BY_EVENT_AND_DANCE[eventNo][dance] = {};\n        RANKINGS_BY_EVENT_AND_DANCE[eventNo][dance][playerNo] = parseInt(rankSlotEl.dataset.rank, 10);\n        // ì„ íƒ í•´ì œ\n        SELECTED_PLAYER_BY_EVENT[eventNo] = null;\n    }\n\n    function unassignPlayer(eventNo, dance, playerNo, rankSlotEl) {\n        rankSlotEl.classList.remove('assigned');\n        rankSlotEl.querySelector('.player-assigned').textContent = '';\n        const playerEl = document.querySelector(`.player-item[data-event=\"${eventNo}\"][data-player=\"${playerNo}\"]`);\n        if (playerEl) { playerEl.classList.remove('assigned'); }\n        if (RANKINGS_BY_EVENT_AND_DANCE[eventNo] && RANKINGS_BY_EVENT_AND_DANCE[eventNo][dance]) {\n            delete RANKINGS_BY_EVENT_AND_DANCE[eventNo][dance][playerNo];\n        }\n    }\n\n    function getCurrentRanks(eventNo, dance) {\n        const obj = (RANKINGS_BY_EVENT_AND_DANCE[eventNo] && RANKINGS_BY_EVENT_AND_DANCE[eventNo][dance]) ? RANKINGS_BY_EVENT_AND_DANCE[eventNo][dance] : {};\n        return obj;\n    }\n\n    // Recall system functions\n    function togglePlayerSelection(card) {\n        const checkbox = card.querySelector('.recall-checkbox');\n        checkbox.checked = !checkbox.checked;\n        updatePlayerCardState(card);\n        updateRecallStatus(card.dataset.event);\n    }\n\n    function updatePlayerCardState(card) {\n        const checkbox = card.querySelector('.recall-checkbox');\n        if (checkbox.checked) {\n            card.classList.add('selected');\n        } else {\n            card.classList.remove('selected');\n        }\n    }\n\n    function updateRecallStatus(eventNo) {\n        const eventBlock = document.querySelector(`[data-event=\"${eventNo}\"]`);\n        const checkboxes = eventBlock.querySelectorAll('.recall-checkbox:checked');\n        const submitBtn = eventBlock.querySelector('.submit-btn');\n        const recallCount = parseInt(submitBtn.dataset.recallCount || '0');\n        const selectedCount = checkboxes.length;\n        \n        const statusDiv = eventBlock.querySelector('.recall-status');\n        const countSpan = statusDiv.querySelector('.selected-count');\n        \n        if (countSpan) {\n            countSpan.textContent = selectedCount;\n        }\n        \n        // Update status styling\n        statusDiv.classList.remove('complete', 'over');\n        if (selectedCount === recallCount) {\n            statusDiv.classList.add('complete');\n            submitBtn.style.display = 'inline-block';\n            submitBtn.disabled = false;\n        } else if (selectedCount > recallCount) {\n            statusDiv.classList.add('over');\n            submitBtn.style.display = 'none';\n            submitBtn.disabled = true;\n        } else {\n            submitBtn.style.display = 'none';\n            submitBtn.disabled = true;\n        }\n    }\n    </script>\n\n    <!-- Bottom Navigation -->\n    <div class=\"bottom-nav\">\n        <button type=\"button\" id=\"dashboardBtn\" class=\"nav-button primary\">\n            <div class=\"nav-icon\">ğŸ </div>\n            <div class=\"nav-text\">ë©”ì¸ìœ¼ë¡œ</div>\n        </button>\n        <button type=\"button\" id=\"refreshBtn\" class=\"nav-button\">\n            <div class=\"nav-icon\">ğŸ”„</div>\n            <div class=\"nav-text\">ìƒˆë¡œê³ ì¹¨</div>\n        </button>\n    </div>\n\n    <script>\n    // Setup navigation buttons\n    document.addEventListener('DOMContentLoaded', function() {\n        document.getElementById('dashboardBtn').addEventListener('click', function() {\n            const compId = '<?= h($comp_id) ?>';\n            const lang = '<?= h($lang) ?>';\n            window.location.href = `scoring_dashboard.php?comp_id=${compId}&lang=${lang}`;\n        });\n        \n        document.getElementById('refreshBtn').addEventListener('click', function() {\n            if (confirm('í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì‹œê² ìŠµë‹ˆê¹Œ? í˜„ì¬ ì‘ì—… ì¤‘ì¸ ë‚´ìš©ì´ ì €ì¥ë˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.')) {\n                window.location.reload();\n            }\n        });\n    });\n    </script>\n</body>\n</html>\n","size_bytes":49286},"comp/result_dashboard.php":{"content":"<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>ëŒ„ìŠ¤ìŠ¤ì½”ì–´ ê²°ê³¼ ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n        \n        body {\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            min-height: 100vh;\n            color: #333;\n        }\n        \n        .container {\n            max-width: 1400px;\n            margin: 0 auto;\n            padding: 20px;\n        }\n        \n        .header {\n            text-align: center;\n            color: white;\n            margin-bottom: 30px;\n        }\n        \n        .header h1 {\n            font-size: 3em;\n            margin-bottom: 10px;\n            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);\n        }\n        \n        .header p {\n            font-size: 1.2em;\n            opacity: 0.9;\n        }\n        \n        .dashboard {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 30px;\n            margin-bottom: 30px;\n        }\n        \n        .panel {\n            background: white;\n            border-radius: 15px;\n            padding: 25px;\n            box-shadow: 0 10px 30px rgba(0,0,0,0.2);\n            transition: transform 0.3s ease;\n        }\n        \n        .panel:hover {\n            transform: translateY(-5px);\n        }\n        \n        .panel h2 {\n            color: #667eea;\n            margin-bottom: 20px;\n            font-size: 1.5em;\n            border-bottom: 3px solid #667eea;\n            padding-bottom: 10px;\n        }\n        \n        .status-indicator {\n            display: inline-block;\n            width: 12px;\n            height: 12px;\n            border-radius: 50%;\n            margin-right: 10px;\n        }\n        \n        .status-online {\n            background: #4CAF50;\n            box-shadow: 0 0 10px rgba(76, 175, 80, 0.5);\n        }\n        \n        .status-offline {\n            background: #f44336;\n            box-shadow: 0 0 10px rgba(244, 67, 54, 0.5);\n        }\n        \n        .file-list {\n            max-height: 300px;\n            overflow-y: auto;\n            border: 1px solid #e0e0e0;\n            border-radius: 8px;\n            padding: 15px;\n        }\n        \n        .file-item {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 10px;\n            margin-bottom: 8px;\n            background: #f8f9fa;\n            border-radius: 5px;\n            border-left: 4px solid #667eea;\n        }\n        \n        .file-item:hover {\n            background: #e9ecef;\n        }\n        \n        .file-name {\n            font-weight: bold;\n            color: #333;\n        }\n        \n        .file-time {\n            font-size: 0.9em;\n            color: #666;\n        }\n        \n        .btn {\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n            border: none;\n            padding: 12px 25px;\n            border-radius: 25px;\n            cursor: pointer;\n            font-size: 16px;\n            transition: all 0.3s ease;\n            margin: 5px;\n        }\n        \n        .btn:hover {\n            transform: translateY(-2px);\n            box-shadow: 0 5px 15px rgba(0,0,0,0.2);\n        }\n        \n        .btn:active {\n            transform: translateY(0);\n        }\n        \n        .btn-success {\n            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);\n        }\n        \n        .btn-warning {\n            background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);\n        }\n        \n        .btn-danger {\n            background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);\n        }\n        \n        .controls {\n            text-align: center;\n            margin-bottom: 30px;\n        }\n        \n        .auto-refresh {\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            margin-top: 15px;\n        }\n        \n        .auto-refresh input[type=\"checkbox\"] {\n            margin-right: 10px;\n            transform: scale(1.2);\n        }\n        \n        .auto-refresh label {\n            color: white;\n            font-weight: bold;\n        }\n        \n        .log-container {\n            background: #1e1e1e;\n            color: #00ff00;\n            padding: 20px;\n            border-radius: 10px;\n            font-family: 'Courier New', monospace;\n            max-height: 200px;\n            overflow-y: auto;\n            margin-top: 20px;\n        }\n        \n        .log-entry {\n            margin-bottom: 5px;\n            padding: 2px 0;\n        }\n        \n        .log-time {\n            color: #888;\n        }\n        \n        .log-info {\n            color: #00ff00;\n        }\n        \n        .log-warning {\n            color: #ffaa00;\n        }\n        \n        .log-error {\n            color: #ff4444;\n        }\n        \n        .fullscreen-btn {\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            z-index: 1000;\n        }\n        \n        .modal {\n            display: none;\n            position: fixed;\n            z-index: 2000;\n            left: 0;\n            top: 0;\n            width: 100%;\n            height: 100%;\n            background-color: rgba(0,0,0,0.8);\n        }\n        \n        .modal-content {\n            background-color: white;\n            margin: 5% auto;\n            padding: 20px;\n            border-radius: 15px;\n            width: 90%;\n            max-width: 1200px;\n            max-height: 80vh;\n            overflow-y: auto;\n        }\n        \n        .close {\n            color: #aaa;\n            float: right;\n            font-size: 28px;\n            font-weight: bold;\n            cursor: pointer;\n        }\n        \n        .close:hover {\n            color: #000;\n        }\n        \n        .stats-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n            gap: 20px;\n            margin-bottom: 20px;\n        }\n        \n        .stat-card {\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n            padding: 20px;\n            border-radius: 10px;\n            text-align: center;\n        }\n        \n        .stat-number {\n            font-size: 2em;\n            font-weight: bold;\n            margin-bottom: 5px;\n        }\n        \n        .stat-label {\n            font-size: 0.9em;\n            opacity: 0.9;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>ğŸ† ëŒ„ìŠ¤ìŠ¤ì½”ì–´ ê²°ê³¼ ëª¨ë‹ˆí„°ë§</h1>\n            <p>ì‹¤ì‹œê°„ ê²°ê³¼ íŒŒì¼ ëª¨ë‹ˆí„°ë§ ë° ì¢…í•© ê²°ê³¼ ìƒì„±</p>\n        </div>\n        \n        <div class=\"controls\">\n            <button class=\"btn\" onclick=\"checkNewFiles()\">ğŸ” ìƒˆ íŒŒì¼ í™•ì¸</button>\n            <button class=\"btn btn-success\" onclick=\"processAllResults()\">âš¡ ëª¨ë“  ê²°ê³¼ ì²˜ë¦¬</button>\n            <button class=\"btn btn-warning\" onclick=\"showFileList()\">ğŸ“ íŒŒì¼ ëª©ë¡</button>\n            <button class=\"btn btn-danger\" onclick=\"clearLog()\">ğŸ—‘ï¸ ë¡œê·¸ ì§€ìš°ê¸°</button>\n            \n            <div class=\"auto-refresh\">\n                <input type=\"checkbox\" id=\"autoRefresh\" onchange=\"toggleAutoRefresh()\">\n                <label for=\"autoRefresh\">ìë™ ìƒˆë¡œê³ ì¹¨ (30ì´ˆ)</label>\n            </div>\n        </div>\n        \n        <div class=\"stats-grid\">\n            <div class=\"stat-card\">\n                <div class=\"stat-number\" id=\"totalFiles\">0</div>\n                <div class=\"stat-label\">ì´ íŒŒì¼ ìˆ˜</div>\n            </div>\n            <div class=\"stat-card\">\n                <div class=\"stat-number\" id=\"processedFiles\">0</div>\n                <div class=\"stat-label\">ì²˜ë¦¬ëœ íŒŒì¼</div>\n            </div>\n            <div class=\"stat-card\">\n                <div class=\"stat-number\" id=\"newFiles\">0</div>\n                <div class=\"stat-label\">ìƒˆ íŒŒì¼</div>\n            </div>\n            <div class=\"stat-card\">\n                <div class=\"stat-number\" id=\"lastUpdate\">-</div>\n                <div class=\"stat-label\">ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸</div>\n            </div>\n        </div>\n        \n        <div class=\"dashboard\">\n            <div class=\"panel\">\n                <h2>ğŸ“Š ëª¨ë‹ˆí„°ë§ ìƒíƒœ</h2>\n                <p><span class=\"status-indicator status-online\" id=\"monitorStatus\"></span>ëª¨ë‹ˆí„°ë§ í™œì„±</p>\n                <p><span class=\"status-indicator status-offline\" id=\"processStatus\"></span>ì²˜ë¦¬ ìƒíƒœ</p>\n                \n                <div class=\"file-list\" id=\"recentFiles\">\n                    <div class=\"file-item\">\n                        <span class=\"file-name\">ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì¤‘...</span>\n                        <span class=\"file-time\">-</span>\n                    </div>\n                </div>\n            </div>\n            \n            <div class=\"panel\">\n                <h2>ğŸ“ ì²˜ë¦¬ ë¡œê·¸</h2>\n                <div class=\"log-container\" id=\"logContainer\">\n                    <div class=\"log-entry\">\n                        <span class=\"log-time\">[ì‹œì‘]</span>\n                        <span class=\"log-info\">ì‹œìŠ¤í…œì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.</span>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"fullscreen-btn\">\n            <button class=\"btn\" onclick=\"openFullscreen()\">ğŸ–¥ï¸ ì „ì²´í™”ë©´</button>\n        </div>\n    </div>\n    \n    <!-- ëª¨ë‹¬ -->\n    <div id=\"fileModal\" class=\"modal\">\n        <div class=\"modal-content\">\n            <span class=\"close\" onclick=\"closeModal()\">&times;</span>\n            <h2>ğŸ“ íŒŒì¼ ëª©ë¡</h2>\n            <div id=\"fileListContent\"></div>\n        </div>\n    </div>\n    \n    <script>\n        let autoRefreshInterval;\n        let isAutoRefresh = false;\n        \n        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”\n        document.addEventListener('DOMContentLoaded', function() {\n            logMessage('ì‹œìŠ¤í…œì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.', 'info');\n            checkNewFiles();\n            updateStats();\n        });\n        \n        // ìƒˆ íŒŒì¼ í™•ì¸\n        async function checkNewFiles() {\n            try {\n                const response = await fetch('result_monitor.php?action=check');\n                const data = await response.json();\n                \n                if (data.success) {\n                    const newFiles = data.new_files || [];\n                    updateNewFilesCount(newFiles.length);\n                    \n                    if (newFiles.length > 0) {\n                        logMessage(`${newFiles.length}ê°œì˜ ìƒˆ íŒŒì¼ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤.`, 'warning');\n                        updateRecentFiles(newFiles);\n                    } else {\n                        logMessage('ìƒˆ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.', 'info');\n                    }\n                } else {\n                    logMessage('íŒŒì¼ í™•ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');\n                }\n            } catch (error) {\n                logMessage(`ì˜¤ë¥˜: ${error.message}`, 'error');\n            }\n        }\n        \n        // ëª¨ë“  ê²°ê³¼ ì²˜ë¦¬\n        async function processAllResults() {\n            try {\n                logMessage('ê²°ê³¼ ì²˜ë¦¬ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...', 'info');\n                setProcessStatus(true);\n                \n                const response = await fetch('result_monitor.php?action=process');\n                const data = await response.json();\n                \n                if (data.success) {\n                    const processed = data.processed || [];\n                    updateProcessedFilesCount(processed.length);\n                    \n                    logMessage(`${processed.length}ê°œì˜ ê²°ê³¼ê°€ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.`, 'info');\n                    \n                    processed.forEach(result => {\n                        logMessage(`ì²˜ë¦¬ ì™„ë£Œ: ${result.event_title} (${result.event_id})`, 'info');\n                    });\n                } else {\n                    logMessage('ê²°ê³¼ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');\n                }\n            } catch (error) {\n                logMessage(`ì˜¤ë¥˜: ${error.message}`, 'error');\n            } finally {\n                setProcessStatus(false);\n            }\n        }\n        \n        // íŒŒì¼ ëª©ë¡ í‘œì‹œ\n        async function showFileList() {\n            try {\n                const response = await fetch('result_monitor.php?action=list');\n                const data = await response.json();\n                \n                if (data.success) {\n                    const pairs = data.pairs || [];\n                    displayFileList(pairs);\n                    document.getElementById('fileModal').style.display = 'block';\n                } else {\n                    logMessage('íŒŒì¼ ëª©ë¡ì„ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');\n                }\n            } catch (error) {\n                logMessage(`ì˜¤ë¥˜: ${error.message}`, 'error');\n            }\n        }\n        \n        // íŒŒì¼ ëª©ë¡ í‘œì‹œ\n        function displayFileList(pairs) {\n            const content = document.getElementById('fileListContent');\n            content.innerHTML = '';\n            \n            if (pairs.length === 0) {\n                content.innerHTML = '<p>ì²˜ë¦¬í•  íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.</p>';\n                return;\n            }\n            \n            pairs.forEach(pair => {\n                const div = document.createElement('div');\n                div.className = 'file-item';\n                div.innerHTML = `\n                    <div>\n                        <div class=\"file-name\">${pair.event_id}</div>\n                        <div style=\"font-size: 0.8em; color: #666;\">\n                            ìš”ì•½: ${pair.summary.split('/').pop()}<br>\n                            ìƒì„¸: ${pair.detailed.split('/').pop()}\n                        </div>\n                    </div>\n                    <div>\n                        <button class=\"btn\" onclick=\"viewResult('${pair.event_id}')\">ë³´ê¸°</button>\n                    </div>\n                `;\n                content.appendChild(div);\n            });\n        }\n        \n        // ê²°ê³¼ ë³´ê¸°\n        function viewResult(eventId) {\n            window.open(`combined_result_${eventId}.html`, '_blank');\n        }\n        \n        // ëª¨ë‹¬ ë‹«ê¸°\n        function closeModal() {\n            document.getElementById('fileModal').style.display = 'none';\n        }\n        \n        // ì „ì²´í™”ë©´ ì—´ê¸°\n        function openFullscreen() {\n            const pairs = getFilePairs();\n            if (pairs.length > 0) {\n                const latestPair = pairs[pairs.length - 1];\n                window.open(`combined_result_${latestPair.event_id}.html`, '_blank');\n            } else {\n                alert('í‘œì‹œí•  ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.');\n            }\n        }\n        \n        // ìë™ ìƒˆë¡œê³ ì¹¨ í† ê¸€\n        function toggleAutoRefresh() {\n            isAutoRefresh = document.getElementById('autoRefresh').checked;\n            \n            if (isAutoRefresh) {\n                autoRefreshInterval = setInterval(() => {\n                    checkNewFiles();\n                    updateStats();\n                }, 30000);\n                logMessage('ìë™ ìƒˆë¡œê³ ì¹¨ì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.', 'info');\n            } else {\n                clearInterval(autoRefreshInterval);\n                logMessage('ìë™ ìƒˆë¡œê³ ì¹¨ì´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.', 'info');\n            }\n        }\n        \n        // ë¡œê·¸ ë©”ì‹œì§€ ì¶”ê°€\n        function logMessage(message, type = 'info') {\n            const logContainer = document.getElementById('logContainer');\n            const time = new Date().toLocaleTimeString();\n            \n            const logEntry = document.createElement('div');\n            logEntry.className = `log-entry log-${type}`;\n            logEntry.innerHTML = `<span class=\"log-time\">[${time}]</span> <span class=\"log-${type}\">${message}</span>`;\n            \n            logContainer.appendChild(logEntry);\n            logContainer.scrollTop = logContainer.scrollHeight;\n            \n            // ìµœëŒ€ 100ê°œ ë¡œê·¸ ìœ ì§€\n            while (logContainer.children.length > 100) {\n                logContainer.removeChild(logContainer.firstChild);\n            }\n        }\n        \n        // ë¡œê·¸ ì§€ìš°ê¸°\n        function clearLog() {\n            document.getElementById('logContainer').innerHTML = '';\n            logMessage('ë¡œê·¸ê°€ ì§€ì›Œì¡ŒìŠµë‹ˆë‹¤.', 'info');\n        }\n        \n        // ì²˜ë¦¬ ìƒíƒœ ì—…ë°ì´íŠ¸\n        function setProcessStatus(processing) {\n            const status = document.getElementById('processStatus');\n            if (processing) {\n                status.className = 'status-indicator status-online';\n                status.nextSibling.textContent = 'ì²˜ë¦¬ ì¤‘...';\n            } else {\n                status.className = 'status-indicator status-offline';\n                status.nextSibling.textContent = 'ëŒ€ê¸° ì¤‘';\n            }\n        }\n        \n        // í†µê³„ ì—…ë°ì´íŠ¸\n        async function updateStats() {\n            try {\n                const response = await fetch('result_monitor.php?action=list');\n                const data = await response.json();\n                \n                if (data.success) {\n                    const pairs = data.pairs || [];\n                    document.getElementById('totalFiles').textContent = pairs.length * 2; // ìš”ì•½ + ìƒì„¸\n                    document.getElementById('processedFiles').textContent = pairs.length;\n                    document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString();\n                }\n            } catch (error) {\n                console.error('í†µê³„ ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:', error);\n            }\n        }\n        \n        // ìƒˆ íŒŒì¼ ìˆ˜ ì—…ë°ì´íŠ¸\n        function updateNewFilesCount(count) {\n            document.getElementById('newFiles').textContent = count;\n        }\n        \n        // ì²˜ë¦¬ëœ íŒŒì¼ ìˆ˜ ì—…ë°ì´íŠ¸\n        function updateProcessedFilesCount(count) {\n            document.getElementById('processedFiles').textContent = count;\n        }\n        \n        // ìµœê·¼ íŒŒì¼ ëª©ë¡ ì—…ë°ì´íŠ¸\n        function updateRecentFiles(files) {\n            const container = document.getElementById('recentFiles');\n            container.innerHTML = '';\n            \n            files.slice(0, 10).forEach(file => {\n                const div = document.createElement('div');\n                div.className = 'file-item';\n                div.innerHTML = `\n                    <span class=\"file-name\">${file.split('/').pop()}</span>\n                    <span class=\"file-time\">${new Date().toLocaleTimeString()}</span>\n                `;\n                container.appendChild(div);\n            });\n        }\n        \n        // íŒŒì¼ ìŒ ê°€ì ¸ì˜¤ê¸° (ì„ì‹œ)\n        function getFilePairs() {\n            // ì‹¤ì œë¡œëŠ” ì„œë²„ì—ì„œ ê°€ì ¸ì™€ì•¼ í•¨\n            return [];\n        }\n        \n        // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°\n        window.onclick = function(event) {\n            const modal = document.getElementById('fileModal');\n            if (event.target === modal) {\n                modal.style.display = 'none';\n            }\n        }\n    </script>\n</body>\n</html>\n\n\n\n\n","size_bytes":19533},"comp/result_monitor.php":{"content":"<?php\n/**\n * ëŒ„ìŠ¤ìŠ¤ì½”ì–´ ê²°ê³¼ íŒŒì¼ ëª¨ë‹ˆí„°ë§ ë° ì¢…í•© ê²°ê³¼ í‘œì‹œ ì‹œìŠ¤í…œ\n * DanceScore ê²°ê³¼ íŒŒì¼ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§í•˜ê³  ìš”ì•½/ìƒì„¸ íŒŒì¼ì„ í•©ì³ì„œ í‘œì‹œ\n */\n\nclass ResultMonitor {\n    private $resultsPath;\n    private $lastCheckTime;\n    private $processedFiles;\n    \n    public function __construct($resultsPath = __DIR__ . \"/../results/results\") {\n        $this->resultsPath = $resultsPath;\n        $this->lastCheckTime = time();\n        $this->processedFiles = [];\n    }\n    \n    /**\n     * ê²°ê³¼ íŒŒì¼ë“¤ì„ ëª¨ë‹ˆí„°ë§í•˜ê³  ìƒˆë¡œìš´ íŒŒì¼ì´ ìƒì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸\n     */\n    public function checkForNewResults() {\n        $files = glob($this->resultsPath . \"/*.html\");\n        $newFiles = [];\n        \n        foreach ($files as $file) {\n            $mtime = filemtime($file);\n            if ($mtime > $this->lastCheckTime) {\n                $newFiles[] = $file;\n            }\n        }\n        \n        $this->lastCheckTime = time();\n        return $newFiles;\n    }\n    \n    /**\n     * ìš”ì•½ íŒŒì¼ê³¼ ìƒì„¸ íŒŒì¼ ìŒì„ ì°¾ì•„ì„œ ë°˜í™˜\n     */\n    public function findResultPairs() {\n        $files = glob($this->resultsPath . \"/*.html\");\n        $pairs = [];\n        \n        foreach ($files as $file) {\n            $basename = basename($file, '.html');\n            \n            // ìƒì„¸ íŒŒì¼ì¸ì§€ í™•ì¸ (-dë¡œ ëë‚˜ëŠ” íŒŒì¼)\n            if (strpos($basename, '-d') !== false) {\n                $summaryFile = str_replace('-d', '', $file);\n                if (file_exists($summaryFile)) {\n                    $pairs[] = [\n                        'summary' => $summaryFile,\n                        'detailed' => $file,\n                        'event_id' => str_replace('-d', '', $basename)\n                    ];\n                }\n            }\n        }\n        \n        return $pairs;\n    }\n    \n    /**\n     * HTML íŒŒì¼ì—ì„œ ê²°ê³¼ ë°ì´í„°ë¥¼ íŒŒì‹±\n     */\n    public function parseResultFile($filePath) {\n        $html = file_get_contents($filePath);\n        $dom = new DOMDocument();\n        @$dom->loadHTML($html);\n        $xpath = new DOMXPath($dom);\n        \n        $result = [\n            'event_title' => '',\n            'event_date' => '',\n            'competitors' => [],\n            'adjudicators' => []\n        ];\n        \n        // ì´ë²¤íŠ¸ ì œëª© ì¶”ì¶œ\n        $titleNodes = $xpath->query(\"//td[@style='font-weight:bold; padding-top:1em;']\");\n        if ($titleNodes->length > 0) {\n            $result['event_title'] = trim($titleNodes->item(0)->textContent);\n        }\n        \n        // ë‚ ì§œ ì¶”ì¶œ\n        $dateNodes = $xpath->query(\"//td[@style='font-weight:bold;']\");\n        if ($dateNodes->length > 0) {\n            $result['event_date'] = trim($dateNodes->item(0)->textContent);\n        }\n        \n        // ê²½ìŸì ë°ì´í„° ì¶”ì¶œ\n        $competitorRows = $xpath->query(\"//tr[td[@style='margin-top:2em; padding-left:1em; padding-top:5px; padding-bottom:5px; background-color:#eee; font-weight:bold;'] or td[@style='margin-top:2em; padding-left:1em; padding-top:5px; padding-bottom:5px; background-color:#ccc; font-weight:bold;']]\");\n        \n        foreach ($competitorRows as $row) {\n            $cells = $xpath->query(\".//td\", $row);\n            if ($cells->length >= 3) {\n                $competitor = [\n                    'place' => trim($cells->item(0)->textContent),\n                    'tag' => trim($cells->item(1)->textContent),\n                    'name' => trim($cells->item(2)->textContent),\n                    'scores' => []\n                ];\n                \n                // ì ìˆ˜ ë°ì´í„° ì¶”ì¶œ (ìš”ì•½ íŒŒì¼ì˜ ê²½ìš°)\n                for ($i = 3; $i < $cells->length - 1; $i++) {\n                    $score = trim($cells->item($i)->textContent);\n                    if ($score !== '') {\n                        $competitor['scores'][] = $score;\n                    }\n                }\n                \n                // ìµœì¢… ì ìˆ˜ (ë§ˆì§€ë§‰ ì…€)\n                if ($cells->length > 0) {\n                    $finalScore = trim($cells->item($cells->length - 1)->textContent);\n                    $competitor['final_score'] = $finalScore;\n                }\n                \n                $result['competitors'][] = $competitor;\n            }\n        }\n        \n        // ì‹¬íŒ ì •ë³´ ì¶”ì¶œ\n        $adjudicatorRows = $xpath->query(\"//tr[td[@style='padding-left:2em;']]\");\n        foreach ($adjudicatorRows as $row) {\n            $cells = $xpath->query(\".//td\", $row);\n            if ($cells->length >= 2) {\n                $letter = trim($cells->item(0)->textContent);\n                $name = trim($cells->item(1)->textContent);\n                if ($letter && $name) {\n                    $result['adjudicators'][] = [\n                        'letter' => $letter,\n                        'name' => $name\n                    ];\n                }\n            }\n        }\n        \n        return $result;\n    }\n    \n    /**\n     * ìƒì„¸ íŒŒì¼ì—ì„œ ëŒ„ìŠ¤ë³„ ì ìˆ˜ ë°ì´í„°ë¥¼ íŒŒì‹±\n     */\n    public function parseDetailedFile($filePath) {\n        $html = file_get_contents($filePath);\n        $dom = new DOMDocument();\n        @$dom->loadHTML($html);\n        $xpath = new DOMXPath($dom);\n        \n        $dances = [];\n        \n        // ê° ëŒ„ìŠ¤ ì„¹ì…˜ ì°¾ê¸°\n        $danceSections = $xpath->query(\"//tr[th[@colspan='28']]\");\n        \n        foreach ($danceSections as $section) {\n            $danceName = trim($section->textContent);\n            $dances[$danceName] = [];\n            \n            // í•´ë‹¹ ëŒ„ìŠ¤ì˜ ê²½ìŸì ë°ì´í„° ì°¾ê¸°\n            $nextSibling = $section->nextSibling;\n            while ($nextSibling) {\n                if ($nextSibling->nodeType === XML_ELEMENT_NODE && $nextSibling->tagName === 'tr') {\n                    $cells = $xpath->query(\".//td\", $nextSibling);\n                    if ($cells->length >= 3) {\n                        $tag = trim($cells->item(0)->textContent);\n                        $name = trim($cells->item(1)->textContent);\n                        $scores = [];\n                        \n                        // ì‹¬íŒë³„ ì ìˆ˜ ì¶”ì¶œ\n                        for ($i = 2; $i < $cells->length - 1; $i++) {\n                            $score = trim($cells->item($i)->textContent);\n                            if ($score !== '') {\n                                $scores[] = $score;\n                            }\n                        }\n                        \n                        // ìµœì¢… ìˆœìœ„ (ë§ˆì§€ë§‰ ì…€)\n                        $placing = trim($cells->item($cells->length - 1)->textContent);\n                        \n                        $dances[$danceName][] = [\n                            'tag' => $tag,\n                            'name' => $name,\n                            'scores' => $scores,\n                            'placing' => $placing\n                        ];\n                    }\n                } elseif ($nextSibling->nodeType === XML_ELEMENT_NODE && $nextSibling->tagName === 'table') {\n                    // ë‹¤ìŒ ëŒ„ìŠ¤ ì„¹ì…˜ì„ ë§Œë‚˜ë©´ ì¤‘ë‹¨\n                    break;\n                }\n                $nextSibling = $nextSibling->nextSibling;\n            }\n        }\n        \n        return $dances;\n    }\n    \n    /**\n     * ì¢…í•© ê²°ê³¼ HTML ìƒì„±\n     */\n    public function generateCombinedResult($summaryData, $detailedData, $eventId) {\n        $html = '<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"UTF-8\">\n    <title>ì¢…í•© ê²°ê³¼ - ' . htmlspecialchars($summaryData['event_title']) . '</title>\n    <style>\n        body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background: #f5f5f5; }\n        .container { max-width: 1400px; margin: 0 auto; background: white; border-radius: 10px; box-shadow: 0 0 20px rgba(0,0,0,0.1); }\n        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; text-align: center; border-radius: 10px 10px 0 0; }\n        .header h1 { margin: 0; font-size: 2.5em; }\n        .header p { margin: 10px 0 0 0; font-size: 1.2em; opacity: 0.9; }\n        .content { padding: 30px; }\n        .summary-section { margin-bottom: 40px; }\n        .detailed-section { margin-bottom: 40px; }\n        .section-title { font-size: 1.8em; color: #333; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 3px solid #667eea; }\n        .summary-table { width: 100%; border-collapse: collapse; margin-bottom: 30px; }\n        .summary-table th, .summary-table td { padding: 15px; text-align: center; border: 1px solid #ddd; }\n        .summary-table th { background: #f8f9fa; font-weight: bold; color: #333; }\n        .summary-table tr:nth-child(even) { background: #f8f9fa; }\n        .summary-table tr:nth-child(odd) { background: white; }\n        .place-1 { background: linear-gradient(135deg, #FFD700, #FFA500) !important; color: white; font-weight: bold; }\n        .place-2 { background: linear-gradient(135deg, #C0C0C0, #A0A0A0) !important; color: white; font-weight: bold; }\n        .place-3 { background: linear-gradient(135deg, #CD7F32, #B8860B) !important; color: white; font-weight: bold; }\n        .dance-section { margin-bottom: 30px; }\n        .dance-title { font-size: 1.4em; color: #667eea; margin-bottom: 15px; padding: 10px; background: #f8f9fa; border-left: 5px solid #667eea; }\n        .dance-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }\n        .dance-table th, .dance-table td { padding: 10px; text-align: center; border: 1px solid #ddd; font-size: 0.9em; }\n        .dance-table th { background: #667eea; color: white; font-weight: bold; }\n        .dance-table tr:nth-child(even) { background: #f8f9fa; }\n        .dance-table tr:nth-child(odd) { background: white; }\n        .adjudicators { margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 5px; }\n        .adjudicators h3 { margin-top: 0; color: #333; }\n        .adjudicator-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; }\n        .adjudicator-item { padding: 10px; background: white; border-radius: 5px; border-left: 3px solid #667eea; }\n        .refresh-btn { position: fixed; top: 20px; right: 20px; background: #667eea; color: white; border: none; padding: 15px 25px; border-radius: 25px; cursor: pointer; font-size: 16px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }\n        .refresh-btn:hover { background: #5a6fd8; transform: translateY(-2px); }\n        .timestamp { text-align: center; color: #666; font-size: 0.9em; margin-top: 20px; }\n    </style>\n    <script>\n        function refreshResults() {\n            location.reload();\n        }\n        \n        // 30ì´ˆë§ˆë‹¤ ìë™ ìƒˆë¡œê³ ì¹¨\n        setInterval(refreshResults, 30000);\n    </script>\n</head>\n<body>\n    <button class=\"refresh-btn\" onclick=\"refreshResults()\">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>\n    \n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>' . htmlspecialchars($summaryData['event_title']) . '</h1>\n            <p>' . htmlspecialchars($summaryData['event_date']) . '</p>\n        </div>\n        \n        <div class=\"content\">\n            <div class=\"summary-section\">\n                <h2 class=\"section-title\">ğŸ“Š ìµœì¢… ìˆœìœ„</h2>\n                <table class=\"summary-table\">\n                    <thead>\n                        <tr>\n                            <th>ìˆœìœ„</th>\n                            <th>ë²ˆí˜¸</th>\n                            <th>ì„ ìˆ˜ëª…</th>\n                            <th>ì ìˆ˜</th>\n                        </tr>\n                    </thead>\n                    <tbody>';\n        \n        foreach ($summaryData['competitors'] as $competitor) {\n            $placeClass = '';\n            if ($competitor['place'] == 1) $placeClass = 'place-1';\n            elseif ($competitor['place'] == 2) $placeClass = 'place-2';\n            elseif ($competitor['place'] == 3) $placeClass = 'place-3';\n            \n            $html .= '<tr class=\"' . $placeClass . '\">\n                <td>' . $competitor['place'] . '</td>\n                <td>' . $competitor['tag'] . '</td>\n                <td>' . htmlspecialchars($competitor['name']) . '</td>\n                <td>' . $competitor['final_score'] . '</td>\n            </tr>';\n        }\n        \n        $html .= '</tbody>\n                </table>\n            </div>\n            \n            <div class=\"detailed-section\">\n                <h2 class=\"section-title\">ğŸ’ƒ ëŒ„ìŠ¤ë³„ ìƒì„¸ ê²°ê³¼</h2>';\n        \n        foreach ($detailedData as $danceName => $danceResults) {\n            $html .= '<div class=\"dance-section\">\n                <h3 class=\"dance-title\">' . htmlspecialchars($danceName) . '</h3>\n                <table class=\"dance-table\">\n                    <thead>\n                        <tr>\n                            <th>ë²ˆí˜¸</th>\n                            <th>ì„ ìˆ˜ëª…</th>';\n            \n            // ì‹¬íŒ ì»¬ëŸ¼ í—¤ë” ìƒì„±\n            for ($i = 0; $i < 15; $i++) {\n                $html .= '<th>' . chr(65 + $i) . '</th>';\n            }\n            \n            $html .= '<th>ìˆœìœ„</th>\n                        </tr>\n                    </thead>\n                    <tbody>';\n            \n            foreach ($danceResults as $result) {\n                $html .= '<tr>\n                    <td>' . $result['tag'] . '</td>\n                    <td>' . htmlspecialchars($result['name']) . '</td>';\n                \n                // ì‹¬íŒë³„ ì ìˆ˜\n                for ($i = 0; $i < 15; $i++) {\n                    $score = isset($result['scores'][$i]) ? $result['scores'][$i] : '';\n                    $html .= '<td>' . $score . '</td>';\n                }\n                \n                $html .= '<td><strong>' . $result['placing'] . '</strong></td>\n                </tr>';\n            }\n            \n            $html .= '</tbody>\n                </table>\n            </div>';\n        }\n        \n        $html .= '</div>\n            \n            <div class=\"adjudicators\">\n                <h3>ğŸ‘¨â€âš–ï¸ ì‹¬íŒì§„</h3>\n                <div class=\"adjudicator-grid\">';\n        \n        foreach ($summaryData['adjudicators'] as $adjudicator) {\n            $html .= '<div class=\"adjudicator-item\">\n                <strong>' . $adjudicator['letter'] . '</strong> ' . htmlspecialchars($adjudicator['name']) . '\n            </div>';\n        }\n        \n        $html .= '</div>\n            </div>\n            \n            <div class=\"timestamp\">\n                ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: ' . date('Y-m-d H:i:s') . '\n            </div>\n        </div>\n    </div>\n</body>\n</html>';\n        \n        return $html;\n    }\n    \n    /**\n     * ê²°ê³¼ íŒŒì¼ì„ ì €ì¥\n     */\n    public function saveCombinedResult($html, $eventId) {\n        $filename = \"combined_result_{$eventId}.html\";\n        \n        // 1. ì›ë³¸ ìœ„ì¹˜ì— ì €ì¥ (results/results í´ë”)\n        $originalPath = $this->resultsPath . \"/\" . $filename;\n        file_put_contents($originalPath, $html);\n        \n        // 2. ì›¹ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•œ ìœ„ì¹˜ì—ë„ ì €ì¥ (comp í´ë”)\n        $webPath = __DIR__ . \"/\" . $filename;\n        file_put_contents($webPath, $html);\n        \n        return [\n            'original' => $originalPath,\n            'web' => $webPath,\n            'web_url' => \"https://www.danceoffice.net/comp/\" . $filename\n        ];\n    }\n    \n    /**\n     * ëª¨ë“  ê²°ê³¼ ìŒì„ ì²˜ë¦¬í•˜ê³  ì¢…í•© ê²°ê³¼ ìƒì„±\n     */\n    public function processAllResults() {\n        $pairs = $this->findResultPairs();\n        $processed = [];\n        \n        foreach ($pairs as $pair) {\n            try {\n                $summaryData = $this->parseResultFile($pair['summary']);\n                $detailedData = $this->parseDetailedFile($pair['detailed']);\n                $combinedHtml = $this->generateCombinedResult($summaryData, $detailedData, $pair['event_id']);\n                $savedFile = $this->saveCombinedResult($combinedHtml, $pair['event_id']);\n                \n                $processed[] = [\n                    'event_id' => $pair['event_id'],\n                    'summary_file' => $pair['summary'],\n                    'detailed_file' => $pair['detailed'],\n                    'combined_file' => $savedFile['original'],\n                    'web_file' => $savedFile['web'],\n                    'web_url' => $savedFile['web_url'],\n                    'event_title' => $summaryData['event_title']\n                ];\n            } catch (Exception $e) {\n                error_log(\"Error processing result pair {$pair['event_id']}: \" . $e->getMessage());\n            }\n        }\n        \n        return $processed;\n    }\n}\n\n// ì‚¬ìš© ì˜ˆì‹œ\nif (isset($_GET['action'])) {\n    $monitor = new ResultMonitor();\n    \n    switch ($_GET['action']) {\n        case 'process':\n            $results = $monitor->processAllResults();\n            echo json_encode(['success' => true, 'processed' => $results]);\n            break;\n            \n        case 'check':\n            $newFiles = $monitor->checkForNewResults();\n            echo json_encode(['success' => true, 'new_files' => $newFiles]);\n            break;\n            \n        case 'list':\n            $pairs = $monitor->findResultPairs();\n            echo json_encode(['success' => true, 'pairs' => $pairs]);\n            break;\n            \n        default:\n            echo json_encode(['success' => false, 'message' => 'Invalid action']);\n    }\n}\n?>\n","size_bytes":17399},"comp/result_watcher copy.php":{"content":"<?php\n/**\n * ëŒ„ìŠ¤ìŠ¤ì½”ì–´ ê²°ê³¼ íŒŒì¼ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ ìŠ¤í¬ë¦½íŠ¸\n * íŒŒì¼ ì‹œìŠ¤í…œì„ ëª¨ë‹ˆí„°ë§í•˜ê³  ìƒˆë¡œìš´ ê²°ê³¼ íŒŒì¼ì´ ìƒì„±ë˜ë©´ ìë™ìœ¼ë¡œ ì²˜ë¦¬\n */\n\nclass ResultWatcher {\n    private $resultsPath;\n    private $lastCheckTime;\n    private $logFile;\n    private $isRunning;\n    \n    public function __construct($resultsPath = \"Y:/results/results\") {\n        $this->resultsPath = $resultsPath;\n        $this->lastCheckTime = time();\n        $this->logFile = __DIR__ . \"/watcher.log\";\n        $this->isRunning = false;\n    }\n    \n    /**\n     * ë¡œê·¸ ë©”ì‹œì§€ ê¸°ë¡\n     */\n    private function log($message, $level = 'INFO') {\n        $timestamp = date('Y-m-d H:i:s');\n        $logMessage = \"[{$timestamp}] [{$level}] {$message}\" . PHP_EOL;\n        file_put_contents($this->logFile, $logMessage, FILE_APPEND | LOCK_EX);\n    }\n    \n    /**\n     * íŒŒì¼ ë³€ê²½ ê°ì§€\n     */\n    public function watch() {\n        $this->isRunning = true;\n        $this->log(\"ê²°ê³¼ íŒŒì¼ ëª¨ë‹ˆí„°ë§ì„ ì‹œì‘í•©ë‹ˆë‹¤.\");\n        \n        while ($this->isRunning) {\n            try {\n                $this->checkForChanges();\n                sleep(5); // 5ì´ˆë§ˆë‹¤ í™•ì¸\n            } catch (Exception $e) {\n                $this->log(\"ëª¨ë‹ˆí„°ë§ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: \" . $e->getMessage(), 'ERROR');\n                sleep(10);\n            }\n        }\n        \n        $this->log(\"ëª¨ë‹ˆí„°ë§ì´ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.\");\n    }\n    \n    /**\n     * íŒŒì¼ ë³€ê²½ì‚¬í•­ í™•ì¸\n     */\n    private function checkForChanges() {\n        $files = glob($this->resultsPath . \"/*.html\");\n        $newFiles = [];\n        \n        foreach ($files as $file) {\n            $mtime = filemtime($file);\n            if ($mtime > $this->lastCheckTime) {\n                $newFiles[] = $file;\n            }\n        }\n        \n        if (!empty($newFiles)) {\n            $this->log(count($newFiles) . \"ê°œì˜ ìƒˆ íŒŒì¼ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤.\");\n            $this->processNewFiles($newFiles);\n        }\n        \n        $this->lastCheckTime = time();\n    }\n    \n    /**\n     * ìƒˆ íŒŒì¼ ì²˜ë¦¬\n     */\n    private function processNewFiles($files) {\n        require_once 'result_monitor.php';\n        \n        $monitor = new ResultMonitor($this->resultsPath);\n        \n        // ê²°ê³¼ ìŒ ì°¾ê¸°\n        $pairs = $monitor->findResultPairs();\n        \n        foreach ($pairs as $pair) {\n            try {\n                $this->log(\"ê²°ê³¼ ì²˜ë¦¬ ì‹œì‘: {$pair['event_id']}\");\n                \n                $summaryData = $monitor->parseResultFile($pair['summary']);\n                $detailedData = $monitor->parseDetailedFile($pair['detailed']);\n                $combinedHtml = $monitor->generateCombinedResult($summaryData, $detailedData, $pair['event_id']);\n                $savedFile = $monitor->saveCombinedResult($combinedHtml, $pair['event_id']);\n                \n                $this->log(\"ê²°ê³¼ ì²˜ë¦¬ ì™„ë£Œ: {$pair['event_id']} -> {$savedFile}\");\n                \n                // ì›¹ì†Œì¼“ì„ í†µí•œ ì‹¤ì‹œê°„ ì•Œë¦¼ (ì„ íƒì‚¬í•­)\n                $this->notifyWebSocket($pair['event_id'], $savedFile);\n                \n            } catch (Exception $e) {\n                $this->log(\"ê²°ê³¼ ì²˜ë¦¬ ì‹¤íŒ¨: {$pair['event_id']} - \" . $e->getMessage(), 'ERROR');\n            }\n        }\n    }\n    \n    /**\n     * ì›¹ì†Œì¼“ ì•Œë¦¼ (ì„ íƒì‚¬í•­)\n     */\n    private function notifyWebSocket($eventId, $filePath) {\n        // ì›¹ì†Œì¼“ ì„œë²„ê°€ ìˆë‹¤ë©´ ì—¬ê¸°ì„œ ì•Œë¦¼ ì „ì†¡\n        // ì˜ˆ: WebSocket::send(\"new_result\", ['event_id' => $eventId, 'file' => $filePath]);\n    }\n    \n    /**\n     * ëª¨ë‹ˆí„°ë§ ì¤‘ì§€\n     */\n    public function stop() {\n        $this->isRunning = false;\n    }\n    \n    /**\n     * ë°ëª¬ ëª¨ë“œë¡œ ì‹¤í–‰\n     */\n    public function runAsDaemon() {\n        // Windowsì—ì„œëŠ” ë°ëª¬ ëª¨ë“œê°€ ì œí•œì ì´ë¯€ë¡œ ì¼ë°˜ ì‹¤í–‰\n        $this->watch();\n    }\n}\n\n// CLIì—ì„œ ì‹¤í–‰ë  ë•Œ\nif (php_sapi_name() === 'cli') {\n    $watcher = new ResultWatcher();\n    \n    // ì‹œê·¸ë„ í•¸ë“¤ëŸ¬ (Windowsì—ì„œëŠ” ì œí•œì )\n    if (function_exists('pcntl_signal')) {\n        pcntl_signal(SIGTERM, function() use ($watcher) {\n            $watcher->stop();\n        });\n        pcntl_signal(SIGINT, function() use ($watcher) {\n            $watcher->stop();\n        });\n    }\n    \n    echo \"ê²°ê³¼ íŒŒì¼ ëª¨ë‹ˆí„°ë§ì„ ì‹œì‘í•©ë‹ˆë‹¤...\\n\";\n    echo \"ì¤‘ì§€í•˜ë ¤ë©´ Ctrl+Cë¥¼ ëˆ„ë¥´ì„¸ìš”.\\n\";\n    \n    $watcher->runAsDaemon();\n} else {\n    // ì›¹ì—ì„œ ì‹¤í–‰ë  ë•Œ\n    if (isset($_GET['action'])) {\n        $watcher = new ResultWatcher();\n        \n        switch ($_GET['action']) {\n            case 'start':\n                // ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰\n                if (strtoupper(substr(PHP_OS, 0, 3)) === 'WIN') {\n                    // Windows\n                    $command = \"php \" . __FILE__ . \" > nul 2>&1 &\";\n                    pclose(popen(\"start /B \" . $command, \"r\"));\n                } else {\n                    // Linux/Unix\n                    $command = \"php \" . __FILE__ . \" > /dev/null 2>&1 &\";\n                    exec($command);\n                }\n                echo json_encode(['success' => true, 'message' => 'ëª¨ë‹ˆí„°ë§ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.']);\n                break;\n                \n            case 'stop':\n                // í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ (Windowsì—ì„œëŠ” ì œí•œì )\n                echo json_encode(['success' => true, 'message' => 'ëª¨ë‹ˆí„°ë§ì„ ì¤‘ì§€í•˜ë ¤ë©´ í”„ë¡œì„¸ìŠ¤ë¥¼ ì¢…ë£Œí•˜ì„¸ìš”.']);\n                break;\n                \n            case 'status':\n                $logFile = __DIR__ . \"/watcher.log\";\n                if (file_exists($logFile)) {\n                    $logs = file_get_contents($logFile);\n                    $lines = explode(\"\\n\", $logs);\n                    $recentLogs = array_slice($lines, -20); // ìµœê·¼ 20ì¤„\n                    echo json_encode(['success' => true, 'logs' => $recentLogs]);\n                } else {\n                    echo json_encode(['success' => false, 'message' => 'ë¡œê·¸ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.']);\n                }\n                break;\n                \n            default:\n                echo json_encode(['success' => false, 'message' => 'ì˜ëª»ëœ ì•¡ì…˜ì…ë‹ˆë‹¤.']);\n        }\n    }\n}\n?>\n","size_bytes":6271},"comp/result_watcher.php":{"content":"<?php\n/**\n * ëŒ„ìŠ¤ìŠ¤ì½”ì–´ ê²°ê³¼ íŒŒì¼ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ ìŠ¤í¬ë¦½íŠ¸\n * íŒŒì¼ ì‹œìŠ¤í…œì„ ëª¨ë‹ˆí„°ë§í•˜ê³  ìƒˆë¡œìš´ ê²°ê³¼ íŒŒì¼ì´ ìƒì„±ë˜ë©´ ìë™ìœ¼ë¡œ ì²˜ë¦¬\n */\n\nclass ResultWatcher {\n    private $resultsPath;\n    private $lastCheckTime;\n    private $logFile;\n    private $isRunning;\n    \n    public function __construct($resultsPath = __DIR__ . \"/../results/results\") {\n        $this->resultsPath = $resultsPath;\n        $this->lastCheckTime = time();\n        $this->logFile = __DIR__ . \"/watcher.log\";\n        $this->isRunning = false;\n    }\n    \n    /**\n     * ë¡œê·¸ ë©”ì‹œì§€ ê¸°ë¡\n     */\n    private function log($message, $level = 'INFO') {\n        $timestamp = date('Y-m-d H:i:s');\n        $logMessage = \"[{$timestamp}] [{$level}] {$message}\" . PHP_EOL;\n        file_put_contents($this->logFile, $logMessage, FILE_APPEND | LOCK_EX);\n    }\n    \n    /**\n     * íŒŒì¼ ë³€ê²½ ê°ì§€\n     */\n    public function watch() {\n        $this->isRunning = true;\n        $this->log(\"ê²°ê³¼ íŒŒì¼ ëª¨ë‹ˆí„°ë§ì„ ì‹œì‘í•©ë‹ˆë‹¤.\");\n        \n        while ($this->isRunning) {\n            try {\n                $this->checkForChanges();\n                sleep(5); // 5ì´ˆë§ˆë‹¤ í™•ì¸\n            } catch (Exception $e) {\n                $this->log(\"ëª¨ë‹ˆí„°ë§ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: \" . $e->getMessage(), 'ERROR');\n                sleep(10);\n            }\n        }\n        \n        $this->log(\"ëª¨ë‹ˆí„°ë§ì´ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.\");\n    }\n    \n    /**\n     * íŒŒì¼ ë³€ê²½ì‚¬í•­ í™•ì¸\n     */\n    private function checkForChanges() {\n        $files = glob($this->resultsPath . \"/*.html\");\n        $newFiles = [];\n        \n        foreach ($files as $file) {\n            $mtime = filemtime($file);\n            if ($mtime > $this->lastCheckTime) {\n                $newFiles[] = $file;\n            }\n        }\n        \n        if (!empty($newFiles)) {\n            $this->log(count($newFiles) . \"ê°œì˜ ìƒˆ íŒŒì¼ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤.\");\n            $this->processNewFiles($newFiles);\n        }\n        \n        $this->lastCheckTime = time();\n    }\n    \n    /**\n     * ìƒˆ íŒŒì¼ ì²˜ë¦¬\n     */\n    private function processNewFiles($files) {\n        require_once 'result_monitor.php';\n        \n        $monitor = new ResultMonitor($this->resultsPath);\n        \n        // ê²°ê³¼ ìŒ ì°¾ê¸°\n        $pairs = $monitor->findResultPairs();\n        \n        foreach ($pairs as $pair) {\n            try {\n                $this->log(\"ê²°ê³¼ ì²˜ë¦¬ ì‹œì‘: {$pair['event_id']}\");\n                \n                $summaryData = $monitor->parseResultFile($pair['summary']);\n                $detailedData = $monitor->parseDetailedFile($pair['detailed']);\n                $combinedHtml = $monitor->generateCombinedResult($summaryData, $detailedData, $pair['event_id']);\n                $savedFile = $monitor->saveCombinedResult($combinedHtml, $pair['event_id']);\n                \n                $this->log(\"ê²°ê³¼ ì²˜ë¦¬ ì™„ë£Œ: {$pair['event_id']} -> {$savedFile}\");\n                \n                // ì›¹ì†Œì¼“ì„ í†µí•œ ì‹¤ì‹œê°„ ì•Œë¦¼ (ì„ íƒì‚¬í•­)\n                $this->notifyWebSocket($pair['event_id'], $savedFile);\n                \n            } catch (Exception $e) {\n                $this->log(\"ê²°ê³¼ ì²˜ë¦¬ ì‹¤íŒ¨: {$pair['event_id']} - \" . $e->getMessage(), 'ERROR');\n            }\n        }\n    }\n    \n    /**\n     * ì›¹ì†Œì¼“ ì•Œë¦¼ (ì„ íƒì‚¬í•­)\n     */\n    private function notifyWebSocket($eventId, $filePath) {\n        // ì›¹ì†Œì¼“ ì„œë²„ê°€ ìˆë‹¤ë©´ ì—¬ê¸°ì„œ ì•Œë¦¼ ì „ì†¡\n        // ì˜ˆ: WebSocket::send(\"new_result\", ['event_id' => $eventId, 'file' => $filePath]);\n    }\n    \n    /**\n     * ëª¨ë‹ˆí„°ë§ ì¤‘ì§€\n     */\n    public function stop() {\n        $this->isRunning = false;\n    }\n    \n    /**\n     * ë°ëª¬ ëª¨ë“œë¡œ ì‹¤í–‰\n     */\n    public function runAsDaemon() {\n        // Windowsì—ì„œëŠ” ë°ëª¬ ëª¨ë“œê°€ ì œí•œì ì´ë¯€ë¡œ ì¼ë°˜ ì‹¤í–‰\n        $this->watch();\n    }\n}\n\n// CLIì—ì„œ ì‹¤í–‰ë  ë•Œ\nif (php_sapi_name() === 'cli') {\n    $watcher = new ResultWatcher();\n    \n    // ì‹œê·¸ë„ í•¸ë“¤ëŸ¬ (Windowsì—ì„œëŠ” ì œí•œì )\n    if (function_exists('pcntl_signal')) {\n        pcntl_signal(SIGTERM, function() use ($watcher) {\n            $watcher->stop();\n        });\n        pcntl_signal(SIGINT, function() use ($watcher) {\n            $watcher->stop();\n        });\n    }\n    \n    echo \"ê²°ê³¼ íŒŒì¼ ëª¨ë‹ˆí„°ë§ì„ ì‹œì‘í•©ë‹ˆë‹¤...\\n\";\n    echo \"ì¤‘ì§€í•˜ë ¤ë©´ Ctrl+Cë¥¼ ëˆ„ë¥´ì„¸ìš”.\\n\";\n    \n    $watcher->runAsDaemon();\n} else {\n    // ì›¹ì—ì„œ ì‹¤í–‰ë  ë•Œ\n    if (isset($_GET['action'])) {\n        $watcher = new ResultWatcher();\n        \n        switch ($_GET['action']) {\n            case 'start':\n                // ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰\n                if (strtoupper(substr(PHP_OS, 0, 3)) === 'WIN') {\n                    // Windows\n                    $command = \"php \" . __FILE__ . \" > nul 2>&1 &\";\n                    pclose(popen(\"start /B \" . $command, \"r\"));\n                } else {\n                    // Linux/Unix\n                    $command = \"php \" . __FILE__ . \" > /dev/null 2>&1 &\";\n                    exec($command);\n                }\n                echo json_encode(['success' => true, 'message' => 'ëª¨ë‹ˆí„°ë§ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.']);\n                break;\n                \n            case 'stop':\n                // í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ (Windowsì—ì„œëŠ” ì œí•œì )\n                echo json_encode(['success' => true, 'message' => 'ëª¨ë‹ˆí„°ë§ì„ ì¤‘ì§€í•˜ë ¤ë©´ í”„ë¡œì„¸ìŠ¤ë¥¼ ì¢…ë£Œí•˜ì„¸ìš”.']);\n                break;\n                \n            case 'status':\n                $logFile = __DIR__ . \"/watcher.log\";\n                if (file_exists($logFile)) {\n                    $logs = file_get_contents($logFile);\n                    $lines = explode(\"\\n\", $logs);\n                    $recentLogs = array_slice($lines, -20); // ìµœê·¼ 20ì¤„\n                    echo json_encode(['success' => true, 'logs' => $recentLogs]);\n                } else {\n                    echo json_encode(['success' => false, 'message' => 'ë¡œê·¸ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.']);\n                }\n                break;\n                \n            default:\n                echo json_encode(['success' => false, 'message' => 'ì˜ëª»ëœ ì•¡ì…˜ì…ë‹ˆë‹¤.']);\n        }\n    }\n}\n?>\n","size_bytes":6282},"comp/save_event_info.php":{"content":"<?php\nheader('Content-Type: application/json; charset=utf-8');\n$data = json_decode(file_get_contents('php://input'), true);\n$comp_id = $data['comp_id'] ?? '';\n$event_no = $data['eventNo'] ?? '';\n$from_event = $data['fromEvent'] ?? '';\n$to_event = $data['toEvent'] ?? '';\n$recall = $data['recall'] ?? '';\n$heats = $data['heats'] ?? '';\n\n// ì •ê·œí™”: BOM ì œê±° ë° í—ˆìš© ë¬¸ìë§Œ ìœ ì§€\n$comp_id = preg_replace('/\\x{FEFF}/u', '', $comp_id);\n$event_no = preg_replace('/\\x{FEFF}/u', '', $event_no);\n$from_event = preg_replace('/\\x{FEFF}/u', '', $from_event);\n$to_event = preg_replace('/\\x{FEFF}/u', '', $to_event);\n$recall = preg_replace('/\\x{FEFF}/u', '', $recall);\n$heats = preg_replace('/\\x{FEFF}/u', '', $heats);\n\n$comp_id = preg_replace('/[^0-9\\-]/', '', $comp_id);\n$event_no = preg_replace('/\\D+/', '', $event_no);\n$from_event = preg_replace('/\\D+/', '', $from_event);\n$to_event = preg_replace('/\\D+/', '', $to_event);\n\n$comp_id = trim($comp_id);\n$event_no = trim($event_no);\n$from_event = trim($from_event);\n$to_event = trim($to_event);\n$recall = trim($recall);\n$heats = trim($heats);\n\nif (!$comp_id || !$event_no) {\n    echo json_encode(['success' => false, 'error' => 'comp_id ë˜ëŠ” eventNo ëˆ„ë½']);\n    exit;\n}\n\nif (!preg_match('/^\\d{8}-\\d+$/', $comp_id)) {\n    echo json_encode(['success' => false, 'error' => 'ì˜ëª»ëœ ëŒ€íšŒ ID']);\n    exit;\n}\n\n$data_dir = __DIR__ . \"/data/$comp_id\";\n$event_info_file = \"$data_dir/event_info.json\";\n\n// ê¸°ì¡´ ì´ë²¤íŠ¸ ì •ë³´ ë¡œë“œ\n$event_info = [];\nif (file_exists($event_info_file)) {\n    $content = file_get_contents($event_info_file);\n    $event_info = json_decode($content, true) ?: [];\n}\n\n// í˜„ì¬ ì´ë²¤íŠ¸ ì •ë³´ ì—…ë°ì´íŠ¸\n$event_info[$event_no] = [\n    'from_event' => $from_event,\n    'to_event' => $to_event,\n    'recall' => $recall,\n    'heats' => $heats,\n    'updated_at' => date('Y-m-d H:i:s')\n];\n\n// íŒŒì¼ ì €ì¥\nif (file_put_contents($event_info_file, json_encode($event_info, JSON_UNESCAPED_UNICODE | JSON_PRETTY_PRINT)) === false) {\n    echo json_encode(['success' => false, 'error' => 'íŒŒì¼ ì €ì¥ ì‹¤íŒ¨']);\n    exit;\n}\n\necho json_encode(['success' => true]);\n?>\n","size_bytes":2143},"comp/save_hits.php":{"content":"<?php\nheader('Content-Type: application/json; charset=utf-8');\n$data = json_decode(file_get_contents('php://input'), true);\n$comp_id = $data['comp_id'] ?? '';\n$event_no = $data['eventNo'] ?? '';\n// comp_id/event_no ì •ê·œí™”: BOM ì œê±° ë° í—ˆìš© ë¬¸ìë§Œ ìœ ì§€\n$comp_id = preg_replace('/\\x{FEFF}/u', '', $comp_id);\n$event_no = preg_replace('/\\x{FEFF}/u', '', $event_no);\n$comp_id = preg_replace('/[^0-9\\-]/', '', $comp_id);\n$event_no = preg_replace('/\\D+/', '', $event_no);\n$comp_id = trim($comp_id);\n$event_no = trim($event_no);\n$hits = $data['hits'] ?? '';\nif (!$comp_id || !$event_no || !$hits || !is_array($hits)) {\n    echo json_encode(['success'=>false, 'error'=>'ë°ì´í„° ë¶€ì¡±']);\n    exit;\n}\n// comp_id í˜•ì‹ ê²€ì¦\nif (!preg_match('/^\\d{8}-\\d+$/', $comp_id)) {\n    echo json_encode(['success'=>false, 'error'=>'ì˜ëª»ëœ ëŒ€íšŒ ID']);\n    exit;\n}\n$data_dir = __DIR__ . \"/data/$comp_id\";\nif (!is_dir($data_dir)) {\n    @mkdir($data_dir, 0777, true);\n}\n$file = \"$data_dir/players_hits_{$event_no}.json\";\nif (file_put_contents($file, json_encode($hits, JSON_UNESCAPED_UNICODE|JSON_PRETTY_PRINT)) === false) {\n    echo json_encode(['success'=>false, 'error'=>'ì €ì¥ ì‹¤íŒ¨']);\n} else {\n    echo json_encode(['success'=>true]);\n}","size_bytes":1241},"comp/save_players.php":{"content":"<?php\n// POST: {\"eventNo\": \"1\", \"players\": [\"101\", \"102\", ...]}\n$data = json_decode(file_get_contents(\"php://input\"), true);\n$comp_id = $_GET['comp_id'] ?? '';\n$eventNo = $data['eventNo'] ?? '';\n$detailNo = $data['detailNo'] ?? '';\n\n// ì •ê·œí™”: BOM ì œê±° ë° í—ˆìš© ë¬¸ìë§Œ ìœ ì§€\n$comp_id = preg_replace('/\\x{FEFF}/u', '', $comp_id);\n$eventNo = preg_replace('/\\x{FEFF}/u', '', $eventNo);\n$detailNo = preg_replace('/\\x{FEFF}/u', '', $detailNo);\n$comp_id = preg_replace('/[^0-9\\-]/', '', $comp_id);\n$eventNo = preg_replace('/\\D+/', '', $eventNo);\n$detailNo = preg_replace('/[^0-9\\-]/', '', $detailNo);\n$comp_id = trim($comp_id);\n$eventNo = trim($eventNo);\n$detailNo = trim($detailNo);\n$players = $data['players'] ?? [];\n\nif (!$comp_id || !$eventNo) {\n    echo json_encode(['success'=>false, 'error'=>'comp_id ë˜ëŠ” eventNo ëˆ„ë½']); exit;\n}\nif (!preg_match('/^\\d{8}-\\d+$/', $comp_id)) {\n    echo json_encode(['success'=>false, 'error'=>'ì˜ëª»ëœ ëŒ€íšŒ ID']); exit;\n}\n\n$data_dir = __DIR__ . \"/data/$comp_id\";\nif (!is_dir($data_dir)) @mkdir($data_dir, 0777, true);\n\n// ì„¸ë¶€ë²ˆí˜¸ê°€ ìˆìœ¼ë©´ ì„¸ë¶€ë²ˆí˜¸ë³„ íŒŒì¼ ì‚¬ìš©, ì—†ìœ¼ë©´ ì›ë³¸ ì´ë²¤íŠ¸ ë²ˆí˜¸ ì‚¬ìš©\n$file = $detailNo ? \"$data_dir/players_{$detailNo}.txt\" : \"$data_dir/players_{$eventNo}.txt\";\n\n$content = implode(\"\\n\", $players);\nif (file_put_contents($file, $content)!==false) {\n    echo json_encode(['success'=>true]);\n} else {\n    echo json_encode(['success'=>false, 'error'=>'íŒŒì¼ ì €ì¥ ì‹¤íŒ¨']);\n}\n?>","size_bytes":1483},"comp/save_round_info.php":{"content":"<?php\nheader('Content-Type: application/json; charset=utf-8');\n\n$comp_id = $_GET['comp_id'] ?? '';\n$comp_id = preg_replace('/[^\\d-]/', '', $comp_id);\n\nif (!$comp_id) {\n    echo json_encode(['success' => false, 'error' => 'comp_id ëˆ„ë½']);\n    exit;\n}\n\n$data_dir = __DIR__ . \"/data/$comp_id\";\nif (!is_dir($data_dir)) {\n    @mkdir($data_dir, 0777, true);\n}\n\n$runorder_file = \"$data_dir/RunOrder_Tablet.txt\";\n$round_info_file = \"$data_dir/round_info.json\";\n\nif (!file_exists($runorder_file)) {\n    echo json_encode(['success' => false, 'error' => 'RunOrder íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤']);\n    exit;\n}\n\n// RunOrder íŒŒì¼ ì½ê¸°\n$events = [];\n$lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\nforeach ($lines as $line) {\n    // Remove BOM from line\n    $line = preg_replace('/\\x{FEFF}/u', '', $line);\n    $line = str_replace([\"\\xEF\\xBB\\xBF\", \"\\xFEFF\", \"\\uFEFF\"], '', $line);\n    $line = preg_replace('/[\\x00-\\x1F\\x7F-\\x9F]/', '', $line);\n    \n    if (preg_match('/^bom/', $line)) continue;\n    $cols = array_map('trim', explode(',', $line));\n    $dance_abbr = [];\n    for ($i=6; $i<=10; $i++) {\n        if (isset($cols[$i]) && trim($cols[$i])!=='') $dance_abbr[] = $cols[$i];\n    }\n    // ê²½ê¸° ì´ë²¤íŠ¸ë§Œ ì²˜ë¦¬\n    if (count($dance_abbr) > 0) {\n        $events[] = [\n            'raw_no' => preg_replace('/\\x{FEFF}/u', '', $cols[0] ?? ''), // Remove BOM from raw_no\n            'name' => $cols[1] ?? '',\n            'round_type' => $cols[2] ?? '',\n            'round_num' => $cols[3] ?? '',\n        ];\n    }\n}\n\n// ë¼ìš´ë“œ ì •ë³´ ê³„ì‚° (RunOrder_Tablet.txt ê¸°ë°˜)\nfunction calculateRoundInfo($events) {\n    $name_groups = [];\n    foreach ($events as $idx => $evt) {\n        $name = $evt['name'];\n        if (!isset($name_groups[$name])) {\n            $name_groups[$name] = [];\n        }\n        $name_groups[$name][] = ['idx' => $idx, 'event' => $evt];\n    }\n    \n    $round_info = [];\n    foreach ($name_groups as $name => $group) {\n        $total_events = count($group);\n        \n        // Sort by event number to get correct order\n        usort($group, function($a, $b) {\n            return intval($a['event']['raw_no']) - intval($b['event']['raw_no']);\n        });\n        \n        foreach ($group as $pos => $item) {\n            $event_no = $item['event']['raw_no'];\n            $stage_text = '';\n            \n            if ($total_events === 1) {\n                $stage_text = 'Final';\n            } else if ($total_events === 2) {\n                if ($pos === 0) $stage_text = 'Semi-Final';\n                else $stage_text = 'Final';\n            } else if ($total_events === 3) {\n                if ($pos === 0) $stage_text = 'Round 1';\n                else if ($pos === 1) $stage_text = 'Semi-Final';\n                else $stage_text = 'Final';\n            } else if ($total_events === 4) {\n                if ($pos === 0) $stage_text = 'Round 1';\n                else if ($pos === 1) $stage_text = 'Round 2';\n                else if ($pos === 2) $stage_text = 'Semi-Final';\n                else $stage_text = 'Final';\n            } else if ($total_events === 5) {\n                if ($pos === 0) $stage_text = 'Round 1';\n                else if ($pos === 1) $stage_text = 'Round 2';\n                else if ($pos === 2) $stage_text = 'Round 3';\n                else if ($pos === 3) $stage_text = 'Semi-Final';\n                else $stage_text = 'Final';\n            } else {\n                $stage_text = ($pos + 1) . '/' . $total_events;\n            }\n            \n            $round_info[$event_no] = $stage_text;\n        }\n    }\n    \n    return $round_info;\n}\n\n$round_info = calculateRoundInfo($events);\n\n// ë¼ìš´ë“œ ì •ë³´ë¥¼ íŒŒì¼ì— ì €ì¥\n$save_data = [\n    'events' => $events,\n    'round_info' => $round_info,\n    'updated_at' => date('Y-m-d H:i:s')\n];\n\nif (file_put_contents($round_info_file, json_encode($save_data, JSON_UNESCAPED_UNICODE | JSON_PRETTY_PRINT)) === false) {\n    echo json_encode(['success' => false, 'error' => 'ë¼ìš´ë“œ ì •ë³´ ì €ì¥ ì‹¤íŒ¨']);\n} else {\n    echo json_encode(['success' => true, 'message' => 'ë¼ìš´ë“œ ì •ë³´ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤']);\n}\n?>\n","size_bytes":4143},"comp/save_runorder_info.php":{"content":"<?php\nheader('Content-Type: application/json');\n\n$input = json_decode(file_get_contents('php://input'), true);\n$comp_id = $input['comp_id'] ?? '';\n$event_no = $input['eventNo'] ?? '';\n$recall = $input['recall'] ?? '';\n$heats = $input['heats'] ?? '';\n\n// ë””ë²„ê·¸: ì…ë ¥ ë°ì´í„° í™•ì¸\nerror_log(\"Save request: comp_id='$comp_id', event_no='$event_no', recall='$recall', heats='$heats'\");\n\nif (!$comp_id || !$event_no) {\n    echo json_encode(['success' => false, 'error' => 'í•„ìˆ˜ íŒŒë¼ë¯¸í„°ê°€ ì—†ìŠµë‹ˆë‹¤.']);\n    exit;\n}\n\n$data_dir = __DIR__ . \"/data/$comp_id\";\n$runorder_file = \"$data_dir/RunOrder_Tablet.txt\";\n\nif (!file_exists($runorder_file)) {\n    echo json_encode(['success' => false, 'error' => 'RunOrder_Tablet.txt íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.']);\n    exit;\n}\n\n// íŒŒì¼ ì½ê¸°\n$lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n$updated = false;\n\nforeach ($lines as $idx => $line) {\n    $cols = explode(',', $line);\n    if (count($cols) >= 13) {\n        // ì´ë²¤íŠ¸ ë²ˆí˜¸ì™€ ì„¸ë¶€ë²ˆí˜¸ ëª¨ë‘ ë¹„êµ\n        $current_base_no = preg_replace('/\\x{FEFF}/u', '', $cols[0] ?? '');\n        $current_base_no = preg_replace('/\\D+/', '', $current_base_no);\n        $current_detail_no = trim($cols[13] ?? '');\n        \n        // í˜„ì¬ ë¼ì¸ì˜ ì‹¤ì œ ì´ë²¤íŠ¸ ë²ˆí˜¸ (ì„¸ë¶€ë²ˆí˜¸ê°€ ìˆìœ¼ë©´ ì„¸ë¶€ë²ˆí˜¸, ì—†ìœ¼ë©´ ê¸°ë³¸ë²ˆí˜¸)\n        $current_event_no = !empty($current_detail_no) ? $current_detail_no : $current_base_no;\n        \n        // ë””ë²„ê·¸: 28ë²ˆ ì´ë²¤íŠ¸ ë§¤ì¹­ í™•ì¸\n        if ($current_base_no === '28') {\n            error_log(\"Found event 28: base_no='$current_base_no', detail_no='$current_detail_no', current_event_no='$current_event_no', target='$event_no'\");\n        }\n        \n        // ë””ë²„ê·¸: ì´ë²¤íŠ¸ ë²ˆí˜¸ ë§¤ì¹­ í™•ì¸\n        error_log(\"Event matching: base_no='$current_base_no', detail_no='$current_detail_no', current_event_no='$current_event_no', target='$event_no'\");\n        \n        if ($current_event_no === $event_no) {\n            // Recall ì—…ë°ì´íŠ¸ (5ë²ˆì§¸ ì»¬ëŸ¼, ì¸ë±ìŠ¤ 4)\n            $cols[4] = $recall;\n            \n            // Heats ì—…ë°ì´íŠ¸ (6ë²ˆì§¸ ì»¬ëŸ¼, ì¸ë±ìŠ¤ 5)\n            // ì»¬ëŸ¼ì´ ë¶€ì¡±í•˜ë©´ ì¶”ê°€\n            while (count($cols) < 6) {\n                $cols[] = '';\n            }\n            $cols[5] = $heats;\n            \n            $lines[$idx] = implode(',', $cols);\n            $updated = true;\n            error_log(\"Updated event $event_no: recall=$recall, heats=$heats\");\n            error_log(\"Updated line: \" . $lines[$idx]);\n            break;\n        }\n    }\n}\n\nif ($updated) {\n    // íŒŒì¼ ì €ì¥\n    $result = file_put_contents($runorder_file, implode(\"\\n\", $lines) . \"\\n\");\n    if ($result !== false) {\n        // ì €ì¥ í›„ ê²€ì¦\n        $verify_lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n        $verification_passed = false;\n        \n        foreach ($verify_lines as $line) {\n            $cols = explode(',', $line);\n            if (count($cols) >= 13) {\n                $current_base_no = preg_replace('/\\x{FEFF}/u', '', $cols[0] ?? '');\n                $current_base_no = preg_replace('/\\D+/', '', $current_base_no);\n                $current_detail_no = trim($cols[13] ?? '');\n                $current_event_no = !empty($current_detail_no) ? $current_detail_no : $current_base_no;\n                \n                if ($current_event_no === $event_no) {\n                    $saved_recall = $cols[4] ?? '';\n                    $saved_heats = $cols[5] ?? '';\n                    error_log(\"Verification: Event $event_no, saved recall=$saved_recall, saved heats=$saved_heats\");\n                    $verification_passed = true;\n                    break;\n                }\n            }\n        }\n        \n        echo json_encode([\n            'success' => true, \n            'verified' => $verification_passed,\n            'message' => 'ì´ë²¤íŠ¸ ì •ë³´ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.'\n        ]);\n    } else {\n        echo json_encode(['success' => false, 'error' => 'íŒŒì¼ ì €ì¥ ì‹¤íŒ¨']);\n    }\n} else {\n    echo json_encode(['success' => false, 'error' => 'í•´ë‹¹ ì´ë²¤íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.']);\n}\n?>\n","size_bytes":4200},"comp/scoring_dashboard.php":{"content":"<?php\nsession_start();\n\n$comp_id = $_GET['comp_id'] ?? '';\n$comp_id = preg_replace('/\\x{FEFF}/u', '', $comp_id);\n$comp_id = preg_replace('/[^\\d-]/', '', $comp_id);\n\n// Language setting\n$lang = $_GET['lang'] ?? 'ko';\nif (!in_array($lang, ['ko', 'en', 'zh', 'ja'])) {\n    $lang = 'ko';\n}\n\n// Language texts\n$texts = [\n    'ko' => [\n        'title' => 'ì‹¬ì‚¬ìœ„ì› ì±„ì  ëŒ€ì‹œë³´ë“œ',\n        'judge_info' => 'ì‹¬ì‚¬ìœ„ì›',\n        'logout' => 'ë¡œê·¸ì•„ì›ƒ',\n        'competition' => 'ëŒ€íšŒ',\n        'no_events' => 'ë“±ë¡ëœ ì´ë²¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤',\n        'contact_admin' => 'ëŒ€íšŒ ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.',\n        'scoring_complete' => 'ì±„ì  ì™„ë£Œ',\n        'scoring_pending' => 'ì±„ì  ëŒ€ê¸°',\n        'round' => 'ë¼ìš´ë“œ',\n        'dances' => 'ì¢…ëª©',\n        'score' => 'ì±„ì í•˜ê¸°',\n        'view_results' => 'ê²°ê³¼ë³´ê¸°',\n        'switch_lang' => 'English',\n        'not_assigned' => 'ë°°ì •ë˜ì§€ ì•ŠìŒ',\n        'panel_info' => 'íŒ¨ë„',\n        'scoring_not_allowed' => 'ì±„ì  ë¶ˆê°€'\n    ],\n    'en' => [\n        'title' => 'Judge Scoring Dashboard',\n        'judge_info' => 'Judge',\n        'logout' => 'Logout',\n        'competition' => 'Competition',\n        'no_events' => 'No events registered',\n        'contact_admin' => 'Please contact the competition administrator.',\n        'scoring_complete' => 'Scoring Complete',\n        'scoring_pending' => 'Pending',\n        'round' => 'Round',\n        'dances' => 'Dances',\n        'score' => 'Score',\n        'view_results' => 'View Results',\n        'switch_lang' => 'í•œêµ­ì–´',\n        'not_assigned' => 'Not Assigned',\n        'panel_info' => 'Panel',\n        'scoring_not_allowed' => 'Not Allowed'\n    ],\n    'zh' => [\n        'title' => 'è¯„å§”è¯„åˆ†ä»ªè¡¨æ¿',\n        'judge_info' => 'è¯„å§”',\n        'logout' => 'é€€å‡ºç™»å½•',\n        'competition' => 'æ¯”èµ›',\n        'no_events' => 'æ²¡æœ‰æ³¨å†Œçš„èµ›äº‹',\n        'contact_admin' => 'è¯·è”ç³»æ¯”èµ›ç®¡ç†å‘˜ã€‚',\n        'scoring_complete' => 'è¯„åˆ†å®Œæˆ',\n        'scoring_pending' => 'å¾…è¯„åˆ†',\n        'round' => 'è½®æ¬¡',\n        'dances' => 'èˆç§',\n        'score' => 'è¯„åˆ†',\n        'view_results' => 'æŸ¥çœ‹ç»“æœ',\n        'switch_lang' => 'English',\n        'not_assigned' => 'æœªåˆ†é…',\n        'panel_info' => 'é¢æ¿',\n        'scoring_not_allowed' => 'ä¸å…è®¸è¯„åˆ†'\n    ],\n    'ja' => [\n        'title' => 'å¯©æŸ»å“¡æ¡ç‚¹ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰',\n        'judge_info' => 'å¯©æŸ»å“¡',\n        'logout' => 'ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ',\n        'competition' => 'å¤§ä¼š',\n        'no_events' => 'ç™»éŒ²ã•ã‚ŒãŸã‚¤ãƒ™ãƒ³ãƒˆãŒã‚ã‚Šã¾ã›ã‚“',\n        'contact_admin' => 'å¤§ä¼šç®¡ç†è€…ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚',\n        'scoring_complete' => 'æ¡ç‚¹å®Œäº†',\n        'scoring_pending' => 'æ¡ç‚¹å¾…ã¡',\n        'round' => 'ãƒ©ã‚¦ãƒ³ãƒ‰',\n        'dances' => 'ç¨®ç›®',\n        'score' => 'æ¡ç‚¹',\n        'view_results' => 'çµæœè¡¨ç¤º',\n        'switch_lang' => 'English',\n        'not_assigned' => 'æœªå‰²ã‚Šå½“ã¦',\n        'panel_info' => 'ãƒ‘ãƒãƒ«',\n        'scoring_not_allowed' => 'æ¡ç‚¹ä¸å¯'\n    ]\n];\n\n$t = $texts[$lang];\n\n// Check if judge is logged in\nif (!isset($_SESSION['scoring_logged_in']) || !$_SESSION['scoring_logged_in'] || $_SESSION['scoring_comp_id'] !== $comp_id) {\n    header(\"Location: scoring_login.php?comp_id=\" . urlencode($comp_id));\n    exit;\n}\n\n// Load competition info\n$data_dir = __DIR__ . \"/data/$comp_id\";\n$info_file = \"$data_dir/info.json\";\n\nif (!file_exists($info_file)) {\n    echo \"<h1>ëŒ€íšŒ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</h1>\";\n    exit;\n}\n\n$info = json_decode(file_get_contents($info_file), true);\n\n// Load events\n$runorder_file = \"$data_dir/RunOrder_Tablet.txt\";\n$events = [];\n$multievent_groups = []; // ë©€í‹° ì´ë²¤íŠ¸ ê·¸ë£¹ ê´€ë¦¬\n\nif (file_exists($runorder_file)) {\n    $lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        if (preg_match('/^bom/', $line)) continue;\n        $cols = array_map('trim', explode(',', $line));\n        \n        // Check if it's a competition event (has dances)\n        $has_dance = false;\n        for ($i = 6; $i <= 10; $i++) {\n            if (isset($cols[$i]) && $cols[$i] !== '') {\n                $has_dance = true;\n                break;\n            }\n        }\n        \n        if ($has_dance) {\n            // Remove BOM from event number\n            $base_no_raw = preg_replace('/\\x{FEFF}/u', '', $cols[0]);\n            $base_no_raw = str_replace([\"\\xEF\\xBB\\xBF\", \"\\xFEFF\", \"\\uFEFF\"], '', $base_no_raw);\n            \n            // ì„¸ë¶€ë²ˆí˜¸ëŠ” 14ë²ˆì§¸ ì»¬ëŸ¼(ì¸ë±ìŠ¤ 13)ì—ì„œ ê°€ì ¸ì˜¤ê¸°\n            $detail_no = trim($cols[13] ?? '');\n            $event_no = !empty($detail_no) ? $detail_no : $base_no_raw;\n            $base_event_no = preg_replace('/\\D+/', '', $base_no_raw); // ìˆ«ìë§Œ ì¶”ì¶œ\n            \n            // ë””ë²„ê·¸: ì´ë²¤íŠ¸ íŒŒì‹± í™•ì¸\n            error_log(\"Event parsing - base_no_raw: '{$base_no_raw}', detail_no: '{$detail_no}', event_no: '{$event_no}', base_event_no: '{$base_event_no}'\");\n            \n            $event_data = [\n                'no' => $event_no,\n                'base_no' => $base_event_no,\n                'detail_no' => $detail_no,\n                'name' => $cols[1],\n                'round_type' => $cols[2],\n                'round_num' => $cols[3],\n                'round_display' => $cols[2], // ì›ë³¸ ë¼ìš´ë“œ ì •ë³´ë¥¼ ì§ì ‘ ì‚¬ìš©\n                'panel_code' => $cols[11] ?? '',\n                'dances' => []\n            ];\n            \n            for ($i = 6; $i <= 10; $i++) {\n                if (!empty($cols[$i])) {\n                    // ì›ë³¸ ìˆ«ì ì½”ë“œë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš© (íŒŒì¼ëª…ê³¼ ì¼ì¹˜ì‹œí‚¤ê¸° ìœ„í•´)\n                    $event_data['dances'][] = $cols[$i];\n                    \n                    // ë””ë²„ê·¸: ì¢…ëª© ì½”ë“œ í™•ì¸\n                    error_log(\"Event {$event_data['no']}: dance code {$cols[$i]} added\");\n                }\n            }\n            \n            // ë©€í‹° ì´ë²¤íŠ¸ ê·¸ë£¹ì— ì¶”ê°€\n            if (!isset($multievent_groups[$base_event_no])) {\n                $multievent_groups[$base_event_no] = [];\n            }\n            $multievent_groups[$base_event_no][] = $event_data;\n            \n            $events[] = $event_data;\n        }\n    }\n}\n\n// ë©€í‹° ì´ë²¤íŠ¸ ê·¸ë£¹ ì •ë¦¬ (ì„¸ë¶€ë²ˆí˜¸ê°€ ìˆëŠ” ê²½ìš°ë§Œ)\n$multievent_events = [];\nforeach ($multievent_groups as $base_no => $group) {\n    if (count($group) > 1) {\n        // ì„¸ë¶€ë²ˆí˜¸ê°€ ìˆëŠ” ë©€í‹° ì´ë²¤íŠ¸\n        $multievent_events[$base_no] = $group;\n    }\n}\n\n// Load round info from RunOrder_Tablet.txt (primary source)\n$round_info = [];\n\n// Load dance name mapping\n$dance_mapping = [];\n$dance_name_file = \"$data_dir/DanceName.txt\";\nif (file_exists($dance_name_file)) {\n    $lines = file($dance_name_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        $line = preg_replace('/\\x{FEFF}/u', '', $line);\n        $line = str_replace([\"\\xEF\\xBB\\xBF\", \"\\xFEFF\", \"\\uFEFF\"], '', $line);\n        $line = preg_replace('/[\\x00-\\x1F\\x7F-\\x9F]/', '', $line);\n        \n        if (preg_match('/^bom/', $line)) continue;\n        $cols = array_map('trim', explode(',', $line));\n        if (count($cols) >= 3 && is_numeric($cols[0])) {\n            $dance_mapping[$cols[0]] = $cols[1]; // ìˆ«ì -> ëŒ„ìŠ¤ëª…\n        }\n    }\n}\n\n// í•˜ë“œì½”ë”©ëœ ëŒ„ìŠ¤ ë§¤í•‘ (ë°±ì—…)\n$dance_mapping = [\n    '1' => 'Waltz',\n    '2' => 'Tango', \n    '3' => 'Viennese Waltz',\n    '4' => 'Slow Foxtrot',\n    '5' => 'Quickstep',\n    '6' => 'Cha Cha Cha',\n    '7' => 'Samba',\n    '8' => 'Rumba',\n    '9' => 'Paso Doble',\n    '10' => 'Jive',\n    '11' => 'Freestyle',\n    '12' => 'Swing',\n    '13' => 'Argentine Tango',\n    '14' => 'Handicap',\n    '15' => 'Formation Team'\n];\n\n// ëŒ„ìŠ¤ ë³€í™˜ í•¨ìˆ˜\nfunction convertDanceNumber($dance_number, $dance_mapping) {\n    $dance_number = trim($dance_number);\n    return $dance_mapping[$dance_number] ?? $dance_number;\n}\n\n// ë””ë²„ê·¸: ëŒ„ìŠ¤ ë§¤í•‘ í™•ì¸\nerror_log(\"Dance mapping loaded: \" . print_r($dance_mapping, true));\n\n\n// Load panel list and check judge's panels\n$panel_list = [];\n$panel_file = \"$data_dir/panel_list.json\";\nif (file_exists($panel_file)) {\n    $panel_data = json_decode(file_get_contents($panel_file), true);\n    if ($panel_data) {\n        $panel_list = $panel_data;\n    }\n}\n\n// Get current judge's panels\n$current_judge_id = $_SESSION['scoring_judge_id'] ?? '';\n$judge_panels = [];\nforeach ($panel_list as $panel) {\n    // ì‹¬ì‚¬ìœ„ì› IDë¥¼ ë¬¸ìì—´ê³¼ ìˆ«ì ëª¨ë‘ë¡œ ë¹„êµ\n    if ($panel['adj_code'] === $current_judge_id || \n        $panel['adj_code'] === (string)$current_judge_id || \n        (string)$panel['adj_code'] === $current_judge_id) {\n        $judge_panels[] = $panel['panel_code'];\n    }\n}\n\n// ë””ë²„ê·¸ ì •ë³´ ì¶”ê°€\nerror_log(\"Current judge ID: '{$current_judge_id}' (type: \" . gettype($current_judge_id) . \")\");\nerror_log(\"Panel list loaded: \" . count($panel_list) . \" panels\");\nerror_log(\"Judge panels: \" . implode(',', $judge_panels));\n\n// íŒ¨ë„ ë¦¬ìŠ¤íŠ¸ì˜ ì‹¬ì‚¬ìœ„ì› IDë“¤ë„ ë¡œê·¸ë¡œ í™•ì¸\n$all_judge_ids = array_unique(array_column($panel_list, 'adj_code'));\nerror_log(\"All judge IDs in panel: \" . implode(',', $all_judge_ids));\n\n// Calculate round info from RunOrder_Tablet.txt data\nfunction calculateRoundDisplay($event_data, $all_events) {\n    $event_name = $event_data['name'];\n    $event_no = $event_data['no'];\n    \n    // Find all events with same name\n    $same_name_events = array_filter($all_events, function($e) use ($event_name) {\n        return $e['name'] === $event_name;\n    });\n    \n    $total_events = count($same_name_events);\n    if ($total_events <= 1) {\n        return 'Final';\n    }\n    \n    // Sort by event number to get position\n    $sorted_events = array_values($same_name_events);\n    usort($sorted_events, function($a, $b) {\n        return intval($a['no']) - intval($b['no']);\n    });\n    \n    $position = 0;\n    foreach ($sorted_events as $idx => $evt) {\n        if ($evt['no'] === $event_no) {\n            $position = $idx;\n            break;\n        }\n    }\n    \n    // Calculate round display based on position and total\n    if ($total_events === 2) {\n        return $position === 0 ? 'Semi-Final' : 'Final';\n    } else if ($total_events === 3) {\n        if ($position === 0) return 'Round 1';\n        else if ($position === 1) return 'Semi-Final';\n        else return 'Final';\n    } else if ($total_events === 4) {\n        if ($position === 0) return 'Round 1';\n        else if ($position === 1) return 'Round 2';\n        else if ($position === 2) return 'Semi-Final';\n        else return 'Final';\n    } else if ($total_events === 5) {\n        if ($position === 0) return 'Round 1';\n        else if ($position === 1) return 'Round 2';\n        else if ($position === 2) return 'Round 3';\n        else if ($position === 3) return 'Semi-Final';\n        else return 'Final';\n    } else {\n        return ($position + 1) . '/' . $total_events;\n    }\n}\n\n// Merge round info into events and check scoring eligibility\nforeach ($events as $idx => &$event) {\n    // Use original round_display from RunOrder_Tablet.txt (already set during parsing)\n    // Only calculate if round_display is empty\n    if (empty($event['round_display'])) {\n        $event['round_display'] = calculateRoundDisplay($event, $events);\n    }\n    \n    // Check if judge can score this event (panel match)\n    $panel_code = $event['panel_code'] ?? '';\n    \n    // ì •í™•í•œ íŒ¨ë„ ë§¤ì¹­ ë¡œì§\n    if (empty($judge_panels)) {\n        // íŒ¨ë„ ì •ë³´ê°€ ì—†ëŠ” ê²½ìš° ëª¨ë“  ì´ë²¤íŠ¸ ì±„ì  ê°€ëŠ¥\n        $event['can_score'] = true;\n        $reason = \"no_panel_info\";\n    } else {\n        // íŒ¨ë„ ì½”ë“œê°€ ë¹„ì–´ìˆê±°ë‚˜ 'N/A'ì¸ ê²½ìš°, ë˜ëŠ” ì‹¬ì‚¬ìœ„ì› íŒ¨ë„ì— ì •í™•íˆ í¬í•¨ëœ ê²½ìš°ë§Œ ì±„ì  ê°€ëŠ¥\n        $event['can_score'] = empty($panel_code) || $panel_code === 'N/A' || in_array($panel_code, $judge_panels);\n        $reason = $event['can_score'] ? \"panel_match\" : \"no_panel_match\";\n    }\n    \n    $event['panel_status'] = $event['can_score'] ? 'eligible' : 'not_eligible';\n    \n    // ë””ë²„ê·¸ ì •ë³´ ì¶”ê°€\n    error_log(\"Event {$event['no']}: panel_code='{$panel_code}', judge_panels=\" . implode(',', $judge_panels) . \", can_score=\" . ($event['can_score'] ? 'true' : 'false') . \", reason={$reason}\");\n}\nunset($event); // Break the reference\n\n// Check which events have scores\n$events_with_scores = [];\n$judge_id = $_SESSION['scoring_judge_id'] ?? '';\n\nforeach ($events as $event) {\n    $event_no = $event['no'];\n    $has_scores = false;\n    \n    // 1. ê¸°ë³¸ ì ìˆ˜ íŒŒì¼ í™•ì¸\n    $scores_file = \"$data_dir/scores_{$event_no}.json\";\n    if (file_exists($scores_file)) {\n        $has_scores = true;\n    } else {\n        // 2. ê°œë³„ .adj íŒŒì¼ í™•ì¸ (ëª¨ë“  ë¼ìš´ë“œ/ì´ë²¤íŠ¸ì— ì ìš©)\n        $all_dances_scored = true;\n        \n        foreach ($event['dances'] as $dance) {\n            $adj_file = \"$data_dir/{$event_no}_{$dance}_{$judge_id}.adj\";\n            if (!file_exists($adj_file)) {\n                $all_dances_scored = false;\n                break;\n            }\n        }\n        \n        $has_scores = $all_dances_scored;\n        \n        // ë””ë²„ê·¸: ê°œë³„ ì¢…ëª© íŒŒì¼ í™•ì¸ ë¡œê·¸\n        error_log(\"Event {$event_no}: checking .adj files for judge {$judge_id}\");\n        foreach ($event['dances'] as $dance) {\n            $adj_file = \"$data_dir/{$event_no}_{$dance}_{$judge_id}.adj\";\n            $exists = file_exists($adj_file) ? 'EXISTS' : 'MISSING';\n            error_log(\"  - {$adj_file}: {$exists}\");\n        }\n        error_log(\"  - Result: \" . ($has_scores ? 'COMPLETED' : 'INCOMPLETE'));\n    }\n    \n    $events_with_scores[$event_no] = $has_scores;\n}\n\nfunction h($s) { return htmlspecialchars($s ?? ''); }\n?>\n<!DOCTYPE html>\n<html lang=\"<?=h($lang)?>\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title><?=h($t['title'])?> | <?=h($info['title'])?></title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\n    <style>\n        * {\n            box-sizing: border-box;\n        }\n        \n        body { \n            background: #f5f7fa; \n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; \n            margin: 0; \n            padding: 10px;\n            font-size: 16px;\n            line-height: 1.4;\n        }\n        \n        .container { \n            max-width: 100%; \n            margin: 0 auto; \n            background: #fff; \n            border-radius: 8px; \n            padding: 15px; \n            box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n        }\n        \n        .header {\n            margin-bottom: 20px;\n            padding-bottom: 15px;\n            border-bottom: 1px solid #e9ecef;\n            margin-top: 50px;\n        }\n        \n        h1 { \n            color: #333; \n            margin: 0 0 10px 0; \n            font-size: 1.4em;\n            font-weight: 700;\n        }\n        \n        .judge-info {\n            background: #e3f2fd;\n            padding: 8px 12px;\n            border-radius: 6px;\n            color: #1976d2;\n            font-weight: 600;\n            font-size: 0.9em;\n            margin-bottom: 10px;\n        }\n        \n        .logout-btn {\n            background: #dc3545;\n            color: #fff;\n            border: none;\n            padding: 8px 16px;\n            border-radius: 6px;\n            cursor: pointer;\n            text-decoration: none;\n            font-size: 12px;\n            font-weight: 600;\n            display: inline-block;\n            text-align: center;\n            transition: all 0.2s;\n        }\n        \n        .logout-btn:active {\n            background: #c82333;\n            transform: translateY(1px);\n        }\n        \n        .filter-btn {\n            background: #28a745;\n            color: #fff;\n            border: none;\n            padding: 8px 16px;\n            border-radius: 6px;\n            cursor: pointer;\n            text-decoration: none;\n            font-size: 12px;\n            font-weight: 600;\n            display: inline-block;\n            text-align: center;\n            transition: all 0.2s;\n        }\n        \n        .filter-btn:active {\n            background: #218838;\n            transform: translateY(1px);\n        }\n        \n        .filter-btn.active {\n            background: #6c757d;\n        }\n        \n        .filter-btn.active:active {\n            background: #5a6268;\n        }\n        \n        .comp-info {\n            background: #f8f9fa; \n            padding: 12px; \n            border-radius: 6px; \n            margin-bottom: 20px; \n            text-align: center;\n            font-size: 0.9em;\n        }\n        \n        .events-grid {\n            display: flex;\n            flex-direction: column;\n            gap: 12px;\n            margin-bottom: 20px;\n        }\n        \n        .event-card {\n            background: #fff;\n            border: 2px solid #e9ecef;\n            border-radius: 8px;\n            padding: 15px;\n            transition: all 0.2s;\n            cursor: pointer;\n        }\n        \n        /* ë©€í‹° ì´ë²¤íŠ¸ ì¹´ë“œ ìŠ¤íƒ€ì¼ */\n        .multievent-card {\n            background: #fff;\n            border: 2px solid #e9ecef;\n            border-radius: 8px;\n            padding: 15px;\n            transition: all 0.2s;\n            cursor: pointer;\n        }\n        \n        .multievent-header {\n            display: flex;\n            align-items: center;\n            margin-bottom: 15px;\n            padding-bottom: 10px;\n            border-bottom: 1px solid #e9ecef;\n        }\n        \n        .multievent-number {\n            font-size: 1.8em;\n            font-weight: 700;\n            color: #667eea;\n            margin-right: 15px;\n            line-height: 1;\n        }\n        \n        .multievent-title {\n            font-size: 1.1em;\n            font-weight: 600;\n            color: #333;\n            flex: 1;\n        }\n        \n        .sub-events {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n            gap: 10px;\n            margin-bottom: 15px;\n        }\n        \n        .sub-event {\n            background: #f8f9fa;\n            border: 1px solid #dee2e6;\n            border-radius: 6px;\n            padding: 10px;\n            text-align: center;\n        }\n        \n        .sub-event-number {\n            font-size: 1.2em;\n            font-weight: 700;\n            color: #495057;\n            margin-bottom: 5px;\n        }\n        \n        .sub-event-name {\n            font-size: 0.9em;\n            color: #6c757d;\n            margin-bottom: 8px;\n        }\n        \n        .sub-event-dances {\n            font-size: 0.8em;\n            color: #868e96;\n            font-style: italic;\n        }\n        \n        .event-card:active {\n            transform: translateY(1px);\n            box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n        }\n        \n        .event-card.scored {\n            border-color: #28a745;\n            background: #f8fff9;\n        }\n        \n        .status-badge {\n            display: inline-block;\n            padding: 4px 8px;\n            border-radius: 4px;\n            font-size: 11px;\n            font-weight: 600;\n            margin-bottom: 8px;\n        }\n        \n        .status-pending {\n            background: #fff3cd;\n            color: #856404;\n        }\n        \n        .status-completed {\n            background: #d4edda;\n            color: #155724;\n        }\n        \n        .status-not-assigned {\n            background: #f8d7da;\n            color: #721c24;\n        }\n        \n        .event-card.not-eligible {\n            border-color: #dc3545;\n            background: #fff5f5;\n            opacity: 0.7;\n        }\n        \n        .btn-disabled {\n            background: #6c757d !important;\n            color: #fff !important;\n            cursor: not-allowed !important;\n            opacity: 0.6;\n        }\n        \n        .btn-disabled:active {\n            transform: none !important;\n        }\n        \n        .panel-info {\n            font-size: 0.8em;\n            color: #666;\n            margin-bottom: 8px;\n            padding: 4px 8px;\n            background: #f8f9fa;\n            border-radius: 4px;\n            display: inline-block;\n        }\n        \n        .event-number {\n            font-size: 1.8em;\n            font-weight: 700;\n            color: #667eea;\n            margin-bottom: 4px;\n            line-height: 1;\n        }\n        \n        .event-title {\n            font-size: 1.1em;\n            font-weight: 600;\n            color: #333;\n            margin-bottom: 8px;\n            line-height: 1.3;\n        }\n        \n        .event-details {\n            color: #666;\n            font-size: 0.85em;\n            margin-bottom: 12px;\n            line-height: 1.4;\n        }\n        \n        .event-actions {\n            display: flex;\n            flex-direction: column;\n            gap: 8px;\n        }\n        \n        .btn {\n            padding: 12px 16px;\n            border: none;\n            border-radius: 6px;\n            cursor: pointer;\n            text-decoration: none;\n            font-size: 14px;\n            font-weight: 600;\n            transition: all 0.2s;\n            text-align: center;\n            display: block;\n        }\n        \n        .btn:active {\n            transform: translateY(1px);\n        }\n        \n        .btn-primary {\n            background: #667eea;\n            color: #fff;\n        }\n        \n        .btn-primary:active {\n            background: #5a6fd8;\n        }\n        \n        .btn-info {\n            background: #17a2b8;\n            color: #fff;\n        }\n        \n        .btn-info:active {\n            background: #138496;\n        }\n        \n        \n        .top-controls {\n            position: absolute;\n            top: 15px;\n            right: 15px;\n            display: flex;\n            gap: 10px;\n            align-items: center;\n        }\n        \n        .lang-switch {\n            background: #667eea;\n            color: #fff;\n            border: none;\n            padding: 8px 12px;\n            border-radius: 6px;\n            font-size: 12px;\n            font-weight: 600;\n            cursor: pointer;\n            text-decoration: none;\n            transition: all 0.2s;\n            appearance: none;\n            -webkit-appearance: none;\n            -moz-appearance: none;\n            background-image: url(\"data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e\");\n            background-repeat: no-repeat;\n            background-position: right 8px center;\n            background-size: 12px;\n            padding-right: 30px;\n        }\n        \n        .lang-switch:active {\n            background-color: #5a6fd8;\n            transform: translateY(1px);\n        }\n        \n        .lang-switch option {\n            background: #667eea;\n            color: #fff;\n            padding: 8px;\n        }\n        \n        .container {\n            position: relative;\n        }\n        \n        .empty-state {\n            text-align: center;\n            padding: 40px 20px;\n            color: #666;\n        }\n        \n        .empty-state h3 {\n            margin: 0 0 10px 0;\n            color: #333;\n            font-size: 1.2em;\n        }\n        \n        /* íƒœë¸”ë¦¿ í™˜ê²½ (768px ì´ìƒ) */\n        @media (min-width: 768px) {\n            body {\n                padding: 20px;\n            }\n            \n            .container {\n                padding: 25px;\n                border-radius: 12px;\n            }\n            \n            .header {\n                margin-bottom: 25px;\n                margin-top: 60px;\n            }\n            \n            h1 {\n                font-size: 1.6em;\n                margin-bottom: 0;\n            }\n            \n            .judge-info {\n                margin-bottom: 0;\n                font-size: 0.95em;\n            }\n            \n            .top-controls {\n                top: 25px;\n                right: 25px;\n            }\n            \n            .logout-btn {\n                padding: 10px 18px;\n                font-size: 13px;\n            }\n            \n            .events-grid {\n                display: grid;\n                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));\n                gap: 15px;\n            }\n            \n            .event-actions {\n                flex-direction: row;\n                gap: 8px;\n            }\n            \n            .btn {\n                flex: 1;\n                padding: 10px 12px;\n                font-size: 13px;\n            }\n            \n            .lang-switch {\n                top: 25px;\n                right: 25px;\n                padding: 10px 32px 10px 14px;\n                font-size: 13px;\n            }\n        }\n        \n        /* í° íƒœë¸”ë¦¿/ë°ìŠ¤í¬í†± (1024px ì´ìƒ) */\n        @media (min-width: 1024px) {\n            .container {\n                max-width: 1200px;\n                padding: 30px;\n            }\n            \n            .events-grid {\n                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\n                gap: 20px;\n            }\n            \n            .event-card {\n                padding: 20px;\n            }\n            \n            .event-number {\n                font-size: 2em;\n            }\n            \n            .event-title {\n                font-size: 1.2em;\n            }\n            \n            .event-details {\n                font-size: 0.9em;\n            }\n            \n            .top-controls {\n                top: 30px;\n                right: 30px;\n            }\n            \n            .lang-switch {\n                padding: 10px 36px 10px 16px;\n                font-size: 14px;\n            }\n            \n            .logout-btn {\n                padding: 10px 20px;\n                font-size: 14px;\n            }\n            \n            .lang-switch:hover {\n                background: #5a6fd8;\n            }\n        }\n    </style>\n</head>\n<body>\n<div class=\"container\">\n    <div class=\"top-controls\">\n        <button id=\"filterToggle\" class=\"filter-btn\" onclick=\"toggleEventFilter()\">ê°„ë‹¨íˆ</button>\n        <select class=\"lang-switch\" onchange=\"window.location.href='?comp_id=<?=h($comp_id)?>&lang=' + this.value\">\n            <option value=\"ko\" <?=$lang === 'ko' ? 'selected' : ''?>>í•œêµ­ì–´</option>\n            <option value=\"en\" <?=$lang === 'en' ? 'selected' : ''?>>English</option>\n            <option value=\"zh\" <?=$lang === 'zh' ? 'selected' : ''?>>ä¸­æ–‡</option>\n            <option value=\"ja\" <?=$lang === 'ja' ? 'selected' : ''?>>æ—¥æœ¬èª</option>\n        </select>\n        <a href=\"scoring_logout.php?comp_id=<?=h($comp_id)?>\" class=\"logout-btn\"><?=h($t['logout'])?></a>\n    </div>\n    \n    <div class=\"header\">\n        <div>\n            <h1><?=h($t['title'])?></h1>\n            <div class=\"judge-info\">\n                <?=h($_SESSION['scoring_judge_name'])?> (<?=h($_SESSION['scoring_judge_country'])?>) - <?=h($t['judge_info'])?> #<?=h($_SESSION['scoring_judge_id'])?>\n            </div>\n        </div>\n    </div>\n    \n    <div class=\"comp-info\" style=\"background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 30px; text-align: center;\">\n        <strong><?=h($info['title'])?></strong><br>\n        <?=h($info['date'])?> | <?=h($info['place'])?>\n        \n        <!-- ë””ë²„ê·¸ ì •ë³´ ì¶”ê°€ -->\n        <div style=\"margin-top: 10px; font-size: 12px; color: #666; text-align: left;\">\n            <strong>ë””ë²„ê·¸ ì •ë³´:</strong><br>\n            ì‹¬ì‚¬ìœ„ì› ID: <?=h($_SESSION['scoring_judge_id'] ?? 'N/A')?><br>\n            ì‹¬ì‚¬ìœ„ì› ì´ë¦„: <?=h($_SESSION['scoring_judge_name'] ?? 'N/A')?><br>\n            íŒ¨ë„ ê°œìˆ˜: <?=count($judge_panels)?><br>\n            ì‹¬ì‚¬ìœ„ì› íŒ¨ë„: <?=implode(', ', $judge_panels)?><br>\n            ì´ë²¤íŠ¸ ì´ ê°œìˆ˜: <?=count($events)?><br>\n            ë©€í‹° ì´ë²¤íŠ¸ ê°œìˆ˜: <?=count($multievent_events)?><br>\n            ëŒ„ìŠ¤ ë§¤í•‘: <?=implode(', ', array_slice($dance_mapping, 0, 5))?>... (<?=count($dance_mapping)?>ê°œ)<br>\n            ì²« ë²ˆì§¸ ì´ë²¤íŠ¸ ì¢…ëª©: <?=h(implode(', ', $events[0]['dances'] ?? []))?><br>\n            ëŒ„ìŠ¤ ë§¤í•‘ í…ŒìŠ¤íŠ¸: 8 -> <?=h($dance_mapping['8'] ?? 'NOT_FOUND')?>, 6 -> <?=h($dance_mapping['6'] ?? 'NOT_FOUND')?><br>\n            ì´ë²¤íŠ¸ 18 ì¢…ëª©: <?=h(implode(', ', $events[17]['dances'] ?? []))?><br>\n            convertDanceNumber í…ŒìŠ¤íŠ¸: <?=h(convertDanceNumber('8', $dance_mapping))?>\n        </div>\n    </div>\n    \n    <?php if (empty($events)): ?>\n        <div class=\"empty-state\">\n            <h3><?=h($t['no_events'])?></h3>\n            <p><?=h($t['contact_admin'])?></p>\n        </div>\n    <?php else: ?>\n        <div class=\"events-grid\">\n            <?php \n            // ëª¨ë“  ì´ë²¤íŠ¸ë¥¼ ë²ˆí˜¸ìˆœìœ¼ë¡œ ì •ë ¬í•˜ì—¬ í‘œì‹œ\n            $all_events = [];\n            \n            // ë©€í‹° ì´ë²¤íŠ¸ë“¤ì„ ê¸°ë³¸ ë²ˆí˜¸ë¡œ ê·¸ë£¹í™”\n            foreach ($multievent_events as $base_no => $group) {\n                $all_events[] = [\n                    'type' => 'multievent',\n                    'base_no' => $base_no,\n                    'group' => $group,\n                    'sort_key' => intval($base_no)\n                ];\n            }\n            \n            // ì¼ë°˜ ì´ë²¤íŠ¸ë“¤ ì¶”ê°€ (ë©€í‹° ì´ë²¤íŠ¸ê°€ ì•„ë‹Œ ê²ƒë“¤)\n            $displayed_events = [];\n            foreach ($multievent_events as $group) {\n                foreach ($group as $event) {\n                    $displayed_events[] = $event['no'];\n                }\n            }\n            \n            foreach ($events as $event) {\n                if (!in_array($event['no'], $displayed_events)) {\n                    $all_events[] = [\n                        'type' => 'single',\n                        'event' => $event,\n                        'sort_key' => intval($event['no'])\n                    ];\n                }\n            }\n            \n            // ë²ˆí˜¸ìˆœìœ¼ë¡œ ì •ë ¬\n            usort($all_events, function($a, $b) {\n                return $a['sort_key'] - $b['sort_key'];\n            });\n            \n            // ì´ë²¤íŠ¸ë“¤ ë Œë”ë§\n            foreach ($all_events as $event_item):\n                if ($event_item['type'] === 'multievent'):\n                    $base_no = $event_item['base_no'];\n                    $group = $event_item['group'];\n                    $first_event = $group[0];\n                    // ë©€í‹° ì´ë²¤íŠ¸ì˜ íŒ¨ë„ ë§¤ì¹­ ë¡œì§\n                    $panel_code = $first_event['panel_code'] ?? '';\n                    if (empty($judge_panels)) {\n                        $can_score = true;\n                    } else {\n                        $can_score = empty($panel_code) || $panel_code === 'N/A' || in_array($panel_code, $judge_panels);\n                    }\n                    $has_scores = true;\n                    foreach ($group as $event) {\n                        if (!$events_with_scores[$event['no']]) {\n                            $has_scores = false;\n                            break;\n                        }\n                    }\n            ?>\n            <div class=\"multievent-card <?=$has_scores ? 'scored' : ''?> <?=!$can_score ? 'not-eligible' : ''?>\" \n                 data-status=\"<?=$has_scores ? 'completed' : ($can_score ? 'pending' : 'not-assigned')?>\">\n                <div class=\"status-badge <?=$has_scores ? 'status-completed' : ($can_score ? 'status-pending' : 'status-not-assigned')?>\">\n                    <?php if ($has_scores): ?>\n                        <?=h($t['scoring_complete'])?>\n                    <?php elseif ($can_score): ?>\n                        <?=h($t['scoring_pending'])?>\n                    <?php else: ?>\n                        <?=h($t['not_assigned'])?>\n                    <?php endif; ?>\n                </div>\n                \n                <div class=\"multievent-header\">\n                    <div class=\"multievent-number\">#<?=h($base_no)?></div>\n                </div>\n                \n                <div class=\"sub-events\">\n                    <?php foreach ($group as $event): ?>\n                    <div class=\"sub-event\">\n                        <div class=\"sub-event-number\">#<?=h($event['no'])?></div>\n                        <div class=\"sub-event-name\"><?=h($event['name'])?></div>\n                        <div class=\"sub-event-dances\"><?php \n                            $dance_names = [];\n                            foreach ($event['dances'] as $dance) {\n                                $dance_names[] = convertDanceNumber($dance, $dance_mapping);\n                            }\n                            echo h(implode(', ', $dance_names));\n                        ?></div>\n                    </div>\n                    <?php endforeach; ?>\n                </div>\n                \n                <div class=\"panel-info\">\n                    <?=h($t['panel_info'])?>: <?=h($first_event['panel_code'] ?: 'N/A')?>\n                </div>\n                \n                <div class=\"event-details\">\n                    <?=h($t['round'])?>: <?=h($first_event['round_display'] ?: $first_event['round_type'] . ' ' . $first_event['round_num'])?><br>\n                    <strong>ë©€í‹° ì´ë²¤íŠ¸ ê²°ìŠ¹ì „</strong>\n                </div>\n                \n                <div class=\"event-actions\">\n                    <?php if ($can_score): ?>\n                        <a href=\"multievent_scoring.php?comp_id=<?=h($comp_id)?>&event_group=<?=h($base_no)?>&lang=<?=h($lang)?>\" \n                           class=\"btn btn-primary\" \n                           target=\"_blank\">\n                            <?=h($t['score'])?>\n                        </a>\n                    <?php else: ?>\n                        <button class=\"btn btn-disabled\" disabled>\n                            <?=h($t['scoring_not_allowed'])?>\n                        </button>\n                    <?php endif; ?>\n                </div>\n            </div>\n            <?php else: // ë‹¨ì¼ ì´ë²¤íŠ¸ ?>\n            <?php \n                $event = $event_item['event'];\n            ?>\n            <div class=\"event-card <?=$events_with_scores[$event['no']] ? 'scored' : ''?> <?=!$event['can_score'] ? 'not-eligible' : ''?>\" \n                 data-status=\"<?=$events_with_scores[$event['no']] ? 'completed' : ($event['can_score'] ? 'pending' : 'not-assigned')?>\">\n                <div class=\"status-badge <?=$events_with_scores[$event['no']] ? 'status-completed' : ($event['can_score'] ? 'status-pending' : 'status-not-assigned')?>\">\n                    <?php if ($events_with_scores[$event['no']]): ?>\n                        <?=h($t['scoring_complete'])?>\n                    <?php elseif ($event['can_score']): ?>\n                        <?=h($t['scoring_pending'])?>\n                    <?php else: ?>\n                        <?=h($t['not_assigned'])?>\n                    <?php endif; ?>\n                </div>\n                \n                <div class=\"event-number\">#<?=h($event['no'])?></div>\n                <div class=\"event-title\"><?=h($event['name'])?></div>\n                \n                <div class=\"panel-info\">\n                    <?=h($t['panel_info'])?>: <?=h($event['panel_code'] ?: 'N/A')?>\n                </div>\n                \n                <div class=\"event-details\">\n                    <?=h($t['round'])?>: <?=h($event['round_display'] ?: $event['round_type'] . ' ' . $event['round_num'])?><br>\n                    <?=h($t['dances'])?>: <?php \n                        $dance_names = [];\n                        foreach ($event['dances'] as $dance) {\n                            $dance_names[] = convertDanceNumber($dance, $dance_mapping);\n                        }\n                        echo h(implode(', ', $dance_names));\n                    ?>\n                </div>\n                \n                <div class=\"event-actions\">\n                    <?php if ($event['can_score']): ?>\n                        <a href=\"judge_scoring.php?comp_id=<?=h($comp_id)?>&event_no=<?=h($event['no'])?>&lang=<?=h($lang)?>\" \n                           class=\"btn btn-primary\" \n                           target=\"_blank\">\n                            <?=h($t['score'])?>\n                        </a>\n                    <?php else: ?>\n                        <button class=\"btn btn-disabled\" disabled>\n                            <?=h($t['scoring_not_allowed'])?>\n                        </button>\n                    <?php endif; ?>\n                </div>\n            </div>\n            <?php endif; ?>\n            <?php endforeach; ?>\n        </div>\n    <?php endif; ?>\n</div>\n\n<footer style=\"text-align: center; margin-top: 30px; color: #666; font-size: 0.9em; padding: 20px;\">\n    2025 danceoffice.net | Powered by Seyoung Lee\n</footer>\n\n<script>\nlet showAllEvents = true;\n\nfunction toggleEventFilter() {\n    const filterBtn = document.getElementById('filterToggle');\n    const eventCards = document.querySelectorAll('.event-card');\n    \n    showAllEvents = !showAllEvents;\n    \n    if (showAllEvents) {\n        // Show all events\n        filterBtn.textContent = 'ê°„ë‹¨íˆ';\n        filterBtn.classList.remove('active');\n        eventCards.forEach(card => {\n            card.style.display = 'block';\n        });\n    } else {\n        // Hide completed and not-assigned events\n        filterBtn.textContent = 'All';\n        filterBtn.classList.add('active');\n        eventCards.forEach(card => {\n            const status = card.getAttribute('data-status');\n            if (status === 'completed' || status === 'not-assigned') {\n                card.style.display = 'none';\n            } else {\n                card.style.display = 'block';\n            }\n        });\n    }\n}\n</script>\n</body>\n</html>\n","size_bytes":37856},"comp/scoring_login.php":{"content":"<?php\nsession_start();\n\n$comp_id = $_GET['comp_id'] ?? '';\n$comp_id = preg_replace('/\\x{FEFF}/u', '', $comp_id);\n$comp_id = preg_replace('/[^\\d-]/', '', $comp_id);\n\n// Language setting\n$lang = $_GET['lang'] ?? 'ko';\nif (!in_array($lang, ['ko', 'en', 'zh', 'ja'])) {\n    $lang = 'ko';\n}\n\n// Language texts\n$texts = [\n    'ko' => [\n        'title' => 'ì‹¬ì‚¬ìœ„ì› ì±„ì  ë¡œê·¸ì¸',\n        'password_label' => 'ì‹¬ì‚¬ìœ„ì› ë¹„ë°€ë²ˆí˜¸',\n        'password_placeholder' => '3-4ìë¦¬ ìˆ«ì ì…ë ¥',\n        'login' => 'ë¡œê·¸ì¸',\n        'password_required' => 'ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.',\n        'invalid_password' => 'ì˜ëª»ëœ ë¹„ë°€ë²ˆí˜¸ì…ë‹ˆë‹¤.',\n        'switch_lang' => 'English'\n    ],\n    'en' => [\n        'title' => 'Judge Scoring Login',\n        'password_label' => 'Judge Password',\n        'password_placeholder' => 'Enter 3-4 digit number',\n        'login' => 'Login',\n        'password_required' => 'Please enter password.',\n        'invalid_password' => 'Invalid password.',\n        'switch_lang' => 'í•œêµ­ì–´'\n    ],\n    'zh' => [\n        'title' => 'è¯„å§”è¯„åˆ†ç™»å½•',\n        'password_label' => 'è¯„å§”å¯†ç ',\n        'password_placeholder' => 'è¯·è¾“å…¥3-4ä½æ•°å­—',\n        'login' => 'ç™»å½•',\n        'password_required' => 'è¯·è¾“å…¥å¯†ç ã€‚',\n        'invalid_password' => 'å¯†ç é”™è¯¯ã€‚',\n        'switch_lang' => 'English'\n    ],\n    'ja' => [\n        'title' => 'å¯©æŸ»å“¡æ¡ç‚¹ãƒ­ã‚°ã‚¤ãƒ³',\n        'password_label' => 'å¯©æŸ»å“¡ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰',\n        'password_placeholder' => '3-4æ¡ã®æ•°å­—ã‚’å…¥åŠ›',\n        'login' => 'ãƒ­ã‚°ã‚¤ãƒ³',\n        'password_required' => 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚',\n        'invalid_password' => 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé–“é•ã£ã¦ã„ã¾ã™ã€‚',\n        'switch_lang' => 'English'\n    ]\n];\n\n$t = $texts[$lang];\n\nif (!$comp_id) {\n    echo \"<h1>ì˜ëª»ëœ ëŒ€íšŒ IDì…ë‹ˆë‹¤.</h1>\";\n    exit;\n}\n\n// Load competition info\n$data_dir = __DIR__ . \"/data/$comp_id\";\n$info_file = \"$data_dir/info.json\";\n\nif (!file_exists($info_file)) {\n    echo \"<h1>ëŒ€íšŒ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</h1>\";\n    exit;\n}\n\n$info = json_decode(file_get_contents($info_file), true);\n\n// Load adjudicators to get passwords\n$adjudicators_file = \"$data_dir/adjudicators.txt\";\n$adjudicators = [];\n\nif (file_exists($adjudicators_file)) {\n    $lines = file($adjudicators_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        if (preg_match('/^bom/', $line)) continue;\n        $cols = array_map('trim', explode(',', $line));\n        if (count($cols) >= 4) {\n            $adjudicators[] = [\n                'id' => $cols[0],\n                'name' => $cols[1],\n                'country' => $cols[2],\n                'password' => $cols[3]\n            ];\n        }\n    }\n}\n\n$error_message = '';\n\n// Handle login\nif ($_SERVER['REQUEST_METHOD'] === 'POST') {\n    $input_password = $_POST['password'] ?? '';\n    $input_password = preg_replace('/\\D+/', '', $input_password); // ìˆ«ìë§Œ ì¶”ì¶œ\n    \n    if (empty($input_password)) {\n        $error_message = $t['password_required'];\n    } else {\n        // Check if password matches any adjudicator\n        $found_adjudicator = null;\n        foreach ($adjudicators as $adjudicator) {\n            if ($adjudicator['password'] === $input_password) {\n                $found_adjudicator = $adjudicator;\n                break;\n            }\n        }\n        \n        if ($found_adjudicator) {\n            // Store adjudicator info in session\n            $_SESSION['scoring_logged_in'] = true;\n            $_SESSION['scoring_judge_id'] = $found_adjudicator['id'];\n            $_SESSION['scoring_judge_name'] = $found_adjudicator['name'];\n            $_SESSION['scoring_judge_country'] = $found_adjudicator['country'];\n            $_SESSION['scoring_comp_id'] = $comp_id;\n            \n            // Redirect to scoring dashboard\n            header(\"Location: scoring_dashboard.php?comp_id=\" . urlencode($comp_id) . \"&lang=\" . urlencode($lang));\n            exit;\n        } else {\n            $error_message = $t['invalid_password'];\n        }\n    }\n}\n\nfunction h($s) { return htmlspecialchars($s ?? ''); }\n?>\n<!DOCTYPE html>\n<html lang=\"<?=h($lang)?>\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title><?=h($t['title'])?> | <?=h($info['title'])?></title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\n    <style>\n        * {\n            box-sizing: border-box;\n        }\n        \n        body { \n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; \n            margin: 0; \n            padding: 20px;\n            min-height: 100vh;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n        }\n        \n        .login-container { \n            background: #fff; \n            border-radius: 12px; \n            padding: 30px 25px; \n            box-shadow: 0 8px 25px rgba(0,0,0,0.15);\n            width: 100%;\n            max-width: 420px;\n            text-align: center;\n            margin: 0 0 20px 0;\n        }\n        \n        h1 { \n            color: #333; \n            margin-bottom: 8px; \n            font-size: 1.5em;\n            font-weight: 700;\n        }\n        \n        .comp-info {\n            color: #666;\n            margin-bottom: 25px;\n            font-size: 0.85em;\n            line-height: 1.4;\n        }\n        \n        .form-group {\n            margin-bottom: 18px;\n            text-align: left;\n        }\n        \n        label {\n            display: block;\n            margin-bottom: 6px;\n            color: #333;\n            font-weight: 600;\n            font-size: 14px;\n        }\n        \n        input[type=\"password\"] {\n            width: 100%;\n            padding: 14px 16px;\n            border: 2px solid #ddd;\n            border-radius: 8px;\n            font-size: 16px;\n            box-sizing: border-box;\n            transition: border-color 0.3s;\n            background: #fafafa;\n        }\n        \n        input[type=\"password\"]:focus {\n            outline: none;\n            border-color: #667eea;\n            background: #fff;\n        }\n        \n        .login-btn {\n            width: 100%;\n            background: #667eea;\n            color: #fff;\n            border: none;\n            padding: 14px;\n            border-radius: 8px;\n            font-size: 16px;\n            font-weight: 600;\n            cursor: pointer;\n            transition: all 0.2s;\n            margin-bottom: 15px;\n        }\n        \n        .login-btn:active {\n            background: #5a6fd8;\n            transform: translateY(1px);\n        }\n        \n        .error {\n            background: #f8d7da;\n            color: #721c24;\n            padding: 12px;\n            border-radius: 6px;\n            margin-bottom: 18px;\n            border: 1px solid #f5c6cb;\n            font-size: 14px;\n        }\n        \n        \n        .lang-switch {\n            position: absolute;\n            top: 15px;\n            right: 15px;\n            background: #667eea;\n            color: #fff;\n            border: none;\n            padding: 8px 30px 8px 12px;\n            border-radius: 6px;\n            font-size: 12px;\n            font-weight: 600;\n            cursor: pointer;\n            text-decoration: none;\n            transition: all 0.2s;\n            appearance: none;\n            -webkit-appearance: none;\n            -moz-appearance: none;\n            background-image: url(\"data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e\");\n            background-repeat: no-repeat;\n            background-position: right 8px center;\n            background-size: 12px;\n        }\n        \n        .lang-switch:active {\n            background-color: #5a6fd8;\n            transform: translateY(1px);\n        }\n        \n        .lang-switch option {\n            background: #667eea;\n            color: #fff;\n            padding: 8px;\n        }\n        \n        .login-container {\n            position: relative;\n        }\n        \n        /* íƒœë¸”ë¦¿ í™˜ê²½ (768px ì´ìƒ) */\n        @media (min-width: 768px) {\n            body {\n                padding: 20px;\n            }\n            \n            .login-container {\n                padding: 35px 30px;\n                border-radius: 15px;\n                max-width: 450px;\n                margin: 0 0 25px 0;\n            }\n            \n            h1 {\n                font-size: 1.8em;\n                margin-bottom: 10px;\n            }\n            \n            .comp-info {\n                font-size: 0.9em;\n                margin-bottom: 30px;\n            }\n            \n            .form-group {\n                margin-bottom: 20px;\n            }\n            \n            input[type=\"password\"] {\n                padding: 12px 15px;\n                font-size: 16px;\n            }\n            \n            .login-btn {\n                padding: 12px;\n                font-size: 16px;\n            }\n            \n            .lang-switch {\n                top: 20px;\n                right: 20px;\n                padding: 10px 32px 10px 14px;\n                font-size: 13px;\n            }\n        }\n        \n        /* í° íƒœë¸”ë¦¿/ë°ìŠ¤í¬í†± (1024px ì´ìƒ) */\n        @media (min-width: 1024px) {\n            .login-container {\n                padding: 40px 35px;\n                max-width: 480px;\n                margin: 0 0 30px 0;\n            }\n            \n            .login-btn:hover {\n                background: #5a6fd8;\n            }\n            \n            \n            .lang-switch {\n                top: 30px;\n                right: 30px;\n                padding: 10px 36px 10px 16px;\n                font-size: 14px;\n            }\n            \n            .lang-switch:hover {\n                background: #5a6fd8;\n            }\n        }\n    </style>\n</head>\n<body>\n<div class=\"login-container\">\n    <select class=\"lang-switch\" onchange=\"window.location.href='?comp_id=<?=h($comp_id)?>&lang=' + this.value\">\n        <option value=\"ko\" <?=$lang === 'ko' ? 'selected' : ''?>>í•œêµ­ì–´</option>\n        <option value=\"en\" <?=$lang === 'en' ? 'selected' : ''?>>English</option>\n        <option value=\"zh\" <?=$lang === 'zh' ? 'selected' : ''?>>ä¸­æ–‡</option>\n        <option value=\"ja\" <?=$lang === 'ja' ? 'selected' : ''?>>æ—¥æœ¬èª</option>\n    </select>\n    \n    <h1><?=h($t['title'])?></h1>\n    <div class=\"comp-info\">\n        <strong><?=h($info['title'])?></strong><br>\n        <?=h($info['date'])?> | <?=h($info['place'])?>\n    </div>\n    \n    <?php if ($error_message): ?>\n        <div class=\"error\"><?=h($error_message)?></div>\n    <?php endif; ?>\n    \n    <form method=\"post\">\n        <div class=\"form-group\">\n            <label for=\"password\"><?=h($t['password_label'])?></label>\n            <input type=\"password\" \n                   id=\"password\" \n                   name=\"password\" \n                   placeholder=\"<?=h($t['password_placeholder'])?>\" \n                   maxlength=\"4\"\n                   pattern=\"[0-9]{3,4}\"\n                   required>\n        </div>\n        <button type=\"submit\" class=\"login-btn\"><?=h($t['login'])?></button>\n    </form>\n    \n</div>\n\n<footer style=\"text-align: center; margin-top: 20px; color: rgba(255,255,255,0.8); font-size: 0.9em; width: 100%;\">\n    2025 danceoffice.net | Powered by Seyoung Lee\n</footer>\n\n<script>\n// Only allow numbers\ndocument.getElementById('password').addEventListener('input', function(e) {\n    this.value = this.value.replace(/[^0-9]/g, '');\n});\n\n// Auto-focus\ndocument.getElementById('password').focus();\n</script>\n</body>\n</html>\n","size_bytes":11855},"comp/scoring_logout.php":{"content":"<?php\nsession_start();\n\n$comp_id = $_GET['comp_id'] ?? '';\n$comp_id = preg_replace('/\\x{FEFF}/u', '', $comp_id);\n$comp_id = preg_replace('/[^\\d-]/', '', $comp_id);\n\n// Clear scoring session\nunset($_SESSION['scoring_logged_in']);\nunset($_SESSION['scoring_judge_id']);\nunset($_SESSION['scoring_judge_name']);\nunset($_SESSION['scoring_judge_country']);\nunset($_SESSION['scoring_comp_id']);\n\n// Redirect to login page\nheader(\"Location: scoring_login.php?comp_id=\" . urlencode($comp_id));\nexit;\n?>\n","size_bytes":493},"comp/select_judges.php":{"content":"<?php\nsession_start();\nrequire_once 'auth.php';\nrequire_once 'judge_manager.php';\n\n// ì˜¤ë„ˆ ê¶Œí•œë§Œ ì ‘ê·¼ ê°€ëŠ¥\nrequirePermission('manage_users');\n\n$user = $_SESSION['user'];\n$comp_id = $_GET['comp_id'] ?? '';\n\nif (!$comp_id) {\n    die(\"ëŒ€íšŒ IDê°€ í•„ìš”í•©ë‹ˆë‹¤.\");\n}\n\n// ëŒ€íšŒ ì •ë³´ ë¡œë“œ\n$data_dir = __DIR__ . '/data';\n$comp_path = \"$data_dir/$comp_id\";\n$info_file = \"$comp_path/info.json\";\n\nif (!file_exists($info_file)) {\n    die(\"ëŒ€íšŒ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\");\n}\n\n$comp_info = json_decode(file_get_contents($info_file), true);\n\n// ì‹¬ì‚¬ìœ„ì› ì„ íƒ ì²˜ë¦¬\nif ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['select_judges'])) {\n    $selected_judges = $_POST['judges'] ?? [];\n    $comp_info['selected_judges'] = $selected_judges;\n    file_put_contents($info_file, json_encode($comp_info, JSON_UNESCAPED_UNICODE|JSON_PRETTY_PRINT));\n    $message = \"ì‹¬ì‚¬ìœ„ì›ì´ ì„ íƒë˜ì—ˆìŠµë‹ˆë‹¤.\";\n}\n\n$judges = loadJudges();\n$selected_judges = $comp_info['selected_judges'] ?? [];\n\nfunction h($s) { return htmlspecialchars($s ?? ''); }\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>ì‹¬ì‚¬ìœ„ì› ì„ íƒ | danceoffice.net</title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\n    <link href=\"https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded\" rel=\"stylesheet\" />\n    <style>\n        body {\n            background: #181B20;\n            min-height: 100vh;\n            font-size: 14px;\n            line-height: 1.5;\n            margin: 0;\n            padding: 0;\n            font-family: 'Noto Sans KR', sans-serif;\n        }\n        \n        .container {\n            max-width: 1200px;\n            margin: 0 auto;\n            padding: 20px;\n        }\n        \n        .header {\n            background: linear-gradient(135deg, #1a1d21 0%, #181B20 100%);\n            border-radius: 15px;\n            padding: 25px;\n            margin-bottom: 20px;\n            box-shadow: 0 8px 25px rgba(3, 199, 90, 0.15);\n            border: 2px solid #03C75A;\n            text-align: center;\n        }\n        \n        .header h1 {\n            color: #03C75A;\n            font-size: 24px;\n            margin: 0 0 10px 0;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 10px;\n        }\n        \n        .comp-info {\n            background: #181B20;\n            border-radius: 8px;\n            padding: 15px;\n            margin-bottom: 20px;\n            border: 1px solid #31343a;\n        }\n        \n        .comp-info h4 {\n            color: #03C75A;\n            margin: 0 0 10px 0;\n        }\n        \n        .judges-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));\n            gap: 15px;\n        }\n        \n        .judge-card {\n            background: #222;\n            border-radius: 12px;\n            padding: 15px;\n            border: 2px solid #31343a;\n            transition: all 0.3s ease;\n            cursor: pointer;\n        }\n        \n        .judge-card:hover {\n            border-color: #03C75A;\n        }\n        \n        .judge-card.selected {\n            border-color: #03C75A;\n            background: rgba(3, 199, 90, 0.1);\n        }\n        \n        .judge-photo {\n            width: 60px;\n            height: 60px;\n            border-radius: 50%;\n            object-fit: cover;\n            margin: 0 auto 10px auto;\n            display: block;\n            border: 2px solid #03C75A;\n        }\n        \n        .judge-name {\n            color: #03C75A;\n            font-size: 14px;\n            font-weight: 600;\n            text-align: center;\n            margin-bottom: 8px;\n        }\n        \n        .judge-info {\n            color: #F5F7FA;\n            font-size: 11px;\n            margin-bottom: 5px;\n            text-align: center;\n        }\n        \n        .btn {\n            background: linear-gradient(90deg, #03C75A 70%, #00BFAE 100%);\n            color: #222;\n            border: none;\n            padding: 12px 24px;\n            border-radius: 20px;\n            font-weight: 600;\n            font-size: 14px;\n            cursor: pointer;\n            transition: all 0.3s ease;\n            margin-top: 20px;\n        }\n        \n        .btn:hover {\n            background: linear-gradient(90deg, #00BFAE 60%, #03C75A 100%);\n            color: white;\n            transform: translateY(-2px);\n        }\n        \n        .message {\n            color: #03C75A;\n            background: rgba(3, 199, 90, 0.1);\n            padding: 10px;\n            border-radius: 8px;\n            margin-bottom: 15px;\n            font-size: 13px;\n        }\n        \n        .selected-count {\n            background: #03C75A;\n            color: #222;\n            padding: 8px 16px;\n            border-radius: 20px;\n            font-weight: 600;\n            margin-bottom: 20px;\n            display: inline-block;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <header class=\"header\">\n            <h1>\n                <span class=\"material-symbols-rounded\">gavel</span>\n                ì‹¬ì‚¬ìœ„ì› ì„ íƒ\n            </h1>\n            <div class=\"comp-info\">\n                <h4><?= h($comp_info['title']) ?></h4>\n                <p><?= h($comp_info['date']) ?> | <?= h($comp_info['place']) ?></p>\n            </div>\n        </header>\n        \n        <?php if (isset($message)): ?>\n            <div class=\"message\"><?= h($message) ?></div>\n        <?php endif; ?>\n        \n        <form method=\"post\">\n            <div class=\"selected-count\" id=\"selectedCount\">\n                ì„ íƒëœ ì‹¬ì‚¬ìœ„ì›: 0ëª…\n            </div>\n            \n            <div class=\"judges-grid\">\n                <?php foreach ($judges as $judge): ?>\n                    <div class=\"judge-card\" onclick=\"toggleJudge('<?= h($judge['id']) ?>')\">\n                        <input type=\"checkbox\" \n                               name=\"judges[]\" \n                               value=\"<?= h($judge['id']) ?>\" \n                               id=\"judge_<?= h($judge['id']) ?>\"\n                               <?= in_array($judge['id'], $selected_judges) ? 'checked' : '' ?>\n                               style=\"display: none;\">\n                        \n                        <?php if ($judge['photo'] && file_exists(__DIR__ . '/judges_photos/' . $judge['photo'])): ?>\n                            <img src=\"judges_photos/<?= h($judge['photo']) ?>\" class=\"judge-photo\" alt=\"<?= h($judge['name']) ?>\">\n                        <?php else: ?>\n                            <div class=\"judge-photo\" style=\"background: #31343a; display: flex; align-items: center; justify-content: center; color: #8A8D93;\">\n                                <span class=\"material-symbols-rounded\">person</span>\n                            </div>\n                        <?php endif; ?>\n                        \n                        <div class=\"judge-name\"><?= h($judge['name']) ?></div>\n                        <div class=\"judge-info\"><?= h($judge['organization']) ?></div>\n                        <div class=\"judge-info\"><?= h($judge['region']) ?> | <?= h($judge['specialty']) ?></div>\n                    </div>\n                <?php endforeach; ?>\n            </div>\n            \n            <div style=\"text-align: center;\">\n                <button type=\"submit\" name=\"select_judges\" class=\"btn\">\n                    <span class=\"material-symbols-rounded\">save</span>\n                    ì‹¬ì‚¬ìœ„ì› ì„ íƒ ì™„ë£Œ\n                </button>\n            </div>\n        </form>\n    </div>\n    \n    <script>\n        function toggleJudge(judgeId) {\n            const checkbox = document.getElementById('judge_' + judgeId);\n            const card = checkbox.closest('.judge-card');\n            \n            checkbox.checked = !checkbox.checked;\n            card.classList.toggle('selected', checkbox.checked);\n            updateSelectedCount();\n        }\n        \n        function updateSelectedCount() {\n            const checkboxes = document.querySelectorAll('input[name=\"judges[]\"]:checked');\n            const countElement = document.getElementById('selectedCount');\n            countElement.textContent = 'ì„ íƒëœ ì‹¬ì‚¬ìœ„ì›: ' + checkboxes.length + 'ëª…';\n        }\n        \n        // ì´ˆê¸° ì„ íƒ ìƒíƒœ ì„¤ì •\n        document.addEventListener('DOMContentLoaded', function() {\n            const checkboxes = document.querySelectorAll('input[name=\"judges[]\"]');\n            checkboxes.forEach(checkbox => {\n                const card = checkbox.closest('.judge-card');\n                if (checkbox.checked) {\n                    card.classList.add('selected');\n                }\n            });\n            updateSelectedCount();\n        });\n    </script>\n</body>\n</html>\n\n\n\n\n\n\n","size_bytes":8787},"comp/senior_dashboard.php":{"content":"<?php\nsession_start();\nrequire_once 'auth.php';\n\n// ê¶Œí•œ í™•ì¸\nrequirePermission('view_all_comps');\n\n$user = $_SESSION['user'];\n\n// ëŒ€íšŒ ëª©ë¡ ë¡œë“œ\n$data_dir = __DIR__ . '/data';\nfunction load_competitions($data_dir) {\n    $comps = [];\n    if (!is_dir($data_dir)) return $comps;\n    foreach (glob($data_dir . \"/*/info.json\") as $info_file) {\n        $comp_id = basename(dirname($info_file));\n        $info = json_decode(file_get_contents($info_file), true);\n        if ($info) {\n            $info['id'] = $comp_id;\n            $comps[] = $info;\n        }\n    }\n    usort($comps, function($a, $b) {\n        return ($b['created'] ?? 0) <=> ($a['created'] ?? 0);\n    });\n    return $comps;\n}\n\n$all_comps = load_competitions($data_dir);\n\n// í˜„ì¬ ì‚¬ìš©ìê°€ ë‹´ë‹¹í•˜ëŠ” ëŒ€íšŒë§Œ í•„í„°ë§\n$comps = array_filter($all_comps, function($comp) use ($user) {\n    return isset($comp['assigned_admin']) && $comp['assigned_admin'] === $user['username'];\n});\n\nfunction h($s) { return htmlspecialchars($s ?? ''); }\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>ì„ ì„ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ | danceoffice.net</title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\n    <link href=\"https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded\" rel=\"stylesheet\" />\n    <style>\n        /* PC ë²„ì „ ìŠ¤íƒ€ì¼ */\n        @media (min-width: 1024px) {\n            body {\n                background: #181B20;\n                min-height: 100vh;\n                font-size: 14px;\n                line-height: 1.5;\n                margin: 0;\n                padding: 0;\n                font-family: 'Noto Sans KR', sans-serif;\n            }\n            \n            .dashboard-container {\n                max-width: 1200px;\n                margin: 0 auto;\n                padding: 20px;\n            }\n            \n            .dashboard-header {\n                background: linear-gradient(135deg, #1a1d21 0%, #181B20 100%);\n                border-radius: 15px;\n                padding: 25px;\n                margin-bottom: 20px;\n                box-shadow: 0 8px 25px rgba(3, 199, 90, 0.15);\n                border: 2px solid #03C75A;\n                position: relative;\n                overflow: hidden;\n                text-align: center;\n            }\n            \n            .dashboard-header::before {\n                content: '';\n                position: absolute;\n                top: -50%;\n                right: -50%;\n                width: 200%;\n                height: 200%;\n                background: radial-gradient(circle, rgba(3, 199, 90, 0.08) 0%, transparent 70%);\n                animation: float 6s ease-in-out infinite;\n            }\n            \n            @keyframes float {\n                0%, 100% { transform: translateY(0px) rotate(0deg); }\n                50% { transform: translateY(-15px) rotate(180deg); }\n            }\n            \n            .dashboard-title {\n                color: #03C75A;\n                font-size: 24px;\n                margin: 0 0 10px 0;\n                position: relative;\n                z-index: 2;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                gap: 10px;\n            }\n            \n            .dashboard-subtitle {\n                color: #00BFAE;\n                font-size: 16px;\n                margin: 0;\n                position: relative;\n                z-index: 2;\n            }\n            \n            .user-info {\n                background: rgba(3, 199, 90, 0.1);\n                border-radius: 10px;\n                padding: 15px;\n                margin: 20px 0;\n                position: relative;\n                z-index: 2;\n            }\n            \n            .user-info strong {\n                color: #03C75A;\n            }\n            \n            .dashboard-nav {\n                display: flex;\n                gap: 15px;\n                margin-top: 20px;\n                position: relative;\n                z-index: 2;\n                justify-content: center;\n            }\n            \n            .dashboard-nav a {\n                color: white;\n                text-decoration: none;\n                font-weight: 600;\n                font-size: 14px;\n                padding: 10px 20px;\n                border-radius: 20px;\n                background: rgba(3, 199, 90, 0.1);\n                backdrop-filter: blur(10px);\n                transition: all 0.3s ease;\n                display: flex;\n                align-items: center;\n                gap: 5px;\n            }\n            \n            .dashboard-nav a:hover {\n                background: #03C75A;\n                color: #222;\n                transform: translateY(-2px);\n            }\n            \n            .comps-list {\n                background: #222;\n                border-radius: 15px;\n                padding: 25px;\n                box-shadow: 0 8px 25px rgba(3, 199, 90, 0.08);\n                border: 1px solid #31343a;\n            }\n            \n            .comps-list h3 {\n                color: #03C75A;\n                font-size: 18px;\n                margin: 0 0 20px 0;\n                display: flex;\n                align-items: center;\n                gap: 10px;\n            }\n            \n            .comps-table {\n                width: 100%;\n                border-collapse: collapse;\n                background: #181B20;\n                border-radius: 8px;\n                overflow: hidden;\n            }\n            \n            .comps-table th {\n                background: #1E2126;\n                color: #03C75A;\n                font-weight: 600;\n                font-size: 13px;\n                padding: 15px 10px;\n                text-align: center;\n                border-bottom: 1px solid #31343a;\n            }\n            \n            .comps-table td {\n                color: #F5F7FA;\n                font-size: 13px;\n                padding: 15px 10px;\n                text-align: center;\n                border-bottom: 1px solid #31343a;\n            }\n            \n            .comps-table tr:last-child td {\n                border-bottom: none;\n            }\n            \n            .dash-btn {\n                background: linear-gradient(90deg, #03C75A 70%, #00BFAE 100%);\n                color: #222;\n                text-decoration: none;\n                padding: 8px 16px;\n                border-radius: 16px;\n                font-size: 12px;\n                font-weight: 600;\n                transition: all 0.3s ease;\n                display: inline-flex;\n                align-items: center;\n                gap: 5px;\n            }\n            \n            .dash-btn:hover {\n                background: linear-gradient(90deg, #00BFAE 60%, #03C75A 100%);\n                color: white;\n                transform: translateY(-2px);\n            }\n            \n            .logout-btn {\n                background: linear-gradient(90deg, #ff4444 70%, #cc0000 100%);\n                color: white;\n                text-decoration: none;\n                padding: 8px 16px;\n                border-radius: 16px;\n                font-size: 12px;\n                font-weight: 600;\n                transition: all 0.3s ease;\n                display: inline-flex;\n                align-items: center;\n                gap: 5px;\n            }\n            \n            .logout-btn:hover {\n                background: linear-gradient(90deg, #cc0000 60%, #ff4444 100%);\n                transform: translateY(-2px);\n            }\n            \n            .none-msg {\n                text-align: center;\n                color: #8A8D93;\n                font-size: 14px;\n                padding: 40px 20px;\n            }\n            \n            .dashboard-footer {\n                text-align: center;\n                color: #03C75A;\n                padding: 20px;\n                font-size: 12px;\n                margin-top: 20px;\n            }\n        }\n        \n        /* ëª¨ë°”ì¼ ë²„ì „ ìŠ¤íƒ€ì¼ */\n        @media (max-width: 1023px) {\n            body {\n                background: #181B20;\n                min-height: 100vh;\n                font-size: 14px;\n                line-height: 1.5;\n                margin: 0;\n                padding: 0;\n                font-family: 'Noto Sans KR', sans-serif;\n            }\n            \n            .dashboard-container {\n                padding: 10px;\n            }\n            \n            .dashboard-header {\n                background: rgba(26, 29, 33, 0.9);\n                backdrop-filter: blur(20px);\n                border-radius: 15px;\n                padding: 20px;\n                margin-bottom: 15px;\n                box-shadow: 0 8px 25px rgba(3, 199, 90, 0.15);\n                border: 2px solid #03C75A;\n                text-align: center;\n            }\n            \n            .dashboard-title {\n                color: #03C75A;\n                font-size: 20px;\n                margin: 0 0 8px 0;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                gap: 8px;\n            }\n            \n            .dashboard-subtitle {\n                color: #00BFAE;\n                font-size: 14px;\n                margin: 0;\n            }\n            \n            .user-info {\n                background: rgba(3, 199, 90, 0.1);\n                border-radius: 8px;\n                padding: 12px;\n                margin: 15px 0;\n                font-size: 12px;\n            }\n            \n            .dashboard-nav {\n                display: flex;\n                gap: 10px;\n                margin-top: 15px;\n                flex-wrap: wrap;\n                justify-content: center;\n            }\n            \n            .dashboard-nav a {\n                color: white;\n                text-decoration: none;\n                font-weight: 600;\n                font-size: 13px;\n                padding: 8px 16px;\n                border-radius: 16px;\n                background: rgba(3, 199, 90, 0.2);\n                backdrop-filter: blur(10px);\n                transition: all 0.3s ease;\n                display: flex;\n                align-items: center;\n                gap: 5px;\n            }\n            \n            .dashboard-nav a:hover {\n                background: #03C75A;\n                color: #222;\n            }\n            \n            .comps-list {\n                background: rgba(34, 34, 34, 0.95);\n                backdrop-filter: blur(20px);\n                border-radius: 15px;\n                padding: 20px;\n                box-shadow: 0 8px 25px rgba(3, 199, 90, 0.08);\n                border: 1px solid #31343a;\n            }\n            \n            .comps-list h3 {\n                color: #03C75A;\n                font-size: 16px;\n                margin: 0 0 15px 0;\n                display: flex;\n                align-items: center;\n                gap: 8px;\n            }\n            \n            .comps-table {\n                width: 100%;\n                border-collapse: collapse;\n                background: #181B20;\n                border-radius: 8px;\n                overflow: hidden;\n                font-size: 12px;\n            }\n            \n            .comps-table th {\n                background: #1E2126;\n                color: #03C75A;\n                font-weight: 600;\n                font-size: 11px;\n                padding: 12px 8px;\n                text-align: center;\n                border-bottom: 1px solid #31343a;\n            }\n            \n            .comps-table td {\n                color: #F5F7FA;\n                font-size: 11px;\n                padding: 12px 8px;\n                text-align: center;\n                border-bottom: 1px solid #31343a;\n            }\n            \n            .dash-btn {\n                background: linear-gradient(90deg, #03C75A 70%, #00BFAE 100%);\n                color: #222;\n                text-decoration: none;\n                padding: 6px 12px;\n                border-radius: 12px;\n                font-size: 10px;\n                font-weight: 600;\n                transition: all 0.3s ease;\n                display: inline-flex;\n                align-items: center;\n                gap: 4px;\n            }\n            \n            .logout-btn {\n                background: linear-gradient(90deg, #ff4444 70%, #cc0000 100%);\n                color: white;\n                text-decoration: none;\n                padding: 6px 12px;\n                border-radius: 12px;\n                font-size: 10px;\n                font-weight: 600;\n                transition: all 0.3s ease;\n                display: inline-flex;\n                align-items: center;\n                gap: 4px;\n            }\n            \n            .none-msg {\n                text-align: center;\n                color: #8A8D93;\n                font-size: 13px;\n                padding: 30px 15px;\n            }\n            \n            .dashboard-footer {\n                text-align: center;\n                color: #03C75A;\n                padding: 15px;\n                font-size: 11px;\n                margin-top: 15px;\n            }\n        }\n        \n        /* ê³µí†µ ìŠ¤íƒ€ì¼ */\n        .material-symbols-rounded {\n            font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 24;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"dashboard-container\">\n        <header class=\"dashboard-header\">\n            <h1 class=\"dashboard-title\">\n                <span class=\"material-symbols-rounded\">admin_panel_settings</span>\n                ì„ ì„ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ\n            </h1>\n            <p class=\"dashboard-subtitle\">danceoffice.net ëŒ€íšŒ ê´€ë¦¬ ì‹œìŠ¤í…œ</p>\n            \n            <div class=\"user-info\">\n                <strong><?= h($user['username']) ?></strong> - <?= getRoleDisplayName($user['role']) ?>\n            </div>\n            \n            <nav class=\"dashboard-nav\">\n                <a href=\"/\">\n                    <span class=\"material-symbols-rounded\">home</span>\n                    ë©”ì¸ìœ¼ë¡œ\n                </a>\n                <a href=\"/manage/\">\n                    <span class=\"material-symbols-rounded\">admin_panel_settings</span>\n                    ê´€ë¦¬ì í˜ì´ì§€\n                </a>\n                <a href=\"/results/\">\n                    <span class=\"material-symbols-rounded\">sports_score</span>\n                    ê²½ê¸° ê²°ê³¼\n                </a>\n                <a href=\"logout.php\" class=\"logout-btn\">\n                    <span class=\"material-symbols-rounded\">logout</span>\n                    ë¡œê·¸ì•„ì›ƒ\n                </a>\n            </nav>\n        </header>\n        \n        <div class=\"comps-list\">\n            <h3>\n                <span class=\"material-symbols-rounded\">list</span>\n                ë‹´ë‹¹ ëŒ€íšŒ ëª©ë¡\n            </h3>\n            <?php if (empty($comps)): ?>\n                <div class=\"none-msg\">ë“±ë¡ëœ ëŒ€íšŒê°€ ì—†ìŠµë‹ˆë‹¤.</div>\n            <?php else: ?>\n                <table class=\"comps-table\">\n                    <thead>\n                        <tr>\n                            <th>ëŒ€íšŒëª…</th>\n                            <th>ì¼ì</th>\n                            <th>ì¥ì†Œ</th>\n                            <th>ì£¼ìµœ</th>\n                            <th>ê´€ë¦¬</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <?php foreach ($comps as $comp): ?>\n                            <tr>\n                                <td><?= h($comp['title']) ?></td>\n                                <td><?= h($comp['date']) ?></td>\n                                <td><?= h($comp['place']) ?></td>\n                                <td><?= h($comp['host']) ?></td>\n                                <td>\n                                    <a class=\"dash-btn\" href=\"dashboard.php?comp_id=<?= urlencode($comp['id']) ?>\">\n                                        <span class=\"material-symbols-rounded\">dashboard</span>\n                                        ëŒ€ì‹œë³´ë“œ\n                                    </a>\n                                </td>\n                            </tr>\n                        <?php endforeach; ?>\n                    </tbody>\n                </table>\n            <?php endif; ?>\n        </div>\n        \n        <footer class=\"dashboard-footer\">\n            &copy; 2025 danceoffice.net | Powered by Seyoung Lee\n        </footer>\n    </div>\n</body>\n</html>\n","size_bytes":16461},"comp/simple_fullscreen.php":{"content":"<?php\n/**\n * ê°„ë‹¨í•œ ì „ì²´í™”ë©´ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ\n * iframe ë¬¸ì œ í•´ê²°ì„ ìœ„í•œ ë‹¨ìˆœí™”ëœ ë²„ì „\n */\n\nrequire_once 'result_monitor.php';\n\n$monitor = new ResultMonitor();\n$pairs = $monitor->findResultPairs();\n\n$currentEvent = isset($_GET['event']) ? $_GET['event'] : (count($pairs) > 0 ? $pairs[0]['event_id'] : '');\n$mode = isset($_GET['mode']) ? $_GET['mode'] : 'results';\n$autoRotate = isset($_GET['auto']) ? $_GET['auto'] : 'true';\n\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>ì „ì²´í™”ë©´ ëª¨ë‹ˆí„°ë§</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n        \n        html, body {\n            width: 100%;\n            height: 100%;\n            overflow: hidden;\n        }\n        \n        body {\n            font-family: 'Arial', sans-serif;\n            background: #000;\n            color: #fff;\n        }\n        \n        .screen {\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100vw;\n            height: 100vh;\n            display: none;\n        }\n        \n        .screen.active {\n            display: block;\n        }\n        \n        /* ëŒ€ê¸°í™”ë©´ */\n        .waiting-screen {\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            text-align: center;\n            animation: pulse 2s infinite;\n        }\n        \n        .waiting-screen h1 {\n            font-size: 4em;\n            margin-bottom: 30px;\n            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);\n        }\n        \n        .waiting-screen p {\n            font-size: 2em;\n            opacity: 0.9;\n        }\n        \n        /* ë¡œê³  í™”ë©´ */\n        .logo-screen {\n            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            text-align: center;\n        }\n        \n        .logo-screen img {\n            max-width: 80%;\n            max-height: 60%;\n            margin-bottom: 30px;\n        }\n        \n        .logo-screen h1 {\n            font-size: 3em;\n            margin-bottom: 20px;\n        }\n        \n        .logo-screen p {\n            font-size: 1.5em;\n            opacity: 0.9;\n        }\n        \n        /* ê²°ê³¼ í™”ë©´ */\n        .results-screen {\n            background: #f5f5f5;\n            color: #333;\n        }\n        \n        .results-content {\n            width: 100%;\n            height: 100%;\n            border: none;\n            display: block;\n        }\n        \n        /* ì œì–´ íŒ¨ë„ */\n        .control-panel {\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            z-index: 1000;\n            background: rgba(0,0,0,0.8);\n            padding: 15px;\n            border-radius: 10px;\n            display: flex;\n            gap: 10px;\n            opacity: 0;\n            transition: opacity 0.3s;\n        }\n        \n        .control-panel:hover {\n            opacity: 1;\n        }\n        \n        .control-btn {\n            background: #667eea;\n            color: white;\n            border: none;\n            padding: 10px 15px;\n            border-radius: 5px;\n            cursor: pointer;\n            font-size: 14px;\n            transition: background 0.3s;\n        }\n        \n        .control-btn:hover {\n            background: #5a6fd8;\n        }\n        \n        .control-btn.active {\n            background: #28a745;\n        }\n        \n        .control-btn.danger {\n            background: #dc3545;\n        }\n        \n        /* ìƒíƒœ í‘œì‹œ */\n        .status-bar {\n            position: fixed;\n            bottom: 20px;\n            left: 20px;\n            background: rgba(0,0,0,0.8);\n            color: white;\n            padding: 10px 15px;\n            border-radius: 5px;\n            font-size: 14px;\n        }\n        \n        /* ì• ë‹ˆë©”ì´ì…˜ */\n        @keyframes pulse {\n            0% { transform: scale(1); }\n            50% { transform: scale(1.05); }\n            100% { transform: scale(1); }\n        }\n        \n        @keyframes fadeIn {\n            from { opacity: 0; transform: translateY(20px); }\n            to { opacity: 1; transform: translateY(0); }\n        }\n        \n        .fade-in {\n            animation: fadeIn 0.5s ease-in-out;\n        }\n        \n        /* ë°˜ì‘í˜• */\n        @media (max-width: 768px) {\n            .waiting-screen h1 { font-size: 2.5em; }\n            .waiting-screen p { font-size: 1.5em; }\n            .logo-screen h1 { font-size: 2em; }\n            .logo-screen p { font-size: 1.2em; }\n        }\n    </style>\n</head>\n<body>\n    <!-- ëŒ€ê¸°í™”ë©´ -->\n    <div id=\"waitingScreen\" class=\"screen waiting-screen\">\n        <h1>ğŸ† ëŒ„ìŠ¤ìŠ¤í¬ì¸  ëŒ€íšŒ</h1>\n        <p>ê²°ê³¼ë¥¼ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”...</p>\n    </div>\n    \n    <!-- ë¡œê³  í™”ë©´ -->\n    <div id=\"logoScreen\" class=\"screen logo-screen\">\n        <img src=\"assets/danceoffice-logo.png\" alt=\"DanceOffice ë¡œê³ \" onerror=\"this.style.display='none'\">\n        <h1>DanceOffice</h1>\n        <p>ëŒ„ìŠ¤ìŠ¤í¬ì¸  ê´€ë¦¬ ì‹œìŠ¤í…œ</p>\n    </div>\n    \n    <!-- ê²°ê³¼ í™”ë©´ -->\n    <div id=\"resultsScreen\" class=\"screen results-screen\">\n        <?php if ($currentEvent && $mode === 'results'): ?>\n            <iframe src=\"combined_result_<?php echo htmlspecialchars($currentEvent); ?>.html\" \n                    class=\"results-content\" id=\"resultFrame\"></iframe>\n        <?php else: ?>\n            <div style=\"display: flex; justify-content: center; align-items: center; height: 100vh; font-size: 2em; color: #666;\">\n                ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...\n            </div>\n        <?php endif; ?>\n    </div>\n    \n    <!-- ì œì–´ íŒ¨ë„ -->\n    <div class=\"control-panel\" id=\"controlPanel\">\n        <button class=\"control-btn\" onclick=\"showMode('waiting')\">â³ ëŒ€ê¸°í™”ë©´</button>\n        <button class=\"control-btn\" onclick=\"showMode('logo')\">ğŸ¢ ë¡œê³ </button>\n        <button class=\"control-btn\" onclick=\"showMode('results')\">ğŸ“Š ê²°ê³¼</button>\n        <button class=\"control-btn\" onclick=\"toggleAutoRotate()\">ğŸ”„ ìë™ìˆœí™˜</button>\n        <button class=\"control-btn\" onclick=\"previousEvent()\">â¬…ï¸ ì´ì „</button>\n        <button class=\"control-btn\" onclick=\"nextEvent()\">ë‹¤ìŒ â¡ï¸</button>\n        <button class=\"control-btn danger\" onclick=\"exitFullscreen()\">âŒ ì¢…ë£Œ</button>\n    </div>\n    \n    <!-- ìƒíƒœ í‘œì‹œ -->\n    <div class=\"status-bar\" id=\"statusBar\">\n        í˜„ì¬ ëª¨ë“œ: <span id=\"currentMode\"><?php echo $mode; ?></span> | \n        ì´ë²¤íŠ¸: <span id=\"currentEvent\"><?php echo $currentEvent; ?></span> | \n        ìë™ìˆœí™˜: <span id=\"autoStatus\"><?php echo $autoRotate === 'true' ? 'ON' : 'OFF'; ?></span>\n    </div>\n\n    <script>\n        let currentMode = '<?php echo $mode; ?>';\n        let currentEvent = '<?php echo $currentEvent; ?>';\n        let autoRotate = <?php echo $autoRotate === 'true' ? 'true' : 'false'; ?>;\n        let eventIndex = 0;\n        let events = <?php echo json_encode(array_column($pairs, 'event_id')); ?>;\n        let rotationInterval;\n        \n        // í˜„ì¬ ì´ë²¤íŠ¸ ì¸ë±ìŠ¤ ì°¾ê¸°\n        eventIndex = events.indexOf(currentEvent);\n        if (eventIndex === -1) eventIndex = 0;\n        \n        // ëª¨ë“œ ì „í™˜ í•¨ìˆ˜\n        function showMode(mode) {\n            // ëª¨ë“  í™”ë©´ ìˆ¨ê¸°ê¸°\n            document.querySelectorAll('.screen').forEach(screen => {\n                screen.classList.remove('active');\n            });\n            \n            // ì„ íƒëœ ëª¨ë“œ í‘œì‹œ\n            currentMode = mode;\n            document.getElementById('currentMode').textContent = mode;\n            \n            switch(mode) {\n                case 'waiting':\n                    document.getElementById('waitingScreen').classList.add('active');\n                    break;\n                case 'logo':\n                    document.getElementById('logoScreen').classList.add('active');\n                    break;\n                case 'results':\n                    document.getElementById('resultsScreen').classList.add('active');\n                    loadCurrentEvent();\n                    break;\n            }\n            \n            // ì œì–´ ë²„íŠ¼ í™œì„±í™” ìƒíƒœ ì—…ë°ì´íŠ¸\n            updateControlButtons();\n        }\n        \n        // ì´ë²¤íŠ¸ ë¡œë“œ í•¨ìˆ˜\n        function loadCurrentEvent() {\n            if (events.length > 0 && eventIndex >= 0 && eventIndex < events.length) {\n                currentEvent = events[eventIndex];\n                document.getElementById('currentEvent').textContent = currentEvent;\n                \n                const iframe = document.getElementById('resultFrame');\n                if (iframe) {\n                    iframe.src = `combined_result_${currentEvent}.html`;\n                }\n            }\n        }\n        \n        // ì´ì „ ì´ë²¤íŠ¸\n        function previousEvent() {\n            if (events.length > 0) {\n                eventIndex = (eventIndex - 1 + events.length) % events.length;\n                loadCurrentEvent();\n            }\n        }\n        \n        // ë‹¤ìŒ ì´ë²¤íŠ¸\n        function nextEvent() {\n            if (events.length > 0) {\n                eventIndex = (eventIndex + 1) % events.length;\n                loadCurrentEvent();\n            }\n        }\n        \n        // ìë™ ìˆœí™˜ í† ê¸€\n        function toggleAutoRotate() {\n            autoRotate = !autoRotate;\n            document.getElementById('autoStatus').textContent = autoRotate ? 'ON' : 'OFF';\n            \n            if (autoRotate) {\n                startAutoRotation();\n            } else {\n                stopAutoRotation();\n            }\n        }\n        \n        // ìë™ ìˆœí™˜ ì‹œì‘\n        function startAutoRotation() {\n            if (rotationInterval) clearInterval(rotationInterval);\n            \n            rotationInterval = setInterval(() => {\n                if (currentMode === 'results' && events.length > 0) {\n                    nextEvent();\n                }\n            }, 10000); // 10ì´ˆë§ˆë‹¤ ìˆœí™˜\n        }\n        \n        // ìë™ ìˆœí™˜ ì¤‘ì§€\n        function stopAutoRotation() {\n            if (rotationInterval) {\n                clearInterval(rotationInterval);\n                rotationInterval = null;\n            }\n        }\n        \n        // ì œì–´ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸\n        function updateControlButtons() {\n            const buttons = document.querySelectorAll('.control-btn');\n            buttons.forEach(btn => btn.classList.remove('active'));\n            \n            // í˜„ì¬ ëª¨ë“œ ë²„íŠ¼ í™œì„±í™”\n            const modeButtons = {\n                'waiting': buttons[0],\n                'logo': buttons[1],\n                'results': buttons[2]\n            };\n            \n            if (modeButtons[currentMode]) {\n                modeButtons[currentMode].classList.add('active');\n            }\n        }\n        \n        // ì „ì²´í™”ë©´ ì¢…ë£Œ\n        function exitFullscreen() {\n            if (document.exitFullscreen) {\n                document.exitFullscreen();\n            } else if (document.webkitExitFullscreen) {\n                document.webkitExitFullscreen();\n            } else if (document.mozCancelFullScreen) {\n                document.mozCancelFullScreen();\n            } else if (document.msExitFullscreen) {\n                document.msExitFullscreen();\n            }\n        }\n        \n        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤\n        document.addEventListener('keydown', function(e) {\n            switch(e.key) {\n                case 'F11':\n                    e.preventDefault();\n                    if (!document.fullscreenElement) {\n                        document.documentElement.requestFullscreen();\n                    } else {\n                        exitFullscreen();\n                    }\n                    break;\n                case 'ArrowLeft':\n                    previousEvent();\n                    break;\n                case 'ArrowRight':\n                    nextEvent();\n                    break;\n                case ' ':\n                    e.preventDefault();\n                    toggleAutoRotate();\n                    break;\n                case '1':\n                    showMode('waiting');\n                    break;\n                case '2':\n                    showMode('logo');\n                    break;\n                case '3':\n                    showMode('results');\n                    break;\n                case 'Escape':\n                    exitFullscreen();\n                    break;\n            }\n        });\n        \n        // ì´ˆê¸°í™”\n        document.addEventListener('DOMContentLoaded', function() {\n            showMode(currentMode);\n            \n            if (autoRotate) {\n                startAutoRotation();\n            }\n            \n            // 3ì´ˆ í›„ ì œì–´ íŒ¨ë„ ìˆ¨ê¸°ê¸°\n            setTimeout(() => {\n                document.getElementById('controlPanel').style.opacity = '0';\n            }, 3000);\n        });\n        \n        // ë§ˆìš°ìŠ¤ ì›€ì§ì„ ê°ì§€ë¡œ ì œì–´ íŒ¨ë„ í‘œì‹œ\n        let mouseTimer;\n        document.addEventListener('mousemove', function() {\n            document.getElementById('controlPanel').style.opacity = '1';\n            clearTimeout(mouseTimer);\n            mouseTimer = setTimeout(() => {\n                document.getElementById('controlPanel').style.opacity = '0';\n            }, 3000);\n        });\n    </script>\n</body>\n</html>\n\n\n\n\n","size_bytes":13677},"comp/simple_router.php":{"content":"<?php\nsession_start();\n\necho \"<h1>Simple Router Test - Step 2</h1>\";\n\n$event_no = $_GET['event_no'] ?? '8';\n$comp_id = $_GET['comp_id'] ?? '20250907-001';\n\necho \"<p>Event No: \" . htmlspecialchars($event_no) . \"</p>\";\necho \"<p>Comp ID: \" . htmlspecialchars($comp_id) . \"</p>\";\n\n// functions.php íŒŒì¼ í¬í•¨ ì‹œë„\necho \"<p>Attempting to include functions.php...</p>\";\ntry {\n    require_once __DIR__ . '/scoring/shared/functions.php';\n    echo \"<p style='color: green;'>functions.php included successfully!</p>\";\n} catch (Exception $e) {\n    echo \"<p style='color: red;'>Error including functions.php: \" . htmlspecialchars($e->getMessage()) . \"</p>\";\n    die();\n}\n\n// ì´ë²¤íŠ¸ ë°ì´í„° ë¡œë“œ ì‹œë„\necho \"<p>Attempting to load event data...</p>\";\ntry {\n    $event_data = loadEventData($comp_id, $event_no);\n    if ($event_data) {\n        echo \"<p style='color: green;'>Event Data Loaded: \" . htmlspecialchars($event_data['name']) . \"</p>\";\n    } else {\n        echo \"<p style='color: red;'>Failed to load event data.</p>\";\n    }\n} catch (Exception $e) {\n    echo \"<p style='color: red;'>Error loading event data: \" . htmlspecialchars($e->getMessage()) . \"</p>\";\n}\n\n// ì„ ìˆ˜ ë°ì´í„° ë¡œë“œ ì‹œë„\necho \"<p>Attempting to load players data...</p>\";\ntry {\n    $players = loadPlayersData($comp_id, $event_no);\n    if ($players) {\n        echo \"<p style='color: green;'>Players Data Loaded: \" . count($players) . \" players</p>\";\n    } else {\n        echo \"<p style='color: red;'>Failed to load players data.</p>\";\n    }\n} catch (Exception $e) {\n    echo \"<p style='color: red;'>Error loading players data: \" . htmlspecialchars($e->getMessage()) . \"</p>\";\n}\n\ndie(\"Script stopped after loading basic data.\");\n?>\n","size_bytes":1710},"comp/smart_fullscreen.php":{"content":"<?php\n/**\n * ìŠ¤ë§ˆíŠ¸ ì „ì²´í™”ë©´ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ\n * ëŒ€íšŒ ìˆœì„œì— ë”°ë¥¸ ìë™ ì „í™˜ ë° ëŒ€ê¸°í™”ë©´ í‘œì‹œ\n */\n\nrequire_once 'event_schedule_manager.php';\nrequire_once 'result_monitor.php';\n\n$scheduleManager = new EventScheduleManager();\n$monitor = new ResultMonitor();\n\n$currentEvent = isset($_GET['event']) ? $_GET['event'] : '';\n$mode = isset($_GET['mode']) ? $_GET['mode'] : 'waiting';\n$autoRotate = isset($_GET['auto']) ? $_GET['auto'] : 'true';\n\n// í˜„ì¬ ì´ë²¤íŠ¸ ì •ë³´ ê°€ì ¸ì˜¤ê¸°\n$currentEventInfo = $scheduleManager->getCurrentEvent($currentEvent);\n$nextEventInfo = $scheduleManager->getNextEvent($currentEvent);\n$schedule = $scheduleManager->getSchedule();\n\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>ìŠ¤ë§ˆíŠ¸ ì „ì²´í™”ë©´ ëª¨ë‹ˆí„°ë§</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n        \n        html, body {\n            width: 100%;\n            height: 100%;\n            overflow: hidden;\n        }\n        \n        body {\n            font-family: 'Arial', sans-serif;\n            background: #000;\n            color: #fff;\n        }\n        \n        .screen {\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100vw;\n            height: 100vh;\n            display: none;\n        }\n        \n        .screen.active {\n            display: block;\n        }\n        \n        /* ëŒ€ê¸°í™”ë©´ */\n        .waiting-screen {\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            text-align: center;\n            animation: pulse 2s infinite;\n        }\n        \n        .waiting-screen h1 {\n            font-size: 4em;\n            margin-bottom: 30px;\n            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);\n        }\n        \n        .waiting-screen .event-info {\n            background: rgba(255,255,255,0.1);\n            padding: 30px;\n            border-radius: 15px;\n            margin: 20px 0;\n            backdrop-filter: blur(10px);\n        }\n        \n        .waiting-screen .event-name {\n            font-size: 2.5em;\n            margin-bottom: 15px;\n            font-weight: bold;\n        }\n        \n        .waiting-screen .event-id {\n            font-size: 1.5em;\n            opacity: 0.8;\n        }\n        \n        .waiting-screen .next-event {\n            margin-top: 30px;\n            font-size: 1.2em;\n            opacity: 0.7;\n        }\n        \n        .event-status {\n            background: rgba(255,255,255,0.1);\n            padding: 20px;\n            border-radius: 10px;\n            margin: 20px 0;\n            backdrop-filter: blur(10px);\n        }\n        \n        .status-item {\n            display: flex;\n            justify-content: space-between;\n            margin-bottom: 10px;\n        }\n        \n        .status-item:last-child {\n            margin-bottom: 0;\n        }\n        \n        .status-label {\n            font-weight: bold;\n            opacity: 0.8;\n        }\n        \n        .status-value {\n            color: #ffeb3b;\n            font-weight: bold;\n        }\n        \n        /* ë¡œê³  í™”ë©´ */\n        .logo-screen {\n            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            text-align: center;\n        }\n        \n        .logo-screen img {\n            max-width: 80%;\n            max-height: 60%;\n            margin-bottom: 30px;\n        }\n        \n        .logo-screen h1 {\n            font-size: 3em;\n            margin-bottom: 20px;\n        }\n        \n        .logo-screen p {\n            font-size: 1.5em;\n            opacity: 0.9;\n        }\n        \n        /* ê²°ê³¼ í™”ë©´ */\n        .results-screen {\n            background: #f5f5f5;\n            color: #333;\n        }\n        \n        .results-content {\n            width: 100%;\n            height: 100%;\n            border: none;\n            display: block;\n        }\n        \n        /* ì œì–´ íŒ¨ë„ */\n        .control-panel {\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            z-index: 1000;\n            background: rgba(0,0,0,0.8);\n            padding: 15px;\n            border-radius: 10px;\n            display: flex;\n            gap: 10px;\n            opacity: 0;\n            transition: opacity 0.3s;\n        }\n        \n        .control-panel:hover {\n            opacity: 1;\n        }\n        \n        .control-btn {\n            background: #667eea;\n            color: white;\n            border: none;\n            padding: 10px 15px;\n            border-radius: 5px;\n            cursor: pointer;\n            font-size: 14px;\n            transition: background 0.3s;\n        }\n        \n        .control-btn:hover {\n            background: #5a6fd8;\n        }\n        \n        .control-btn.active {\n            background: #28a745;\n        }\n        \n        .control-btn.danger {\n            background: #dc3545;\n        }\n        \n        /* ìƒíƒœ í‘œì‹œ */\n        .status-bar {\n            position: fixed;\n            bottom: 20px;\n            left: 20px;\n            background: rgba(0,0,0,0.8);\n            color: white;\n            padding: 10px 15px;\n            border-radius: 5px;\n            font-size: 14px;\n        }\n        \n        /* ì§„í–‰ë¥  í‘œì‹œ */\n        .progress-bar {\n            position: fixed;\n            bottom: 0;\n            left: 0;\n            width: 100%;\n            height: 4px;\n            background: rgba(255,255,255,0.2);\n        }\n        \n        .progress-fill {\n            height: 100%;\n            background: linear-gradient(90deg, #667eea, #764ba2);\n            transition: width 0.3s ease;\n        }\n        \n        /* ì• ë‹ˆë©”ì´ì…˜ */\n        @keyframes pulse {\n            0% { transform: scale(1); }\n            50% { transform: scale(1.05); }\n            100% { transform: scale(1); }\n        }\n        \n        @keyframes fadeIn {\n            from { opacity: 0; transform: translateY(20px); }\n            to { opacity: 1; transform: translateY(0); }\n        }\n        \n        .fade-in {\n            animation: fadeIn 0.5s ease-in-out;\n        }\n        \n        /* ë°˜ì‘í˜• */\n        @media (max-width: 768px) {\n            .waiting-screen h1 { font-size: 2.5em; }\n            .waiting-screen .event-name { font-size: 1.8em; }\n            .waiting-screen .event-id { font-size: 1.2em; }\n            .logo-screen h1 { font-size: 2em; }\n            .logo-screen p { font-size: 1.2em; }\n        }\n    </style>\n</head>\n<body>\n    <!-- ëŒ€ê¸°í™”ë©´ -->\n    <div id=\"waitingScreen\" class=\"screen waiting-screen\">\n        <h1>ğŸ† 2025 ê²½ê¸°ë„ì§€ì‚¬ë°° ì „êµ­ì¥ì• ì¸ëŒ„ìŠ¤ìŠ¤í¬ì¸ ì„ ìˆ˜ê¶ŒëŒ€íšŒ</h1>\n        \n        <?php if ($currentEventInfo): ?>\n        <div class=\"event-info\">\n            <div class=\"event-name\"><?php echo htmlspecialchars($currentEventInfo['event_name']); ?></div>\n            <div class=\"event-id\">ì´ë²¤íŠ¸ ID: <?php echo htmlspecialchars($currentEventInfo['event_id']); ?></div>\n        </div>\n        <?php endif; ?>\n        \n        <p>ê²°ê³¼ë¥¼ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”...</p>\n        \n        <div class=\"event-status\" id=\"eventStatus\">\n            <div class=\"status-item\">\n                <span class=\"status-label\">í˜„ì¬ ìƒíƒœ:</span>\n                <span class=\"status-value\" id=\"currentStatus\">ëŒ€ê¸° ì¤‘</span>\n            </div>\n            <div class=\"status-item\">\n                <span class=\"status-label\">ê²°ê³¼ íŒŒì¼:</span>\n                <span class=\"status-value\" id=\"fileStatus\">í™•ì¸ ì¤‘...</span>\n            </div>\n        </div>\n        \n        <?php if ($nextEventInfo): ?>\n        <div class=\"next-event\">\n            ë‹¤ìŒ: <?php echo htmlspecialchars($nextEventInfo['event_name']); ?>\n        </div>\n        <?php endif; ?>\n    </div>\n    \n    <!-- ë¡œê³  í™”ë©´ -->\n    <div id=\"logoScreen\" class=\"screen logo-screen\">\n        <img src=\"assets/danceoffice-logo.png\" alt=\"DanceOffice ë¡œê³ \" onerror=\"this.style.display='none'\">\n        <h1>DanceOffice</h1>\n        <p>ëŒ„ìŠ¤ìŠ¤í¬ì¸  ê´€ë¦¬ ì‹œìŠ¤í…œ</p>\n    </div>\n    \n    <!-- ê²°ê³¼ í™”ë©´ -->\n    <div id=\"resultsScreen\" class=\"screen results-screen\">\n        <?php if ($currentEvent && $mode === 'results'): ?>\n            <iframe src=\"combined_result_<?php echo htmlspecialchars($currentEvent); ?>.html\" \n                    class=\"results-content\" id=\"resultFrame\"></iframe>\n        <?php else: ?>\n            <div style=\"display: flex; justify-content: center; align-items: center; height: 100vh; font-size: 2em; color: #666;\">\n                ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...\n            </div>\n        <?php endif; ?>\n    </div>\n    \n    <!-- ì œì–´ íŒ¨ë„ -->\n    <div class=\"control-panel\" id=\"controlPanel\">\n        <button class=\"control-btn\" onclick=\"showMode('waiting')\">â³ ëŒ€ê¸°í™”ë©´</button>\n        <button class=\"control-btn\" onclick=\"showMode('logo')\">ğŸ¢ ë¡œê³ </button>\n        <button class=\"control-btn\" onclick=\"showMode('results')\">ğŸ“Š ê²°ê³¼</button>\n        <button class=\"control-btn\" onclick=\"toggleAutoRotate()\">ğŸ”„ ìë™ìˆœí™˜</button>\n        <button class=\"control-btn\" onclick=\"previousEvent()\">â¬…ï¸ ì´ì „</button>\n        <button class=\"control-btn\" onclick=\"nextEvent()\">ë‹¤ìŒ â¡ï¸</button>\n        <button class=\"control-btn danger\" onclick=\"exitFullscreen()\">âŒ ì¢…ë£Œ</button>\n    </div>\n    \n    <!-- ìƒíƒœ í‘œì‹œ -->\n    <div class=\"status-bar\" id=\"statusBar\">\n        í˜„ì¬ ëª¨ë“œ: <span id=\"currentMode\"><?php echo $mode; ?></span> | \n        ì´ë²¤íŠ¸: <span id=\"currentEvent\"><?php echo $currentEvent; ?></span> | \n        ìë™ìˆœí™˜: <span id=\"autoStatus\"><?php echo $autoRotate === 'true' ? 'ON' : 'OFF'; ?></span>\n    </div>\n    \n    <!-- ì§„í–‰ë¥  í‘œì‹œ -->\n    <div class=\"progress-bar\">\n        <div class=\"progress-fill\" id=\"progressFill\" style=\"width: 0%\"></div>\n    </div>\n\n    <script>\n        let currentMode = '<?php echo $mode; ?>';\n        let currentEvent = '<?php echo $currentEvent; ?>';\n        let autoRotate = <?php echo $autoRotate === 'true' ? 'true' : 'false'; ?>;\n        let eventIndex = <?php echo $scheduleManager->getCurrentEventIndex($currentEvent); ?>;\n        let events = <?php echo json_encode(array_column($schedule, 'event_id')); ?>;\n        let eventNames = <?php echo json_encode(array_column($schedule, 'event_name')); ?>;\n        let showResults = <?php echo json_encode(array_column($schedule, 'show_result')); ?>;\n        let rotationInterval;\n        let progressInterval;\n        \n        // ëª¨ë“œ ì „í™˜ í•¨ìˆ˜\n        function showMode(mode) {\n            // ëª¨ë“  í™”ë©´ ìˆ¨ê¸°ê¸°\n            document.querySelectorAll('.screen').forEach(screen => {\n                screen.classList.remove('active');\n            });\n            \n            // ì„ íƒëœ ëª¨ë“œ í‘œì‹œ\n            currentMode = mode;\n            document.getElementById('currentMode').textContent = mode;\n            \n            switch(mode) {\n                case 'waiting':\n                    document.getElementById('waitingScreen').classList.add('active');\n                    break;\n                case 'logo':\n                    document.getElementById('logoScreen').classList.add('active');\n                    break;\n                case 'results':\n                    document.getElementById('resultsScreen').classList.add('active');\n                    loadCurrentEvent();\n                    break;\n            }\n            \n            // ì œì–´ ë²„íŠ¼ í™œì„±í™” ìƒíƒœ ì—…ë°ì´íŠ¸\n            updateControlButtons();\n        }\n        \n        // ì´ë²¤íŠ¸ ë¡œë“œ í•¨ìˆ˜\n        function loadCurrentEvent() {\n            if (events.length > 0 && eventIndex >= 0 && eventIndex < events.length) {\n                currentEvent = events[eventIndex];\n                document.getElementById('currentEvent').textContent = currentEvent;\n                \n                const iframe = document.getElementById('resultFrame');\n                if (iframe) {\n                    iframe.src = `combined_result_${currentEvent}.html`;\n                }\n            }\n        }\n        \n        // ì´ì „ ì´ë²¤íŠ¸\n        function previousEvent() {\n            if (events.length > 0) {\n                eventIndex = (eventIndex - 1 + events.length) % events.length;\n                loadCurrentEvent();\n            }\n        }\n        \n        // ë‹¤ìŒ ì´ë²¤íŠ¸\n        function nextEvent() {\n            if (events.length > 0) {\n                eventIndex = (eventIndex + 1) % events.length;\n                loadCurrentEvent();\n            }\n        }\n        \n        // ìë™ ìˆœí™˜ í† ê¸€\n        function toggleAutoRotate() {\n            autoRotate = !autoRotate;\n            document.getElementById('autoStatus').textContent = autoRotate ? 'ON' : 'OFF';\n            \n            if (autoRotate) {\n                startAutoRotation();\n            } else {\n                stopAutoRotation();\n            }\n        }\n        \n        // ìë™ ìˆœí™˜ ì‹œì‘\n        function startAutoRotation() {\n            if (rotationInterval) clearInterval(rotationInterval);\n            \n            rotationInterval = setInterval(() => {\n                if (currentMode === 'waiting' && events.length > 0) {\n                    // ëŒ€ê¸°í™”ë©´ì—ì„œ ê²°ê³¼ê°€ ìˆëŠ” ì´ë²¤íŠ¸ë¡œ ìë™ ì „í™˜\n                    if (showResults[eventIndex]) {\n                        checkResultFileAndShow();\n                    } else {\n                        nextEvent();\n                    }\n                } else if (currentMode === 'results') {\n                    // ê²°ê³¼ í™”ë©´ì—ì„œ ë‹¤ìŒ ì´ë²¤íŠ¸ë¡œ ì „í™˜\n                    nextEvent();\n                    if (showResults[eventIndex]) {\n                        checkResultFileAndShow();\n                    } else {\n                        showMode('waiting');\n                    }\n                }\n            }, 10000); // 10ì´ˆë§ˆë‹¤ ìˆœí™˜\n        }\n        \n        // ê²°ê³¼ íŒŒì¼ ì¡´ì¬ ì—¬ë¶€ í™•ì¸ í›„ í‘œì‹œ\n        function checkResultFileAndShow() {\n            if (events.length > 0 && eventIndex >= 0 && eventIndex < events.length) {\n                const eventId = events[eventIndex];\n                \n                // ìƒíƒœ ì—…ë°ì´íŠ¸\n                updateEventStatus('ê²°ê³¼ íŒŒì¼ í™•ì¸ ì¤‘...', 'í™•ì¸ ì¤‘...');\n                \n                // ê²°ê³¼ íŒŒì¼ ì¡´ì¬ ì—¬ë¶€ í™•ì¸\n                fetch(`check_result_file.php?event=${eventId}`)\n                    .then(response => response.json())\n                    .then(data => {\n                        if (data.exists) {\n                            updateEventStatus('ê²°ê³¼ ì¤€ë¹„ ì™„ë£Œ', 'ì¡´ì¬í•¨');\n                            showMode('results');\n                            startProgress();\n                        } else {\n                            // ê²°ê³¼ íŒŒì¼ì´ ì—†ìœ¼ë©´ ëŒ€ê¸°í™”ë©´ ìœ ì§€\n                            updateEventStatus('ê²°ê³¼ ëŒ€ê¸° ì¤‘', 'ì—†ìŒ');\n                            console.log(`ê²°ê³¼ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤: ${eventId}`);\n                            showMode('waiting');\n                        }\n                    })\n                    .catch(error => {\n                        console.error('ê²°ê³¼ íŒŒì¼ í™•ì¸ ì˜¤ë¥˜:', error);\n                        updateEventStatus('ì˜¤ë¥˜ ë°œìƒ', 'í™•ì¸ ì‹¤íŒ¨');\n                        showMode('waiting');\n                    });\n            }\n        }\n        \n        // ì´ë²¤íŠ¸ ìƒíƒœ ì—…ë°ì´íŠ¸\n        function updateEventStatus(currentStatus, fileStatus) {\n            const currentStatusElement = document.getElementById('currentStatus');\n            const fileStatusElement = document.getElementById('fileStatus');\n            \n            if (currentStatusElement) {\n                currentStatusElement.textContent = currentStatus;\n            }\n            if (fileStatusElement) {\n                fileStatusElement.textContent = fileStatus;\n            }\n        }\n        \n        // ìë™ ìˆœí™˜ ì¤‘ì§€\n        function stopAutoRotation() {\n            if (rotationInterval) {\n                clearInterval(rotationInterval);\n                rotationInterval = null;\n            }\n            stopProgress();\n        }\n        \n        // ì§„í–‰ë¥  ì‹œì‘\n        function startProgress() {\n            if (progressInterval) clearInterval(progressInterval);\n            \n            let progress = 0;\n            const duration = 10000; // 10ì´ˆ\n            const increment = 100 / (duration / 100);\n            \n            progressInterval = setInterval(() => {\n                progress += increment;\n                document.getElementById('progressFill').style.width = progress + '%';\n                \n                if (progress >= 100) {\n                    clearInterval(progressInterval);\n                }\n            }, 100);\n        }\n        \n        // ì§„í–‰ë¥  ì¤‘ì§€\n        function stopProgress() {\n            if (progressInterval) {\n                clearInterval(progressInterval);\n                progressInterval = null;\n            }\n            document.getElementById('progressFill').style.width = '0%';\n        }\n        \n        // ì œì–´ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸\n        function updateControlButtons() {\n            const buttons = document.querySelectorAll('.control-btn');\n            buttons.forEach(btn => btn.classList.remove('active'));\n            \n            // í˜„ì¬ ëª¨ë“œ ë²„íŠ¼ í™œì„±í™”\n            const modeButtons = {\n                'waiting': buttons[0],\n                'logo': buttons[1],\n                'results': buttons[2]\n            };\n            \n            if (modeButtons[currentMode]) {\n                modeButtons[currentMode].classList.add('active');\n            }\n        }\n        \n        // ì „ì²´í™”ë©´ ì¢…ë£Œ\n        function exitFullscreen() {\n            if (document.exitFullscreen) {\n                document.exitFullscreen();\n            } else if (document.webkitExitFullscreen) {\n                document.webkitExitFullscreen();\n            } else if (document.mozCancelFullScreen) {\n                document.mozCancelFullScreen();\n            } else if (document.msExitFullscreen) {\n                document.msExitFullscreen();\n            }\n        }\n        \n        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤\n        document.addEventListener('keydown', function(e) {\n            switch(e.key) {\n                case 'F11':\n                    e.preventDefault();\n                    if (!document.fullscreenElement) {\n                        document.documentElement.requestFullscreen();\n                    } else {\n                        exitFullscreen();\n                    }\n                    break;\n                case 'ArrowLeft':\n                    previousEvent();\n                    break;\n                case 'ArrowRight':\n                    nextEvent();\n                    break;\n                case ' ':\n                    e.preventDefault();\n                    toggleAutoRotate();\n                    break;\n                case '1':\n                    showMode('waiting');\n                    break;\n                case '2':\n                    showMode('logo');\n                    break;\n                case '3':\n                    showMode('results');\n                    break;\n                case 'Escape':\n                    exitFullscreen();\n                    break;\n            }\n        });\n        \n        // ì´ˆê¸°í™”\n        document.addEventListener('DOMContentLoaded', function() {\n            showMode(currentMode);\n            \n            if (autoRotate) {\n                startAutoRotation();\n            }\n            \n            // 3ì´ˆ í›„ ì œì–´ íŒ¨ë„ ìˆ¨ê¸°ê¸°\n            setTimeout(() => {\n                document.getElementById('controlPanel').style.opacity = '0';\n            }, 3000);\n            \n            // ê²°ê³¼ íŒŒì¼ ëª¨ë‹ˆí„°ë§ ì‹œì‘ (5ì´ˆë§ˆë‹¤ í™•ì¸)\n            startResultFileMonitoring();\n        });\n        \n        // ê²°ê³¼ íŒŒì¼ ëª¨ë‹ˆí„°ë§\n        function startResultFileMonitoring() {\n            setInterval(() => {\n                if (currentMode === 'waiting' && events.length > 0) {\n                    const eventId = events[eventIndex];\n                    if (showResults[eventIndex]) {\n                        checkResultFileAndShow();\n                    }\n                }\n            }, 5000); // 5ì´ˆë§ˆë‹¤ í™•ì¸\n        }\n        \n        // ë§ˆìš°ìŠ¤ ì›€ì§ì„ ê°ì§€ë¡œ ì œì–´ íŒ¨ë„ í‘œì‹œ\n        let mouseTimer;\n        document.addEventListener('mousemove', function() {\n            document.getElementById('controlPanel').style.opacity = '1';\n            clearTimeout(mouseTimer);\n            mouseTimer = setTimeout(() => {\n                document.getElementById('controlPanel').style.opacity = '0';\n            }, 3000);\n        });\n    </script>\n</body>\n</html>\n","size_bytes":21107},"comp/test_results.php":{"content":"<?php\n/**\n * results/ í´ë”ì˜ ê¸°ì¡´ íŒŒì¼ë“¤ë¡œ í…ŒìŠ¤íŠ¸í•˜ëŠ” í˜ì´ì§€\n */\n\nrequire_once 'result_monitor.php';\n\n$monitor = new ResultMonitor();\n\necho \"<!DOCTYPE html>\n<html lang='ko'>\n<head>\n    <meta charset='UTF-8'>\n    <meta name='viewport' content='width=device-width, initial-scale=1.0'>\n    <title>Results í´ë” í…ŒìŠ¤íŠ¸</title>\n    <style>\n        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }\n        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 0 20px rgba(0,0,0,0.1); }\n        .section { margin-bottom: 30px; padding: 20px; border: 1px solid #ddd; border-radius: 5px; }\n        .section h2 { color: #333; margin-top: 0; }\n        .file-list { max-height: 300px; overflow-y: auto; }\n        .file-item { padding: 10px; margin: 5px 0; background: #f8f9fa; border-radius: 3px; }\n        .btn { background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin: 5px; }\n        .btn:hover { background: #0056b3; }\n        .success { color: #28a745; }\n        .error { color: #dc3545; }\n        .info { color: #17a2b8; }\n        pre { background: #f8f9fa; padding: 15px; border-radius: 5px; overflow-x: auto; }\n    </style>\n</head>\n<body>\n    <div class='container'>\n        <h1>ğŸ” Results í´ë” í…ŒìŠ¤íŠ¸</h1>\n        <p>í˜„ì¬ Y:/results í´ë”ì˜ íŒŒì¼ë“¤ì„ ë¶„ì„í•˜ê³  ì¢…í•© ê²°ê³¼ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.</p>\";\n\n// 1. í´ë” ì¡´ì¬ í™•ì¸\necho \"<div class='section'>\n        <h2>ğŸ“ í´ë” ìƒíƒœ</h2>\";\n\n$resultsPath = __DIR__ . \"/../results\";\n$resultsResultsPath = __DIR__ . \"/../results/results\";\n\nif (is_dir($resultsPath)) {\n    echo \"<p class='success'>âœ… results í´ë”ê°€ ì¡´ì¬í•©ë‹ˆë‹¤.</p>\";\n} else {\n    echo \"<p class='error'>âŒ results í´ë”ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>\";\n    echo \"</div></div></body></html>\";\n    exit;\n}\n\nif (is_dir($resultsResultsPath)) {\n    echo \"<p class='success'>âœ… results/results í´ë”ê°€ ì¡´ì¬í•©ë‹ˆë‹¤.</p>\";\n} else {\n    echo \"<p class='error'>âŒ results/results í´ë”ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>\";\n}\n\necho \"</div>\";\n\n// 2. íŒŒì¼ ìŒ ì°¾ê¸°\necho \"<div class='section'>\n        <h2>ğŸ” ê²°ê³¼ íŒŒì¼ ìŒ ì°¾ê¸°</h2>\";\n\ntry {\n    $pairs = $monitor->findResultPairs();\n    echo \"<p class='info'>ğŸ“Š ì´ \" . count($pairs) . \"ê°œì˜ ê²°ê³¼ íŒŒì¼ ìŒì„ ì°¾ì•˜ìŠµë‹ˆë‹¤.</p>\";\n    \n    if (count($pairs) > 0) {\n        echo \"<div class='file-list'>\";\n        foreach ($pairs as $pair) {\n            echo \"<div class='file-item'>\n                    <strong>ì´ë²¤íŠ¸ ID:</strong> {$pair['event_id']}<br>\n                    <strong>ìš”ì•½ íŒŒì¼:</strong> \" . basename($pair['summary']) . \"<br>\n                    <strong>ìƒì„¸ íŒŒì¼:</strong> \" . basename($pair['detailed']) . \"\n                  </div>\";\n        }\n        echo \"</div>\";\n    } else {\n        echo \"<p class='error'>âŒ ê²°ê³¼ íŒŒì¼ ìŒì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>\";\n    }\n} catch (Exception $e) {\n    echo \"<p class='error'>âŒ ì˜¤ë¥˜: \" . $e->getMessage() . \"</p>\";\n}\n\necho \"</div>\";\n\n// 3. ìƒ˜í”Œ íŒŒì¼ íŒŒì‹± í…ŒìŠ¤íŠ¸\necho \"<div class='section'>\n        <h2>ğŸ§ª íŒŒì¼ íŒŒì‹± í…ŒìŠ¤íŠ¸</h2>\";\n\nif (count($pairs) > 0) {\n    $testPair = $pairs[0]; // ì²« ë²ˆì§¸ ìŒìœ¼ë¡œ í…ŒìŠ¤íŠ¸\n    \n    try {\n        echo \"<p class='info'>í…ŒìŠ¤íŠ¸ íŒŒì¼: {$testPair['event_id']}</p>\";\n        \n        // ìš”ì•½ íŒŒì¼ íŒŒì‹±\n        echo \"<h3>ğŸ“„ ìš”ì•½ íŒŒì¼ íŒŒì‹± ê²°ê³¼</h3>\";\n        $summaryData = $monitor->parseResultFile($testPair['summary']);\n        echo \"<pre>\";\n        echo \"ì´ë²¤íŠ¸ ì œëª©: \" . $summaryData['event_title'] . \"\\n\";\n        echo \"ì´ë²¤íŠ¸ ë‚ ì§œ: \" . $summaryData['event_date'] . \"\\n\";\n        echo \"ê²½ìŸì ìˆ˜: \" . count($summaryData['competitors']) . \"\\n\";\n        echo \"ì‹¬íŒ ìˆ˜: \" . count($summaryData['adjudicators']) . \"\\n\";\n        echo \"\\nê²½ìŸì ëª©ë¡:\\n\";\n        foreach ($summaryData['competitors'] as $competitor) {\n            echo \"- ìˆœìœ„: {$competitor['place']}, ë²ˆí˜¸: {$competitor['tag']}, ì´ë¦„: {$competitor['name']}, ì ìˆ˜: {$competitor['final_score']}\\n\";\n        }\n        echo \"</pre>\";\n        \n        // ìƒì„¸ íŒŒì¼ íŒŒì‹±\n        echo \"<h3>ğŸ“Š ìƒì„¸ íŒŒì¼ íŒŒì‹± ê²°ê³¼</h3>\";\n        $detailedData = $monitor->parseDetailedFile($testPair['detailed']);\n        echo \"<pre>\";\n        echo \"ëŒ„ìŠ¤ ì¢…ë¥˜: \" . implode(\", \", array_keys($detailedData)) . \"\\n\";\n        foreach ($detailedData as $danceName => $danceResults) {\n            echo \"\\n{$danceName}:\\n\";\n            foreach ($danceResults as $result) {\n                echo \"- ë²ˆí˜¸: {$result['tag']}, ì´ë¦„: {$result['name']}, ìˆœìœ„: {$result['placing']}\\n\";\n            }\n        }\n        echo \"</pre>\";\n        \n    } catch (Exception $e) {\n        echo \"<p class='error'>âŒ íŒŒì‹± ì˜¤ë¥˜: \" . $e->getMessage() . \"</p>\";\n    }\n} else {\n    echo \"<p class='error'>âŒ í…ŒìŠ¤íŠ¸í•  íŒŒì¼ ìŒì´ ì—†ìŠµë‹ˆë‹¤.</p>\";\n}\n\necho \"</div>\";\n\n// 4. ì¢…í•© ê²°ê³¼ ìƒì„± í…ŒìŠ¤íŠ¸\necho \"<div class='section'>\n        <h2>ğŸ¨ ì¢…í•© ê²°ê³¼ ìƒì„± í…ŒìŠ¤íŠ¸</h2>\";\n\nif (count($pairs) > 0) {\n    $testPair = $pairs[0];\n    \n    try {\n        echo \"<p class='info'>ì¢…í•© ê²°ê³¼ë¥¼ ìƒì„±í•©ë‹ˆë‹¤...</p>\";\n        \n        $summaryData = $monitor->parseResultFile($testPair['summary']);\n        $detailedData = $monitor->parseDetailedFile($testPair['detailed']);\n        $combinedHtml = $monitor->generateCombinedResult($summaryData, $detailedData, $testPair['event_id']);\n        \n        $savedFile = $monitor->saveCombinedResult($combinedHtml, $testPair['event_id']);\n        \n        echo \"<p class='success'>âœ… ì¢…í•© ê²°ê³¼ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!</p>\";\n        echo \"<p><strong>ì €ì¥ ìœ„ì¹˜:</strong> \" . $savedFile . \"</p>\";\n        echo \"<p><a href='combined_result_{$testPair['event_id']}.html' target='_blank' class='btn'>ğŸ¯ ì¢…í•© ê²°ê³¼ ë³´ê¸°</a></p>\";\n        \n    } catch (Exception $e) {\n        echo \"<p class='error'>âŒ ì¢…í•© ê²°ê³¼ ìƒì„± ì˜¤ë¥˜: \" . $e->getMessage() . \"</p>\";\n    }\n} else {\n    echo \"<p class='error'>âŒ í…ŒìŠ¤íŠ¸í•  íŒŒì¼ ìŒì´ ì—†ìŠµë‹ˆë‹¤.</p>\";\n}\n\necho \"</div>\";\n\n// 5. ëª¨ë“  ê²°ê³¼ ì²˜ë¦¬\necho \"<div class='section'>\n        <h2>âš¡ ëª¨ë“  ê²°ê³¼ ì²˜ë¦¬</h2>\n        <p>ëª¨ë“  ê²°ê³¼ íŒŒì¼ ìŒì„ ì²˜ë¦¬í•˜ì—¬ ì¢…í•© ê²°ê³¼ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.</p>\n        <button onclick='processAllResults()' class='btn'>ğŸš€ ëª¨ë“  ê²°ê³¼ ì²˜ë¦¬</button>\n        <div id='processResult'></div>\n      </div>\";\n\necho \"</div>\n\n<script>\nasync function processAllResults() {\n    const resultDiv = document.getElementById('processResult');\n    resultDiv.innerHTML = '<p class=\\\"info\\\">ì²˜ë¦¬ ì¤‘...</p>';\n    \n    try {\n        const response = await fetch('result_monitor.php?action=process');\n        const data = await response.json();\n        \n        if (data.success) {\n            const processed = data.processed || [];\n            let html = '<p class=\\\"success\\\">âœ… ' + processed.length + 'ê°œì˜ ê²°ê³¼ê°€ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤!</p>';\n            html += '<ul>';\n            processed.forEach(result => {\n                html += '<li>';\n                html += '<a href=\\\"combined_result_' + result.event_id + '.html\\\" target=\\\"_blank\\\">' + result.event_title + ' (' + result.event_id + ')</a>';\n                if (result.web_url) {\n                    html += ' <a href=\\\"' + result.web_url + '\\\" target=\\\"_blank\\\" style=\\\"color: #667eea; text-decoration: none;\\\">ğŸŒ ì›¹ì—ì„œ ë³´ê¸°</a>';\n                }\n                html += '</li>';\n            });\n            html += '</ul>';\n            resultDiv.innerHTML = html;\n        } else {\n            resultDiv.innerHTML = '<p class=\\\"error\\\">âŒ ì²˜ë¦¬ ì‹¤íŒ¨: ' + (data.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜') + '</p>';\n        }\n    } catch (error) {\n        resultDiv.innerHTML = '<p class=\\\"error\\\">âŒ ì˜¤ë¥˜: ' + error.message + '</p>';\n    }\n}\n</script>\n\n</body>\n</html>\";\n?>\n","size_bytes":7923},"comp/test_scoring.php":{"content":"<?php\n// ì—ëŸ¬ ë¦¬í¬íŒ… í™œì„±í™”\nerror_reporting(E_ALL);\nini_set('display_errors', 1);\n\necho \"<h1>ì±„ì  ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸</h1>\";\n\n$comp_id = $_GET['comp_id'] ?? '';\n$event_no = $_GET['event_no'] ?? '';\n\necho \"<p>comp_id: \" . htmlspecialchars($comp_id) . \"</p>\";\necho \"<p>event_no: \" . htmlspecialchars($event_no) . \"</p>\";\n\n// ì„¸ì…˜ í™•ì¸\nsession_start();\necho \"<p>ì„¸ì…˜ ë¡œê·¸ì¸ ìƒíƒœ: \" . (isset($_SESSION['scoring_logged_in']) ? 'YES' : 'NO') . \"</p>\";\necho \"<p>ì‹¬ì‚¬ìœ„ì› ID: \" . ($_SESSION['scoring_judge_id'] ?? 'N/A') . \"</p>\";\n\n// íŒŒì¼ ì¡´ì¬ í™•ì¸\n$data_dir = __DIR__ . \"/data/$comp_id\";\necho \"<p>ë°ì´í„° ë””ë ‰í† ë¦¬: \" . $data_dir . \"</p>\";\necho \"<p>ë””ë ‰í† ë¦¬ ì¡´ì¬: \" . (is_dir($data_dir) ? 'YES' : 'NO') . \"</p>\";\n\n$runorder_file = \"$data_dir/RunOrder_Tablet.txt\";\necho \"<p>RunOrder íŒŒì¼: \" . $runorder_file . \"</p>\";\necho \"<p>íŒŒì¼ ì¡´ì¬: \" . (file_exists($runorder_file) ? 'YES' : 'NO') . \"</p>\";\n\n$players_file = \"$data_dir/players_$event_no.txt\";\necho \"<p>ì„ ìˆ˜ íŒŒì¼: \" . $players_file . \"</p>\";\necho \"<p>íŒŒì¼ ì¡´ì¬: \" . (file_exists($players_file) ? 'YES' : 'NO') . \"</p>\";\n\necho \"<p><a href='judge_scoring.php?comp_id=$comp_id&event_no=$event_no&lang=ko'>ì›ë˜ ì±„ì  í˜ì´ì§€ë¡œ ì´ë™</a></p>\";\n?>\n\n\n\n\n\n\n","size_bytes":1259},"comp/test_scoring_types.php":{"content":"<?php\n/**\n * 5ê°€ì§€ ì‹¬ì‚¬ ë°©ì‹ í…ŒìŠ¤íŠ¸ í˜ì´ì§€\n */\n\n// HTML ì´ìŠ¤ì¼€ì´í”„ í•¨ìˆ˜\nfunction h($s) { \n    return htmlspecialchars($s ?? ''); \n}\n\n$comp_id = '20250907-001';\n$lang = 'ko';\n\n$scoring_types = [\n    '8' => ['name' => 'ë©€í‹°ì´ë²¤íŠ¸ ê²°ìŠ¹ì „ (ê¸°ì¡´)', 'type' => 'multievent_final'],\n    '9' => ['name' => 'ë©€í‹°ì´ë²¤íŠ¸ ì¤€ê²°ìŠ¹ (ê¸°ì¡´)', 'type' => 'multievent_preliminary'],\n    '10' => ['name' => 'í”„ë¦¬ìŠ¤íƒ€ì¼ ì‹¬ì‚¬', 'type' => 'freestyle'],\n    '11' => ['name' => 'í¬ë©”ì´ì…˜ ì‹¬ì‚¬', 'type' => 'formation'],\n    '12' => ['name' => 'ë©€í‹°ì´ë²¤íŠ¸ ê²°ìŠ¹ì „ (ì¤€ê²°ìŠ¹ ì—†ìŒ)', 'type' => 'multievent_final_only']\n];\n?>\n\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>ì‹¬ì‚¬ ë°©ì‹ í…ŒìŠ¤íŠ¸</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            max-width: 800px;\n            margin: 0 auto;\n            padding: 20px;\n            background: #f5f5f5;\n        }\n        .container {\n            background: white;\n            padding: 30px;\n            border-radius: 10px;\n            box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n        }\n        h1 {\n            color: #333;\n            text-align: center;\n            margin-bottom: 30px;\n        }\n        .scoring-type {\n            background: #f8f9fa;\n            border: 2px solid #e9ecef;\n            border-radius: 8px;\n            padding: 20px;\n            margin: 15px 0;\n            transition: all 0.3s ease;\n        }\n        .scoring-type:hover {\n            border-color: #667eea;\n            transform: translateY(-2px);\n            box-shadow: 0 4px 8px rgba(0,0,0,0.1);\n        }\n        .scoring-type h3 {\n            margin: 0 0 10px 0;\n            color: #333;\n        }\n        .scoring-type p {\n            margin: 0 0 15px 0;\n            color: #666;\n        }\n        .test-btn {\n            background: #667eea;\n            color: white;\n            border: none;\n            padding: 10px 20px;\n            border-radius: 5px;\n            cursor: pointer;\n            text-decoration: none;\n            display: inline-block;\n            font-weight: bold;\n        }\n        .test-btn:hover {\n            background: #5a6fd8;\n        }\n        .type-badge {\n            background: #e3f2fd;\n            color: #1976d2;\n            padding: 4px 8px;\n            border-radius: 4px;\n            font-size: 12px;\n            font-weight: bold;\n            margin-left: 10px;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>ğŸ­ 5ê°€ì§€ ì‹¬ì‚¬ ë°©ì‹ í…ŒìŠ¤íŠ¸</h1>\n        \n        <?php foreach ($scoring_types as $event_no => $info): ?>\n        <div class=\"scoring-type\">\n            <h3>\n                ì´ë²¤íŠ¸ #<?= $event_no ?>: <?= $info['name'] ?>\n                <span class=\"type-badge\"><?= $info['type'] ?></span>\n            </h3>\n            <p>\n                <?php if ($info['type'] === 'multievent_final'): ?>\n                    ê¸°ì¡´ì— ì‘ì—…í•œ ê²°ìŠ¹ì „ ì‹œìŠ¤í…œ - í„°ì¹˜ ê¸°ë°˜ ìˆœìœ„ ì‹œìŠ¤í…œ, ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì§€ì›\n                <?php elseif ($info['type'] === 'multievent_preliminary'): ?>\n                    ê¸°ì¡´ì— ì‘ì—…í•œ ì¤€ê²°ìŠ¹ ì‹œìŠ¤í…œ - Instagram ìŠ¤íƒ€ì¼ ëŒ„ìŠ¤ë³„ ì±„ì \n                <?php elseif ($info['type'] === 'freestyle'): ?>\n                    í”„ë¦¬ìŠ¤íƒ€ì¼ ì‹¬ì‚¬ - ì°½ì˜ì„±, ê¸°ìˆ ì„±, í‘œí˜„ë ¥, ìŒì•…ì„± ì¢…í•© í‰ê°€\n                <?php elseif ($info['type'] === 'formation'): ?>\n                    í¬ë©”ì´ì…˜ ì‹¬ì‚¬ - íŒ€ ë‹¨ìœ„ í¬ë©”ì´ì…˜ íŒ¨í„´ í‰ê°€\n                <?php elseif ($info['type'] === 'multievent_final_only'): ?>\n                    ë©€í‹°ì´ë²¤íŠ¸ ê²°ìŠ¹ì „ (ì¤€ê²°ìŠ¹ ì—†ìŒ) - ë°”ë¡œ ê²°ìŠ¹ì „ìœ¼ë¡œ ì§„í–‰\n                <?php endif; ?>\n            </p>\n            <a href=\"judge_scoring_router.php?comp_id=<?= h($comp_id) ?>&event_no=<?= $event_no ?>&lang=<?= h($lang) ?>\" \n               class=\"test-btn\" target=\"_blank\">\n                í…ŒìŠ¤íŠ¸í•˜ê¸°\n            </a>\n        </div>\n        <?php endforeach; ?>\n        \n        <div style=\"text-align: center; margin-top: 30px; padding: 20px; background: #e8f5e8; border-radius: 8px;\">\n            <h3>ğŸ“ í…ŒìŠ¤íŠ¸ ë°©ë²•</h3>\n            <p>1. ê° ì‹¬ì‚¬ ë°©ì‹ì„ í´ë¦­í•˜ì—¬ í…ŒìŠ¤íŠ¸ í˜ì´ì§€ë¡œ ì´ë™</p>\n            <p>2. ê° ì‹œìŠ¤í…œì˜ ê¸°ëŠ¥ì„ í™•ì¸í•˜ê³  í…ŒìŠ¤íŠ¸</p>\n            <p>3. ë°ì´í„° ì €ì¥ ë° ë³µì› ê¸°ëŠ¥ í™•ì¸</p>\n            <p>4. ëª¨ë°”ì¼/íƒœë¸”ë¦¿ ë°˜ì‘í˜• ë””ìì¸ í™•ì¸</p>\n        </div>\n    </div>\n</body>\n</html>\n","size_bytes":4610},"comp/test_simple.php":{"content":"<?php\n// ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸ í˜ì´ì§€\necho \"<h1>5ê°€ì§€ ì‹¬ì‚¬ ë°©ì‹ í…ŒìŠ¤íŠ¸</h1>\";\n\n$comp_id = '20250907-001';\n$lang = 'ko';\n\n$scoring_types = [\n    '8' => 'ë©€í‹°ì´ë²¤íŠ¸ ê²°ìŠ¹ì „ (ê¸°ì¡´)',\n    '9' => 'ë©€í‹°ì´ë²¤íŠ¸ ì¤€ê²°ìŠ¹ (ê¸°ì¡´)', \n    '10' => 'í”„ë¦¬ìŠ¤íƒ€ì¼ ì‹¬ì‚¬',\n    '11' => 'í¬ë©”ì´ì…˜ ì‹¬ì‚¬',\n    '12' => 'ë©€í‹°ì´ë²¤íŠ¸ ê²°ìŠ¹ì „ (ì¤€ê²°ìŠ¹ ì—†ìŒ)'\n];\n\nforeach ($scoring_types as $event_no => $name) {\n    echo \"<p>\";\n    echo \"<strong>ì´ë²¤íŠ¸ #{$event_no}: {$name}</strong><br>\";\n    echo \"<a href='judge_scoring_router.php?comp_id={$comp_id}&event_no={$event_no}&lang={$lang}' target='_blank'>í…ŒìŠ¤íŠ¸í•˜ê¸°</a>\";\n    echo \"</p><hr>\";\n}\n?>\n\n\n\n\n\n\n","size_bytes":683},"comp/test_touch.php":{"content":"<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>í„°ì¹˜ í…ŒìŠ¤íŠ¸</title>\n    <style>\n        .player-card {\n            background: #fff;\n            border: 2px solid #ddd;\n            border-radius: 6px;\n            padding: 20px;\n            text-align: center;\n            cursor: pointer;\n            transition: all 0.3s ease;\n            margin: 10px;\n            display: inline-block;\n            min-width: 80px;\n            user-select: none;\n        }\n        .player-card.selected {\n            border-color: #4CAF50;\n            background: #e8f5e8;\n        }\n        .player-card:hover {\n            border-color: #4CAF50;\n            transform: translateY(-2px);\n        }\n    </style>\n</head>\n<body>\n    <h1>í„°ì¹˜ í…ŒìŠ¤íŠ¸</h1>\n    <p>ì„ ìˆ˜ ë²ˆí˜¸ë¥¼ í´ë¦­í•˜ê±°ë‚˜ í„°ì¹˜í•´ë³´ì„¸ìš”:</p>\n    \n    <div class=\"player-card\" data-player=\"11\" onclick=\"toggleCard(this)\">\n        <div class=\"player-number\">11</div>\n        <input type=\"checkbox\" class=\"recall-checkbox\" style=\"display: none;\">\n    </div>\n    \n    <div class=\"player-card\" data-player=\"12\" onclick=\"toggleCard(this)\">\n        <div class=\"player-number\">12</div>\n        <input type=\"checkbox\" class=\"recall-checkbox\" style=\"display: none;\">\n    </div>\n    \n    <div class=\"player-card\" data-player=\"13\" onclick=\"toggleCard(this)\">\n        <div class=\"player-number\">13</div>\n        <input type=\"checkbox\" class=\"recall-checkbox\" style=\"display: none;\">\n    </div>\n    \n    <div class=\"player-card\" data-player=\"14\" onclick=\"toggleCard(this)\">\n        <div class=\"player-number\">14</div>\n        <input type=\"checkbox\" class=\"recall-checkbox\" style=\"display: none;\">\n    </div>\n    \n    <div class=\"player-card\" data-player=\"15\" onclick=\"toggleCard(this)\">\n        <div class=\"player-number\">15</div>\n        <input type=\"checkbox\" class=\"recall-checkbox\" style=\"display: none;\">\n    </div>\n    \n    <div id=\"status\">ì„ íƒëœ ì„ ìˆ˜: 0ëª…</div>\n    \n    <script>\n        function toggleCard(card) {\n            console.log('Card clicked:', card);\n            const checkbox = card.querySelector('.recall-checkbox');\n            checkbox.checked = !checkbox.checked;\n            \n            if (checkbox.checked) {\n                card.classList.add('selected');\n            } else {\n                card.classList.remove('selected');\n            }\n            \n            updateStatus();\n        }\n        \n        function updateStatus() {\n            const selected = document.querySelectorAll('.recall-checkbox:checked').length;\n            document.getElementById('status').textContent = `ì„ íƒëœ ì„ ìˆ˜: ${selected}ëª…`;\n        }\n        \n        // í„°ì¹˜ ì´ë²¤íŠ¸ë„ ì¶”ê°€\n        document.querySelectorAll('.player-card').forEach(card => {\n            card.addEventListener('touchstart', function(e) {\n                e.preventDefault();\n                this.style.transform = 'scale(0.95)';\n            });\n            \n            card.addEventListener('touchend', function(e) {\n                e.preventDefault();\n                this.style.transform = '';\n                toggleCard(this);\n            });\n        });\n    </script>\n</body>\n</html>\n\n\n\n\n\n\n","size_bytes":3254},"comp/test_upload.php":{"content":"<?php\necho \"File upload test - \" . date('Y-m-d H:i:s');\necho \"<br>Current directory: \" . __DIR__;\necho \"<br>File exists: \" . (file_exists(__DIR__ . '/judge_scoring.php') ? 'YES' : 'NO');\necho \"<br>File size: \" . filesize(__DIR__ . '/judge_scoring.php') . \" bytes\";\n?>\n\n\n\n","size_bytes":271},"comp/update_event_status.php":{"content":"<?php\n/**\n * ì´ë²¤íŠ¸ ìƒíƒœ ì—…ë°ì´íŠ¸ API\n */\n\nheader('Content-Type: application/json');\n\n$eventId = $_POST['event_id'] ?? '';\n$showResult = $_POST['show_result'] === 'true';\n\nif (!$eventId) {\n    echo json_encode(['success' => false, 'message' => 'ì´ë²¤íŠ¸ IDê°€ í•„ìš”í•©ë‹ˆë‹¤.']);\n    exit;\n}\n\n// ì´ë²¤íŠ¸ ìƒíƒœ íŒŒì¼ ê²½ë¡œ\n$statusFile = __DIR__ . '/uploads/event_status.json';\n\n// ê¸°ì¡´ ìƒíƒœ ë¡œë“œ\n$status = [];\nif (file_exists($statusFile)) {\n    $status = json_decode(file_get_contents($statusFile), true) ?: [];\n}\n\n// ìƒíƒœ ì—…ë°ì´íŠ¸\n$status[$eventId] = $showResult;\n\n// íŒŒì¼ ì €ì¥\nif (file_put_contents($statusFile, json_encode($status, JSON_PRETTY_PRINT))) {\n    echo json_encode(['success' => true, 'message' => 'ìƒíƒœê°€ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.']);\n} else {\n    echo json_encode(['success' => false, 'message' => 'íŒŒì¼ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.']);\n}\n?>\n\n\n\n\n","size_bytes":903},"comp/view_scores.php":{"content":"<?php\n$comp_id = $_GET['comp_id'] ?? '';\n$event_no = $_GET['event_no'] ?? '';\n\n// Remove BOM and normalize\n$comp_id = preg_replace('/\\x{FEFF}/u', '', $comp_id);\n$event_no = preg_replace('/\\x{FEFF}/u', '', $event_no);\n\n$comp_id = preg_replace('/[^\\d-]/', '', $comp_id);\n$event_no = preg_replace('/\\D+/', '', $event_no);\n\n// Language setting\n$lang = $_GET['lang'] ?? 'ko';\nif (!in_array($lang, ['ko', 'en', 'zh', 'ja'])) {\n    $lang = 'ko';\n}\n\nif (!$comp_id || !$event_no) {\n    echo \"<h1>ì˜ëª»ëœ ëŒ€íšŒ ID ë˜ëŠ” ì´ë²¤íŠ¸ ë²ˆí˜¸ì…ë‹ˆë‹¤.</h1>\";\n    exit;\n}\n\n// Load scores\n$scores_file = __DIR__ . \"/data/$comp_id/scores_$event_no.json\";\n$scores_data = null;\n$recall_data = null;\n\nif (file_exists($scores_file)) {\n    $content = file_get_contents($scores_file);\n    $scores_data = json_decode($content, true);\n} else {\n    // Look for .adj files (recall round)\n    $adj_files = glob(\"$data_dir/{$event_no}_*.adj\");\n    $recall_data = [];\n    \n    foreach ($adj_files as $file) {\n        $filename = basename($file);\n        if (preg_match('/^(\\d+)_(.+)_(\\d+)\\.adj$/', $filename, $matches)) {\n            $file_dance = $matches[2];\n            $file_judge_id = $matches[3];\n            \n            // Read file content\n            $lines = file($file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n            $players = [];\n            \n            foreach ($lines as $line) {\n                $line = trim($line, '\"');\n                if ($line && is_numeric($line)) {\n                    $players[] = $line;\n                }\n            }\n            \n            if (!isset($recall_data[$file_dance])) {\n                $recall_data[$file_dance] = [];\n            }\n            \n            $recall_data[$file_dance][$file_judge_id] = $players;\n        }\n    }\n}\n\n// Load event data\n$data_dir = __DIR__ . \"/data/$comp_id\";\n$runorder_file = \"$data_dir/RunOrder_Tablet.txt\";\n$event_data = null;\n\nif (file_exists($runorder_file)) {\n    $lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        if (preg_match('/^bom/', $line)) continue;\n        $cols = array_map('trim', explode(',', $line));\n        if (($cols[0] ?? '') === $event_no) {\n            $event_data = [\n                'no' => $cols[0],\n                'name' => $cols[1],\n                'round_type' => $cols[2],\n                'round_num' => $cols[3],\n                'dances' => []\n            ];\n            for ($i = 6; $i <= 10; $i++) {\n                if (!empty($cols[$i])) $event_data['dances'][] = $cols[$i];\n            }\n            break;\n        }\n    }\n}\n\nfunction h($s) { return htmlspecialchars($s ?? ''); }\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>ì±„ì  ê²°ê³¼ | <?=h($event_data['name'] ?? 'ì´ë²¤íŠ¸')?></title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\n    <style>\n        body { background:#1a1a1a; font-family:sans-serif; margin:0; padding:20px;}\n        .container { max-width:1200px; margin:0 auto; background:#fff; border-radius:12px; padding:30px; box-shadow:0 4px 20px rgba(0,0,0,0.3);}\n        h1 { color:#003399; margin-bottom:20px; text-align:center;}\n        .event-info { background:#f0f4ff; padding:15px; border-radius:8px; margin-bottom:20px; text-align:center;}\n        .event-info h2 { margin:0 0 10px 0; color:#0d2c96;}\n        .event-info p { margin:5px 0; color:#333;}\n        .results-section { margin-bottom:30px;}\n        .results-header { background:#03C75A; color:#fff; padding:10px 15px; border-radius:6px 6px 0 0; font-weight:bold;}\n        .results-table { width:100%; border-collapse:collapse; background:#fff; border:1px solid #ddd;}\n        .results-table th, .results-table td { padding:12px 8px; text-align:center; border:1px solid #ddd;}\n        .results-table th { background:#f8f9fa; font-weight:bold; color:#333;}\n        .results-table tr:nth-child(even) { background:#f8f9fa;}\n        .place-1 { background:#FFD700; font-weight:bold; color:#000;}\n        .place-2 { background:#C0C0C0; font-weight:bold; color:#000;}\n        .place-3 { background:#CD7F32; font-weight:bold; color:#fff;}\n        .adjudicator-section { margin-bottom:30px;}\n        .adjudicator-header { background:#003399; color:#fff; padding:10px 15px; border-radius:6px 6px 0 0; font-weight:bold;}\n        .adjudicator-table { width:100%; border-collapse:collapse; background:#fff; border:1px solid #ddd; font-size:14px;}\n        .adjudicator-table th, .adjudicator-table td { padding:8px 4px; text-align:center; border:1px solid #ddd;}\n        .adjudicator-table th { background:#f8f9fa; font-weight:bold; color:#333;}\n        .adjudicator-table tr:nth-child(even) { background:#f8f9fa;}\n        .no-data { text-align:center; padding:40px; color:#666; font-size:18px;}\n        .back-btn { background:#6c757d; color:#fff; border:none; padding:10px 20px; font-size:14px; border-radius:6px; cursor:pointer; text-decoration:none; display:inline-block; margin-bottom:20px;}\n        .back-btn:hover { background:#5a6268;}\n        .stats { background:#e7f3ff; border:1px solid #b3d9ff; padding:15px; border-radius:6px; margin-bottom:20px;}\n        .stats h3 { margin:0 0 10px 0; color:#003399;}\n        .stats p { margin:5px 0; color:#333;}\n    </style>\n</head>\n<body>\n<div class=\"container\">\n    <a href=\"live_panel.php?comp_id=<?=h($comp_id)?>\" class=\"back-btn\">â† ë¼ì´ë¸Œ íŒ¨ë„ë¡œ ëŒì•„ê°€ê¸°</a>\n    \n    <h1>ì±„ì  ê²°ê³¼</h1>\n    \n    <?php if ($event_data): ?>\n    <div class=\"event-info\">\n        <h2><?=h($event_data['name'])?></h2>\n        <p><strong>ì´ë²¤íŠ¸ ë²ˆí˜¸:</strong> <?=h($event_data['no'])?></p>\n        <p><strong>ë¼ìš´ë“œ:</strong> <?=h($event_data['round_type'])?> <?=h($event_data['round_num'])?></p>\n        <p><strong>ì¢…ëª©:</strong> <?=h(implode(', ', $event_data['dances']))?></p>\n    </div>\n    <?php endif; ?>\n\n    <?php if ($scores_data): ?>\n        <div class=\"stats\">\n            <h3>ì±„ì  ì •ë³´ (ê²°ìŠ¹ì „)</h3>\n            <p><strong>ì±„ì  ì‹œê°„:</strong> <?=h($scores_data['calculated_at'])?></p>\n            <p><strong>ì‹¬ì‚¬ìœ„ì› ìˆ˜:</strong> <?=h($scores_data['num_adjudicators'])?>ëª…</p>\n            <p><strong>ì¶œì „ ì„ ìˆ˜:</strong> <?=h($scores_data['num_couples'])?>ëª…</p>\n        </div>\n    <?php elseif ($recall_data): ?>\n        <div class=\"stats\">\n            <h3>Recall ì •ë³´ (ì˜ˆì„ /ì¤€ê²°)</h3>\n            <p><strong>ì±„ì ëœ ëŒ„ìŠ¤:</strong> <?=count($recall_data)?>ê°œ</p>\n            <?php \n            $total_judges = 0;\n            foreach ($recall_data as $dance => $judges) {\n                $total_judges = max($total_judges, count($judges));\n            }\n            ?>\n            <p><strong>ì‹¬ì‚¬ìœ„ì› ìˆ˜:</strong> <?=$total_judges?>ëª…</p>\n        </div>\n    <?php endif; ?>\n\n        <div class=\"results-section\">\n            <div class=\"results-header\">\n                ìµœì¢… ê²°ê³¼ (Skating System ì ìš©)\n            </div>\n            <table class=\"results-table\">\n                <thead>\n                    <tr>\n                        <th style=\"width:80px;\">ìˆœìœ„</th>\n                        <th style=\"width:100px;\">ì„ ìˆ˜ ë²ˆí˜¸</th>\n                        <th style=\"width:200px;\">ì„ ìˆ˜ ì •ë³´</th>\n                        <th style=\"width:150px;\">ì´ ì ìˆ˜</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    <?php \n                    $results = $scores_data['results']['results'];\n                    $couples = $scores_data['results']['couples'];\n                    $sortedResults = $results;\n                    asort($sortedResults);\n                    $place = 1;\n                    foreach ($sortedResults as $coupleId => $finalPlace): \n                        $totalMarks = $couples[$coupleId]['total_marks'];\n                        $placeClass = '';\n                        if ($finalPlace == 1) $placeClass = 'place-1';\n                        elseif ($finalPlace == 2) $placeClass = 'place-2';\n                        elseif ($finalPlace == 3) $placeClass = 'place-3';\n                    ?>\n                    <tr>\n                        <td class=\"<?=$placeClass?>\"><strong><?=$finalPlace?></strong></td>\n                        <td><strong><?=h($coupleId)?></strong></td>\n                        <td>ì„ ìˆ˜ #<?=h($coupleId)?></td>\n                        <td><?=h($totalMarks)?></td>\n                    </tr>\n                    <?php $place++; endforeach; ?>\n                </tbody>\n            </table>\n        </div>\n\n        <div class=\"adjudicator-section\">\n            <div class=\"adjudicator-header\">\n                ì‹¬ì‚¬ìœ„ì›ë³„ ìƒì„¸ ì ìˆ˜\n            </div>\n            <table class=\"adjudicator-table\">\n                <thead>\n                    <tr>\n                        <th style=\"width:100px;\">ì„ ìˆ˜ ë²ˆí˜¸</th>\n                        <?php foreach ($scores_data['adjudicator_marks'] as $adjudicatorId => $marks): ?>\n                        <th style=\"width:60px;\">ì‹¬ì‚¬ìœ„ì› <?=h($adjudicatorId)?></th>\n                        <?php endforeach; ?>\n                        <th style=\"width:80px;\">ì´ì </th>\n                    </tr>\n                </thead>\n                <tbody>\n                    <?php foreach ($sortedResults as $coupleId => $finalPlace): ?>\n                    <tr>\n                        <td><strong><?=h($coupleId)?></strong></td>\n                        <?php foreach ($scores_data['adjudicator_marks'] as $adjudicatorId => $marks): ?>\n                        <td><?=h($marks[$coupleId] ?? '-')?></td>\n                        <?php endforeach; ?>\n                        <td><strong><?=h($couples[$coupleId]['total_marks'])?></strong></td>\n                    </tr>\n                    <?php endforeach; ?>\n                </tbody>\n            </table>\n        </div>\n\n        <div style=\"text-align:center; margin-top:30px;\">\n            <a href=\"judge_scoring.php?comp_id=<?=h($comp_id)?>&event_no=<?=h($event_no)?>\" \n               style=\"background:#003399; color:#fff; border:none; padding:12px 24px; font-size:16px; font-weight:bold; border-radius:8px; cursor:pointer; text-decoration:none; display:inline-block;\">\n               ì ìˆ˜ ìˆ˜ì •í•˜ê¸°\n            </a>\n        </div>\n\n    <?php elseif ($recall_data): ?>\n        <!-- Recall Data Display -->\n        <?php foreach ($recall_data as $dance => $judges): ?>\n        <div class=\"results-section\">\n            <div class=\"results-header\">\n                <?=h($dance)?> - Recall ê²°ê³¼\n            </div>\n            <table class=\"results-table\">\n                <thead>\n                    <tr>\n                        <th style=\"width:100px;\">ì‹¬ì‚¬ìœ„ì›</th>\n                        <th>ì„ íƒëœ ì„ ìˆ˜</th>\n                        <th style=\"width:80px;\">ì„ íƒ ìˆ˜</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    <?php foreach ($judges as $judge_id => $selected_players): ?>\n                    <tr>\n                        <td><strong>ì‹¬ì‚¬ìœ„ì› #<?=h($judge_id)?></strong></td>\n                        <td style=\"text-align:left;\">\n                            <?php if (!empty($selected_players)): ?>\n                                <?=h(implode(', ', $selected_players))?>\n                            <?php else: ?>\n                                <span style=\"color:#999;\">ì„ íƒ ì—†ìŒ</span>\n                            <?php endif; ?>\n                        </td>\n                        <td><?=count($selected_players)?>ëª…</td>\n                    </tr>\n                    <?php endforeach; ?>\n                </tbody>\n            </table>\n        </div>\n        <?php endforeach; ?>\n        \n        <div style=\"text-align:center; margin-top:30px;\">\n            <a href=\"judge_scoring.php?comp_id=<?=h($comp_id)?>&event_no=<?=h($event_no)?>\" \n               style=\"background:#003399; color:#fff; border:none; padding:12px 24px; font-size:16px; font-weight:bold; border-radius:8px; cursor:pointer; text-decoration:none; display:inline-block;\">\n               ì ìˆ˜ ìˆ˜ì •í•˜ê¸°\n            </a>\n        </div>\n\n    <?php else: ?>\n        <div class=\"no-data\">\n            <p>ì•„ì§ ì±„ì ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>\n            <a href=\"judge_scoring.php?comp_id=<?=h($comp_id)?>&event_no=<?=h($event_no)?>\" \n               style=\"background:#03C75A; color:#fff; border:none; padding:12px 24px; font-size:16px; font-weight:bold; border-radius:8px; cursor:pointer; text-decoration:none; display:inline-block; margin-top:20px;\">\n               ì±„ì  ì‹œì‘í•˜ê¸°\n            </a>\n        </div>\n    <?php endif; ?>\n</div>\n\n<footer style=\"text-align: center; margin-top: 30px; color: #666; font-size: 0.9em; padding: 20px; border-top: 1px solid #eee;\">\n    2025 danceoffice.net | Powered by Seyoung Lee\n</footer>\n</body>\n</html>\n","size_bytes":12833},"comp/working_router.php":{"content":"<?php\n/**\n * ì‘ë™í•˜ëŠ” ë¼ìš°í„° - debug_router2.php ê¸°ë°˜\n */\n\nsession_start();\n\n// ê³µí†µ í•¨ìˆ˜ë“¤ í¬í•¨\nrequire_once __DIR__ . '/scoring/shared/functions.php';\nrequire_once __DIR__ . '/scoring/shared/components.php';\n\n// ê¸°ë³¸ ì„¤ì •\n$comp_id = $_GET['comp_id'] ?? '';\n$event_no = $_GET['event_no'] ?? '';\n$lang = $_GET['lang'] ?? 'ko';\n\n// ì´ë²¤íŠ¸ ë°ì´í„° ë¡œë“œ\n$event_data = loadEventData($comp_id, $event_no);\nif (!$event_data) {\n    die('<div class=\"error\">ì´ë²¤íŠ¸ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>');\n}\n\n// ì„ ìˆ˜ ë°ì´í„° ë¡œë“œ\n$players = loadPlayersData($comp_id, $event_no);\nif (empty($players)) {\n    die('<div class=\"error\">ì„ ìˆ˜ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>');\n}\n\n// ëŒ„ìŠ¤ ë§¤í•‘ ë¡œë“œ\n$dance_mapping = loadDanceMapping($comp_id);\n\n// ë¼ìš´ë“œ ì •ë³´ ë¡œë“œ\n$round_info = loadRoundInfo($comp_id);\n\n// ê²°ìŠ¹ì „ ì—¬ë¶€ í™•ì¸\n$is_final = isFinalRound($event_no, $round_info, $event_data);\n\n// ì–¸ì–´ í…ìŠ¤íŠ¸ ë¡œë“œ\n$t = getLanguageTexts($lang);\n\n// ì‹¬ì‚¬ìœ„ì› ì •ë³´ (ì„ì‹œë¡œ ì„¤ì •)\n$judge_id = $_SESSION['scoring_judge_id'] ?? '8';\n$judge_name = $_SESSION['scoring_judge_name'] ?? 'Test Judge';\n$judge_country = $_SESSION['scoring_judge_country'] ?? 'Korea';\n\n// ì´ë²¤íŠ¸ë³„ ë°ì´í„° ì¤€ë¹„\n$recall_count = intval($event_data['recall_count'] ?? 0);\n$round_display = $event_data['round_type'] ?? '';\n\n// ì‹¬ì‚¬ ë°©ì‹ ê²°ì •\n$scoring_type = 'multievent_preliminary'; // ê¸°ë³¸ê°’\n\n// ì´ë²¤íŠ¸ë³„ ì‹¬ì‚¬ ë°©ì‹ ë§¤í•‘\n$scoring_type_mapping = [\n    '8' => 'multievent_final',           // ê¸°ì¡´ ê²°ìŠ¹ì „\n    '9' => 'multievent_preliminary',     // ê¸°ì¡´ ì¤€ê²°ìŠ¹\n    '10' => 'freestyle',                 // í”„ë¦¬ìŠ¤íƒ€ì¼\n    '11' => 'formation',                 // í¬ë©”ì´ì…˜\n    '12' => 'multievent_final_only'      // ë©€í‹°ì´ë²¤íŠ¸ ê²°ìŠ¹ì „(ì¤€ê²°ìŠ¹ ì—†ìŒ)\n];\n\n// ì´ë²¤íŠ¸ ë²ˆí˜¸ì— ë”°ë¥¸ ì‹¬ì‚¬ ë°©ì‹ ê²°ì •\nif (isset($scoring_type_mapping[$event_no])) {\n    $scoring_type = $scoring_type_mapping[$event_no];\n} elseif ($is_final || $event_no === '8') {\n    $scoring_type = 'multievent_final';\n}\n\n// ì‹¬ì‚¬ ë°©ì‹ë³„ ë°ì´í„° ì¤€ë¹„\n$hits_data = null;\n$existing_selections = [];\n$saved_rankings = [];\n\nif ($scoring_type === 'multievent_preliminary') {\n    // ì˜ˆì„ /ì¤€ê²°ìŠ¹ìš© ë°ì´í„°\n    $data_dir = __DIR__ . \"/data/$comp_id\";\n    $hits_file = \"$data_dir/players_hits_$event_no.json\";\n    if (file_exists($hits_file)) {\n        $hits_data = json_decode(file_get_contents($hits_file), true);\n    }\n    $existing_selections = loadExistingSelections($comp_id, $event_no, $judge_id, $event_data['dances']);\n} elseif (in_array($scoring_type, ['multievent_final', 'multievent_final_only'])) {\n    // ê²°ìŠ¹ì „ìš© ë°ì´í„°\n    $data_dir = __DIR__ . \"/data/$comp_id\";\n    foreach ($event_data['dances'] as $dance) {\n        $adj_file = \"$data_dir/{$event_no}_{$dance}_{$judge_id}.adj\";\n        if (file_exists($adj_file)) {\n            $lines = file($adj_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n            $dance_rankings = [];\n            foreach ($lines as $line) {\n                $line = cleanInput($line);\n                $parts = explode(',', $line);\n                if (count($parts) >= 2) {\n                    $dance_rankings[] = [trim($parts[0]), trim($parts[1])];\n                }\n            }\n            if (!empty($dance_rankings)) {\n                $saved_rankings[$dance] = $dance_rankings;\n            }\n        }\n    }\n}\n\n// ì €ì¥ëœ ì ìˆ˜ í‘œì‹œìš©\n$saved_scores = [];\nif (in_array($scoring_type, ['multievent_final', 'multievent_final_only'])) {\n    $saved_scores = array_keys($saved_rankings);\n} elseif ($scoring_type === 'multievent_preliminary') {\n    $saved_scores = array_keys($existing_selections);\n}\n\n// ëŒ„ìŠ¤ ì´ë¦„ ë³€í™˜\n$dance_names = getDanceNames($event_data['dances'], $dance_mapping);\n?>\n\n<!DOCTYPE html>\n<html lang=\"<?=h($lang)?>\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title><?=h($t['title'])?></title>\n    \n    <!-- ê³µí†µ ìŠ¤íƒ€ì¼ í¬í•¨ -->\n    <?php include __DIR__ . '/scoring/shared/styles.php'; ?>\n</head>\n<body>\n    <div class=\"scoring-container\">\n        <!-- ì‹¬ì‚¬ìœ„ì› ì •ë³´ í—¤ë” -->\n        <?php renderJudgeInfoHeader($judge_id, $judge_name, $judge_country, $recall_count, $is_final, $event_no); ?>\n        \n        <!-- ì´ë²¤íŠ¸ ì •ë³´ í—¤ë” -->\n        <?php renderEventInfoHeader($event_data, $round_display, $dance_names, count($players), $hits_data, $saved_scores); ?>\n        \n        <!-- ë©”ì‹œì§€ ì»¨í…Œì´ë„ˆ -->\n        <?php renderMessageContainer(); ?>\n        \n        <!-- í¼ ì‹œì‘ -->\n        <?php renderFormStart($comp_id, $event_no, $is_final, $recall_count); ?>\n        \n        <!-- ì‹¬ì‚¬ ì‹œìŠ¤í…œ ë¡œë“œ -->\n        <?php \n        echo \"<!-- DEBUG: scoring_type = \" . $scoring_type . \" -->\";\n        echo \"<!-- DEBUG: event_no = \" . $event_no . \" -->\";\n        echo \"<!-- DEBUG: is_final = \" . ($is_final ? 'TRUE' : 'FALSE') . \" -->\";\n        \n        $scoring_file = __DIR__ . \"/scoring/types/{$scoring_type}.php\";\n        echo \"<!-- DEBUG: scoring_file = \" . $scoring_file . \" -->\";\n        echo \"<!-- DEBUG: file_exists = \" . (file_exists($scoring_file) ? 'TRUE' : 'FALSE') . \" -->\";\n        \n        echo \"<div style='background: lightblue; padding: 10px; margin: 10px; border: 2px solid blue;'>\";\n        echo \"<h3>DEBUG: About to include scoring file</h3>\";\n        echo \"<p>File: \" . htmlspecialchars($scoring_file) . \"</p>\";\n        echo \"<p>Exists: \" . (file_exists($scoring_file) ? 'YES' : 'NO') . \"</p>\";\n        echo \"</div>\";\n        \n        if (file_exists($scoring_file)) {\n            echo \"<div style='background: lightgreen; padding: 10px; margin: 10px; border: 2px solid green;'>\";\n            echo \"<h3>DEBUG: Including file now...</h3>\";\n            echo \"</div>\";\n            \n            try {\n                include $scoring_file;\n                echo \"<div style='background: lightgreen; padding: 10px; margin: 10px; border: 2px solid green;'>\";\n                echo \"<h3>DEBUG: File included successfully!</h3>\";\n                echo \"</div>\";\n            } catch (Exception $e) {\n                echo \"<div style='background: lightcoral; padding: 10px; margin: 10px; border: 2px solid red;'>\";\n                echo \"<h3>DEBUG: Error including file: \" . htmlspecialchars($e->getMessage()) . \"</h3>\";\n                echo \"</div>\";\n            }\n        } else {\n            echo '<div class=\"error\">ì§€ì›í•˜ì§€ ì•ŠëŠ” ì‹¬ì‚¬ ë°©ì‹ì…ë‹ˆë‹¤: ' . h($scoring_type) . '</div>';\n        }\n        ?>\n        \n        <!-- í¼ ì¢…ë£Œ -->\n        <?php renderFormEnd(); ?>\n        \n        <!-- í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->\n        <?php renderBottomNavigation($comp_id, $lang); ?>\n        \n        <!-- í‘¸í„° -->\n        <?php renderFooter(); ?>\n    </div>\n    \n    <!-- ê³µí†µ JavaScript í¬í•¨ -->\n    <?php renderCommonJavaScript($comp_id, $lang); ?>\n</body>\n</html>\n","size_bytes":6957},"comprehensive/index.php":{"content":"<?php\n// ì¢…í•©ê²°ê³¼ í˜ì´ì§€ - ëŒ„ìŠ¤ìŠ¤ì½”ì–´ì™€ ìì²´ ì‹œìŠ¤í…œ í†µí•©\nrequire_once __DIR__ . '/../data/scheduler.php';\n\n$scheduler = new CompetitionScheduler();\n\n// í˜„ì¬ ì£¼ê°„ ëŒ€íšŒë“¤\n$currentWeek = date('Y-m-d', strtotime('monday this week'));\n$nextWeek = date('Y-m-d', strtotime('monday next week'));\n$lastWeek = date('Y-m-d', strtotime('monday last week'));\n\n$lastWeekCompetitions = $scheduler->getCompetitionsByDateRange($lastWeek, date('Y-m-d', strtotime('sunday last week')));\n$currentWeekCompetitions = $scheduler->getCompetitionsByDateRange($currentWeek, date('Y-m-d', strtotime('sunday this week')));\n$nextWeekCompetitions = $scheduler->getCompetitionsByDateRange($nextWeek, date('Y-m-d', strtotime('sunday next week')));\n\n// ì—°ë„ë³„ ëŒ€íšŒ ëª©ë¡\n$currentYear = date('Y');\n$availableYears = [];\n$allCompetitions = $scheduler->getAllCompetitions();\nforeach ($allCompetitions as $comp) {\n    $year = date('Y', strtotime($comp['date']));\n    if (!in_array($year, $availableYears)) {\n        $availableYears[] = $year;\n    }\n}\nrsort($availableYears); // ìµœì‹  ì—°ë„ë¶€í„°\n\n// íŠ¹ì • ì—°ë„ ì„ íƒ\n$selectedYear = $_GET['year'] ?? $currentYear;\n$yearCompetitions = $scheduler->getCompetitionsByYear($selectedYear);\n\n// íŠ¹ì • ëŒ€íšŒ ì„ íƒ\n$selectedComp = null;\nif (isset($_GET['comp'])) {\n    $selectedComp = $scheduler->getCompetitionById($_GET['comp']);\n}\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>ì¢…í•©ê²°ê³¼ - danceoffice.net</title>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <link rel=\"stylesheet\" href=\"/assets/style.css\">\n    <style>\n        /* PC ë²„ì „ ìŠ¤íƒ€ì¼ */\n        @media (min-width: 1024px) {\n            body {\n                background: #181B20;\n                min-height: 100vh;\n                font-size: 14px;\n                line-height: 1.5;\n            }\n            \n            .main-container {\n                display: grid;\n                grid-template-columns: 200px 1fr 180px;\n                grid-template-rows: auto 1fr auto;\n                grid-template-areas: \n                    \"sidebar-left header sidebar-right\"\n                    \"sidebar-left main sidebar-right\"\n                    \"footer footer footer\";\n                min-height: 100vh;\n                gap: 15px;\n                padding: 15px;\n                max-width: 1200px;\n                margin: 0 auto;\n            }\n            \n            .sidebar-left {\n                grid-area: sidebar-left;\n                display: flex;\n                flex-direction: column;\n                gap: 15px;\n            }\n            \n            .sidebar-left .logo-nav {\n                background: linear-gradient(135deg, #1a1d21 0%, #181B20 100%);\n                border-radius: 15px;\n                padding: 20px;\n                box-shadow: 0 8px 25px rgba(3, 199, 90, 0.15);\n                border: 2px solid #03C75A;\n                text-align: center;\n            }\n            \n            .sidebar-left .main-logo {\n                height: 50px;\n                margin-bottom: 20px;\n                filter: drop-shadow(0 3px 6px rgba(0,0,0,0.2));\n            }\n            \n            .sidebar-left .main-nav {\n                display: flex;\n                flex-direction: column;\n                gap: 10px;\n            }\n            \n            .sidebar-left .main-nav a {\n                color: white;\n                text-decoration: none;\n                font-weight: 600;\n                font-size: 14px;\n                padding: 12px 20px;\n                border-radius: 20px;\n                transition: all 0.3s ease;\n                background: rgba(3, 199, 90, 0.1);\n                backdrop-filter: blur(10px);\n                text-align: center;\n            }\n            \n            .sidebar-left .main-nav a:hover,\n            .sidebar-left .main-nav a.active {\n                background: #03C75A;\n                color: #222;\n                transform: translateY(-2px);\n                box-shadow: 0 4px 12px rgba(3, 199, 90, 0.3);\n            }\n            \n            .ad-side {\n                grid-area: sidebar-right;\n                display: flex;\n                flex-direction: column;\n                gap: 15px;\n            }\n            \n            .ad-side img {\n                width: 100%;\n                border-radius: 12px;\n                box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n                transition: transform 0.3s ease;\n            }\n            \n            .ad-side img:hover {\n                transform: scale(1.03);\n            }\n            \n            .main-header {\n                grid-area: header;\n                background: linear-gradient(135deg, #1a1d21 0%, #181B20 100%);\n                border-radius: 15px;\n                padding: 20px;\n                box-shadow: 0 8px 25px rgba(3, 199, 90, 0.15);\n                border: 2px solid #03C75A;\n                text-align: center;\n            }\n            \n            .main-header h1 {\n                color: #03C75A;\n                font-size: 24px;\n                margin: 0;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                gap: 12px;\n            }\n            \n            main {\n                grid-area: main;\n                display: flex;\n                flex-direction: column;\n                gap: 20px;\n            }\n            \n            .results-grid {\n                display: grid;\n                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\n                gap: 20px;\n            }\n            \n            .result-card {\n                background: #222;\n                border-radius: 15px;\n                padding: 20px;\n                box-shadow: 0 8px 25px rgba(3, 199, 90, 0.08);\n                border: 1px solid #31343a;\n                transition: transform 0.3s ease;\n            }\n            \n            .result-card:hover {\n                transform: translateY(-3px);\n                box-shadow: 0 12px 30px rgba(3, 199, 90, 0.15);\n            }\n            \n            .result-card h3 {\n                color: #03C75A;\n                font-size: 18px;\n                margin-bottom: 15px;\n                display: flex;\n                align-items: center;\n                gap: 8px;\n            }\n            \n            .result-links {\n                display: flex;\n                gap: 10px;\n                flex-wrap: wrap;\n            }\n            \n            .result-links a {\n                background: linear-gradient(90deg, #03C75A 70%, #00BFAE 100%);\n                color: #222;\n                padding: 8px 16px;\n                border-radius: 15px;\n                text-decoration: none;\n                font-weight: 600;\n                font-size: 12px;\n                transition: all 0.3s ease;\n            }\n            \n            .result-links a:hover {\n                background: linear-gradient(90deg, #00BFAE 60%, #03C75A 100%);\n                color: white;\n                transform: translateY(-2px);\n            }\n            \n            .main-footer {\n                grid-area: footer;\n                text-align: center;\n                color: #03C75A;\n                padding: 15px;\n                background: #222;\n                border-radius: 12px;\n                box-shadow: 0 4px 12px rgba(3, 199, 90, 0.08);\n                border: 1px solid #31343a;\n                font-size: 13px;\n            }\n        }\n        \n        /* ëª¨ë°”ì¼ ë²„ì „ ìŠ¤íƒ€ì¼ */\n        @media (max-width: 1023px) {\n            body {\n                background: #181B20;\n                min-height: 100vh;\n                margin: 0;\n                padding: 0;\n                padding-bottom: 80px;\n            }\n            \n            .main-container {\n                display: flex;\n                flex-direction: column;\n                min-height: 100vh;\n            }\n            \n            .sidebar-left {\n                display: none;\n            }\n            \n            .ad-side {\n                display: none;\n            }\n            \n            .main-header {\n                background: rgba(26, 29, 33, 0.9);\n                backdrop-filter: blur(20px);\n                padding: 20px;\n                position: sticky;\n                top: 0;\n                z-index: 100;\n                border-bottom: 2px solid #03C75A;\n            }\n            \n            .main-header h1 {\n                color: #03C75A;\n                font-size: 20px;\n                margin: 0;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                gap: 8px;\n            }\n            \n            main {\n                flex: 1;\n                padding: 20px;\n                display: flex;\n                flex-direction: column;\n                gap: 20px;\n            }\n            \n            .results-grid {\n                display: flex;\n                flex-direction: column;\n                gap: 15px;\n            }\n            \n            .result-card {\n                background: rgba(34, 34, 34, 0.95);\n                border-radius: 20px;\n                padding: 20px;\n                box-shadow: 0 10px 30px rgba(3, 199, 90, 0.1);\n                backdrop-filter: blur(20px);\n                border: 1px solid #31343a;\n            }\n            \n            .result-card h3 {\n                color: #03C75A;\n                font-size: 16px;\n                margin-bottom: 15px;\n            }\n            \n            .result-links {\n                display: flex;\n                gap: 8px;\n                flex-wrap: wrap;\n            }\n            \n            .result-links a {\n                background: linear-gradient(90deg, #03C75A 70%, #00BFAE 100%);\n                color: #222;\n                padding: 10px 16px;\n                border-radius: 15px;\n                text-decoration: none;\n                font-weight: 600;\n                font-size: 12px;\n                transition: all 0.3s ease;\n            }\n            \n            .result-links a:hover {\n                background: linear-gradient(90deg, #00BFAE 60%, #03C75A 100%);\n                color: white;\n            }\n            \n            .main-footer {\n                text-align: center;\n                color: #03C75A;\n                padding: 20px;\n                background: rgba(34, 34, 34, 0.9);\n                backdrop-filter: blur(20px);\n                border-top: 2px solid #03C75A;\n            }\n            \n            /* í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ */\n            .bottom-nav {\n                position: fixed;\n                bottom: 0;\n                left: 0;\n                right: 0;\n                background: rgba(26, 29, 33, 0.95);\n                backdrop-filter: blur(20px);\n                border-top: 2px solid #03C75A;\n                padding: 10px 0;\n                z-index: 1000;\n                display: flex;\n                justify-content: space-around;\n                align-items: center;\n            }\n            \n            .bottom-nav a {\n                color: white;\n                text-decoration: none;\n                font-weight: 600;\n                font-size: 12px;\n                padding: 8px 12px;\n                border-radius: 15px;\n                background: rgba(3, 199, 90, 0.1);\n                backdrop-filter: blur(10px);\n                transition: all 0.3s ease;\n                text-align: center;\n                display: flex;\n                flex-direction: column;\n                align-items: center;\n                gap: 4px;\n                min-width: 60px;\n            }\n            \n            .bottom-nav a:hover,\n            .bottom-nav a.active {\n                background: #03C75A;\n                color: #222;\n                transform: translateY(-2px);\n            }\n            \n            .bottom-nav .nav-icon {\n                font-size: 20px;\n            }\n        }\n        \n        .material-symbols-rounded {\n            font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 24;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"main-container\">\n        <aside class=\"sidebar-left\">\n            <div class=\"logo-nav\">\n                <img src=\"/assets/danceoffice-logo.png\" alt=\"Danceoffice Logo\" class=\"main-logo\">\n                <nav class=\"main-nav\">\n                    <a href=\"/\">í™ˆ</a>\n                    <a href=\"/results/\">ê²½ê¸° ê²°ê³¼</a>\n                    <a href=\"/comprehensive/\" class=\"active\">ì¢…í•©ê²°ê³¼</a>\n                    <a href=\"/notice/\">ê³µì§€ì‚¬í•­</a>\n                    <a href=\"/manage/\">ê´€ë¦¬ì</a>\n                </nav>\n            </div>\n        </aside>\n        \n        <header class=\"main-header\">\n            <h1><span class=\"material-symbols-rounded\">analytics</span> ì¢…í•©ê²°ê³¼</h1>\n        </header>\n        \n        <aside class=\"ad-side\">\n            <!-- ê´‘ê³  ì˜ì—­ -->\n        </aside>\n        \n        <main>\n            <!-- ì£¼ê°„ ëŒ€íšŒ í˜„í™© -->\n            <section class=\"weekly-section\">\n                <h2><span class=\"material-symbols-rounded\">calendar_view_week</span> ì£¼ê°„ ëŒ€íšŒ í˜„í™©</h2>\n                \n                <!-- ì§€ë‚œì£¼ ëŒ€íšŒ -->\n                <?php if (!empty($lastWeekCompetitions)): ?>\n                <div class=\"week-group\">\n                    <h3><span class=\"material-symbols-rounded\">history</span> ì§€ë‚œì£¼ ëŒ€íšŒ</h3>\n                    <div class=\"competitions-grid\">\n                        <?php foreach ($lastWeekCompetitions as $comp): ?>\n                        <div class=\"competition-card completed\">\n                            <div class=\"comp-header\">\n                                <h4><?= htmlspecialchars($comp['title']) ?></h4>\n                                <div class=\"comp-date\"><?= date('m.d', strtotime($comp['date'])) ?></div>\n                            </div>\n                            <div class=\"comp-details\">\n                                <p><span class=\"material-symbols-rounded\">location_on</span> <?= htmlspecialchars($comp['place']) ?></p>\n                            </div>\n                            <div class=\"comp-actions\">\n                                <a href=\"/results/?comp=<?= $comp['id'] ?>\" class=\"button\">ê²°ê³¼ ë³´ê¸°</a>\n                            </div>\n                        </div>\n                        <?php endforeach; ?>\n                    </div>\n                </div>\n                <?php endif; ?>\n                \n                <!-- ì´ë²ˆì£¼ ëŒ€íšŒ -->\n                <?php if (!empty($currentWeekCompetitions)): ?>\n                <div class=\"week-group\">\n                    <h3><span class=\"material-symbols-rounded\">event</span> ì´ë²ˆì£¼ ëŒ€íšŒ</h3>\n                    <div class=\"competitions-grid\">\n                        <?php foreach ($currentWeekCompetitions as $comp): ?>\n                        <div class=\"competition-card <?= $comp['status'] === 'ongoing' ? 'ongoing' : 'upcoming' ?>\">\n                            <div class=\"comp-header\">\n                                <h4><?= htmlspecialchars($comp['title']) ?></h4>\n                                <div class=\"comp-date\"><?= date('m.d', strtotime($comp['date'])) ?></div>\n                            </div>\n                            <div class=\"comp-details\">\n                                <p><span class=\"material-symbols-rounded\">location_on</span> <?= htmlspecialchars($comp['place']) ?></p>\n                                <p><span class=\"material-symbols-rounded\">info</span> <?= ucfirst($comp['status']) ?></p>\n                            </div>\n                            <div class=\"comp-actions\">\n                                <?php if ($comp['status'] === 'completed'): ?>\n                                    <a href=\"/results/?comp=<?= $comp['id'] ?>\" class=\"button\">ê²°ê³¼ ë³´ê¸°</a>\n                                <?php else: ?>\n                                    <a href=\"/comprehensive/?comp=<?= $comp['id'] ?>\" class=\"button\">ëŒ€íšŒ ì •ë³´</a>\n                                <?php endif; ?>\n                            </div>\n                        </div>\n                        <?php endforeach; ?>\n                    </div>\n                </div>\n                <?php endif; ?>\n                \n                <!-- ë‹¤ìŒì£¼ ëŒ€íšŒ -->\n                <?php if (!empty($nextWeekCompetitions)): ?>\n                <div class=\"week-group\">\n                    <h3><span class=\"material-symbols-rounded\">schedule</span> ë‹¤ìŒì£¼ ëŒ€íšŒ</h3>\n                    <div class=\"competitions-grid\">\n                        <?php foreach ($nextWeekCompetitions as $comp): ?>\n                        <div class=\"competition-card upcoming\">\n                            <div class=\"comp-header\">\n                                <h4><?= htmlspecialchars($comp['title']) ?></h4>\n                                <div class=\"comp-date\"><?= date('m.d', strtotime($comp['date'])) ?></div>\n                            </div>\n                            <div class=\"comp-details\">\n                                <p><span class=\"material-symbols-rounded\">location_on</span> <?= htmlspecialchars($comp['place']) ?></p>\n                            </div>\n                            <div class=\"comp-actions\">\n                                <a href=\"/comprehensive/?comp=<?= $comp['id'] ?>\" class=\"button\">ëŒ€íšŒ ì •ë³´</a>\n                            </div>\n                        </div>\n                        <?php endforeach; ?>\n                    </div>\n                </div>\n                <?php endif; ?>\n            </section>\n            \n            <!-- ì—°ë„ë³„ ëŒ€íšŒ ëª©ë¡ -->\n            <section class=\"yearly-section\">\n                <h2><span class=\"material-symbols-rounded\">calendar_month</span> ì—°ë„ë³„ ëŒ€íšŒ ëª©ë¡</h2>\n                \n                <!-- ì—°ë„ ì„ íƒ -->\n                <div class=\"year-selector\">\n                    <?php foreach ($availableYears as $year): ?>\n                        <a href=\"?year=<?= $year ?>\" class=\"year-button <?= $selectedYear == $year ? 'active' : '' ?>\">\n                            <?= $year ?>ë…„\n                        </a>\n                    <?php endforeach; ?>\n                </div>\n                \n                <!-- ì„ íƒëœ ì—°ë„ì˜ ëŒ€íšŒë“¤ -->\n                <div class=\"year-competitions\">\n                    <?php if (empty($yearCompetitions)): ?>\n                        <div class=\"no-competitions\">\n                            <span class=\"material-symbols-rounded\">info</span>\n                            <p><?= $selectedYear ?>ë…„ì—ëŠ” ë“±ë¡ëœ ëŒ€íšŒê°€ ì—†ìŠµë‹ˆë‹¤.</p>\n                        </div>\n                    <?php else: ?>\n                        <div class=\"competitions-timeline\">\n                            <?php foreach ($yearCompetitions as $comp): ?>\n                            <div class=\"timeline-item\">\n                                <div class=\"timeline-date\"><?= date('m.d', strtotime($comp['date'])) ?></div>\n                                <div class=\"timeline-content\">\n                                    <h4><?= htmlspecialchars($comp['title']) ?></h4>\n                                    <p><?= htmlspecialchars($comp['place']) ?></p>\n                                    <div class=\"timeline-actions\">\n                                        <?php if ($comp['status'] === 'completed'): ?>\n                                            <a href=\"/results/?comp=<?= $comp['id'] ?>\" class=\"button small\">ê²°ê³¼ ë³´ê¸°</a>\n                                        <?php else: ?>\n                                            <a href=\"/comprehensive/?comp=<?= $comp['id'] ?>\" class=\"button small\">ì •ë³´ ë³´ê¸°</a>\n                                        <?php endif; ?>\n                                    </div>\n                                </div>\n                            </div>\n                            <?php endforeach; ?>\n                        </div>\n                    <?php endif; ?>\n                </div>\n            </section>\n        </main>\n        \n        <footer class=\"main-footer\">\n            &copy; 2025 danceoffice.net | Powered by Seyoung Lee\n        </footer>\n    </div>\n    \n    <!-- ëª¨ë°”ì¼ í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->\n    <nav class=\"bottom-nav\">\n        <a href=\"/\">\n            <span class=\"nav-icon material-symbols-rounded\">home</span>\n            <span>í™ˆ</span>\n        </a>\n        <a href=\"/results/\">\n            <span class=\"nav-icon material-symbols-rounded\">sports_score</span>\n            <span>ê²½ê¸°ê²°ê³¼</span>\n        </a>\n        <a href=\"/comprehensive/\" class=\"active\">\n            <span class=\"nav-icon material-symbols-rounded\">analytics</span>\n            <span>ì¢…í•©ê²°ê³¼</span>\n        </a>\n        <a href=\"/notice/\">\n            <span class=\"nav-icon material-symbols-rounded\">campaign</span>\n            <span>ê³µì§€ì‚¬í•­</span>\n        </a>\n        <a href=\"/manage/\">\n            <span class=\"nav-icon material-symbols-rounded\">settings</span>\n            <span>ê´€ë¦¬ì</span>\n        </a>\n    </nav>\n    \n    <!-- êµ¬ê¸€ ë¨¸í‹°ë¦¬ì–¼ ì•„ì´ì½˜ ë¡œë“œ -->\n    <link href=\"https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded\" rel=\"stylesheet\" />\n</body>\n</html>\n","size_bytes":21328},"data/scheduler.php":{"content":"<?php\n/**\n * ëŒ€íšŒ ìŠ¤ì¼€ì¤„ëŸ¬ ì‹œìŠ¤í…œ\n * ëŒ„ìŠ¤ìŠ¤ì½”ì–´ì™€ ìì²´ ì‹œìŠ¤í…œì„ í†µí•©í•œ ëŒ€íšŒ ê´€ë¦¬\n */\n\nclass CompetitionScheduler {\n    private $scheduleFile;\n    private $competitions;\n    private $compDataDir;\n    \n    public function __construct() {\n        $this->scheduleFile = __DIR__ . '/competitions.json';\n        $this->compDataDir = __DIR__ . '/../comp/data';\n        $this->loadCompetitions();\n    }\n    \n    private function loadCompetitions() {\n        // ê¸°ì¡´ competitions.jsonì—ì„œ ë¡œë“œ\n        if (file_exists($this->scheduleFile)) {\n            $this->competitions = json_decode(file_get_contents($this->scheduleFile), true) ?: [];\n        } else {\n            $this->competitions = [];\n        }\n        \n        // comp/dataì—ì„œ ì‹¤ì œ ëŒ€íšŒ ì •ë³´ ì¶”ê°€\n        $this->loadCompetitionsFromCompData();\n    }\n    \n    private function loadCompetitionsFromCompData() {\n        if (!is_dir($this->compDataDir)) return;\n        \n        foreach (glob($this->compDataDir . \"/*/info.json\") as $info_file) {\n            $comp_id = basename(dirname($info_file));\n            $info = json_decode(file_get_contents($info_file), true);\n            \n            if ($info) {\n                // ì´ë¯¸ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸ (our_system_idë¡œ)\n                $exists = false;\n                foreach ($this->competitions as $existing) {\n                    if (isset($existing['our_system_id']) && $existing['our_system_id'] === $comp_id) {\n                        $exists = true;\n                        break;\n                    }\n                }\n                \n                if (!$exists) {\n                    // comp/dataì˜ ì •ë³´ë¥¼ ìŠ¤ì¼€ì¤„ëŸ¬ í˜•ì‹ìœ¼ë¡œ ë³€í™˜\n                    $competition = [\n                        'id' => 'comp_' . $comp_id,\n                        'name' => $info['title'],\n                        'title' => $info['title'],\n                        'subtitle' => '',\n                        'date' => $info['date'],\n                        'location' => $info['place'],\n                        'place' => $info['place'],\n                        'host' => $info['host'],\n                        'country' => $info['country'] ?? 'KR',\n                        'description' => $info['host'] . ' ì£¼ìµœ',\n                        'status' => $this->getCompetitionStatus($info['date']),\n                        'our_system_id' => $comp_id,\n                        'comp_data_path' => dirname($info_file),\n                        'created_at' => date('Y-m-d H:i:s', $info['created']),\n                        'updated_at' => date('Y-m-d H:i:s', $info['created'])\n                    ];\n                    \n                    $this->competitions[] = $competition;\n                }\n            }\n        }\n    }\n    \n    public function saveCompetitions() {\n        file_put_contents($this->scheduleFile, json_encode($this->competitions, JSON_PRETTY_PRINT | JSON_UNESCAPED_UNICODE));\n    }\n    \n    public function addCompetition($data) {\n        $competition = [\n            'id' => uniqid('comp_'),\n            'title' => $data['title'],\n            'subtitle' => $data['subtitle'] ?? '',\n            'date' => $data['date'],\n            'place' => $data['place'],\n            'status' => $data['status'] ?? 'upcoming', // upcoming, ongoing, completed\n            'dancescore_id' => $data['dancescore_id'] ?? null,\n            'our_system_id' => $data['our_system_id'] ?? null,\n            'results_url' => $data['results_url'] ?? null,\n            'created_at' => date('Y-m-d H:i:s'),\n            'updated_at' => date('Y-m-d H:i:s')\n        ];\n        \n        $this->competitions[] = $competition;\n        $this->saveCompetitions();\n        return $competition['id'];\n    }\n    \n    public function updateCompetition($id, $data) {\n        foreach ($this->competitions as &$comp) {\n            if ($comp['id'] === $id) {\n                $comp = array_merge($comp, $data);\n                $comp['updated_at'] = date('Y-m-d H:i:s');\n                $this->saveCompetitions();\n                return true;\n            }\n        }\n        return false;\n    }\n    \n    public function getCompetitionsByDateRange($startDate, $endDate) {\n        return array_filter($this->competitions, function($comp) use ($startDate, $endDate) {\n            return $comp['date'] >= $startDate && $comp['date'] <= $endDate;\n        });\n    }\n    \n    public function getUpcomingCompetitions($limit = 3) {\n        $today = date('Y-m-d');\n        $upcoming = array_filter($this->competitions, function($comp) use ($today) {\n            return $comp['date'] >= $today && $comp['status'] === 'upcoming';\n        });\n        \n        usort($upcoming, function($a, $b) {\n            return strtotime($a['date']) - strtotime($b['date']);\n        });\n        \n        return array_slice($upcoming, 0, $limit);\n    }\n    \n    public function getRecentCompetitions($limit = 3) {\n        $today = date('Y-m-d');\n        $recent = array_filter($this->competitions, function($comp) use ($today) {\n            return $comp['date'] < $today && $comp['status'] === 'completed';\n        });\n        \n        usort($recent, function($a, $b) {\n            return strtotime($b['date']) - strtotime($a['date']);\n        });\n        \n        return array_slice($recent, 0, $limit);\n    }\n    \n    public function getRecentResultsCompetitions() {\n        $today = date('Y-m-d');\n        $yesterday = date('Y-m-d', strtotime('-1 day'));\n        $seven_days_ago = date('Y-m-d', strtotime('-7 days'));\n        \n        // ëŒ€íšŒ ì „ë‚ ë¶€í„° 7ì¼ê°„ì˜ ëŒ€íšŒë“¤ (ì™„ë£Œë˜ì—ˆê±°ë‚˜ ì§„í–‰ ì¤‘ì¸ ëŒ€íšŒ)\n        $recent = array_filter($this->competitions, function($comp) use ($yesterday, $seven_days_ago) {\n            $comp_date = $comp['date'];\n            return $comp_date >= $seven_days_ago && \n                   $comp_date <= $yesterday && \n                   ($comp['status'] === 'completed' || $comp['status'] === 'ongoing');\n        });\n        \n        // ë‚ ì§œ ê¸°ì¤€ìœ¼ë¡œ ìµœì‹ ìˆœ ì •ë ¬\n        usort($recent, function($a, $b) {\n            return strtotime($b['date']) - strtotime($a['date']);\n        });\n        \n        return $recent;\n    }\n    \n    public function getCompetitionsByYear($year) {\n        return array_filter($this->competitions, function($comp) use ($year) {\n            return date('Y', strtotime($comp['date'])) == $year;\n        });\n    }\n    \n    public function getCompetitionById($id) {\n        foreach ($this->competitions as $comp) {\n            if ($comp['id'] === $id) {\n                return $comp;\n            }\n        }\n        return null;\n    }\n    \n    public function getAllCompetitions() {\n        return $this->competitions;\n    }\n    \n    public function getCompetitionStatus($date) {\n        $today = date('Y-m-d');\n        $compDate = date('Y-m-d', strtotime($date));\n        \n        if ($compDate < $today) {\n            return 'completed';\n        } elseif ($compDate == $today) {\n            return 'ongoing';\n        } else {\n            return 'upcoming';\n        }\n    }\n}\n\n// ì‚¬ìš© ì˜ˆì‹œ\nif (isset($_GET['action'])) {\n    $scheduler = new CompetitionScheduler();\n    \n    switch ($_GET['action']) {\n        case 'add':\n            if ($_POST) {\n                $id = $scheduler->addCompetition($_POST);\n                echo json_encode(['success' => true, 'id' => $id]);\n            }\n            break;\n            \n        case 'update':\n            if ($_POST && isset($_POST['id'])) {\n                $success = $scheduler->updateCompetition($_POST['id'], $_POST);\n                echo json_encode(['success' => $success]);\n            }\n            break;\n            \n        case 'upcoming':\n            $competitions = $scheduler->getUpcomingCompetitions();\n            echo json_encode($competitions);\n            break;\n            \n        case 'recent':\n            $competitions = $scheduler->getRecentCompetitions();\n            echo json_encode($competitions);\n            break;\n            \n        case 'year':\n            $year = $_GET['year'] ?? date('Y');\n            $competitions = $scheduler->getCompetitionsByYear($year);\n            echo json_encode($competitions);\n            break;\n    }\n}\n?>\n","size_bytes":8219},"manage/index.php":{"content":"<?php\nsession_start();\n\n// ë‹¤êµ­ì–´ ì‹œìŠ¤í…œ ë¡œë“œ\nrequire_once __DIR__ . '/../lang/Language.php';\n$lang = Language::getInstance();\n\n// NoticeManager ë¡œë“œ\nrequire_once __DIR__ . '/../data/NoticeManager.php';\n\n// ê´€ë¦¬ì ì¸ì¦ í™•ì¸\nif (!isset($_SESSION['admin'])) {\n    if ($_POST['pw'] ?? '' === 'adminpw') {\n        $_SESSION['admin'] = true;\n    } else {\n        ?>\n        <!DOCTYPE html>\n        <html lang=\"<?= $lang->getCurrentLang() ?>\">\n        <head>\n            <meta charset=\"UTF-8\">\n            <title><?= t('admin_login') ?> | DanceOffice</title>\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n            <link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap\" rel=\"stylesheet\">\n            <link href=\"https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0\" rel=\"stylesheet\">\n            <style>\n                * {\n                    margin: 0;\n                    padding: 0;\n                    box-sizing: border-box;\n                }\n\n                body {\n                    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\n                    background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);\n                    color: #e2e8f0;\n                    min-height: 100vh;\n                    display: flex;\n                    align-items: center;\n                    justify-content: center;\n                }\n\n                .login-container {\n                    background: rgba(30, 41, 59, 0.8);\n                    backdrop-filter: blur(20px);\n                    border: 1px solid rgba(59, 130, 246, 0.2);\n                    border-radius: 20px;\n                    padding: 40px;\n                    max-width: 400px;\n                    width: 90%;\n                    text-align: center;\n                    position: relative;\n                    overflow: hidden;\n                }\n\n                .login-container::before {\n                    content: '';\n                    position: absolute;\n                    top: 0;\n                    left: 0;\n                    right: 0;\n                    bottom: 0;\n                    background: radial-gradient(circle at 30% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%);\n                    pointer-events: none;\n                }\n\n                .login-content {\n                    position: relative;\n                    z-index: 2;\n                }\n\n                .login-title {\n                    font-size: 28px;\n                    font-weight: 700;\n                    color: #f1f5f9;\n                    margin-bottom: 8px;\n                    display: flex;\n                    align-items: center;\n                    justify-content: center;\n                    gap: 12px;\n                }\n\n                .login-title .material-symbols-rounded {\n                    color: #3b82f6;\n                    font-size: 32px;\n                }\n\n                .login-subtitle {\n                    color: #94a3b8;\n                    font-size: 16px;\n                    margin-bottom: 32px;\n                }\n\n                .form-group {\n                    margin-bottom: 24px;\n                    text-align: left;\n                }\n\n                .form-group label {\n                    display: block;\n                    color: #f1f5f9;\n                    font-size: 14px;\n                    font-weight: 500;\n                    margin-bottom: 8px;\n                }\n\n                .form-group input {\n                    width: 100%;\n                    padding: 14px 16px;\n                    border: 1px solid rgba(59, 130, 246, 0.2);\n                    border-radius: 12px;\n                    background: rgba(15, 23, 42, 0.6);\n                    color: #f1f5f9;\n                    font-size: 14px;\n                    transition: all 0.3s ease;\n                }\n\n                .form-group input:focus {\n                    outline: none;\n                    border-color: #3b82f6;\n                    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n                }\n\n                .btn {\n                    background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);\n                    color: white;\n                    border: none;\n                    padding: 14px 32px;\n                    border-radius: 12px;\n                    font-weight: 600;\n                    font-size: 14px;\n                    cursor: pointer;\n                    transition: all 0.3s ease;\n                    width: 100%;\n                    display: flex;\n                    align-items: center;\n                    justify-content: center;\n                    gap: 8px;\n                }\n\n                .btn:hover {\n                    transform: translateY(-2px);\n                    box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);\n                }\n\n                .btn .material-symbols-rounded {\n                    font-size: 18px;\n                }\n            </style>\n        </head>\n        <body>\n            <div class=\"login-container\">\n                <div class=\"login-content\">\n                    <h1 class=\"login-title\">\n                        <span class=\"material-symbols-rounded\">admin_panel_settings</span>\n                        <?= t('admin_login') ?>\n                    </h1>\n                    <p class=\"login-subtitle\"><?= t('admin_subtitle') ?></p>\n                    \n                    <form method=\"post\">\n                        <div class=\"form-group\">\n                            <label for=\"pw\"><?= t('admin_password') ?></label>\n                            <input type=\"password\" id=\"pw\" name=\"pw\" placeholder=\"<?= t('admin_password_placeholder') ?>\" required>\n                        </div>\n                        <button type=\"submit\" class=\"btn\">\n                            <span class=\"material-symbols-rounded\">login</span>\n                            <?= t('admin_login_btn') ?>\n                        </button>\n                    </form>\n                </div>\n            </div>\n        </body>\n        </html>\n        <?php\n        exit;\n    }\n}\n\n// ê´‘ê³  ìœ„ì¹˜ë³„ ì •ë³´\n$positions = [\n    'top'    => ['label' => t('banner_top'),    'size' => '728x90px',    'desc' => t('banner_top_desc'),    'img' => 'top.jpg',    'link' => 'top.link'],\n    'bottom' => ['label' => t('banner_bottom'), 'size' => '728x90px',    'desc' => t('banner_bottom_desc'), 'img' => 'bottom.jpg', 'link' => 'bottom.link'],\n    'left'   => ['label' => t('banner_left'),   'size' => '160x600px',   'desc' => t('banner_left_desc'),   'img' => 'left.jpg',   'link' => 'left.link'],\n    'right'  => ['label' => t('banner_right'),  'size' => '160x600px',   'desc' => t('banner_right_desc'),  'img' => 'right.jpg',  'link' => 'right.link'],\n    'main'   => ['label' => t('banner_main'),   'size' => '300x250px ' . t('or') . ' 728x90px', 'desc' => t('banner_main_desc'),   'img' => 'main.jpg',   'link' => 'main.link'],\n];\n\n# ë””ë ‰í† ë¦¬ ê²½ë¡œ\n$base_ads_dir = __DIR__ . \"/../data/ads/\";\n$schedule_file = __DIR__ . \"/../data/schedule.txt\";\n\n// NoticeManager ì´ˆê¸°í™”\ntry {\n    $noticeManager = new NoticeManager();\n} catch (Exception $e) {\n    error_log(\"NoticeManager ì´ˆê¸°í™” ì‹¤íŒ¨: \" . $e->getMessage());\n}\n\n// ê³µì§€ì‚¬í•­ ì²˜ë¦¬\nif (isset($_POST['notice_action']) && isset($noticeManager)) {\n    try {\n        switch ($_POST['notice_action']) {\n            case 'create':\n                $imagePath = null;\n                if (isset($_FILES['notice_image']) && $_FILES['notice_image']['size'] > 0) {\n                    $imagePath = $noticeManager->uploadImage($_FILES['notice_image']);\n                }\n                $noticeManager->createNotice(\n                    $_POST['notice_title'],\n                    $_POST['notice_content'],\n                    $imagePath,\n                    isset($_POST['is_pinned'])\n                );\n                break;\n            case 'edit':\n                $imagePath = $_POST['existing_image'] ?? null;\n                if (isset($_FILES['notice_image']) && $_FILES['notice_image']['size'] > 0) {\n                    $imagePath = $noticeManager->uploadImage($_FILES['notice_image']);\n                }\n                $noticeManager->updateNotice(\n                    $_POST['notice_id'],\n                    $_POST['notice_title'],\n                    $_POST['notice_content'],\n                    $imagePath,\n                    isset($_POST['is_pinned'])\n                );\n                break;\n            case 'delete':\n                $noticeManager->deleteNotice($_POST['notice_id']);\n                break;\n            case 'toggle_pin':\n                $noticeManager->togglePin($_POST['notice_id']);\n                break;\n        }\n    } catch (Exception $e) {\n        $notice_error = $e->getMessage();\n    }\n    if (!isset($notice_error)) {\n        header(\"Location: /manage/\");\n        exit;\n    }\n}\n\n// ì¼ì • ì‚­ì œ ì²˜ë¦¬\nif (isset($_GET['delete_schedule'])) {\n    if (file_exists($schedule_file)) unlink($schedule_file);\n    header(\"Location: /manage/\");\n    exit;\n}\n\n// ê´‘ê³  ì‚­ì œ ì²˜ë¦¬\nif (isset($_GET['delete']) && isset($_GET['pos']) && isset($positions[$_GET['pos']])) {\n    $pos = $_GET['pos'];\n    $type = $_GET['delete'];\n    if ($type === 'img') {\n        $file = $base_ads_dir . $positions[$pos]['img'];\n        if (file_exists($file)) unlink($file);\n    } elseif ($type === 'link') {\n        $file = $base_ads_dir . $positions[$pos]['link'];\n        if (file_exists($file)) unlink($file);\n    }\n    header(\"Location: /manage/\");\n    exit;\n}\n\n// ê´‘ê³  ì—…ë¡œë“œ/ë§í¬ ë“±ë¡\nif ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['pos'])) {\n    $pos = $_POST['pos'];\n    if (isset($_FILES['banner']) && $_FILES['banner']['size'] > 0) {\n        $target = $base_ads_dir . $positions[$pos]['img'];\n        move_uploaded_file($_FILES['banner']['tmp_name'], $target);\n    }\n    if (isset($_POST['banner_link'])) {\n        $linkfile = $base_ads_dir . $positions[$pos]['link'];\n        file_put_contents($linkfile, trim($_POST['banner_link']));\n    }\n    echo \"<script>location.href='/manage/';</script>\";\n    exit;\n}\n\n// ê¸°ì¡´ íŒŒì¼ ê¸°ë°˜ ê³µì§€ì‚¬í•­ ì‹œìŠ¤í…œ ì œê±°ë¨ - ë°ì´í„°ë² ì´ìŠ¤ ê¸°ë°˜ìœ¼ë¡œ êµì²´\n\n// ëŒ€íšŒì¼ì • ë“±ë¡/ìˆ˜ì •\nif ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['schedule'])) {\n    file_put_contents($schedule_file, trim($_POST['schedule']));\n    echo \"<script>location.href='/manage/';</script>\";\n    exit;\n}\n\n// ê³µì§€ì‚¬í•­ ë° í†µê³„ ë¡œë“œ\ntry {\n    $notices = isset($noticeManager) ? $noticeManager->getAllNotices() : [];\n    $notice_stats = isset($noticeManager) ? $noticeManager->getNoticeStats() : null;\n} catch (Exception $e) {\n    $notices = [];\n    $notice_stats = null;\n    error_log(\"ê³µì§€ì‚¬í•­ ë¡œë“œ ì‹¤íŒ¨: \" . $e->getMessage());\n}\n\n$current_schedule = file_exists($schedule_file) ? file_get_contents($schedule_file) : \"\";\n?>\n<!DOCTYPE html>\n<html lang=\"<?= $lang->getCurrentLang() ?>\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title><?= t('admin_title') ?> | DanceOffice</title>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0\" rel=\"stylesheet\">\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        body {\n            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\n            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);\n            color: #e2e8f0;\n            min-height: 100vh;\n        }\n\n        .container {\n            max-width: 1200px;\n            margin: 0 auto;\n            padding: 20px;\n        }\n\n        /* ìƒë‹¨ í—¤ë” */\n        .admin-header {\n            background: rgba(30, 41, 59, 0.8);\n            backdrop-filter: blur(20px);\n            border: 1px solid rgba(59, 130, 246, 0.2);\n            border-radius: 20px;\n            padding: 32px;\n            margin-bottom: 32px;\n            position: relative;\n            overflow: hidden;\n        }\n\n        .admin-header::before {\n            content: '';\n            position: absolute;\n            top: 0;\n            left: 0;\n            right: 0;\n            bottom: 0;\n            background: radial-gradient(circle at 30% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%);\n            pointer-events: none;\n        }\n\n        .admin-header-content {\n            position: relative;\n            z-index: 2;\n        }\n\n        .admin-title {\n            font-size: 32px;\n            font-weight: 700;\n            color: #f1f5f9;\n            margin-bottom: 8px;\n            display: flex;\n            align-items: center;\n            gap: 12px;\n        }\n\n        .admin-title .material-symbols-rounded {\n            color: #3b82f6;\n            font-size: 36px;\n        }\n\n        .admin-subtitle {\n            color: #94a3b8;\n            font-size: 16px;\n            margin-bottom: 24px;\n        }\n\n        .admin-nav {\n            display: flex;\n            gap: 16px;\n            flex-wrap: wrap;\n        }\n\n        .admin-nav a {\n            display: flex;\n            align-items: center;\n            gap: 8px;\n            padding: 12px 20px;\n            background: rgba(59, 130, 246, 0.1);\n            color: #3b82f6;\n            text-decoration: none;\n            border-radius: 12px;\n            font-weight: 500;\n            transition: all 0.3s ease;\n            border: 1px solid rgba(59, 130, 246, 0.2);\n        }\n\n        .admin-nav a:hover {\n            background: rgba(59, 130, 246, 0.2);\n            transform: translateY(-2px);\n        }\n\n        .admin-nav .material-symbols-rounded {\n            font-size: 18px;\n        }\n\n        /* ì–¸ì–´ ì„ íƒê¸° */\n        .language-selector {\n            position: absolute;\n            top: 32px;\n            right: 32px;\n            z-index: 3;\n        }\n\n        .language-dropdown {\n            position: relative;\n            display: inline-block;\n        }\n\n        .language-btn {\n            display: flex;\n            align-items: center;\n            gap: 8px;\n            padding: 8px 16px;\n            background: rgba(59, 130, 246, 0.1);\n            color: #3b82f6;\n            border: 1px solid rgba(59, 130, 246, 0.2);\n            border-radius: 12px;\n            cursor: pointer;\n            transition: all 0.3s ease;\n        }\n\n        .language-btn:hover {\n            background: rgba(59, 130, 246, 0.2);\n        }\n\n        .language-menu {\n            position: absolute;\n            top: 100%;\n            right: 0;\n            margin-top: 8px;\n            background: rgba(30, 41, 59, 0.95);\n            backdrop-filter: blur(20px);\n            border: 1px solid rgba(59, 130, 246, 0.2);\n            border-radius: 12px;\n            padding: 8px;\n            min-width: 160px;\n            display: none;\n            z-index: 1000;\n        }\n\n        .language-menu.show {\n            display: block;\n        }\n\n        .language-menu a {\n            display: flex;\n            align-items: center;\n            gap: 8px;\n            padding: 8px 12px;\n            color: #e2e8f0;\n            text-decoration: none;\n            border-radius: 8px;\n            transition: all 0.3s ease;\n            font-size: 14px;\n        }\n\n        .language-menu a:hover {\n            background: rgba(59, 130, 246, 0.1);\n            color: #3b82f6;\n        }\n\n        .language-menu a.active {\n            background: rgba(59, 130, 246, 0.2);\n            color: #3b82f6;\n        }\n\n        /* ì¹´ë“œ ê·¸ë¦¬ë“œ */\n        .cards-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));\n            gap: 24px;\n            margin-bottom: 32px;\n        }\n\n        .admin-card {\n            background: rgba(30, 41, 59, 0.6);\n            backdrop-filter: blur(20px);\n            border: 1px solid rgba(59, 130, 246, 0.2);\n            border-radius: 16px;\n            padding: 24px;\n        }\n\n        .card-title {\n            font-size: 20px;\n            font-weight: 600;\n            color: #f1f5f9;\n            margin-bottom: 16px;\n            display: flex;\n            align-items: center;\n            gap: 12px;\n        }\n\n        .card-title .material-symbols-rounded {\n            color: #3b82f6;\n            font-size: 24px;\n        }\n\n        .preview-box {\n            background: rgba(15, 23, 42, 0.6);\n            border: 1px solid rgba(59, 130, 246, 0.1);\n            border-radius: 12px;\n            padding: 16px;\n            margin-bottom: 16px;\n            min-height: 80px;\n        }\n\n        .preview-box strong {\n            color: #3b82f6;\n            font-weight: 600;\n        }\n\n        .form-group {\n            margin-bottom: 16px;\n        }\n\n        .form-group label {\n            display: block;\n            color: #f1f5f9;\n            font-size: 14px;\n            font-weight: 500;\n            margin-bottom: 8px;\n        }\n\n        .form-group input,\n        .form-group textarea {\n            width: 100%;\n            padding: 12px 16px;\n            border: 1px solid rgba(59, 130, 246, 0.2);\n            border-radius: 12px;\n            background: rgba(15, 23, 42, 0.6);\n            color: #f1f5f9;\n            font-size: 14px;\n            transition: all 0.3s ease;\n            font-family: inherit;\n        }\n\n        .form-group textarea {\n            min-height: 100px;\n            resize: vertical;\n        }\n\n        .form-group input:focus,\n        .form-group textarea:focus {\n            outline: none;\n            border-color: #3b82f6;\n            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n        }\n\n        .btn {\n            display: inline-flex;\n            align-items: center;\n            gap: 8px;\n            padding: 12px 20px;\n            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);\n            color: white;\n            border: none;\n            border-radius: 12px;\n            font-weight: 500;\n            font-size: 14px;\n            cursor: pointer;\n            transition: all 0.3s ease;\n            text-decoration: none;\n        }\n\n        .btn:hover {\n            transform: translateY(-2px);\n            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);\n        }\n\n        .btn-danger {\n            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);\n        }\n\n        .btn-danger:hover {\n            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.3);\n        }\n\n        .btn-small {\n            padding: 8px 16px;\n            font-size: 13px;\n        }\n\n        .btn .material-symbols-rounded {\n            font-size: 18px;\n        }\n\n        .action-buttons {\n            display: flex;\n            gap: 12px;\n            margin-top: 16px;\n            flex-wrap: wrap;\n        }\n\n        /* ë°°ë„ˆ ê·¸ë¦¬ë“œ */\n        .banner-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));\n            gap: 24px;\n        }\n\n        .banner-card {\n            background: rgba(30, 41, 59, 0.6);\n            backdrop-filter: blur(20px);\n            border: 1px solid rgba(59, 130, 246, 0.2);\n            border-radius: 16px;\n            padding: 24px;\n        }\n\n        .banner-info {\n            background: rgba(15, 23, 42, 0.6);\n            border: 1px solid rgba(59, 130, 246, 0.1);\n            border-radius: 12px;\n            padding: 12px;\n            margin-bottom: 16px;\n            font-size: 13px;\n            color: #94a3b8;\n        }\n\n        .banner-thumb {\n            max-width: 100%;\n            height: auto;\n            border-radius: 12px;\n            margin: 12px 0;\n            box-shadow: 0 4px 12px rgba(0,0,0,0.3);\n        }\n\n        .file-info {\n            background: rgba(15, 23, 42, 0.6);\n            border: 1px solid rgba(59, 130, 246, 0.1);\n            border-radius: 8px;\n            padding: 12px;\n            margin: 12px 0;\n            font-size: 13px;\n            color: #94a3b8;\n        }\n\n        .file-info strong {\n            color: #3b82f6;\n        }\n\n        .file-info code {\n            background: rgba(59, 130, 246, 0.1);\n            color: #3b82f6;\n            padding: 2px 6px;\n            border-radius: 4px;\n            font-size: 12px;\n        }\n\n        /* ëª¨ë°”ì¼ ëŒ€ì‘ */\n        @media (max-width: 768px) {\n            .container {\n                padding: 16px;\n            }\n\n            .admin-header {\n                padding: 24px 20px;\n            }\n\n            .admin-title {\n                font-size: 24px;\n            }\n\n            .admin-nav {\n                flex-direction: column;\n                gap: 12px;\n            }\n\n            .cards-grid {\n                grid-template-columns: 1fr;\n                gap: 20px;\n            }\n\n            .banner-grid {\n                grid-template-columns: 1fr;\n                gap: 20px;\n            }\n\n            .language-selector {\n                position: relative;\n                top: auto;\n                right: auto;\n                margin-top: 16px;\n                text-align: center;\n            }\n\n            .language-menu {\n                right: 50%;\n                transform: translateX(50%);\n            }\n\n            .action-buttons {\n                flex-direction: column;\n            }\n\n            .action-buttons .btn {\n                justify-content: center;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <header class=\"admin-header\">\n            <div class=\"admin-header-content\">\n                <h1 class=\"admin-title\">\n                    <span class=\"material-symbols-rounded\">admin_panel_settings</span>\n                    <?= t('admin_title') ?>\n                </h1>\n                <p class=\"admin-subtitle\"><?= t('admin_subtitle') ?></p>\n                \n                <nav class=\"admin-nav\">\n                    <a href=\"/\">\n                        <span class=\"material-symbols-rounded\">home</span>\n                        <?= t('admin_nav_home') ?>\n                    </a>\n                    <a href=\"/results.php\">\n                        <span class=\"material-symbols-rounded\">military_tech</span>\n                        <?= t('admin_nav_results') ?>\n                    </a>\n                    <a href=\"/comp/\">\n                        <span class=\"material-symbols-rounded\">sports</span>\n                        <?= t('admin_nav_competitions') ?>\n                    </a>\n                    <a href=\"/comp/admin_event.php\">\n                        <span class=\"material-symbols-rounded\">score</span>\n                        <?= t('admin_nav_judging') ?>\n                    </a>\n                </nav>\n            </div>\n\n            <!-- ì–¸ì–´ ì„ íƒê¸° -->\n            <div class=\"language-selector\">\n                <div class=\"language-dropdown\">\n                    <div class=\"language-btn\" onclick=\"toggleLanguageMenu()\">\n                        <span><?= $lang->getLangFlag() ?></span>\n                        <span><?= $lang->getLangName() ?></span>\n                        <span class=\"material-symbols-rounded\">expand_more</span>\n                    </div>\n                    <div class=\"language-menu\" id=\"languageMenu\">\n                        <?php foreach ($lang->getAvailableLanguages() as $code => $info): ?>\n                            <a href=\"<?= $lang->getLanguageUrl($code) ?>\" class=\"<?= $lang->getCurrentLang() === $code ? 'active' : '' ?>\">\n                                <span><?= $info['flag'] ?></span>\n                                <span><?= $info['name'] ?></span>\n                            </a>\n                        <?php endforeach; ?>\n                    </div>\n                </div>\n            </div>\n        </header>\n\n        <main>\n            <!-- ê³µì§€ì‚¬í•­ ê´€ë¦¬ -->\n            <div class=\"admin-card\" style=\"margin-bottom: 32px;\">\n                <h2 class=\"card-title\">\n                    <span class=\"material-symbols-rounded\">campaign</span>\n                    <?= t('notice_management') ?>\n                    \n                    <?php if ($notice_stats): ?>\n                        <span style=\"font-size: 14px; color: #94a3b8; font-weight: 400;\">\n                            (<?= t('total') ?>: <?= $notice_stats['total'] ?>, <?= t('pinned') ?>: <?= $notice_stats['pinned'] ?>)\n                        </span>\n                    <?php endif; ?>\n                </h2>\n                \n                <?php if (isset($notice_error)): ?>\n                    <div style=\"background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.2); color: #fca5a5; padding: 12px; border-radius: 8px; margin-bottom: 16px;\">\n                        <strong><?= t('error') ?>:</strong> <?= htmlspecialchars($notice_error) ?>\n                    </div>\n                <?php endif; ?>\n                \n                <!-- ìƒˆ ê³µì§€ì‚¬í•­ ì‘ì„± -->\n                <div class=\"preview-box\" style=\"margin-bottom: 24px;\">\n                    <strong><?= t('create_notice') ?></strong>\n                    <form method=\"post\" enctype=\"multipart/form-data\" style=\"margin-top: 16px;\">\n                        <input type=\"hidden\" name=\"notice_action\" value=\"create\">\n                        \n                        <div class=\"form-group\">\n                            <label for=\"notice_title\"><?= t('notice_title') ?></label>\n                            <input type=\"text\" id=\"notice_title\" name=\"notice_title\" placeholder=\"<?= t('notice_title_placeholder') ?>\" required>\n                        </div>\n                        \n                        <div class=\"form-group\">\n                            <label for=\"notice_content\"><?= t('notice_content') ?></label>\n                            <textarea id=\"notice_content\" name=\"notice_content\" placeholder=\"<?= t('notice_content_placeholder') ?>\" required></textarea>\n                        </div>\n                        \n                        <div class=\"form-group\">\n                            <label for=\"notice_image\"><?= t('notice_image') ?> (<?= t('optional') ?>)</label>\n                            <input type=\"file\" id=\"notice_image\" name=\"notice_image\" accept=\"image/*\">\n                            <small style=\"color: #94a3b8; display: block; margin-top: 4px;\">\n                                <?= t('notice_image_help') ?>\n                            </small>\n                        </div>\n                        \n                        <div class=\"form-group\">\n                            <label style=\"display: flex; align-items: center; gap: 8px; cursor: pointer;\">\n                                <input type=\"checkbox\" name=\"is_pinned\" style=\"width: auto;\">\n                                <span><?= t('notice_pin') ?></span>\n                            </label>\n                        </div>\n                        \n                        <button type=\"submit\" class=\"btn\">\n                            <span class=\"material-symbols-rounded\">add</span>\n                            <?= t('notice_create') ?>\n                        </button>\n                    </form>\n                </div>\n                \n                <!-- ê¸°ì¡´ ê³µì§€ì‚¬í•­ ëª©ë¡ -->\n                <div style=\"max-height: 600px; overflow-y: auto;\">\n                    <strong style=\"color: #f1f5f9; margin-bottom: 16px; display: block;\"><?= t('existing_notices') ?></strong>\n                    \n                    <?php if (empty($notices)): ?>\n                        <div class=\"preview-box\" style=\"text-align: center; color: #94a3b8;\">\n                            <span class=\"material-symbols-rounded\" style=\"font-size: 48px; margin-bottom: 12px; display: block; opacity: 0.5;\">campaign</span>\n                            <?= t('no_notices') ?>\n                        </div>\n                    <?php else: ?>\n                        <?php foreach ($notices as $notice): ?>\n                            <div class=\"notice-item\" style=\"background: rgba(15, 23, 42, 0.6); border: 1px solid rgba(59, 130, 246, 0.1); border-radius: 12px; padding: 16px; margin-bottom: 16px;\">\n                                <div style=\"display: flex; justify-content: between; align-items: flex-start; margin-bottom: 12px;\">\n                                    <div style=\"flex: 1;\">\n                                        <h4 style=\"color: #f1f5f9; font-size: 16px; font-weight: 600; margin: 0 0 4px 0; display: flex; align-items: center; gap: 8px;\">\n                                            <?php if ($notice['is_pinned']): ?>\n                                                <span class=\"material-symbols-rounded\" style=\"color: #f59e0b; font-size: 18px;\">push_pin</span>\n                                            <?php endif; ?>\n                                            <?= htmlspecialchars($notice['title']) ?>\n                                        </h4>\n                                        <p style=\"color: #94a3b8; font-size: 12px; margin: 0;\">\n                                            <?= date('Y-m-d H:i', strtotime($notice['created_at'])) ?>\n                                            <?php if ($notice['updated_at'] !== $notice['created_at']): ?>\n                                                (<?= t('updated') ?>: <?= date('Y-m-d H:i', strtotime($notice['updated_at'])) ?>)\n                                            <?php endif; ?>\n                                        </p>\n                                    </div>\n                                </div>\n                                \n                                <div style=\"color: #e2e8f0; margin-bottom: 12px; line-height: 1.5;\">\n                                    <?= nl2br(htmlspecialchars($notice['content'])) ?>\n                                </div>\n                                \n                                <?php if ($notice['image_path']): ?>\n                                    <div style=\"margin-bottom: 12px;\">\n                                        <img src=\"/<?= $notice['image_path'] ?>\" alt=\"<?= htmlspecialchars($notice['title']) ?>\" \n                                             style=\"max-width: 100%; height: auto; border-radius: 8px; max-height: 200px;\">\n                                    </div>\n                                <?php endif; ?>\n                                \n                                <div class=\"action-buttons\">\n                                    <form method=\"post\" style=\"display: inline;\">\n                                        <input type=\"hidden\" name=\"notice_action\" value=\"toggle_pin\">\n                                        <input type=\"hidden\" name=\"notice_id\" value=\"<?= $notice['id'] ?>\">\n                                        <button type=\"submit\" class=\"btn btn-small\" style=\"background: <?= $notice['is_pinned'] ? 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)' : 'rgba(59, 130, 246, 0.1)' ?>; color: <?= $notice['is_pinned'] ? 'white' : '#3b82f6' ?>;\">\n                                            <span class=\"material-symbols-rounded\">push_pin</span>\n                                            <?= $notice['is_pinned'] ? t('notice_unpin') : t('notice_pin') ?>\n                                        </button>\n                                    </form>\n                                    \n                                    <button onclick=\"editNotice(<?= $notice['id'] ?>, '<?= addslashes($notice['title']) ?>', '<?= addslashes($notice['content']) ?>', '<?= $notice['image_path'] ?>', <?= $notice['is_pinned'] ? 'true' : 'false' ?>)\" class=\"btn btn-small\">\n                                        <span class=\"material-symbols-rounded\">edit</span>\n                                        <?= t('edit') ?>\n                                    </button>\n                                    \n                                    <form method=\"post\" style=\"display: inline;\" onsubmit=\"return confirm('<?= t('notice_delete_confirm') ?>')\">\n                                        <input type=\"hidden\" name=\"notice_action\" value=\"delete\">\n                                        <input type=\"hidden\" name=\"notice_id\" value=\"<?= $notice['id'] ?>\">\n                                        <button type=\"submit\" class=\"btn btn-danger btn-small\">\n                                            <span class=\"material-symbols-rounded\">delete</span>\n                                            <?= t('delete') ?>\n                                        </button>\n                                    </form>\n                                </div>\n                            </div>\n                        <?php endforeach; ?>\n                    <?php endif; ?>\n                </div>\n            </div>\n\n            <!-- ì¼ì • ê´€ë¦¬ -->\n            <div class=\"cards-grid\">\n                <div class=\"admin-card\">\n\n                <!-- ì¼ì • ê´€ë¦¬ -->\n                <div class=\"admin-card\">\n                    <h2 class=\"card-title\">\n                        <span class=\"material-symbols-rounded\">event</span>\n                        <?= t('schedule_management') ?>\n                    </h2>\n                    \n                    <div class=\"preview-box\">\n                        <strong><?= t('current_schedule') ?></strong><br>\n                        <?= $current_schedule ? nl2br(htmlspecialchars($current_schedule)) : t('no_schedule') ?>\n                        \n                        <?php if ($current_schedule): ?>\n                            <div class=\"action-buttons\">\n                                <a href=\"/manage/?delete_schedule=1\" class=\"btn btn-danger btn-small\"\n                                   onclick=\"return confirm('<?= t('schedule_delete_confirm') ?>')\">\n                                    <span class=\"material-symbols-rounded\">delete</span>\n                                    <?= t('schedule_delete') ?>\n                                </a>\n                            </div>\n                        <?php endif; ?>\n                    </div>\n                    \n                    <form method=\"post\">\n                        <div class=\"form-group\">\n                            <label for=\"schedule\"><?= t('schedule_content') ?></label>\n                            <textarea id=\"schedule\" name=\"schedule\" placeholder=\"<?= t('schedule_placeholder') ?>\"><?= htmlspecialchars($current_schedule) ?></textarea>\n                        </div>\n                        <button type=\"submit\" class=\"btn\">\n                            <span class=\"material-symbols-rounded\">save</span>\n                            <?= t('schedule_save') ?>\n                        </button>\n                    </form>\n                </div>\n            </div>\n\n            <!-- ë°°ë„ˆ ê´€ë¦¬ -->\n            <div class=\"admin-card\" style=\"margin-bottom: 32px;\">\n                <h2 class=\"card-title\">\n                    <span class=\"material-symbols-rounded\">image</span>\n                    <?= t('banner_management') ?>\n                </h2>\n                \n                <div class=\"banner-grid\">\n                    <?php foreach($positions as $pos => $data): ?>\n                        <div class=\"banner-card\">\n                            <h3 class=\"card-title\" style=\"font-size: 18px; margin-bottom: 12px;\">\n                                <span class=\"material-symbols-rounded\">ad_units</span>\n                                <?= $data['label'] ?> <?= t('banner_management') ?>\n                                <span style=\"font-size: 12px; color: #94a3b8; font-weight: 400;\">\n                                    (<?= t('banner_recommended_size') ?>: <?= $data['size'] ?>)\n                                </span>\n                            </h3>\n                            \n                            <div class=\"banner-info\">\n                                <?= $data['desc'] ?>\n                            </div>\n                            \n                            <?php\n                            $img_file_web = \"/ads/\" . $data['img'];\n                            $img_file_real = $base_ads_dir . $data['img'];\n                            $link_file = $base_ads_dir . $data['link'];\n                            $link = file_exists($link_file) ? file_get_contents($link_file) : \"\";\n                            ?>\n                            \n                            <?php if (file_exists($img_file_real)): ?>\n                                <div>\n                                    <img src=\"<?= $img_file_web ?>\" class=\"banner-thumb\" alt=\"<?= $data['label'] ?> ë°°ë„ˆ\">\n                                    <div class=\"action-buttons\">\n                                        <a href=\"/manage/?delete=img&pos=<?= $pos ?>\" class=\"btn btn-danger btn-small\"\n                                           onclick=\"return confirm('<?= t('banner_delete_image_confirm') ?>')\">\n                                            <span class=\"material-symbols-rounded\">delete</span>\n                                            <?= t('banner_image_delete') ?>\n                                        </a>\n                                        <?php if ($link): ?>\n                                            <a href=\"<?= htmlspecialchars($link) ?>\" target=\"_blank\" class=\"btn btn-small\">\n                                                <span class=\"material-symbols-rounded\">open_in_new</span>\n                                                <?= t('banner_view_link') ?>\n                                            </a>\n                                        <?php endif; ?>\n                                    </div>\n                                </div>\n                            <?php endif; ?>\n                            \n                            <?php if (file_exists($link_file)): ?>\n                                <div class=\"file-info\">\n                                    <strong><?= t('banner_current_link') ?></strong> <code><?= htmlspecialchars($link) ?></code>\n                                    <div class=\"action-buttons\">\n                                        <a href=\"/manage/?delete=link&pos=<?= $pos ?>\" class=\"btn btn-danger btn-small\"\n                                           onclick=\"return confirm('<?= t('banner_delete_link_confirm') ?>')\">\n                                            <span class=\"material-symbols-rounded\">delete</span>\n                                            <?= t('banner_link_delete') ?>\n                                        </a>\n                                    </div>\n                                </div>\n                            <?php endif; ?>\n                            \n                            <form method=\"post\" enctype=\"multipart/form-data\">\n                                <input type=\"hidden\" name=\"pos\" value=\"<?= $pos ?>\">\n                                <div class=\"form-group\">\n                                    <label for=\"banner_<?= $pos ?>\"><?= t('banner_upload') ?></label>\n                                    <input type=\"file\" id=\"banner_<?= $pos ?>\" name=\"banner\" accept=\"image/*\">\n                                </div>\n                                <div class=\"form-group\">\n                                    <label for=\"link_<?= $pos ?>\"><?= t('banner_link') ?></label>\n                                    <input type=\"text\" id=\"link_<?= $pos ?>\" name=\"banner_link\" \n                                           value=\"<?= htmlspecialchars($link) ?>\" \n                                           placeholder=\"<?= t('banner_link_placeholder') ?>\">\n                                </div>\n                                <button type=\"submit\" class=\"btn\">\n                                    <span class=\"material-symbols-rounded\">upload</span>\n                                    <?= t('banner_upload_save') ?>\n                                </button>\n                            </form>\n                        </div>\n                    <?php endforeach; ?>\n                </div>\n            </div>\n        </main>\n    </div>\n\n    <!-- í¸ì§‘ ëª¨ë‹¬ -->\n    <div id=\"editModal\" style=\"display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.8); z-index: 9999; padding: 20px;\">\n        <div style=\"max-width: 600px; margin: 50px auto; background: rgba(30, 41, 59, 0.95); backdrop-filter: blur(20px); border: 1px solid rgba(59, 130, 246, 0.2); border-radius: 16px; padding: 24px; max-height: 80vh; overflow-y: auto;\">\n            <h3 style=\"color: #f1f5f9; margin: 0 0 20px 0; display: flex; align-items: center; gap: 12px;\">\n                <span class=\"material-symbols-rounded\" style=\"color: #3b82f6;\">edit</span>\n                <?= t('edit_notice') ?>\n            </h3>\n            \n            <form method=\"post\" enctype=\"multipart/form-data\" id=\"editForm\">\n                <input type=\"hidden\" name=\"notice_action\" value=\"edit\">\n                <input type=\"hidden\" name=\"notice_id\" id=\"edit_notice_id\">\n                <input type=\"hidden\" name=\"existing_image\" id=\"edit_existing_image\">\n                \n                <div class=\"form-group\">\n                    <label for=\"edit_notice_title\"><?= t('notice_title') ?></label>\n                    <input type=\"text\" id=\"edit_notice_title\" name=\"notice_title\" placeholder=\"<?= t('notice_title_placeholder') ?>\" required>\n                </div>\n                \n                <div class=\"form-group\">\n                    <label for=\"edit_notice_content\"><?= t('notice_content') ?></label>\n                    <textarea id=\"edit_notice_content\" name=\"notice_content\" placeholder=\"<?= t('notice_content_placeholder') ?>\" required></textarea>\n                </div>\n                \n                <div class=\"form-group\">\n                    <label for=\"edit_notice_image\"><?= t('notice_image') ?> (<?= t('optional') ?>)</label>\n                    <input type=\"file\" id=\"edit_notice_image\" name=\"notice_image\" accept=\"image/*\">\n                    <div id=\"current_image_preview\" style=\"margin-top: 8px;\"></div>\n                </div>\n                \n                <div class=\"form-group\">\n                    <label style=\"display: flex; align-items: center; gap: 8px; cursor: pointer;\">\n                        <input type=\"checkbox\" name=\"is_pinned\" id=\"edit_is_pinned\" style=\"width: auto;\">\n                        <span><?= t('notice_pin') ?></span>\n                    </label>\n                </div>\n                \n                <div class=\"action-buttons\">\n                    <button type=\"submit\" class=\"btn\">\n                        <span class=\"material-symbols-rounded\">save</span>\n                        <?= t('save_changes') ?>\n                    </button>\n                    <button type=\"button\" onclick=\"closeEditModal()\" class=\"btn\" style=\"background: rgba(148, 163, 184, 0.1); color: #94a3b8;\">\n                        <span class=\"material-symbols-rounded\">close</span>\n                        <?= t('cancel') ?>\n                    </button>\n                </div>\n            </form>\n        </div>\n    </div>\n\n    <script>\n        function toggleLanguageMenu() {\n            const menu = document.getElementById('languageMenu');\n            menu.classList.toggle('show');\n        }\n\n        // ì–¸ì–´ ë©”ë‰´ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°\n        document.addEventListener('click', function(event) {\n            const dropdown = document.querySelector('.language-dropdown');\n            const menu = document.getElementById('languageMenu');\n            \n            if (!dropdown.contains(event.target)) {\n                menu.classList.remove('show');\n            }\n        });\n\n        // ê³µì§€ì‚¬í•­ í¸ì§‘ í•¨ìˆ˜\n        function editNotice(id, title, content, imagePath, isPinned) {\n            document.getElementById('edit_notice_id').value = id;\n            document.getElementById('edit_notice_title').value = title;\n            document.getElementById('edit_notice_content').value = content;\n            document.getElementById('edit_existing_image').value = imagePath || '';\n            document.getElementById('edit_is_pinned').checked = isPinned;\n            \n            // í˜„ì¬ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°\n            const preview = document.getElementById('current_image_preview');\n            if (imagePath) {\n                preview.innerHTML = '<img src=\"/' + imagePath + '\" style=\"max-width: 200px; height: auto; border-radius: 8px; display: block; margin-top: 8px;\"><small style=\"color: #94a3b8; margin-top: 4px; display: block;\"><?= t('current_image') ?></small>';\n            } else {\n                preview.innerHTML = '<small style=\"color: #94a3b8;\"><?= t('no_current_image') ?></small>';\n            }\n            \n            document.getElementById('editModal').style.display = 'block';\n        }\n\n        function closeEditModal() {\n            document.getElementById('editModal').style.display = 'none';\n        }\n\n        // ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°\n        document.addEventListener('keydown', function(event) {\n            if (event.key === 'Escape') {\n                closeEditModal();\n            }\n        });\n\n        // ëª¨ë‹¬ ë°°ê²½ í´ë¦­ ì‹œ ë‹«ê¸°\n        document.getElementById('editModal').addEventListener('click', function(event) {\n            if (event.target === this) {\n                closeEditModal();\n            }\n        });\n    </script>\n</body>\n</html>","size_bytes":45494},"notice/index.php":{"content":"<?php\n$notice_file = __DIR__ . \"/../data/notice.txt\";\n$schedule_file = __DIR__ . \"/../data/schedule.txt\";\n\n$notice = file_exists($notice_file) ? nl2br(htmlspecialchars(file_get_contents($notice_file))) : \"ë“±ë¡ëœ ê³µì§€ê°€ ì—†ìŠµë‹ˆë‹¤.\";\n$schedule = file_exists($schedule_file) ? nl2br(htmlspecialchars(file_get_contents($schedule_file))) : \"ë“±ë¡ëœ ëŒ€íšŒì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤.\";\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>ê³µì§€/í˜„ì¥ ì•ˆë‚´</title>\n    <link rel=\"stylesheet\" href=\"/assets/style.css\">\n</head>\n<body>\n    <header>\n        <h1>ê³µì§€/í˜„ì¥ ì•ˆë‚´</h1>\n        <nav>\n            <a href=\"/\">ë©”ì¸ìœ¼ë¡œ</a>\n            <a href=\"/manage/\">ê´€ë¦¬ì</a>\n        </nav>\n    </header>\n    <main>\n        <section>\n            <h2>ê³µì§€ì‚¬í•­</h2>\n            <div style=\"background:#f2f2f2; padding:1em; border-radius:5px;\">\n                <?= $notice ?>\n            </div>\n        </section>\n        <section>\n            <h2>ëŒ€íšŒ ì¼ì •</h2>\n            <div style=\"background:#f2f2f2; padding:1em; border-radius:5px;\">\n                <?= $schedule ?>\n            </div>\n        </section>\n    </main>\n    <footer>\n        &copy; 2025 danceoffice.net\n    </footer>\n</body>\n</html>","size_bytes":1247},"results/index.php":{"content":"ï»¿<?php\n// ì „ì²´ ê²°ê³¼ ëª©ë¡ íŒŒì¼ ê²½ë¡œ\n$all_results_file = __DIR__ . '/index_results.html';\nheader('Content-Type: text/html; charset=UTF-8');\n$results_html = \"<div class='result-error'><span class='material-symbols-rounded'>error</span> ì „ì²´ ê²°ê³¼ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>\";\nif (file_exists($all_results_file)) {\n    $raw = file_get_contents($all_results_file);\n    if ($raw !== false) {\n        $results_html = $raw;\n    } else {\n        $results_html = \"<div class='result-error'><span class='material-symbols-rounded'>error</span> íŒŒì¼ì„ ì½ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>\";\n    }\n}\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>ê²½ê¸° ê²°ê³¼ - danceoffice.net</title>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <link rel=\"stylesheet\" href=\"/assets/style.css\">\n    <style>\n        /* PC ë²„ì „ ìŠ¤íƒ€ì¼ */\n        @media (min-width: 1024px) {\n            body {\n                background: #181B20;\n                min-height: 100vh;\n                font-size: 14px;\n                line-height: 1.5;\n            }\n            \n            .main-container {\n                display: grid;\n                grid-template-columns: 200px 1fr 180px;\n                grid-template-rows: auto 1fr auto;\n                grid-template-areas: \n                    \"sidebar-left header sidebar-right\"\n                    \"sidebar-left main sidebar-right\"\n                    \"footer footer footer\";\n                min-height: 100vh;\n                gap: 15px;\n                padding: 15px;\n                max-width: 1200px;\n                margin: 0 auto;\n            }\n            \n            .sidebar-left {\n                grid-area: sidebar-left;\n                display: flex;\n                flex-direction: column;\n                gap: 15px;\n            }\n            \n            .sidebar-left .logo-nav {\n                background: linear-gradient(135deg, #1a1d21 0%, #181B20 100%);\n                border-radius: 15px;\n                padding: 20px;\n                box-shadow: 0 8px 25px rgba(3, 199, 90, 0.15);\n                border: 2px solid #03C75A;\n                text-align: center;\n            }\n            \n            .sidebar-left .main-logo {\n                height: 50px;\n                margin-bottom: 20px;\n                filter: drop-shadow(0 3px 6px rgba(0,0,0,0.2));\n            }\n            \n            .sidebar-left .main-nav {\n                display: flex;\n                flex-direction: column;\n                gap: 10px;\n            }\n            \n            .sidebar-left .main-nav a {\n                color: white;\n                text-decoration: none;\n                font-weight: 600;\n                font-size: 14px;\n                padding: 12px 20px;\n                border-radius: 20px;\n                transition: all 0.3s ease;\n                background: rgba(3, 199, 90, 0.1);\n                backdrop-filter: blur(10px);\n                text-align: center;\n            }\n            \n            .sidebar-left .main-nav a:hover,\n            .sidebar-left .main-nav a.active {\n                background: #03C75A;\n                color: #222;\n                transform: translateY(-2px);\n                box-shadow: 0 4px 12px rgba(3, 199, 90, 0.3);\n            }\n            \n            .ad-side {\n                grid-area: sidebar-right;\n                display: flex;\n                flex-direction: column;\n                gap: 15px;\n            }\n            \n            .main-header {\n                grid-area: header;\n                background: linear-gradient(135deg, #1a1d21 0%, #181B20 100%);\n                border-radius: 15px;\n                padding: 20px;\n                box-shadow: 0 8px 25px rgba(3, 199, 90, 0.15);\n                border: 2px solid #03C75A;\n                text-align: center;\n            }\n            \n            .main-header h1 {\n                color: #03C75A;\n                font-size: 24px;\n                margin: 0;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                gap: 12px;\n            }\n            \n            main {\n                grid-area: main;\n                display: flex;\n                flex-direction: column;\n                gap: 20px;\n            }\n            \n            .results-section {\n                background: #222;\n                border-radius: 15px;\n                padding: 25px;\n                box-shadow: 0 8px 25px rgba(3, 199, 90, 0.08);\n                border: 1px solid #31343a;\n            }\n            \n            .results-section h2 {\n                color: #03C75A;\n                font-size: 20px;\n                margin-bottom: 20px;\n                display: flex;\n                align-items: center;\n                gap: 12px;\n            }\n            \n            .main-footer {\n                grid-area: footer;\n                text-align: center;\n                color: #03C75A;\n                padding: 15px;\n                background: #222;\n                border-radius: 12px;\n                box-shadow: 0 4px 12px rgba(3, 199, 90, 0.08);\n                border: 1px solid #31343a;\n                font-size: 13px;\n            }\n        }\n        \n        /* ëª¨ë°”ì¼ ë²„ì „ ìŠ¤íƒ€ì¼ */\n        @media (max-width: 1023px) {\n            body {\n                background: #181B20;\n                min-height: 100vh;\n                margin: 0;\n                padding: 0;\n                padding-bottom: 80px;\n            }\n            \n            .main-container {\n                display: flex;\n                flex-direction: column;\n                min-height: 100vh;\n            }\n            \n            .sidebar-left {\n                display: none;\n            }\n            \n            .ad-side {\n                display: none;\n            }\n            \n            .main-header {\n                background: rgba(26, 29, 33, 0.9);\n                backdrop-filter: blur(20px);\n                padding: 20px;\n                position: sticky;\n                top: 0;\n                z-index: 100;\n                border-bottom: 2px solid #03C75A;\n            }\n            \n            .main-header h1 {\n                color: #03C75A;\n                font-size: 20px;\n                margin: 0;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                gap: 8px;\n            }\n            \n            main {\n                flex: 1;\n                padding: 20px;\n                display: flex;\n                flex-direction: column;\n                gap: 20px;\n            }\n            \n            .results-section {\n                background: rgba(34, 34, 34, 0.95);\n                border-radius: 20px;\n                padding: 25px;\n                box-shadow: 0 10px 30px rgba(3, 199, 90, 0.1);\n                backdrop-filter: blur(20px);\n                border: 1px solid #31343a;\n            }\n            \n            .results-section h2 {\n                color: #03C75A;\n                font-size: 18px;\n                margin-bottom: 20px;\n                display: flex;\n                align-items: center;\n                gap: 8px;\n            }\n            \n            .main-footer {\n                text-align: center;\n                color: #03C75A;\n                padding: 20px;\n                background: rgba(34, 34, 34, 0.9);\n                backdrop-filter: blur(20px);\n                border-top: 2px solid #03C75A;\n            }\n            \n            /* í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ */\n            .bottom-nav {\n                position: fixed;\n                bottom: 0;\n                left: 0;\n                right: 0;\n                background: rgba(26, 29, 33, 0.95);\n                backdrop-filter: blur(20px);\n                border-top: 2px solid #03C75A;\n                padding: 10px 0;\n                z-index: 1000;\n                display: flex;\n                justify-content: space-around;\n                align-items: center;\n            }\n            \n            .bottom-nav a {\n                color: white;\n                text-decoration: none;\n                font-weight: 600;\n                font-size: 12px;\n                padding: 8px 12px;\n                border-radius: 15px;\n                background: rgba(3, 199, 90, 0.1);\n                backdrop-filter: blur(10px);\n                transition: all 0.3s ease;\n                text-align: center;\n                display: flex;\n                flex-direction: column;\n                align-items: center;\n                gap: 4px;\n                min-width: 60px;\n            }\n            \n            .bottom-nav a:hover,\n            .bottom-nav a.active {\n                background: #03C75A;\n                color: #222;\n                transform: translateY(-2px);\n            }\n            \n            .bottom-nav .nav-icon {\n                font-size: 20px;\n            }\n        }\n        \n        .material-symbols-rounded {\n            font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 24;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"main-container\">\n        <aside class=\"sidebar-left\">\n            <div class=\"logo-nav\">\n                <img src=\"/assets/danceoffice-logo.png\" alt=\"Danceoffice Logo\" class=\"main-logo\">\n                <nav class=\"main-nav\">\n                    <a href=\"/\">í™ˆ</a>\n                    <a href=\"/results/\" class=\"active\">ê²½ê¸° ê²°ê³¼</a>\n                    <a href=\"/comprehensive/\">ì¢…í•©ê²°ê³¼</a>\n                    <a href=\"/notice/\">ê³µì§€ì‚¬í•­</a>\n                    <a href=\"/manage/\">ê´€ë¦¬ì</a>\n                </nav>\n            </div>\n        </aside>\n        \n        <header class=\"main-header\">\n            <h1><span class=\"material-symbols-rounded\">sports_score</span> ê²½ê¸° ê²°ê³¼</h1>\n        </header>\n        \n        <aside class=\"ad-side\">\n            <!-- ê´‘ê³  ì˜ì—­ -->\n        </aside>\n        \n        <main>\n            <section class=\"results-section\">\n                <h2><span class=\"material-symbols-rounded\">sports_score</span> ì „ì²´ ê²½ê¸° ê²°ê³¼</h2>\n                <div class=\"result-area\">\n                    <?php echo $results_html; ?>\n                </div>\n            </section>\n        </main>\n        \n        <footer class=\"main-footer\">\n            &copy; 2025 danceoffice.net | Powered by Seyoung Lee\n        </footer>\n    </div>\n    \n    <!-- ëª¨ë°”ì¼ í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->\n    <nav class=\"bottom-nav\">\n        <a href=\"/\">\n            <span class=\"nav-icon material-symbols-rounded\">home</span>\n            <span>í™ˆ</span>\n        </a>\n        <a href=\"/results/\" class=\"active\">\n            <span class=\"nav-icon material-symbols-rounded\">sports_score</span>\n            <span>ê²½ê¸°ê²°ê³¼</span>\n        </a>\n        <a href=\"/comprehensive/\">\n            <span class=\"nav-icon material-symbols-rounded\">analytics</span>\n            <span>ì¢…í•©ê²°ê³¼</span>\n        </a>\n        <a href=\"/notice/\">\n            <span class=\"nav-icon material-symbols-rounded\">campaign</span>\n            <span>ê³µì§€ì‚¬í•­</span>\n        </a>\n        <a href=\"/manage/\">\n            <span class=\"nav-icon material-symbols-rounded\">settings</span>\n            <span>ê´€ë¦¬ì</span>\n        </a>\n    </nav>\n    \n    <!-- êµ¬ê¸€ ë¨¸í‹°ë¦¬ì–¼ ì•„ì´ì½˜ ë¡œë“œ -->\n    <link href=\"https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded\" rel=\"stylesheet\" />\n</body>\n</html>","size_bytes":11533},"results/live.php":{"content":"<?php\n// ë””ë²„ê·¸/ì—ëŸ¬ ì¶œë ¥ì„ ì„ì‹œë¡œ ì¼­ë‹ˆë‹¤ (ë°°í¬ì‹œ ë„ì„¸ìš”)\nini_set('display_errors', 1);\nini_set('display_startup_errors', 1);\nerror_reporting(E_ALL);\n\n// ì‹¤ì‹œê°„ ê²°ê³¼ íŒŒì¼ ê²½ë¡œ (NASì—ì„œ ìë™ ë³µì‚¬ëœ ìµœì‹  ê²°ê³¼ íŒŒì¼)\n$recall_php_path = '/volume1/web/Recall/index.php';\n\n// ëª…ì‹œì  ì¶œë ¥ ì¸ì½”ë”©\nheader('Content-Type: text/html; charset=UTF-8');\n\n$result_html = \"<div class='result-error'><span class='material-symbols-rounded'>error</span> ì‹¤ì‹œê°„ ê²°ê³¼ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>\";\n\nif (file_exists($recall_php_path)) {\n    $raw = file_get_contents($recall_php_path);\n    if ($raw === false) {\n        $result_html = \"<div class='result-error'><span class='material-symbols-rounded'>error</span> íŒŒì¼ì„ ì½ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>\";\n    } else {\n        // BOM ê²€ì‚¬(UTF-8 BOM, UTF-16 LE/BE)\n        if (substr($raw, 0, 3) === \"\\xEF\\xBB\\xBF\") {\n            // UTF-8 BOM ì œê±°\n            $result_html = substr($raw, 3);\n        } elseif (substr($raw, 0, 2) === \"\\xFF\\xFE\") {\n            // UTF-16 LE\n            if (function_exists('iconv')) {\n                $result_html = iconv(\"UTF-16LE\", \"UTF-8//IGNORE\", $raw);\n            } elseif (function_exists('mb_convert_encoding')) {\n                $result_html = mb_convert_encoding($raw, \"UTF-8\", \"UTF-16LE\");\n            } else {\n                $result_html = $raw;\n            }\n        } elseif (substr($raw, 0, 2) === \"\\xFE\\xFF\") {\n            // UTF-16 BE\n            if (function_exists('iconv')) {\n                $result_html = iconv(\"UTF-16BE\", \"UTF-8//IGNORE\", $raw);\n            } elseif (function_exists('mb_convert_encoding')) {\n                $result_html = mb_convert_encoding($raw, \"UTF-8\", \"UTF-16BE\");\n            } else {\n                $result_html = $raw;\n            }\n        } else {\n            // ì¸ì½”ë”© ìë™ ê°ì§€ ì‹œë„\n            $enc = null;\n            if (function_exists('mb_detect_encoding')) {\n                $enc = mb_detect_encoding($raw, ['UTF-8','CP949','EUC-KR','ISO-8859-1','ASCII'], true);\n            }\n            if ($enc) {\n                if ($enc === 'UTF-8') {\n                    $result_html = $raw;\n                } else {\n                    if (function_exists('iconv')) {\n                        $result_html = iconv($enc, \"UTF-8//IGNORE\", $raw);\n                    } elseif (function_exists('mb_convert_encoding')) {\n                        $result_html = mb_convert_encoding($raw, \"UTF-8\", $enc);\n                    } else {\n                        $result_html = $raw;\n                    }\n                }\n            } else {\n                // ìµœí›„ì˜ ìˆ˜ë‹¨: CP949->UTF-8, EUC-KR->UTF-8, ê·¸ëƒ¥ RAW ìˆœìœ¼ë¡œ ì‹œë„\n                if (function_exists('iconv')) {\n                    $try = @iconv(\"CP949\", \"UTF-8//IGNORE\", $raw);\n                    if ($try !== false && mb_detect_encoding($try, 'UTF-8', true)) {\n                        $result_html = $try;\n                    } else {\n                        $try2 = @iconv(\"EUC-KR\", \"UTF-8//IGNORE\", $raw);\n                        if ($try2 !== false && mb_detect_encoding($try2, 'UTF-8', true)) {\n                            $result_html = $try2;\n                        } else {\n                            $result_html = $raw;\n                        }\n                    }\n                } elseif (function_exists('mb_convert_encoding')) {\n                    $result_html = mb_convert_encoding($raw, \"UTF-8\", \"CP949\");\n                } else {\n                    $result_html = $raw;\n                }\n            }\n        }\n    }\n}\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>ì¤€ê²° ì˜ˆì„  ì‹¤ì‹œê°„ ê²½ê¸° ê²°ê³¼ - danceoffice.net</title>\n    <meta http-equiv=\"refresh\" content=\"30\">\n    <link rel=\"stylesheet\" href=\"/assets/style.css\">\n    <link href=\"https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded\" rel=\"stylesheet\" />\n</head>\n<body>\n    <header class=\"main-header\" style=\"margin-bottom: 5px;\">\n        <div class=\"logo-nav\">\n            <img src=\"/assets/danceoffice-logo.png\" alt=\"Danceoffice Logo\" class=\"main-logo\">\n            <nav class=\"main-nav\">\n                <a href=\"/\">í™ˆ</a>\n                <a href=\"/results/\">ì „ì²´ ê²°ê³¼</a>\n                <a href=\"/results/live.php\" class=\"active\">ì‹¤ì‹œê°„ ê²°ê³¼</a>\n                <a href=\"/notice/\">ê³µì§€ì‚¬í•­</a>\n                <a href=\"/manage/\">ê´€ë¦¬ì</a>\n            </nav>\n        </div>\n    </header>\n    <main style=\"padding: 5px 10px; max-width: 1000px; margin: 0 auto;\">\n        <section class=\"results-section\" style=\"padding: 10px 15px; margin-bottom: 10px;\">\n            <h1 style=\"font-size: 20px; margin-bottom: 5px; color: #03C75A; text-align: center;\">1. ì‹±ê¸€ ë§¨ í”„ë¦¬ìŠ¤íƒ€ì¼ - Semi</h1>\n            <h2 style=\"font-size: 16px; margin-bottom: 15px; color: #00BFAE; text-align: center;\">7ì»¤í”Œì´ 3ë²ˆ ì´ë²¤íŠ¸ë¡œ ì§„ì¶œí•©ë‹ˆë‹¤.</h2>\n            <h3 style=\"font-size: 18px; margin-bottom: 10px; color: #03C75A;\">\n                <span class=\"material-symbols-rounded\">update</span>\n                ë‹¤ìŒ ë¼ìš´ë“œ ì§„ì¶œì ëª…ë‹¨\n            </h3>\n            <div class=\"result-area\" style=\"margin-bottom: 10px;\">\n                <?php echo $result_html; ?>\n            </div>\n            <div class=\"result-refresh\" style=\"font-size: 12px; margin-bottom: 10px;\">\n                <span class=\"material-symbols-rounded\" style=\"vertical-align:middle;\">refresh</span>\n                <span>30ì´ˆë§ˆë‹¤ ìë™ ê°±ì‹ ë©ë‹ˆë‹¤. ìµœì‹  ê²°ê³¼ê°€ ì•„ë‹ ê²½ìš° ìƒˆë¡œê³ ì¹¨(F5) í•´ì£¼ì„¸ìš”.</span>\n            </div>\n        </section>\n        <section style=\"text-align: center; margin-top: 20px;\">\n            <p class=\"result-desc\" style=\"font-size: 12px; color: #00BFAE;\">ì „ì²´ ê²°ê³¼ëŠ” <a href=\"/results/\">danceoffice.net</a>ì—ì„œ í™•ì¸í•˜ì„¸ìš”</p>\n        </section>\n    </main>\n    <footer class=\"main-footer\">\n        &copy; 2025 danceoffice.net | Powered by Seyoung Lee\n    </footer>\n</body>\n</html>","size_bytes":6026},"comp/recall/live_aggregation_api.php":{"content":"<?php\nheader('Content-Type: application/json; charset=utf-8');\nerror_reporting(E_ALL);\nini_set('display_errors', 1);\n\n// ëª…ë ¹í–‰ì—ì„œ ì‹¤í–‰ë˜ëŠ” ê²½ìš°ì™€ ì›¹ì—ì„œ ì‹¤í–‰ë˜ëŠ” ê²½ìš° ëª¨ë‘ ì²˜ë¦¬\nif (php_sapi_name() === 'cli') {\n    // ëª…ë ¹í–‰ì—ì„œ ì‹¤í–‰ë˜ëŠ” ê²½ìš°\n    $comp_id = $argv[1] ?? '';\n    $event_no = $argv[2] ?? '';\n} else {\n    // ì›¹ì—ì„œ ì‹¤í–‰ë˜ëŠ” ê²½ìš°\n    $comp_id = $_GET['comp_id'] ?? '';\n    $event_no = $_GET['event_no'] ?? '';\n}\n\nerror_log(\"=== Live Aggregation API Called ===\");\nerror_log(\"GET parameters: \" . json_encode($_GET ?? []));\nerror_log(\"comp_id: '$comp_id', event_no: '$event_no'\");\n\nif (empty($comp_id) || empty($event_no)) {\n    error_log(\"Missing parameters - comp_id: '$comp_id', event_no: '$event_no'\");\n    echo json_encode(['success' => false, 'error' => 'Missing parameters']);\n    exit;\n}\n\n$data_dir = \"data/{$comp_id}\";\nerror_log(\"data_dir: $data_dir\");\n\n// ì´ë²¤íŠ¸ ì •ë³´ ê°€ì ¸ì˜¤ê¸°\nerror_log(\"Looking for event: $event_no\");\n$event_info = getEventInfo($data_dir, $event_no);\nif (!$event_info) {\n    error_log(\"Event not found: $event_no\");\n    echo json_encode(['success' => false, 'error' => 'Event not found']);\n    exit;\n}\nerror_log(\"Event found: \" . json_encode($event_info));\n\n// ëŒ„ìŠ¤ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°\n$dances = $event_info['dances'];\nif (empty($dances)) {\n    echo json_encode(['success' => false, 'error' => 'No dances found for this event']);\n    exit;\n}\n\n// ì‹¬ì‚¬ìœ„ì› ëª©ë¡ ê°€ì ¸ì˜¤ê¸°\n$judges = getJudgesForEvent($data_dir, $event_no);\nif (empty($judges)) {\n    echo json_encode(['success' => false, 'error' => 'No judges found for this event']);\n    exit;\n}\n\n// ì„ ìˆ˜ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°\n$players = getPlayersForEvent($data_dir, $event_no);\nif (empty($players)) {\n    echo json_encode(['success' => false, 'error' => 'No players found for this event']);\n    exit;\n}\n\n// ì „ì²´ ì„ ìˆ˜ ì •ë³´ ê°€ì ¸ì˜¤ê¸° (ì‹¤ì œ ì„ ìˆ˜ëª…ì„ ìœ„í•´) - live_panel.phpì™€ ë™ì¼í•œ ë°©ì‹\n$all_players = [];\n$players_file = \"$data_dir/players.txt\";\nif (file_exists($players_file)) {\n    $lines = file($players_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        $cols = array_map('trim', explode(',', $line));\n        if (count($cols) >= 3) {\n            $all_players[$cols[0]] = [\n                'male' => $cols[1] ?? '',\n                'female' => $cols[2] ?? '',\n            ];\n        }\n    }\n    error_log(\"Loaded player data from players.txt: \" . count($all_players) . \" players\");\n} else {\n    error_log(\"players.txt not found, using fallback names\");\n    // fallback: ë“±ë²ˆí˜¸ë§Œ ìˆëŠ” ê²½ìš° ê¸°ë³¸ ì´ë¦„ ì‚¬ìš©\n    foreach ($players as $player) {\n        $all_players[$player['number']] = [\n            'male' => \"ì„ ìˆ˜\",\n            'female' => $player['number']\n        ];\n    }\n}\n\n// ì§‘ê³„ ë°ì´í„° ìˆ˜ì§‘\n$aggregation_data = collectAggregationData($data_dir, $event_no, $dances, $judges, $players, $all_players);\n\necho json_encode([\n    'success' => true,\n    'event_info' => $event_info,\n    'judges' => $judges,\n    'players' => $players,\n    'all_players' => $all_players,\n    'aggregation' => $aggregation_data\n]);\n\nfunction getEventInfo($data_dir, $event_no) {\n    $runorder_file = \"$data_dir/RunOrder_Tablet.txt\";\n    if (!file_exists($runorder_file)) {\n        return null;\n    }\n    \n    $lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    \n    foreach ($lines as $line) {\n        $cols = explode(',', $line);\n        if (count($cols) >= 13) {\n            $file_event_no = preg_replace('/\\x{FEFF}/u', '', $cols[0] ?? '');\n            $file_event_no = preg_replace('/\\D+/', '', $file_event_no);\n            $detail_no = trim($cols[13] ?? '');\n            \n            $match_event_no = !empty($detail_no) ? $detail_no : $file_event_no;\n            \n            // ë””ë²„ê·¸ ë¡œê·¸ ì¶”ê°€\n            error_log(\"Event matching: file_event_no='$file_event_no', detail_no='$detail_no', match_event_no='$match_event_no', target='$event_no'\");\n            \n            if ($match_event_no === $event_no) {\n                $dances = [];\n                for ($i = 6; $i <= 10; $i++) {\n                    if (!empty($cols[$i]) && $cols[$i] !== '0') {\n                        $dances[] = $cols[$i];\n                    }\n                }\n                \n                return [\n                    'no' => $cols[0],\n                    'detail_no' => $detail_no,\n                    'name' => $cols[1],\n                    'round' => $cols[2],\n                    'dances' => $dances,\n                    'panel' => $cols[11] ?? ''\n                ];\n            }\n        }\n    }\n    \n    return null;\n}\n\nfunction getJudgesForEvent($data_dir, $event_no) {\n    $panel_file = \"$data_dir/panel_list.json\";\n    if (!file_exists($panel_file)) {\n        error_log(\"Panel file not found: $panel_file\");\n        return [];\n    }\n    \n    $panel_data = json_decode(file_get_contents($panel_file), true);\n    if (!$panel_data) {\n        error_log(\"Failed to parse panel file: $panel_file\");\n        return [];\n    }\n    \n    // ì´ë²¤íŠ¸ì˜ íŒ¨ë„ ì½”ë“œ ê°€ì ¸ì˜¤ê¸°\n    $event_info = getEventInfo($data_dir, $event_no);\n    if (!$event_info || !isset($event_info['panel'])) {\n        error_log(\"No panel info for event: $event_no\");\n        return [];\n    }\n    \n    $panel_code = $event_info['panel'];\n    error_log(\"Looking for judges in panel: $panel_code\");\n    \n    // í•´ë‹¹ íŒ¨ë„ì˜ ì‹¬ì‚¬ìœ„ì›ë“¤ ì°¾ê¸°\n    $judges = [];\n    foreach ($panel_data as $item) {\n        if (isset($item['panel_code']) && $item['panel_code'] === $panel_code) {\n            $judges[] = [\n                'code' => $item['adj_code'],\n                'name' => \"Judge {$item['adj_code']}\" // ì‹¤ì œ ì´ë¦„ì´ ì—†ìœ¼ë¯€ë¡œ ì½”ë“œë¡œ ëŒ€ì²´\n            ];\n        }\n    }\n    \n    error_log(\"Found \" . count($judges) . \" judges for panel: $panel_code\");\n    return $judges;\n}\n\nfunction getPlayersForEvent($data_dir, $event_no) {\n    // live_panel.phpì™€ ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ ì„ ìˆ˜ ì •ë³´ ë¡œë“œ\n    $players_file = \"$data_dir/players_{$event_no}.txt\";\n    if (!file_exists($players_file)) {\n        // BOM ë“± ë¹„ì •ìƒ ë¬¸ìê°€ ë¼ì–´ ìƒì„±ëœ íŒŒì¼ì„ íƒìƒ‰í•˜ì—¬ ë³´ì •\n        foreach (glob($data_dir . \"/players_*.txt\") as $alt) {\n            $base = basename($alt);\n            $num = $base;\n            $num = preg_replace('/^players_/u', '', $num);\n            $num = preg_replace('/\\.txt$/u', '', $num);\n            $num = preg_replace('/\\x{FEFF}/u', '', $num); // BOM ì œê±°\n            $num = preg_replace('/\\D+/', '', $num); // ìˆ«ìë§Œ ë‚¨ê¹€\n            \n            if ($num === (string)$event_no) {\n                $players_file = $alt;\n                break;\n            }\n        }\n    }\n    \n    if (!file_exists($players_file)) {\n        error_log(\"Players file not found for event: $event_no\");\n        return [];\n    }\n    \n    $lines = file($players_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    $players = [];\n    \n    foreach ($lines as $line) {\n        $line = trim($line);\n        if (empty($line)) continue;\n        \n        $parts = explode(',', $line);\n        if (count($parts) >= 2) {\n            $players[] = [\n                'number' => trim($parts[0]),\n                'name' => trim($parts[1])\n            ];\n        } else {\n            // ë“±ë²ˆí˜¸ë§Œ ìˆëŠ” ê²½ìš°\n            $player_number = trim($line);\n            if (!empty($player_number)) {\n                $players[] = [\n                    'number' => $player_number,\n                    'name' => \"ì„ ìˆ˜ {$player_number}\"\n                ];\n            }\n        }\n    }\n    \n    error_log(\"Loaded \" . count($players) . \" players for event: $event_no\");\n    return $players;\n}\n\nfunction collectAggregationData($data_dir, $event_no, $dances, $judges, $players, $all_players = []) {\n    $player_scores = [];\n    $judge_status = [];\n    \n    // ê° ì„ ìˆ˜ë³„ ì ìˆ˜ ì´ˆê¸°í™”\n    foreach ($players as $player) {\n        $player_number = $player['number'];\n        $player_name = $player['name'];\n        \n        // ì „ì²´ ì„ ìˆ˜ ì •ë³´ì—ì„œ ì‹¤ì œ ì„ ìˆ˜ëª… ê°€ì ¸ì˜¤ê¸°\n        if (isset($all_players[$player_number])) {\n            $male = $all_players[$player_number]['male'] ?? '';\n            $female = $all_players[$player_number]['female'] ?? '';\n            if ($male && $female) {\n                $player_name = \"{$male} / {$female}\";\n            } elseif ($male) {\n                $player_name = $male;\n            } elseif ($female) {\n                $player_name = $female;\n            }\n        }\n        \n        $player_scores[$player_number] = [\n            'name' => $player_name,\n            'total_recall' => 0,\n            'dance_scores' => []\n        ];\n    }\n    \n    // ê° ì‹¬ì‚¬ìœ„ì›ë³„ ìƒíƒœ ì´ˆê¸°í™”\n    foreach ($judges as $judge) {\n        $judge_status[$judge['code']] = [\n            'name' => $judge['name'],\n            'completed_dances' => 0,\n            'total_dances' => count($dances),\n            'status' => 'waiting'\n        ];\n    }\n    \n    // ê° ëŒ„ìŠ¤ë³„ë¡œ .adj íŒŒì¼ í™•ì¸\n    foreach ($dances as $dance) {\n        foreach ($judges as $judge) {\n            $adj_file = \"$data_dir/{$event_no}_{$dance}_{$judge['code']}.adj\";\n            \n            if (file_exists($adj_file)) {\n                $judge_status[$judge['code']]['completed_dances']++;\n                $judge_status[$judge['code']]['status'] = 'scoring';\n                \n                // .adj íŒŒì¼ì—ì„œ Recall ë°ì´í„° ì½ê¸°\n                $recall_data = file($adj_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n                foreach ($recall_data as $line) {\n                    $player_number = trim($line, '\"');\n                    if (isset($player_scores[$player_number])) {\n                        $player_scores[$player_number]['total_recall']++;\n                        $player_scores[$player_number]['dance_scores'][$dance] = \n                            ($player_scores[$player_number]['dance_scores'][$dance] ?? 0) + 1;\n                    }\n                }\n            }\n        }\n    }\n    \n    // ì‹¬ì‚¬ìœ„ì› ìƒíƒœ ì—…ë°ì´íŠ¸\n    foreach ($judge_status as $code => &$status) {\n        if ($status['completed_dances'] === 0) {\n            $status['status'] = 'waiting';\n        } elseif ($status['completed_dances'] < $status['total_dances']) {\n            $status['status'] = 'scoring';\n        } else {\n            $status['status'] = 'completed';\n        }\n    }\n    \n    // ì„ ìˆ˜ë³„ ì ìˆ˜ë¡œ ì •ë ¬\n    uasort($player_scores, function($a, $b) {\n        return $b['total_recall'] - $a['total_recall'];\n    });\n    \n    return [\n        'player_scores' => $player_scores,\n        'judge_status' => $judge_status,\n        'total_judges' => count($judges),\n        'completed_judges' => count(array_filter($judge_status, function($status) {\n            return $status['status'] === 'completed';\n        })),\n        'progress_rate' => round((count(array_filter($judge_status, function($status) {\n            return $status['status'] === 'completed';\n        })) / count($judges)) * 100, 1)\n    ];\n}\n?>\n","size_bytes":11123},"comp/result/result.php":{"content":"<?php\nsession_start();\n\n$data_dir = '/volume1/web/comp/data'; // í™˜ê²½ì— ë§ê²Œ ìˆ˜ì •\n$event_file = $data_dir . '/events.txt';\n$adjudicator_file = $data_dir . '/Adjudicator.txt';\n\n// ëŒ€íšŒëª…/ë‚ ì§œ ë¶ˆëŸ¬ì˜¤ê¸°\n$compinfo_file = $data_dir . '/competition_info.txt';\n$comp_title = \"\";\n$comp_date = \"\";\nif (file_exists($compinfo_file)) {\n    $lines = file($compinfo_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    $comp_title = isset($lines[0]) ? trim($lines[0]) : \"\";\n    $comp_date = isset($lines[1]) ? trim($lines[1]) : \"\";\n}\n\nfunction load_events($event_file) {\n    $events = [];\n    if (file_exists($event_file)) {\n        $lines = file($event_file);\n        foreach ($lines as $line) {\n            $cols = explode(',', trim($line), 2);\n            if (count($cols) >= 2) {\n                $events[] = [\n                    'code' => trim($cols[0]),\n                    'name' => trim($cols[1])\n                ];\n            }\n        }\n    }\n    return $events;\n}\nfunction load_adjudicators($adjudicator_file) {\n    $adjs = [];\n    if (file_exists($adjudicator_file)) {\n        $lines = file($adjudicator_file);\n        foreach ($lines as $line) {\n            $cols = explode(',', trim($line));\n            if (count($cols) >= 2) {\n                $adjs[trim($cols[0])] = trim($cols[1]);\n            }\n        }\n    }\n    return $adjs;\n}\nfunction load_players($event_code, $data_dir) {\n    $players = [];\n    $player_file = $data_dir . '/event_players/' . $event_code . '_players.txt';\n    if (file_exists($player_file)) {\n        $lines = file($player_file);\n        foreach ($lines as $line) {\n            $cols = array_map('trim', explode(',', $line));\n            if (count($cols) >= 2) {\n                $players[$cols[0]] = [\n                    'number' => $cols[0],\n                    'name' => $cols[1],\n                    'partner' => isset($cols[2]) ? $cols[2] : '',\n                ];\n            }\n        }\n    }\n    return $players;\n}\nfunction load_scores($event_code, $adjudicators, $data_dir) {\n    $scores = [];\n    foreach ($adjudicators as $adj_id => $adj_name) {\n        $score_file = $data_dir . \"/scores/score_{$event_code}_J{$adj_id}.txt\";\n        if (file_exists($score_file)) {\n            $lines = file($score_file);\n            foreach ($lines as $line) {\n                $cols = explode(',', trim($line));\n                if (count($cols) == 4) {\n                    list($num, $tech, $choreo, $diff) = $cols;\n                    if (!isset($scores[$num])) $scores[$num] = [];\n                    $scores[$num][$adj_id] = [\n                        'tech' => floatval($tech),\n                        'choreo' => floatval($choreo),\n                        'diff' => floatval($diff)\n                    ];\n                }\n            }\n        }\n    }\n    return $scores;\n}\n\n// ìµœê³ /ìµœì € ì œì™¸ í‰ê· \nfunction calc_final_score($score_arr) {\n    if (count($score_arr) < 3) return 0;\n    sort($score_arr, SORT_NUMERIC);\n    if (count($score_arr) > 3) {\n        $score_arr = array_slice($score_arr, 1, count($score_arr) - 2); // Min/Max ì œì™¸\n    }\n    return array_sum($score_arr) / count($score_arr);\n}\n\n// ì´ì : (ê¸°ìˆ +ì•ˆë¬´) * ë‚œì´ë„\nfunction calc_total_score($final_tech, $final_choreo, $final_diff) {\n    return ($final_tech + $final_choreo) * $final_diff;\n}\n\n// ë°ì´í„° ë¡œë”©\n$events = load_events($event_file);\n$adjudicators = load_adjudicators($adjudicator_file);\n\n$selected_event = '';\n$event_name = '';\nif (isset($_GET['event'])) {\n    foreach ($events as $ev) {\n        if ($ev['code'] === $_GET['event']) {\n            $selected_event = $ev['code'];\n            $event_name = $ev['name'];\n            break;\n        }\n    }\n}\n\n$players = $selected_event ? load_players($selected_event, $data_dir) : [];\n$scores = ($selected_event && $adjudicators) ? load_scores($selected_event, $adjudicators, $data_dir) : [];\n\n// ì„ ìˆ˜ë³„ ì ìˆ˜ ì§‘ê³„\n$player_results = [];\nif ($players && $scores) {\n    foreach ($players as $num => $player) {\n        $tech_scores = []; $choreo_scores = []; $diff_scores = [];\n        foreach ($adjudicators as $adj_id => $adj_name) {\n            $t = isset($scores[$num][$adj_id]) ? $scores[$num][$adj_id]['tech'] : null;\n            $c = isset($scores[$num][$adj_id]) ? $scores[$num][$adj_id]['choreo'] : null;\n            $d = isset($scores[$num][$adj_id]) ? $scores[$num][$adj_id]['diff'] : null;\n            if ($t !== null) $tech_scores[$adj_id] = $t;\n            if ($c !== null) $choreo_scores[$adj_id] = $c;\n            if ($d !== null) $diff_scores[$adj_id] = $d;\n        }\n        $final_tech = calc_final_score(array_values($tech_scores));\n        $final_choreo = calc_final_score(array_values($choreo_scores));\n        $final_diff = calc_final_score(array_values($diff_scores));\n        $total_score = calc_total_score($final_tech, $final_choreo, $final_diff);\n\n        $player_results[$num] = [\n            'number' => $player['number'],\n            'name' => $player['name'],\n            'partner' => $player['partner'],\n            'tech_scores' => $tech_scores,\n            'choreo_scores' => $choreo_scores,\n            'diff_scores' => $diff_scores,\n            'final_tech' => $final_tech,\n            'final_choreo' => $final_choreo,\n            'final_diff' => $final_diff,\n            'total_score' => $total_score,\n        ];\n    }\n    // ì´ì  ìˆœì„œë¡œ ì •ë ¬ & ìˆœìœ„ ë¶€ì—¬\n    uasort($player_results, function($a, $b) {\n        return $b['total_score'] <=> $a['total_score'];\n    });\n    $rank = 1;\n    foreach ($player_results as &$result) {\n        $result['rank'] = $rank++;\n    }\n    unset($result);\n}\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>ì±„ì  ê²°ê³¼ | danceoffice.net</title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\n    <style>\n        body { background:#191b22; color:#222; }\n        .result-section {background:#fff; border-radius:14px; padding:2em 2em 2.5em 2em; max-width:1200px; margin:3em auto; box-shadow:0 4px 30px #0002;}\n        .result-title {font-size:1.7em; font-weight:700; color:#003399; margin-bottom:2em; text-align:center;}\n        .comp-title {font-size:1.18em; color:#03C75A; font-weight:700; margin-bottom:0.25em; text-align:center;}\n        .comp-date {font-size:1.03em; color:#0066b3; margin-bottom:1.2em; text-align:center;}\n        .score-table {width:100%; margin-bottom:2.1em; border-collapse:collapse; font-size:1.05em;}\n        .score-table th, .score-table td {padding:0.6em 0.4em; border:1px solid #c0c0c0; text-align:center;}\n        .score-table th {background:#e3edfa; color:#1b4a90;}\n        .score-table.ts th {background:#e3edfa;}\n        .score-table.cp th {background:#f8ebff;}\n        .score-table.dl th {background:#eafae4;}\n        .score-table.ts .final, .score-table.cp .final, .score-table.dl .final { font-weight:700;}\n        .score-table .min {background:#f9e5e5; color:#c02929;}\n        .score-table .max {background:#e2f7e2; color:#178a1a;}\n        .score-table .final {background:#f2f2fa;}\n        .score-table .row-num {font-weight:700;}\n        .score-table .avg {background:#fafafa; font-weight:700;}\n        .summary-table {width:100%; margin-top:2.5em; border-collapse:collapse; font-size:1.13em;}\n        .summary-table th, .summary-table td {padding:0.5em 0.3em; border:1px solid #bdbdbd; text-align:center;}\n        .summary-table th {background:#e3edfa; color:#003399;}\n        .summary-table .rank1 {background:#ffe966;}\n        .summary-table .rank2 {background:#cde4ff;}\n        .summary-table .rank3 {background:#fff0e2;}\n        .summary-table tr:last-child td {border-bottom:1.7px solid #aab;}\n        .print-btn {\n            display:inline-block; padding:0.5em 1.4em; font-size:1.1em; font-weight:700;\n            background:#003399; color:#fff; border:none; border-radius:28px; margin:0 0 2em 0; cursor:pointer;\n            transition:background 0.18s;\n        }\n        .print-btn:hover { background:#0057b7; }\n        @media (max-width:900px) {\n            .result-section {padding:1em 0.2em;}\n            .score-table th, .score-table td, .summary-table th, .summary-table td {font-size:0.98em;}\n        }\n        @media (max-width:600px) {\n            .result-title {font-size:1.1em;}\n            .score-table th, .score-table td, .summary-table th, .summary-table td {font-size:0.91em;}\n        }\n        /* ì¸ì‡„ ìŠ¤íƒ€ì¼ */\n        @media print {\n            body { background:#fff !important; color:#000 !important; margin:0; }\n            .result-section { box-shadow:none !important; margin:0 !important; padding:0.4cm 0.4cm 0.1cm 0.4cm !important;}\n            .print-btn, .event-link, .event-list, nav, .no-print, .result-section > :not(.print-version) { display:none !important; }\n            .print-version { display:block !important; }\n            .print-version table { width:100%; border-collapse:collapse; font-size:0.91em; margin-bottom:0.7em;}\n            .print-version th, .print-version td { border:1px solid #888; padding:0.18em 0.09em; text-align:center; }\n            .print-version th { background:#e3edfa !important; color:#222 !important; }\n            .print-version .cp th { background:#f8ebff !important; }\n            .print-version .dl th { background:#eafae4 !important; }\n            .print-version .min { background:#f9e5e5 !important; }\n            .print-version .max { background:#e2f7e2 !important; }\n            .print-version .final { background:#f2f2fa !important; font-weight:700; }\n            .print-version .rank1 { background:#ffe966 !important; }\n            .print-version .rank2 { background:#cde4ff !important; }\n            .print-version .rank3 { background:#fff0e2 !important; }\n            .print-version h2 { margin:0 0 0.25em 0; font-size:1.09em; }\n            .print-version .desc { font-size:0.84em; color:#444; margin:0.1em 0 0 0;}\n            .print-version .comp-title, .print-version .comp-date { display:block !important; }\n            @page { size: A4 landscape; margin:0.6cm; }\n        }\n        @media screen {\n            .print-version { display:none; }\n        }\n    </style>\n    <script>\n    function printResult() { window.print(); }\n    </script>\n</head>\n<body>\n<main>\n<section class=\"result-section\">\n<?php if ($selected_event && $player_results): ?>\n    <button class=\"print-btn no-print\" onclick=\"printResult()\">ğŸ–¨ï¸ ì¸ì‡„</button>\n    <?php if ($comp_title): ?>\n        <div class=\"comp-title\"><?= htmlspecialchars($comp_title) ?></div>\n    <?php endif; ?>\n    <?php if ($comp_date): ?>\n        <div class=\"comp-date\"><?= htmlspecialchars($comp_date) ?></div>\n    <?php endif; ?>\n    <div class=\"result-title\"><?= htmlspecialchars($event_name) ?> ê²°ê³¼ì§€</div>\n    <!-- ê¸°ìˆ (TS) -->\n    <table class=\"score-table ts\">\n        <tr>\n            <th colspan=\"<?= 3+count($adjudicators) ?>\">ê¸°ìˆ  (TS)</th>\n        </tr>\n        <tr>\n            <th>ë²ˆí˜¸</th>\n            <?php foreach($adjudicators as $adj_name): ?>\n                <th><?= htmlspecialchars($adj_name) ?></th>\n            <?php endforeach; ?>\n            <th class=\"min\">Min</th>\n            <th class=\"max\">Max</th>\n            <th class=\"final\">í‰ê· </th>\n        </tr>\n        <?php foreach($player_results as $player):\n            $scores = $player['tech_scores'];\n            $min = (count($scores) >= 1) ? min($scores) : '';\n            $max = (count($scores) >= 1) ? max($scores) : '';\n        ?>\n        <tr>\n            <td class=\"row-num\"><?= $player['number'] ?></td>\n            <?php foreach($adjudicators as $adj_id => $adj_name): ?>\n                <td><?= isset($scores[$adj_id]) ? number_format($scores[$adj_id], 2) : '-' ?></td>\n            <?php endforeach; ?>\n            <td class=\"min\"><?= $min !== '' ? number_format($min,2) : '' ?></td>\n            <td class=\"max\"><?= $max !== '' ? number_format($max,2) : '' ?></td>\n            <td class=\"final\"><?= number_format($player['final_tech'], 2) ?></td>\n        </tr>\n        <?php endforeach; ?>\n    </table>\n    <!-- ì•ˆë¬´(CP) -->\n    <table class=\"score-table cp\">\n        <tr>\n            <th colspan=\"<?= 3+count($adjudicators) ?>\">ì•ˆë¬´ (CP)</th>\n        </tr>\n        <tr>\n            <th>ë²ˆí˜¸</th>\n            <?php foreach($adjudicators as $adj_name): ?>\n                <th><?= htmlspecialchars($adj_name) ?></th>\n            <?php endforeach; ?>\n            <th class=\"min\">Min</th>\n            <th class=\"max\">Max</th>\n            <th class=\"final\">í‰ê· </th>\n        </tr>\n        <?php foreach($player_results as $player):\n            $scores = $player['choreo_scores'];\n            $min = (count($scores) >= 1) ? min($scores) : '';\n            $max = (count($scores) >= 1) ? max($scores) : '';\n        ?>\n        <tr>\n            <td class=\"row-num\"><?= $player['number'] ?></td>\n            <?php foreach($adjudicators as $adj_id => $adj_name): ?>\n                <td><?= isset($scores[$adj_id]) ? number_format($scores[$adj_id], 2) : '-' ?></td>\n            <?php endforeach; ?>\n            <td class=\"min\"><?= $min !== '' ? number_format($min,2) : '' ?></td>\n            <td class=\"max\"><?= $max !== '' ? number_format($max,2) : '' ?></td>\n            <td class=\"final\"><?= number_format($player['final_choreo'], 2) ?></td>\n        </tr>\n        <?php endforeach; ?>\n    </table>\n    <!-- ë‚œì´ë„(DL) -->\n    <table class=\"score-table dl\">\n        <tr>\n            <th colspan=\"<?= 3+count($adjudicators) ?>\">ë‚œì´ë„ (DL)</th>\n        </tr>\n        <tr>\n            <th>ë²ˆí˜¸</th>\n            <?php foreach($adjudicators as $adj_name): ?>\n                <th><?= htmlspecialchars($adj_name) ?></th>\n            <?php endforeach; ?>\n            <th class=\"min\">Min</th>\n            <th class=\"max\">Max</th>\n            <th class=\"final\">í‰ê· </th>\n        </tr>\n        <?php foreach($player_results as $player):\n            $scores = $player['diff_scores'];\n            $min = (count($scores) >= 1) ? min($scores) : '';\n            $max = (count($scores) >= 1) ? max($scores) : '';\n        ?>\n        <tr>\n            <td class=\"row-num\"><?= $player['number'] ?></td>\n            <?php foreach($adjudicators as $adj_id => $adj_name): ?>\n                <td><?= isset($scores[$adj_id]) ? number_format($scores[$adj_id], 2) : '-' ?></td>\n            <?php endforeach; ?>\n            <td class=\"min\"><?= $min !== '' ? number_format($min,2) : '' ?></td>\n            <td class=\"max\"><?= $max !== '' ? number_format($max,2) : '' ?></td>\n            <td class=\"final\"><?= number_format($player['final_diff'], 2) ?></td>\n        </tr>\n        <?php endforeach; ?>\n    </table>\n    <!-- ì¢…í•© ì§‘ê³„í‘œ -->\n    <table class=\"summary-table\">\n        <tr>\n            <th>ë²ˆí˜¸</th>\n            <th>ê¸°ìˆ </th>\n            <th>ì•ˆë¬´</th>\n            <th>ë‚œì´ë„</th>\n            <th>ì´ì <br><span style=\"font-size:0.94em;\">(ê¸°ìˆ +ì•ˆë¬´)Ã—ë‚œì´ë„</span></th>\n            <th>ìˆœìœ„</th>\n            <th>ì„ ìˆ˜ëª…</th>\n            <th>ì†Œì†</th>\n        </tr>\n        <?php foreach($player_results as $player):\n            $rank_class = 'rank' . ($player['rank'] <= 3 ? $player['rank'] : '');\n        ?>\n        <tr class=\"<?= $rank_class ?>\">\n            <td><?= $player['number'] ?></td>\n            <td><?= number_format($player['final_tech'], 2) ?></td>\n            <td><?= number_format($player['final_choreo'], 2) ?></td>\n            <td><?= number_format($player['final_diff'], 2) ?></td>\n            <td><b><?= number_format($player['total_score'], 2) ?></b></td>\n            <td><?= $player['rank'] ?>ìœ„</td>\n            <td><?= htmlspecialchars($player['name']) ?></td>\n            <td><?= htmlspecialchars($player['partner']) ?></td>\n        </tr>\n        <?php endforeach; ?>\n    </table>\n    <div style=\"margin:1.2em 0 0 0; color:#555; font-size:0.97em;\">\n        â€» ê° í•­ëª© ì ìˆ˜ëŠ” ì‹¬ì‚¬ìœ„ì› 5ëª… ì¤‘ ìµœê³ /ìµœì €ì  ì œì™¸ 3ëª… í‰ê· ì…ë‹ˆë‹¤.<br>\n        â€» ì´ì  = <b>(ê¸°ìˆ ì ìˆ˜ + ì•ˆë¬´ì ìˆ˜) Ã— ë‚œì´ë„ì ìˆ˜</b> ì…ë‹ˆë‹¤.<br>\n        â€» ì‹¬ì‚¬ìœ„ì› ì ìˆ˜ê°€ ì—†ìœ¼ë©´ '-'ë¡œ í‘œì‹œë©ë‹ˆë‹¤.\n    </div>\n    <!-- ì¸ì‡„ ì „ìš©: í™”ë©´ê³¼ ì™„ì „íˆ ë™ì¼í•œ ë ˆì´ì•„ì›ƒì„ 1í˜ì´ì§€ì—! -->\n    <div class=\"print-version\">\n        <?php if ($comp_title): ?>\n            <div class=\"comp-title\"><?= htmlspecialchars($comp_title) ?></div>\n        <?php endif; ?>\n        <?php if ($comp_date): ?>\n            <div class=\"comp-date\"><?= htmlspecialchars($comp_date) ?></div>\n        <?php endif; ?>\n        <h2><?= htmlspecialchars($event_name) ?> ê²°ê³¼ì§€</h2>\n        <!-- ê¸°ìˆ  -->\n        <table class=\"score-table ts\">\n            <tr>\n                <th colspan=\"<?= 3+count($adjudicators) ?>\">ê¸°ìˆ  (TS)</th>\n            </tr>\n            <tr>\n                <th>ë²ˆí˜¸</th>\n                <?php foreach($adjudicators as $adj_name): ?>\n                    <th><?= htmlspecialchars($adj_name) ?></th>\n                <?php endforeach; ?>\n                <th class=\"min\">Min</th>\n                <th class=\"max\">Max</th>\n                <th class=\"final\">í‰ê· </th>\n            </tr>\n            <?php foreach($player_results as $player):\n                $scores = $player['tech_scores'];\n                $min = (count($scores) >= 1) ? min($scores) : '';\n                $max = (count($scores) >= 1) ? max($scores) : '';\n            ?>\n            <tr>\n                <td><?= $player['number'] ?></td>\n                <?php foreach($adjudicators as $adj_id => $adj_name): ?>\n                    <td><?= isset($scores[$adj_id]) ? number_format($scores[$adj_id], 2) : '-' ?></td>\n                <?php endforeach; ?>\n                <td class=\"min\"><?= $min !== '' ? number_format($min,2) : '' ?></td>\n                <td class=\"max\"><?= $max !== '' ? number_format($max,2) : '' ?></td>\n                <td class=\"final\"><?= number_format($player['final_tech'], 2) ?></td>\n            </tr>\n            <?php endforeach; ?>\n        </table>\n        <!-- ì•ˆë¬´ -->\n        <table class=\"score-table cp\">\n            <tr>\n                <th colspan=\"<?= 3+count($adjudicators) ?>\">ì•ˆë¬´ (CP)</th>\n            </tr>\n            <tr>\n                <th>ë²ˆí˜¸</th>\n                <?php foreach($adjudicators as $adj_name): ?>\n                    <th><?= htmlspecialchars($adj_name) ?></th>\n                <?php endforeach; ?>\n                <th class=\"min\">Min</th>\n                <th class=\"max\">Max</th>\n                <th class=\"final\">í‰ê· </th>\n            </tr>\n            <?php foreach($player_results as $player):\n                $scores = $player['choreo_scores'];\n                $min = (count($scores) >= 1) ? min($scores) : '';\n                $max = (count($scores) >= 1) ? max($scores) : '';\n            ?>\n            <tr>\n                <td><?= $player['number'] ?></td>\n                <?php foreach($adjudicators as $adj_id => $adj_name): ?>\n                    <td><?= isset($scores[$adj_id]) ? number_format($scores[$adj_id], 2) : '-' ?></td>\n                <?php endforeach; ?>\n                <td class=\"min\"><?= $min !== '' ? number_format($min,2) : '' ?></td>\n                <td class=\"max\"><?= $max !== '' ? number_format($max,2) : '' ?></td>\n                <td class=\"final\"><?= number_format($player['final_choreo'], 2) ?></td>\n            </tr>\n            <?php endforeach; ?>\n        </table>\n        <!-- ë‚œì´ë„ -->\n        <table class=\"score-table dl\">\n            <tr>\n                <th colspan=\"<?= 3+count($adjudicators) ?>\">ë‚œì´ë„ (DL)</th>\n            </tr>\n            <tr>\n                <th>ë²ˆí˜¸</th>\n                <?php foreach($adjudicators as $adj_name): ?>\n                    <th><?= htmlspecialchars($adj_name) ?></th>\n                <?php endforeach; ?>\n                <th class=\"min\">Min</th>\n                <th class=\"max\">Max</th>\n                <th class=\"final\">í‰ê· </th>\n            </tr>\n            <?php foreach($player_results as $player):\n                $scores = $player['diff_scores'];\n                $min = (count($scores) >= 1) ? min($scores) : '';\n                $max = (count($scores) >= 1) ? max($scores) : '';\n            ?>\n            <tr>\n                <td><?= $player['number'] ?></td>\n                <?php foreach($adjudicators as $adj_id => $adj_name): ?>\n                    <td><?= isset($scores[$adj_id]) ? number_format($scores[$adj_id], 2) : '-' ?></td>\n                <?php endforeach; ?>\n                <td class=\"min\"><?= $min !== '' ? number_format($min,2) : '' ?></td>\n                <td class=\"max\"><?= $max !== '' ? number_format($max,2) : '' ?></td>\n                <td class=\"final\"><?= number_format($player['final_diff'], 2) ?></td>\n            </tr>\n            <?php endforeach; ?>\n        </table>\n        <!-- ì§‘ê³„í‘œ -->\n        <table class=\"summary-table\">\n            <tr>\n                <th>ë²ˆí˜¸</th>\n                <th>ê¸°ìˆ </th>\n                <th>ì•ˆë¬´</th>\n                <th>ë‚œì´ë„</th>\n                <th>ì´ì <br><span style=\"font-size:0.94em;\">(ê¸°ìˆ +ì•ˆë¬´)Ã—ë‚œì´ë„</span></th>\n                <th>ìˆœìœ„</th>\n                <th>ì„ ìˆ˜ëª…</th>\n                <th>ì†Œì†</th>\n            </tr>\n            <?php foreach($player_results as $player):\n                $rank_class = 'rank' . ($player['rank'] <= 3 ? $player['rank'] : '');\n            ?>\n            <tr class=\"<?= $rank_class ?>\">\n                <td><?= $player['number'] ?></td>\n                <td><?= number_format($player['final_tech'], 2) ?></td>\n                <td><?= number_format($player['final_choreo'], 2) ?></td>\n                <td><?= number_format($player['final_diff'], 2) ?></td>\n                <td><b><?= number_format($player['total_score'], 2) ?></b></td>\n                <td><?= $player['rank'] ?>ìœ„</td>\n                <td><?= htmlspecialchars($player['name']) ?></td>\n                <td><?= htmlspecialchars($player['partner']) ?></td>\n            </tr>\n            <?php endforeach; ?>\n        </table>\n        <div class=\"desc\">\n            â€» ê° í•­ëª© ì ìˆ˜ëŠ” ì‹¬ì‚¬ìœ„ì› 5ëª… ì¤‘ ìµœê³ /ìµœì €ì  ì œì™¸ 3ëª… í‰ê· ì…ë‹ˆë‹¤.<br>\n            â€» ì´ì  = <b>(ê¸°ìˆ ì ìˆ˜ + ì•ˆë¬´ì ìˆ˜) Ã— ë‚œì´ë„ì ìˆ˜</b>\n        </div>\n    </div>\n<?php elseif ($selected_event): ?>\n    <div style=\"margin:2em 0; padding:1.2em; background:#f6eaea; color:#e33; border-radius:8px;\">\n        ì°¸ê°€ì ë˜ëŠ” ì±„ì  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.\n    </div>\n<?php else: ?>\n    <?php if ($comp_title): ?>\n        <div class=\"comp-title\"><?= htmlspecialchars($comp_title) ?></div>\n    <?php endif; ?>\n    <?php if ($comp_date): ?>\n        <div class=\"comp-date\"><?= htmlspecialchars($comp_date) ?></div>\n    <?php endif; ?>\n    <div class=\"result-title\">ì±„ì  ê²°ê³¼</div>\n    <div class=\"event-list\" style=\"text-align:center; margin-bottom:3em;\">\n        <?php if ($events): ?>\n            <?php foreach ($events as $ev): ?>\n                <a class=\"event-link\" style=\"display:inline-block;margin:0.4em 0.8em 0.4em 0;padding:.5em 1.2em; border-radius:24px;\n                background:#23262b; color:#03C75A; border:1px solid #3a3d44; text-decoration:none; font-weight:700;\"\n                   href=\"?event=<?= urlencode($ev['code']) ?>\">\n                    <?= htmlspecialchars($ev['name']) ?>\n                </a>\n            <?php endforeach; ?>\n        <?php else: ?>\n            <span style=\"color:#f55;\">ë“±ë¡ëœ ì¢…ëª©ì´ ì—†ìŠµë‹ˆë‹¤.</span>\n        <?php endif; ?>\n    </div>\n    <div style=\"color:#999; text-align:center;\">ì¢…ëª©ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.</div>\n<?php endif; ?>\n</section>\n</main>\n</body>\n</html>","size_bytes":23561},"comp/scoring/get_scores.php":{"content":"<?php\nheader('Content-Type: application/json; charset=utf-8');\n\n$comp_id = $_GET['comp_id'] ?? '';\n$event_no = $_GET['event_no'] ?? '';\n$dance = $_GET['dance'] ?? ''; // Optional: specific dance\n$judge_id = $_GET['judge_id'] ?? ''; // Optional: specific judge\n\n// Remove BOM and normalize\n$comp_id = preg_replace('/\\x{FEFF}/u', '', $comp_id);\n$event_no = preg_replace('/\\x{FEFF}/u', '', $event_no);\n$comp_id = preg_replace('/[^\\d-]/', '', $comp_id);\n$event_no = preg_replace('/\\D+/', '', $event_no);\n\nif (!$comp_id || !$event_no) {\n    echo json_encode(['success' => false, 'error' => 'comp_id ë˜ëŠ” event_no ëˆ„ë½']);\n    exit;\n}\n\n$data_dir = __DIR__ . \"/../data/$comp_id\";\n\n// Check for JSON scores file first (final round)\n$scores_file = \"$data_dir/scores_$event_no.json\";\nif (file_exists($scores_file)) {\n    $content = file_get_contents($scores_file);\n    $scores_data = json_decode($content, true);\n    if (json_last_error() === JSON_ERROR_NONE) {\n        echo json_encode(['success' => true, 'scores' => $scores_data, 'type' => 'final']);\n        exit;\n    }\n}\n\n// Look for .adj files (recall round)\n$adj_files = glob(\"$data_dir/{$event_no}_*.adj\");\n$recall_data = [];\n\nforeach ($adj_files as $file) {\n    $filename = basename($file);\n    \n    // Parse filename: event_no_dance_judge_id.adj\n    if (preg_match('/^(\\d+)_(.+)_(\\d+)\\.adj$/', $filename, $matches)) {\n        $file_event_no = $matches[1];\n        $file_dance = $matches[2];\n        $file_judge_id = $matches[3];\n        \n        // Filter by dance and judge if specified\n        if ($dance && $file_dance !== $dance) continue;\n        if ($judge_id && $file_judge_id !== $judge_id) continue;\n        \n        // Read file content\n        $lines = file($file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n        $players = [];\n        \n        foreach ($lines as $line) {\n            $line = trim($line);\n            // Remove quotes if present\n            $line = trim($line, '\"');\n            if ($line && is_numeric($line)) {\n                $players[] = $line;\n            }\n        }\n        \n        if (!isset($recall_data[$file_dance])) {\n            $recall_data[$file_dance] = [];\n        }\n        \n        $recall_data[$file_dance][$file_judge_id] = $players;\n    }\n}\n\nif (!empty($recall_data)) {\n    echo json_encode([\n        'success' => true, \n        'scores' => $recall_data, \n        'type' => 'recall',\n        'files_found' => count($adj_files)\n    ]);\n} else {\n    echo json_encode(['success' => false, 'error' => 'ì ìˆ˜ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤']);\n}\n?>\n","size_bytes":2561},"comp/scoring/save_multievent_scores.php":{"content":"<?php\nsession_start();\n\n// Check if judge is logged in\nif (!isset($_SESSION['scoring_logged_in']) || !$_SESSION['scoring_logged_in']) {\n    echo json_encode(['success' => false, 'error' => 'ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.']);\n    exit;\n}\n\n$comp_id = $_POST['comp_id'] ?? '';\n$event_no = $_POST['event_no'] ?? '';\n$dance = $_POST['dance'] ?? '';\n$judge_id = $_SESSION['scoring_judge_id'] ?? '';\n$type = $_POST['type'] ?? 'final';\n\nif (!$comp_id || !$event_no || !$dance || !$judge_id) {\n    echo json_encode(['success' => false, 'error' => 'í•„ìˆ˜ ë§¤ê°œë³€ìˆ˜ê°€ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤.']);\n    exit;\n}\n\n$data_dir = __DIR__ . \"/../data/$comp_id\";\nif (!is_dir($data_dir)) {\n    mkdir($data_dir, 0777, true);\n}\n\n// File format: {event_no}_{dance}_{judge_id}.adj\n$adj_file = \"$data_dir/{$event_no}_{$dance}_{$judge_id}.adj\";\n\nif ($type === 'recall') {\n    // Recall system: save selected players\n    $recall_marks_json = $_POST['recall_marks'] ?? '';\n    $recall_marks = json_decode($recall_marks_json, true);\n    \n    if (!$recall_marks || !isset($recall_marks[$dance])) {\n        echo json_encode(['success' => false, 'error' => 'Recall ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.']);\n        exit;\n    }\n    \n    $selected_players = $recall_marks[$dance];\n    $file_content = [];\n    \n    // Save in format: \"player\" (judge_scoring.php í˜¸í™˜)\n    foreach ($selected_players as $player) {\n        $file_content[] = \"\\\"$player\\\"\";\n    }\n    \n    $success = file_put_contents($adj_file, implode(\"\\n\", $file_content));\n} else {\n    // Final system: save rankings\n    $adjudicator_marks_json = $_POST['adjudicator_marks'] ?? '';\n    $adjudicator_marks = json_decode($adjudicator_marks_json, true);\n    \n    if (!$adjudicator_marks || !isset($adjudicator_marks[$judge_id])) {\n        echo json_encode(['success' => false, 'error' => 'ì±„ì  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.']);\n        exit;\n    }\n    \n    $rankings = $adjudicator_marks[$judge_id];\n    $file_content = [];\n    \n    // Save in format: player,rank\n    foreach ($rankings as $player => $rank) {\n        $file_content[] = \"$player,$rank\";\n    }\n    \n    $success = file_put_contents($adj_file, implode(\"\\n\", $file_content));\n}\n\nif ($success !== false) {\n    echo json_encode([\n        'success' => true,\n        'message' => 'ì ìˆ˜ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.',\n        'file' => basename($adj_file),\n        'type' => $type\n    ]);\n} else {\n    echo json_encode(['success' => false, 'error' => 'íŒŒì¼ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.']);\n}\n?>\n","size_bytes":2474},"comp/scoring/save_scores.php":{"content":"<?php\nheader('Content-Type: application/json; charset=utf-8');\n\nrequire_once 'skating_system.php';\n\n// Check if it's FormData (POST) or JSON input\n$input = [];\nif ($_SERVER['REQUEST_METHOD'] === 'POST' && !empty($_POST)) {\n    // FormData input\n    $input = $_POST;\n} else {\n    // JSON input\n    $input = json_decode(file_get_contents('php://input'), true) ?? [];\n}\n\n$comp_id = $input['comp_id'] ?? '';\n$event_no = $input['event_no'] ?? '';\n$type = $input['type'] ?? 'final'; // 'final' or 'recall'\n$is_final = $input['is_final'] ?? '0';\n$adjudicator_marks = $input['adjudicator_marks'] ?? [];\n$recall_marks = $input['recall_marks'] ?? [];\n\n// Get judge ID from session first\nsession_start();\n$judge_id = $_SESSION['scoring_judge_id'] ?? 'unknown';\n\n// Handle final round from FormData\nif ($is_final === '1' || $is_final === 1) {\n    $type = 'final';\n    // Convert FormData to adjudicator_marks format\n    if (isset($input['adjudicator_marks'])) {\n        // Check if it's JSON string\n        if (is_string($input['adjudicator_marks'])) {\n            $adjudicator_marks = json_decode($input['adjudicator_marks'], true);\n            error_log(\"Decoded adjudicator_marks: \" . print_r($adjudicator_marks, true));\n        } else {\n            $adjudicator_marks = $input['adjudicator_marks'];\n        }\n    } else if (isset($input['final_ranking'])) {\n        // Handle final_ranking format from touch-based system\n        $adjudicator_marks = [];\n        $adjudicator_marks[$judge_id] = [];\n        foreach ($input['final_ranking'] as $rank => $player) {\n            if (!empty($player)) {\n                $adjudicator_marks[$judge_id][$player] = intval($rank);\n            }\n        }\n    } else {\n        // Handle direct place inputs\n        $adjudicator_marks = [];\n        foreach ($input as $key => $value) {\n            if (strpos($key, 'adjudicator_marks[') === 0) {\n                // Parse the key to extract adjudicator and couple info\n                preg_match('/adjudicator_marks\\[(\\d+)\\]\\[(.+)\\]/', $key, $matches);\n                if (count($matches) === 3) {\n                    $adjudicator_id = $matches[1];\n                    $couple_id = $matches[2];\n                    if (!isset($adjudicator_marks[$adjudicator_id])) {\n                        $adjudicator_marks[$adjudicator_id] = [];\n                    }\n                    $adjudicator_marks[$adjudicator_id][$couple_id] = intval($value);\n                }\n            }\n        }\n    }\n}\n\n// Remove BOM and normalize\n$comp_id = preg_replace('/\\x{FEFF}/u', '', $comp_id);\n$event_no = preg_replace('/\\x{FEFF}/u', '', $event_no);\n$comp_id = preg_replace('/[^\\d-]/', '', $comp_id);\n$event_no = preg_replace('/[^0-9\\-]/', '', $event_no); // í•˜ì´í”ˆ í—ˆìš©\n\nif (!$comp_id || !$event_no) {\n    echo json_encode(['success' => false, 'error' => 'í•„ìˆ˜ ë°ì´í„°ê°€ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤']);\n    exit;\n}\n\n$data_dir = __DIR__ . \"/../data/$comp_id\";\nif (!is_dir($data_dir)) {\n    @mkdir($data_dir, 0777, true);\n}\n\n// Get judge ID from session (already started above)\n$judge_id = $_SESSION['scoring_judge_id'] ?? 'unknown';\n\nif ($type === 'final') {\n    // Final round - save individual dance scores\n    if (empty($adjudicator_marks)) {\n        echo json_encode(['success' => false, 'error' => 'ì‹¬ì‚¬ìœ„ì› ì ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤']);\n        exit;\n    }\n    \n    // Get dance name from input\n    $dance = $input['dance'] ?? 'unknown';\n    \n    // Validate adjudicator marks format\n    $validated_marks = [];\n    foreach ($adjudicator_marks as $adjudicator_id => $marks) {\n        if (is_array($marks)) {\n            $validated_marks[$adjudicator_id] = [];\n            foreach ($marks as $couple_id => $place) {\n                if (is_numeric($place) && $place > 0) {\n                    $validated_marks[$adjudicator_id][$couple_id] = intval($place);\n                }\n            }\n        }\n    }\n    \n    if (empty($validated_marks)) {\n        echo json_encode(['success' => false, 'error' => 'ìœ íš¨í•œ ì‹¬ì‚¬ìœ„ì› ì ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤']);\n        exit;\n    }\n    \n    // Save individual dance file: event_no_dance_judge_id.adj\n    $dance_file = \"{$event_no}_{$dance}_{$judge_id}.adj\";\n    $dance_filepath = \"$data_dir/$dance_file\";\n    \n    // Save as .adj file (one player per line with rank)\n    $content = '';\n    foreach ($validated_marks[$judge_id] as $player => $rank) {\n        $content .= \"$player,$rank\\n\";\n    }\n    \n    if (file_put_contents($dance_filepath, $content) === false) {\n        echo json_encode(['success' => false, 'error' => 'íŒŒì¼ ì €ì¥ ì‹¤íŒ¨']);\n        exit;\n    }\n    \n    // Check if all judges have submitted for this dance\n    $all_judges_submitted = checkAllJudgesSubmitted($data_dir, $event_no, $dance);\n    \n    if ($all_judges_submitted) {\n        // All judges submitted - calculate final results for this dance\n        $final_results = calculateFinalResultsForDance($data_dir, $event_no, $dance);\n        \n        echo json_encode([\n            'success' => true, \n            'message' => \"$dance ëŒ„ìŠ¤ ì±„ì ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤\",\n            'dance_completed' => true,\n            'results' => $final_results\n        ]);\n    } else {\n        echo json_encode([\n            'success' => true, \n            'message' => \"$dance ëŒ„ìŠ¤ ì ìˆ˜ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤\",\n            'dance_completed' => false\n        ]);\n    }\n    \n} else if ($type === 'recall') {\n    // Recall round - save dance by dance\n    if (empty($recall_marks)) {\n        echo json_encode(['success' => false, 'error' => 'Recall ì ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤']);\n        exit;\n    }\n    \n    $saved_files = [];\n    $errors = [];\n    \n    foreach ($recall_marks as $dance => $selected_players) {\n        if (empty($selected_players)) {\n            $errors[] = \"$dance: ì„ íƒëœ ì„ ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤\";\n            continue;\n        }\n        \n        // Create filename: event_no_dance_judge_id.adj\n        $filename = \"{$event_no}_{$dance}_{$judge_id}.adj\";\n        $filepath = \"$data_dir/$filename\";\n        \n        // Save as .adj file (one player per line, quoted)\n        $content = '';\n        foreach ($selected_players as $player) {\n            $content .= '\"' . $player . '\"' . \"\\n\";\n        }\n        \n        if (file_put_contents($filepath, $content) === false) {\n            $errors[] = \"$dance: íŒŒì¼ ì €ì¥ ì‹¤íŒ¨\";\n        } else {\n            $saved_files[] = $filename;\n        }\n    }\n    \n    if (!empty($errors)) {\n        echo json_encode([\n            'success' => false, \n            'error' => implode(', ', $errors)\n        ]);\n    } else {\n        // Check if all dances are completed for this judge\n        $all_completed = checkAllRecallDancesCompleted($data_dir, $event_no, $judge_id);\n        \n        echo json_encode([\n            'success' => true, \n            'message' => 'Recall ì ìˆ˜ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤',\n            'saved_files' => $saved_files,\n            'all_completed' => $all_completed\n        ]);\n    }\n} else {\n    echo json_encode(['success' => false, 'error' => 'ì˜ëª»ëœ ìš”ì²­ íƒ€ì…ì…ë‹ˆë‹¤']);\n}\n\n// Helper function to check if all recall dances are completed for a judge\nfunction checkAllRecallDancesCompleted($data_dir, $event_no, $judge_id) {\n    // Get event data to find all dances\n    $runorder_file = \"$data_dir/RunOrder_Tablet.txt\";\n    if (!file_exists($runorder_file)) {\n        error_log(\"checkAllRecallDancesCompleted: RunOrder file not found\");\n        return false;\n    }\n    \n    $lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    $event_dances = [];\n    \n    foreach ($lines as $line) {\n        $line = preg_replace('/\\x{FEFF}/u', '', $line);\n        $cols = array_map('trim', explode(',', $line));\n        \n        if (preg_match('/^bom/', $line)) continue;\n        \n        $file_event_no = preg_replace('/\\x{FEFF}/u', '', $cols[0]);\n        $detail_no = trim($cols[13] ?? '');\n        $match_event_no = !empty($detail_no) ? $detail_no : preg_replace('/\\D+/', '', $file_event_no);\n        \n        if ($match_event_no === $event_no) {\n            // Get dances from columns 6-10\n            for ($i = 6; $i <= 10; $i++) {\n                if (!empty($cols[$i])) {\n                    $event_dances[] = $cols[$i];\n                }\n            }\n            break;\n        }\n    }\n    \n    error_log(\"checkAllRecallDancesCompleted: Event dances for $event_no: \" . json_encode($event_dances));\n    \n    if (empty($event_dances)) {\n        error_log(\"checkAllRecallDancesCompleted: No dances found for event $event_no\");\n        return false;\n    }\n    \n    // Check if all dance files exist for this judge\n    foreach ($event_dances as $dance) {\n        $adj_file = \"$data_dir/{$event_no}_{$dance}_{$judge_id}.adj\";\n        error_log(\"checkAllRecallDancesCompleted: Checking file: $adj_file\");\n        if (!file_exists($adj_file)) {\n            error_log(\"checkAllRecallDancesCompleted: File not found: $adj_file\");\n            return false;\n        }\n    }\n    \n    error_log(\"checkAllRecallDancesCompleted: All files found for event $event_no, judge $judge_id\");\n    return true;\n}\n\n// Helper function to check if all judges have submitted for a dance\nfunction checkAllJudgesSubmitted($data_dir, $event_no, $dance) {\n    // Get list of judges from adjudicators.txt\n    $adjudicators_file = \"$data_dir/adjudicators.txt\";\n    if (!file_exists($adjudicators_file)) {\n        return false;\n    }\n    \n    $judges = [];\n    $lines = file($adjudicators_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        $cols = explode(',', $line);\n        if (count($cols) >= 2) {\n            $judges[] = trim($cols[1]); // Judge ID is in second column\n        }\n    }\n    \n    // Check if all judges have submitted\n    foreach ($judges as $judge_id) {\n        $dance_file = \"{$event_no}_{$dance}_{$judge_id}.adj\";\n        $dance_filepath = \"$data_dir/$dance_file\";\n        if (!file_exists($dance_filepath)) {\n            return false;\n        }\n    }\n    \n    return true;\n}\n\n// Helper function to calculate final results for a dance\nfunction calculateFinalResultsForDance($data_dir, $event_no, $dance) {\n    // Get all judge scores for this dance\n    $adjudicator_marks = [];\n    \n    $adjudicators_file = \"$data_dir/adjudicators.txt\";\n    if (file_exists($adjudicators_file)) {\n        $lines = file($adjudicators_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n        foreach ($lines as $line) {\n            $cols = explode(',', $line);\n            if (count($cols) >= 2) {\n                $judge_id = trim($cols[1]);\n                $dance_file = \"{$event_no}_{$dance}_{$judge_id}.adj\";\n                $dance_filepath = \"$data_dir/$dance_file\";\n                \n                if (file_exists($dance_filepath)) {\n                    $adjudicator_marks[$judge_id] = [];\n                    $content = file_get_contents($dance_filepath);\n                    $lines = explode(\"\\n\", trim($content));\n                    foreach ($lines as $line) {\n                        if (strpos($line, ',') !== false) {\n                            list($player, $rank) = explode(',', $line, 2);\n                            $adjudicator_marks[$judge_id][trim($player)] = intval(trim($rank));\n                        }\n                    }\n                }\n            }\n        }\n    }\n    \n    if (empty($adjudicator_marks)) {\n        return [];\n    }\n    \n    // Calculate results using Skating System\n    require_once 'skating_system.php';\n    $results = SkatingSystem::calculateSingleDance($adjudicator_marks);\n    \n    // Save final results for this dance\n    $final_file = \"{$event_no}_{$dance}_final.json\";\n    $final_filepath = \"$data_dir/$final_file\";\n    $final_data = [\n        'event_no' => $event_no,\n        'dance' => $dance,\n        'adjudicator_marks' => $adjudicator_marks,\n        'results' => $results,\n        'calculated_at' => date('Y-m-d H:i:s'),\n        'num_adjudicators' => count($adjudicator_marks),\n        'num_couples' => count($results['results'])\n    ];\n    \n    file_put_contents($final_filepath, json_encode($final_data, JSON_UNESCAPED_UNICODE | JSON_PRETTY_PRINT));\n    \n    return $results['results'];\n}\n?>\n","size_bytes":12174},"comp/scoring/skating_system.php":{"content":"<?php\n/**\n * Skating System for DanceSport Competition Scoring\n * Based on the official rules adopted by the Official Board of Ballroom Dancing\n */\n\nclass SkatingSystem {\n    \n    /**\n     * Calculate majority threshold\n     * @param int $numAdjudicators Number of adjudicators\n     * @return int Majority threshold\n     */\n    public static function getMajority($numAdjudicators) {\n        return floor($numAdjudicators / 2) + 1;\n    }\n    \n    /**\n     * Calculate results for a single dance\n     * @param array $adjudicatorMarks Array of adjudicator marks [adjudicator_id => [couple_id => place]]\n     * @return array Results with places and detailed calculations\n     */\n    public static function calculateSingleDance($adjudicatorMarks) {\n        $couples = [];\n        $numAdjudicators = count($adjudicatorMarks);\n        $majority = self::getMajority($numAdjudicators);\n        \n        // Get all couples\n        foreach ($adjudicatorMarks as $adjudicator => $marks) {\n            foreach ($marks as $coupleId => $place) {\n                if (!isset($couples[$coupleId])) {\n                    $couples[$coupleId] = [\n                        'id' => $coupleId,\n                        'places' => [],\n                        'place_counts' => [],\n                        'total_marks' => 0\n                    ];\n                }\n            }\n        }\n        \n        // Collect all places for each couple\n        foreach ($adjudicatorMarks as $adjudicator => $marks) {\n            foreach ($marks as $coupleId => $place) {\n                $couples[$coupleId]['places'][] = $place;\n                $couples[$coupleId]['total_marks'] += $place;\n            }\n        }\n        \n        // Count places for each couple\n        foreach ($couples as $coupleId => &$couple) {\n            $placeCounts = array_count_values($couple['places']);\n            for ($i = 1; $i <= count($couples); $i++) {\n                $couple['place_counts'][$i] = isset($placeCounts[$i]) ? $placeCounts[$i] : 0;\n            }\n        }\n        \n        // Calculate places using Skating System rules\n        $results = [];\n        $remainingCouples = array_keys($couples);\n        $currentPlace = 1;\n        \n        while (!empty($remainingCouples)) {\n            $placeResult = self::determinePlace($remainingCouples, $couples, $majority, $currentPlace);\n            \n            if (count($placeResult['couples']) == 1) {\n                // Single couple gets this place\n                $results[$placeResult['couples'][0]] = $currentPlace;\n                $remainingCouples = array_diff($remainingCouples, $placeResult['couples']);\n                $currentPlace++;\n            } else {\n                // Tie - multiple couples share this place\n                foreach ($placeResult['couples'] as $coupleId) {\n                    $results[$coupleId] = $currentPlace;\n                }\n                $remainingCouples = array_diff($remainingCouples, $placeResult['couples']);\n                $currentPlace += count($placeResult['couples']);\n            }\n        }\n        \n        return [\n            'results' => $results,\n            'couples' => $couples,\n            'majority' => $majority,\n            'num_adjudicators' => $numAdjudicators\n        ];\n    }\n    \n    /**\n     * Determine which couples get a specific place\n     * @param array $remainingCouples Couples still to be placed\n     * @param array $couples Couple data\n     * @param int $majority Majority threshold\n     * @param int $targetPlace Place being determined\n     * @return array Couples that get this place\n     */\n    private static function determinePlace($remainingCouples, $couples, $majority, $targetPlace) {\n        $candidates = [];\n        \n        // Rule 1: Check for majority of 1st places\n        if ($targetPlace == 1) {\n            foreach ($remainingCouples as $coupleId) {\n                if ($couples[$coupleId]['place_counts'][1] >= $majority) {\n                    $candidates[] = $coupleId;\n                }\n            }\n            if (!empty($candidates)) {\n                return ['couples' => $candidates, 'rule' => 'majority_1st'];\n            }\n        }\n        \n        // Rule 2: Check for majority of 1st+2nd places\n        if ($targetPlace <= 2) {\n            foreach ($remainingCouples as $coupleId) {\n                $firstSecond = $couples[$coupleId]['place_counts'][1] + $couples[$coupleId]['place_counts'][2];\n                if ($firstSecond >= $majority) {\n                    $candidates[] = $coupleId;\n                }\n            }\n            if (!empty($candidates)) {\n                // If multiple couples, use total marks to break tie\n                usort($candidates, function($a, $b) use ($couples) {\n                    return $couples[$a]['total_marks'] - $couples[$b]['total_marks'];\n                });\n                \n                // Check if there's still a tie\n                $lowestTotal = $couples[$candidates[0]]['total_marks'];\n                $finalCandidates = [];\n                foreach ($candidates as $coupleId) {\n                    if ($couples[$coupleId]['total_marks'] == $lowestTotal) {\n                        $finalCandidates[] = $coupleId;\n                    }\n                }\n                \n                return ['couples' => $finalCandidates, 'rule' => 'majority_1st_2nd'];\n            }\n        }\n        \n        // Rule 3: Continue checking 1st+2nd+3rd, etc.\n        for ($place = 1; $place <= count($remainingCouples); $place++) {\n            $totalCount = 0;\n            foreach ($remainingCouples as $coupleId) {\n                for ($i = 1; $i <= $place; $i++) {\n                    $totalCount += $couples[$coupleId]['place_counts'][$i];\n                }\n            }\n            \n            if ($totalCount >= $majority) {\n                foreach ($remainingCouples as $coupleId) {\n                    $totalCount = 0;\n                    for ($i = 1; $i <= $place; $i++) {\n                        $totalCount += $couples[$coupleId]['place_counts'][$i];\n                    }\n                    if ($totalCount >= $majority) {\n                        $candidates[] = $coupleId;\n                    }\n                }\n                \n                if (!empty($candidates)) {\n                    // Use total marks to break tie\n                    usort($candidates, function($a, $b) use ($couples) {\n                        return $couples[$a]['total_marks'] - $couples[$b]['total_marks'];\n                    });\n                    \n                    $lowestTotal = $couples[$candidates[0]]['total_marks'];\n                    $finalCandidates = [];\n                    foreach ($candidates as $coupleId) {\n                        if ($couples[$coupleId]['total_marks'] == $lowestTotal) {\n                            $finalCandidates[] = $coupleId;\n                        }\n                    }\n                    \n                    return ['couples' => $finalCandidates, 'rule' => \"majority_1st_to_{$place}th\"];\n                }\n            }\n        }\n        \n        // Fallback: Use total marks\n        usort($remainingCouples, function($a, $b) use ($couples) {\n            return $couples[$a]['total_marks'] - $couples[$b]['total_marks'];\n        });\n        \n        $lowestTotal = $couples[$remainingCouples[0]]['total_marks'];\n        $finalCandidates = [];\n        foreach ($remainingCouples as $coupleId) {\n            if ($couples[$coupleId]['total_marks'] == $lowestTotal) {\n                $finalCandidates[] = $coupleId;\n            }\n        }\n        \n        return ['couples' => $finalCandidates, 'rule' => 'total_marks'];\n    }\n    \n    /**\n     * Calculate results for multiple dance event (Rule 11)\n     * @param array $danceResults Array of single dance results\n     * @param array $adjudicatorMarks All adjudicator marks for all dances\n     * @return array Final results\n     */\n    public static function calculateMultipleDance($danceResults, $adjudicatorMarks) {\n        $couples = [];\n        $numDances = count($danceResults);\n        $numAdjudicators = count($adjudicatorMarks[0] ?? []);\n        $totalMarks = $numDances * $numAdjudicators;\n        $majority = floor($totalMarks / 2) + 1;\n        \n        // Calculate final summary (sum of places)\n        foreach ($danceResults as $dance => $results) {\n            foreach ($results['results'] as $coupleId => $place) {\n                if (!isset($couples[$coupleId])) {\n                    $couples[$coupleId] = [\n                        'id' => $coupleId,\n                        'final_summary' => 0,\n                        'place_counts' => [],\n                        'total_marks' => 0\n                    ];\n                }\n                $couples[$coupleId]['final_summary'] += $place;\n            }\n        }\n        \n        // Sort by final summary\n        uasort($couples, function($a, $b) {\n            return $a['final_summary'] - $b['final_summary'];\n        });\n        \n        // Check for ties in final summary\n        $finalResults = [];\n        $currentPlace = 1;\n        $groupedCouples = [];\n        \n        $prevSummary = null;\n        $currentGroup = [];\n        \n        foreach ($couples as $coupleId => $couple) {\n            if ($prevSummary === null || $couple['final_summary'] == $prevSummary) {\n                $currentGroup[] = $coupleId;\n            } else {\n                if (count($currentGroup) > 1) {\n                    $groupedCouples[] = $currentGroup;\n                } else {\n                    $finalResults[$currentGroup[0]] = $currentPlace;\n                    $currentPlace++;\n                }\n                $currentGroup = [$coupleId];\n            }\n            $prevSummary = $couple['final_summary'];\n        }\n        \n        // Handle last group\n        if (count($currentGroup) > 1) {\n            $groupedCouples[] = $currentGroup;\n        } else {\n            $finalResults[$currentGroup[0]] = $currentPlace;\n        }\n        \n        // Apply Rule 11 for tied couples\n        foreach ($groupedCouples as $tiedCouples) {\n            $rule11Result = self::applyRule11($tiedCouples, $adjudicatorMarks, $majority);\n            foreach ($rule11Result as $coupleId => $place) {\n                $finalResults[$coupleId] = $currentPlace + $place - 1;\n            }\n            $currentPlace += count($tiedCouples);\n        }\n        \n        return [\n            'results' => $finalResults,\n            'couples' => $couples,\n            'majority' => $majority,\n            'total_marks' => $totalMarks\n        ];\n    }\n    \n    /**\n     * Apply Rule 11 for tied couples\n     * @param array $tiedCouples Couples that are tied\n     * @param array $adjudicatorMarks All adjudicator marks\n     * @param int $majority Majority threshold\n     * @return array Rule 11 results\n     */\n    private static function applyRule11($tiedCouples, $adjudicatorMarks, $majority) {\n        $couples = [];\n        \n        // Initialize couples\n        foreach ($tiedCouples as $coupleId) {\n            $couples[$coupleId] = [\n                'id' => $coupleId,\n                'place_counts' => [],\n                'total_marks' => 0\n            ];\n        }\n        \n        // Collect all marks across all dances\n        foreach ($adjudicatorMarks as $dance => $adjudicators) {\n            foreach ($adjudicators as $adjudicator => $marks) {\n                foreach ($marks as $coupleId => $place) {\n                    if (in_array($coupleId, $tiedCouples)) {\n                        $couples[$coupleId]['place_counts'][$place] = \n                            ($couples[$coupleId]['place_counts'][$place] ?? 0) + 1;\n                        $couples[$coupleId]['total_marks'] += $place;\n                    }\n                }\n            }\n        }\n        \n        // Apply same logic as single dance\n        $results = [];\n        $remainingCouples = $tiedCouples;\n        $currentPlace = 1;\n        \n        while (!empty($remainingCouples)) {\n            $placeResult = self::determinePlace($remainingCouples, $couples, $majority, $currentPlace);\n            \n            if (count($placeResult['couples']) == 1) {\n                $results[$placeResult['couples'][0]] = $currentPlace;\n                $remainingCouples = array_diff($remainingCouples, $placeResult['couples']);\n                $currentPlace++;\n            } else {\n                foreach ($placeResult['couples'] as $coupleId) {\n                    $results[$coupleId] = $currentPlace;\n                }\n                $remainingCouples = array_diff($remainingCouples, $placeResult['couples']);\n                $currentPlace += count($placeResult['couples']);\n            }\n        }\n        \n        return $results;\n    }\n}\n?>\n","size_bytes":12717},"comp/wizard/index.php":{"content":"<?php\nsession_start();\n\n// ë‹¨ê³„ ê²°ì •\n$step = isset($_GET['step']) ? intval($_GET['step']) : 1;\n$total_steps = 6;\n\n// í¼ ë°ì´í„° ì €ì¥ (ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” íŒŒì¼/DBë¡œ ì €ì¥ ê¶Œì¥)\nif ($_SERVER['REQUEST_METHOD'] === 'POST') {\n    $_SESSION['wizard'][$step] = $_POST;\n    // ë§ˆì§€ë§‰ ë‹¨ê³„ê¹Œì§€ ì…ë ¥ë˜ë©´ ì™„ë£Œ í”Œë˜ê·¸ ì„¤ì •\n    if ($step >= $total_steps) {\n        $_SESSION['wizard_complete'] = true;\n        header(\"Location: ../index.php\");\n        exit;\n    } else {\n        header(\"Location: index.php?step=\" . ($step + 1));\n        exit;\n    }\n}\n\n// ì…ë ¥í–ˆë˜ ê°’ ë¶ˆëŸ¬ì˜¤ê¸°(ìˆ˜ì •ì‹œ)\nfunction get_prev($key, $step) {\n    return isset($_SESSION['wizard'][$step][$key]) ? htmlspecialchars($_SESSION['wizard'][$step][$key]) : '';\n}\n\n// ë‹¨ê³„ë³„ ì•ˆë‚´ ë° í¼\nfunction render_step($step) {\n    switch ($step) {\n        case 1: // ëŒ€íšŒ ê¸°ë³¸ì •ë³´\n            ?>\n            <div class=\"wizard-title\">1. ëŒ€íšŒ ê¸°ë³¸ì •ë³´ ì…ë ¥</div>\n            <form method=\"post\">\n                <div><input name=\"comp_title\" placeholder=\"ëŒ€íšŒëª…\" value=\"<?= get_prev('comp_title', 1) ?>\" required></div>\n                <div><input type=\"date\" name=\"comp_date\" value=\"<?= get_prev('comp_date', 1) ?>\" required></div>\n                <div><input name=\"comp_place\" placeholder=\"ì¥ì†Œ\" value=\"<?= get_prev('comp_place', 1) ?>\"></div>\n                <div><input name=\"comp_host\" placeholder=\"ì£¼ìµœ/ì£¼ê´€\" value=\"<?= get_prev('comp_host', 1) ?>\"></div>\n                <button type=\"submit\">ë‹¤ìŒ &gt;</button>\n            </form>\n            <?php\n            break;\n        case 2: // ì‹¬ì‚¬ìœ„ì› ì…ë ¥\n            ?>\n            <div class=\"wizard-title\">2. ì‹¬ì‚¬ìœ„ì› ë“±ë¡</div>\n            <form method=\"post\">\n                <div>\n                    <textarea name=\"adjudicators\" rows=\"5\" placeholder=\"ID,ì´ë¦„ í˜•ì‹ìœ¼ë¡œ ì¤„ë§ˆë‹¤ ì…ë ¥\" required><?= get_prev('adjudicators', 2) ?></textarea>\n                    <div class=\"small\">ì˜ˆì‹œ: <br>J1,ê¹€ì‹¬ì‚¬<br>J2,ì´ì‹¬ì‚¬</div>\n                </div>\n                <button type=\"submit\">ë‹¤ìŒ &gt;</button>\n            </form>\n            <?php\n            break;\n        case 3: // ì´ë²¤íŠ¸(ì¢…ëª©) ì…ë ¥\n            ?>\n            <div class=\"wizard-title\">3. ì´ë²¤íŠ¸(ì¢…ëª©) ë“±ë¡</div>\n            <form method=\"post\">\n                <div>\n                    <textarea name=\"events\" rows=\"5\" placeholder=\"ì½”ë“œ,ì´ë¦„ í˜•ì‹ìœ¼ë¡œ ì¤„ë§ˆë‹¤ ì…ë ¥\" required><?= get_prev('events', 3) ?></textarea>\n                    <div class=\"small\">ì˜ˆì‹œ:<br>S1,ì†”ë¡œë¼í‹´<br>D1,ë“€ì˜¤í”„ë¦¬ìŠ¤íƒ€ì¼</div>\n                </div>\n                <button type=\"submit\">ë‹¤ìŒ &gt;</button>\n            </form>\n            <?php\n            break;\n        case 4: // ì„ ìˆ˜ëª…ë‹¨ ì…ë ¥\n            ?>\n            <div class=\"wizard-title\">4. ì„ ìˆ˜ ëª…ë‹¨ ì…ë ¥</div>\n            <form method=\"post\">\n                <div>\n                    <textarea name=\"players\" rows=\"7\" placeholder=\"ë“±ë²ˆí˜¸,ì´ë¦„,íŒŒíŠ¸ë„ˆ(ì—†ìœ¼ë©´ ê³µë€) í˜•ì‹\"><?= get_prev('players', 4) ?></textarea>\n                    <div class=\"small\">ì˜ˆì‹œ:<br>101,í™ê¸¸ë™,ê¹€ì¶˜í–¥<br>102,ì´ëª½ë£¡,</div>\n                </div>\n                <button type=\"submit\">ë‹¤ìŒ &gt;</button>\n            </form>\n            <?php\n            break;\n        case 5: // ì‹œê°„í‘œ\n            ?>\n            <div class=\"wizard-title\">5. ì‹œê°„í‘œ(íƒ€ì„í…Œì´ë¸”) ì…ë ¥</div>\n            <form method=\"post\">\n                <div>\n                    <textarea name=\"timetable\" rows=\"5\" placeholder=\"ê²½ê¸°,ì‹œê°„,ë‚´ìš© ë“±\"><?= get_prev('timetable', 5) ?></textarea>\n                    <div class=\"small\">ì˜ˆì‹œ:<br>ì†”ë¡œë¼í‹´,10:00,1ë¼ìš´ë“œ<br>ë“€ì˜¤í”„ë¦¬ìŠ¤íƒ€ì¼,11:00,ë³¸ì„ </div>\n                </div>\n                <button type=\"submit\">ë‹¤ìŒ &gt;</button>\n            </form>\n            <?php\n            break;\n        case 6: // ìš”ì•½/ìµœì¢…í™•ì¸\n            ?>\n            <div class=\"wizard-title\">6. ì…ë ¥ì •ë³´ ìµœì¢… í™•ì¸</div>\n            <form method=\"post\">\n                <div class=\"summary\">\n                    <b>ëŒ€íšŒëª…:</b> <?= get_prev('comp_title', 1) ?><br>\n                    <b>ì¼ì:</b> <?= get_prev('comp_date', 1) ?><br>\n                    <b>ì¥ì†Œ:</b> <?= get_prev('comp_place', 1) ?><br>\n                    <b>ì£¼ìµœ/ì£¼ê´€:</b> <?= get_prev('comp_host', 1) ?><br>\n                    <b>ì‹¬ì‚¬ìœ„ì›:</b><br>\n                    <pre><?= htmlspecialchars(get_prev('adjudicators', 2)) ?></pre>\n                    <b>ì´ë²¤íŠ¸:</b><br>\n                    <pre><?= htmlspecialchars(get_prev('events', 3)) ?></pre>\n                    <b>ì„ ìˆ˜ëª…ë‹¨:</b><br>\n                    <pre><?= htmlspecialchars(get_prev('players', 4)) ?></pre>\n                    <b>ì‹œê°„í‘œ:</b><br>\n                    <pre><?= htmlspecialchars(get_prev('timetable', 5)) ?></pre>\n                </div>\n                <button type=\"submit\" style=\"background:#03C75A;\">ëŒ€íšŒ ì¤€ë¹„ ì™„ë£Œ</button>\n            </form>\n            <?php\n            break;\n        default:\n            echo \"ì˜ëª»ëœ ë‹¨ê³„ì…ë‹ˆë‹¤.\";\n    }\n}\n?>\n<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>ëŒ€íšŒ ì„¤ì • ë§ˆë²•ì‚¬ | COMP</title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\">\n    <style>\n        body { background:#f0f3f8; font-family:sans-serif; margin:0;}\n        .wizard-main { max-width:430px; margin:3vh auto 0 auto; background:#fff; border-radius:14px; box-shadow:0 4px 18px #00339914; padding:2.1em 1.2em 2.2em 1.2em;}\n        .wizard-steps { margin-bottom:2em; text-align:center;}\n        .wizard-step { display:inline-block; width:26px; height:26px; line-height:26px; border-radius:50%; background:#eee; color:#888; text-align:center; margin-right:7px;}\n        .wizard-step.active { background:#03C75A; color:#fff; font-weight:700;}\n        .wizard-title { font-weight:700; margin-bottom:1.2em; text-align:center; font-size:1.08em;}\n        form > div { margin-bottom:1em;}\n        input, textarea { width:100%; padding:0.55em; border-radius:7px; border:1px solid #bbb; font-size:1em;}\n        textarea {resize:vertical;min-height:65px;}\n        button { padding:0.5em 2em; border-radius:8px; border:none; background:#03C75A; color:#fff; font-weight:700; font-size:1em;}\n        .small {font-size:0.93em; color:#888; margin:0.2em 0 0 0;}\n        .summary { font-size:0.97em; color:#333; background:#f7fafd; border-radius:8px; padding:1.1em; margin-bottom:1.3em;}\n        pre { background:#f0f3f8; padding:0.5em 0.7em; border-radius:7px; font-size:0.97em;}\n        @media (max-width:600px) {\n            .wizard-main { max-width:97vw; padding:1.1em 0.3em;}\n            .wizard-title { font-size:0.99em;}\n        }\n        footer {margin-top:2.2em;text-align:center;font-size:0.92em;color:#aaa;}\n    </style>\n</head>\n<body>\n<div class=\"wizard-main\">\n    <div class=\"wizard-steps\">\n        <?php for ($i=1; $i<=$total_steps; $i++): ?>\n            <span class=\"wizard-step<?= $step==$i?' active':'' ?>\"><?= $i ?></span>\n        <?php endfor; ?>\n    </div>\n    <?php render_step($step); ?>\n</div>\n<footer>\n    2025 danceoffice.net | Powered by Seyoung Lee\n</footer>\n</body>\n</html>","size_bytes":7250},"recall/recall/live_aggregation_api.php":{"content":"<?php\nheader('Content-Type: application/json; charset=utf-8');\nerror_reporting(E_ALL);\nini_set('display_errors', 1);\n\n// ëª…ë ¹í–‰ì—ì„œ ì‹¤í–‰ë˜ëŠ” ê²½ìš°ì™€ ì›¹ì—ì„œ ì‹¤í–‰ë˜ëŠ” ê²½ìš° ëª¨ë‘ ì²˜ë¦¬\nif (php_sapi_name() === 'cli') {\n    // ëª…ë ¹í–‰ì—ì„œ ì‹¤í–‰ë˜ëŠ” ê²½ìš°\n    $comp_id = $argv[1] ?? '';\n    $event_no = $argv[2] ?? '';\n} else {\n    // ì›¹ì—ì„œ ì‹¤í–‰ë˜ëŠ” ê²½ìš°\n    $comp_id = $_GET['comp_id'] ?? '';\n    $event_no = $_GET['event_no'] ?? '';\n}\n\nerror_log(\"=== Live Aggregation API Called ===\");\nerror_log(\"GET parameters: \" . json_encode($_GET ?? []));\nerror_log(\"comp_id: '$comp_id', event_no: '$event_no'\");\n\nif (empty($comp_id) || empty($event_no)) {\n    error_log(\"Missing parameters - comp_id: '$comp_id', event_no: '$event_no'\");\n    echo json_encode(['success' => false, 'error' => 'Missing parameters']);\n    exit;\n}\n\n$data_dir = \"data/{$comp_id}\";\nerror_log(\"data_dir: $data_dir\");\n\n// ì´ë²¤íŠ¸ ì •ë³´ ê°€ì ¸ì˜¤ê¸°\nerror_log(\"Looking for event: $event_no\");\n$event_info = getEventInfo($data_dir, $event_no);\nif (!$event_info) {\n    error_log(\"Event not found: $event_no\");\n    echo json_encode(['success' => false, 'error' => 'Event not found']);\n    exit;\n}\nerror_log(\"Event found: \" . json_encode($event_info));\n\n// ëŒ„ìŠ¤ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°\n$dances = $event_info['dances'];\nif (empty($dances)) {\n    echo json_encode(['success' => false, 'error' => 'No dances found for this event']);\n    exit;\n}\n\n// ì‹¬ì‚¬ìœ„ì› ëª©ë¡ ê°€ì ¸ì˜¤ê¸°\n$judges = getJudgesForEvent($data_dir, $event_no);\nif (empty($judges)) {\n    echo json_encode(['success' => false, 'error' => 'No judges found for this event']);\n    exit;\n}\n\n// ì„ ìˆ˜ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°\n$players = getPlayersForEvent($data_dir, $event_no);\nif (empty($players)) {\n    echo json_encode(['success' => false, 'error' => 'No players found for this event']);\n    exit;\n}\n\n// ì „ì²´ ì„ ìˆ˜ ì •ë³´ ê°€ì ¸ì˜¤ê¸° (ì‹¤ì œ ì„ ìˆ˜ëª…ì„ ìœ„í•´) - live_panel.phpì™€ ë™ì¼í•œ ë°©ì‹\n$all_players = [];\n$players_file = \"$data_dir/players.txt\";\nif (file_exists($players_file)) {\n    $lines = file($players_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    foreach ($lines as $line) {\n        $cols = array_map('trim', explode(',', $line));\n        if (count($cols) >= 3) {\n            $all_players[$cols[0]] = [\n                'male' => $cols[1] ?? '',\n                'female' => $cols[2] ?? '',\n            ];\n        }\n    }\n    error_log(\"Loaded player data from players.txt: \" . count($all_players) . \" players\");\n} else {\n    error_log(\"players.txt not found, using fallback names\");\n    // fallback: ë“±ë²ˆí˜¸ë§Œ ìˆëŠ” ê²½ìš° ê¸°ë³¸ ì´ë¦„ ì‚¬ìš©\n    foreach ($players as $player) {\n        $all_players[$player['number']] = [\n            'male' => \"ì„ ìˆ˜\",\n            'female' => $player['number']\n        ];\n    }\n}\n\n// ì§‘ê³„ ë°ì´í„° ìˆ˜ì§‘\n$aggregation_data = collectAggregationData($data_dir, $event_no, $dances, $judges, $players, $all_players);\n\necho json_encode([\n    'success' => true,\n    'event_info' => $event_info,\n    'judges' => $judges,\n    'players' => $players,\n    'all_players' => $all_players,\n    'aggregation' => $aggregation_data\n]);\n\nfunction getEventInfo($data_dir, $event_no) {\n    $runorder_file = \"$data_dir/RunOrder_Tablet.txt\";\n    if (!file_exists($runorder_file)) {\n        return null;\n    }\n    \n    $lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    \n    foreach ($lines as $line) {\n        $cols = explode(',', $line);\n        if (count($cols) >= 13) {\n            $file_event_no = preg_replace('/\\x{FEFF}/u', '', $cols[0] ?? '');\n            $file_event_no = preg_replace('/\\D+/', '', $file_event_no);\n            $detail_no = trim($cols[13] ?? '');\n            \n            $match_event_no = !empty($detail_no) ? $detail_no : $file_event_no;\n            \n            // ë””ë²„ê·¸ ë¡œê·¸ ì¶”ê°€\n            error_log(\"Event matching: file_event_no='$file_event_no', detail_no='$detail_no', match_event_no='$match_event_no', target='$event_no'\");\n            \n            if ($match_event_no === $event_no) {\n                $dances = [];\n                for ($i = 6; $i <= 10; $i++) {\n                    if (!empty($cols[$i]) && $cols[$i] !== '0') {\n                        $dances[] = $cols[$i];\n                    }\n                }\n                \n                return [\n                    'no' => $cols[0],\n                    'detail_no' => $detail_no,\n                    'name' => $cols[1],\n                    'round' => $cols[2],\n                    'dances' => $dances,\n                    'panel' => $cols[11] ?? ''\n                ];\n            }\n        }\n    }\n    \n    return null;\n}\n\nfunction getJudgesForEvent($data_dir, $event_no) {\n    $panel_file = \"$data_dir/panel_list.json\";\n    if (!file_exists($panel_file)) {\n        error_log(\"Panel file not found: $panel_file\");\n        return [];\n    }\n    \n    $panel_data = json_decode(file_get_contents($panel_file), true);\n    if (!$panel_data) {\n        error_log(\"Failed to parse panel file: $panel_file\");\n        return [];\n    }\n    \n    // ì´ë²¤íŠ¸ì˜ íŒ¨ë„ ì½”ë“œ ê°€ì ¸ì˜¤ê¸°\n    $event_info = getEventInfo($data_dir, $event_no);\n    if (!$event_info || !isset($event_info['panel'])) {\n        error_log(\"No panel info for event: $event_no\");\n        return [];\n    }\n    \n    $panel_code = $event_info['panel'];\n    error_log(\"Looking for judges in panel: $panel_code\");\n    \n    // í•´ë‹¹ íŒ¨ë„ì˜ ì‹¬ì‚¬ìœ„ì›ë“¤ ì°¾ê¸°\n    $judges = [];\n    foreach ($panel_data as $item) {\n        if (isset($item['panel_code']) && $item['panel_code'] === $panel_code) {\n            $judges[] = [\n                'code' => $item['adj_code'],\n                'name' => \"Judge {$item['adj_code']}\" // ì‹¤ì œ ì´ë¦„ì´ ì—†ìœ¼ë¯€ë¡œ ì½”ë“œë¡œ ëŒ€ì²´\n            ];\n        }\n    }\n    \n    error_log(\"Found \" . count($judges) . \" judges for panel: $panel_code\");\n    return $judges;\n}\n\nfunction getPlayersForEvent($data_dir, $event_no) {\n    // live_panel.phpì™€ ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ ì„ ìˆ˜ ì •ë³´ ë¡œë“œ\n    $players_file = \"$data_dir/players_{$event_no}.txt\";\n    if (!file_exists($players_file)) {\n        // BOM ë“± ë¹„ì •ìƒ ë¬¸ìê°€ ë¼ì–´ ìƒì„±ëœ íŒŒì¼ì„ íƒìƒ‰í•˜ì—¬ ë³´ì •\n        foreach (glob($data_dir . \"/players_*.txt\") as $alt) {\n            $base = basename($alt);\n            $num = $base;\n            $num = preg_replace('/^players_/u', '', $num);\n            $num = preg_replace('/\\.txt$/u', '', $num);\n            $num = preg_replace('/\\x{FEFF}/u', '', $num); // BOM ì œê±°\n            $num = preg_replace('/\\D+/', '', $num); // ìˆ«ìë§Œ ë‚¨ê¹€\n            \n            if ($num === (string)$event_no) {\n                $players_file = $alt;\n                break;\n            }\n        }\n    }\n    \n    if (!file_exists($players_file)) {\n        error_log(\"Players file not found for event: $event_no\");\n        return [];\n    }\n    \n    $lines = file($players_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n    $players = [];\n    \n    foreach ($lines as $line) {\n        $line = trim($line);\n        if (empty($line)) continue;\n        \n        $parts = explode(',', $line);\n        if (count($parts) >= 2) {\n            $players[] = [\n                'number' => trim($parts[0]),\n                'name' => trim($parts[1])\n            ];\n        } else {\n            // ë“±ë²ˆí˜¸ë§Œ ìˆëŠ” ê²½ìš°\n            $player_number = trim($line);\n            if (!empty($player_number)) {\n                $players[] = [\n                    'number' => $player_number,\n                    'name' => \"ì„ ìˆ˜ {$player_number}\"\n                ];\n            }\n        }\n    }\n    \n    error_log(\"Loaded \" . count($players) . \" players for event: $event_no\");\n    return $players;\n}\n\nfunction collectAggregationData($data_dir, $event_no, $dances, $judges, $players, $all_players = []) {\n    $player_scores = [];\n    $judge_status = [];\n    \n    // ê° ì„ ìˆ˜ë³„ ì ìˆ˜ ì´ˆê¸°í™”\n    foreach ($players as $player) {\n        $player_number = $player['number'];\n        $player_name = $player['name'];\n        \n        // ì „ì²´ ì„ ìˆ˜ ì •ë³´ì—ì„œ ì‹¤ì œ ì„ ìˆ˜ëª… ê°€ì ¸ì˜¤ê¸°\n        if (isset($all_players[$player_number])) {\n            $male = $all_players[$player_number]['male'] ?? '';\n            $female = $all_players[$player_number]['female'] ?? '';\n            if ($male && $female) {\n                $player_name = \"{$male} / {$female}\";\n            } elseif ($male) {\n                $player_name = $male;\n            } elseif ($female) {\n                $player_name = $female;\n            }\n        }\n        \n        $player_scores[$player_number] = [\n            'name' => $player_name,\n            'total_recall' => 0,\n            'dance_scores' => []\n        ];\n    }\n    \n    // ê° ì‹¬ì‚¬ìœ„ì›ë³„ ìƒíƒœ ì´ˆê¸°í™”\n    foreach ($judges as $judge) {\n        $judge_status[$judge['code']] = [\n            'name' => $judge['name'],\n            'completed_dances' => 0,\n            'total_dances' => count($dances),\n            'status' => 'waiting'\n        ];\n    }\n    \n    // ê° ëŒ„ìŠ¤ë³„ë¡œ .adj íŒŒì¼ í™•ì¸\n    foreach ($dances as $dance) {\n        foreach ($judges as $judge) {\n            $adj_file = \"$data_dir/{$event_no}_{$dance}_{$judge['code']}.adj\";\n            \n            if (file_exists($adj_file)) {\n                $judge_status[$judge['code']]['completed_dances']++;\n                $judge_status[$judge['code']]['status'] = 'scoring';\n                \n                // .adj íŒŒì¼ì—ì„œ Recall ë°ì´í„° ì½ê¸°\n                $recall_data = file($adj_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n                foreach ($recall_data as $line) {\n                    $player_number = trim($line, '\"');\n                    if (isset($player_scores[$player_number])) {\n                        $player_scores[$player_number]['total_recall']++;\n                        $player_scores[$player_number]['dance_scores'][$dance] = \n                            ($player_scores[$player_number]['dance_scores'][$dance] ?? 0) + 1;\n                    }\n                }\n            }\n        }\n    }\n    \n    // ì‹¬ì‚¬ìœ„ì› ìƒíƒœ ì—…ë°ì´íŠ¸\n    foreach ($judge_status as $code => &$status) {\n        if ($status['completed_dances'] === 0) {\n            $status['status'] = 'waiting';\n        } elseif ($status['completed_dances'] < $status['total_dances']) {\n            $status['status'] = 'scoring';\n        } else {\n            $status['status'] = 'completed';\n        }\n    }\n    \n    // ì„ ìˆ˜ë³„ ì ìˆ˜ë¡œ ì •ë ¬\n    uasort($player_scores, function($a, $b) {\n        return $b['total_recall'] - $a['total_recall'];\n    });\n    \n    return [\n        'player_scores' => $player_scores,\n        'judge_status' => $judge_status,\n        'total_judges' => count($judges),\n        'completed_judges' => count(array_filter($judge_status, function($status) {\n            return $status['status'] === 'completed';\n        })),\n        'progress_rate' => round((count(array_filter($judge_status, function($status) {\n            return $status['status'] === 'completed';\n        })) / count($judges)) * 100, 1)\n    ];\n}\n?>\n","size_bytes":11123},"comp/scoring/shared/components.php":{"content":"<?php\n// ê³µí†µ ì»´í¬ë„ŒíŠ¸ë“¤\n\nfunction renderBottomNavigation($comp_id, $lang) {\n    echo '<div class=\"bottom-nav\" style=\"position: fixed; bottom: 0; left: 0; right: 0; background: white; border-top: 1px solid #ddd; padding: 15px; display: flex; justify-content: space-around; z-index: 1000;\">';\n    echo '<button type=\"button\" id=\"dashboardBtn\" class=\"btn btn-primary\">ğŸ  ëŒ€ì‹œë³´ë“œ</button>';\n    echo '<button type=\"button\" id=\"refreshBtn\" class=\"btn btn-success\">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>';\n    echo '</div>';\n}\n?>","size_bytes":526},"comp/scoring/shared/functions.php":{"content":"<?php\n// ê³µí†µ í•¨ìˆ˜ë“¤\n\nfunction h($string) {\n    return htmlspecialchars($string, ENT_QUOTES, 'UTF-8');\n}\n\nfunction renderFixedProgressBar($recall_count, $is_final, $event_no) {\n    if ($is_final) return;\n    \n    echo '<div id=\"fixedProgress\" class=\"fixed-progress\">';\n    echo '<div style=\"display: flex; align-items: center; justify-content: center;\">';\n    echo '<span style=\"margin-right: 10px;\">ğŸ“Š Recall ì§„í–‰: </span>';\n    echo '<span id=\"fixedRecallCount\" style=\"font-size: 24px; font-weight: bold;\">0</span>';\n    echo '<span style=\"margin-left: 5px;\">/ ' . $recall_count . 'ëª…</span>';\n    echo '</div>';\n    echo '</div>';\n}\n?>","size_bytes":648},"comp/scoring/shared/styles.php":{"content":"<?php\n// ê³µí†µ ìŠ¤íƒ€ì¼ë“¤\n?>\n<style>\n/* ê¸°ë³¸ ìŠ¤íƒ€ì¼ */\nbody {\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n    margin: 0;\n    padding: 0;\n    background: #f5f5f5;\n}\n\n.container {\n    max-width: 1200px;\n    margin: 0 auto;\n    background: white;\n    min-height: 100vh;\n}\n\n.header {\n    background: #2c3e50;\n    color: white;\n    padding: 20px;\n    text-align: center;\n}\n\n.event-info {\n    background: #ecf0f1;\n    padding: 20px;\n    border-bottom: 1px solid #bdc3c7;\n}\n\n/* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */\n.btn {\n    padding: 10px 20px;\n    border: none;\n    border-radius: 5px;\n    cursor: pointer;\n    font-size: 16px;\n    font-weight: bold;\n    transition: all 0.3s;\n}\n\n.btn-primary {\n    background: #3498db;\n    color: white;\n}\n\n.btn-primary:hover {\n    background: #2980b9;\n}\n\n.btn-success {\n    background: #27ae60;\n    color: white;\n}\n\n.btn-success:hover {\n    background: #229954;\n}\n\n.btn-danger {\n    background: #e74c3c;\n    color: white;\n}\n\n.btn-danger:hover {\n    background: #c0392b;\n}\n</style>","size_bytes":1041},"comp/scoring/types/formation.php":{"content":"<?php\n/**\n * í¬ë©”ì´ì…˜ ì‹¬ì‚¬ ì‹œìŠ¤í…œ\n * íŒ€ ë‹¨ìœ„, í¬ë©”ì´ì…˜ íŒ¨í„´ í‰ê°€ ì‹œìŠ¤í…œ\n */\n\n// ê³µí†µ íŒŒì¼ë“¤ í¬í•¨\nrequire_once __DIR__ . '/../shared/functions.php';\nrequire_once __DIR__ . '/../shared/styles.php';\nrequire_once __DIR__ . '/../shared/components.php';\n?>\n\n<!-- í¬ë©”ì´ì…˜ ì „ìš© ìŠ¤íƒ€ì¼ -->\n<style>\n    .formation-container {\n        background: #fff;\n        border: 2px solid #e0e0e0;\n        border-radius: 8px;\n        box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n        padding: 20px;\n        margin-top: 10px;\n    }\n    \n    .formation-header {\n        text-align: center;\n        margin-bottom: 20px;\n        padding: 15px;\n        background: linear-gradient(135deg, #FF6B6B, #4ECDC4);\n        color: white;\n        border-radius: 8px;\n    }\n    \n    .formation-header h2 {\n        margin: 0 0 10px 0;\n        font-size: 24px;\n    }\n    \n    .formation-header p {\n        margin: 0;\n        opacity: 0.9;\n        font-size: 14px;\n    }\n    \n    .team-selection {\n        margin-bottom: 20px;\n    }\n    \n    .team-grid {\n        display: grid;\n        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));\n        gap: 15px;\n        margin-bottom: 20px;\n    }\n    \n    .team-card {\n        background: #f8f9fa;\n        border: 2px solid #e9ecef;\n        border-radius: 8px;\n        padding: 15px;\n        text-align: center;\n        cursor: pointer;\n        transition: all 0.3s ease;\n    }\n    \n    .team-card:hover {\n        border-color: #FF6B6B;\n        transform: translateY(-2px);\n        box-shadow: 0 4px 8px rgba(0,0,0,0.1);\n    }\n    \n    .team-card.selected {\n        border-color: #FF6B6B;\n        background: linear-gradient(135deg, #ffe8e8, #f0f8ff);\n        transform: scale(1.05);\n    }\n    \n    .team-number {\n        font-size: 20px;\n        font-weight: bold;\n        color: #333;\n        margin-bottom: 5px;\n    }\n    \n    .team-members {\n        font-size: 12px;\n        color: #666;\n    }\n    \n    .pattern-selection {\n        margin-bottom: 20px;\n    }\n    \n    .pattern-grid {\n        display: grid;\n        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n        gap: 15px;\n        margin-bottom: 20px;\n    }\n    \n    .pattern-card {\n        background: #fff;\n        border: 2px solid #ddd;\n        border-radius: 8px;\n        padding: 15px;\n        text-align: center;\n        cursor: pointer;\n        transition: all 0.3s ease;\n    }\n    \n    .pattern-card:hover {\n        border-color: #4ECDC4;\n        transform: translateY(-2px);\n        box-shadow: 0 4px 8px rgba(0,0,0,0.1);\n    }\n    \n    .pattern-card.selected {\n        border-color: #4ECDC4;\n        background: linear-gradient(135deg, #e8f8f5, #f0f8ff);\n    }\n    \n    .pattern-icon {\n        font-size: 24px;\n        margin-bottom: 10px;\n    }\n    \n    .pattern-name {\n        font-weight: bold;\n        color: #333;\n        margin-bottom: 5px;\n    }\n    \n    .pattern-description {\n        font-size: 12px;\n        color: #666;\n    }\n    \n    .evaluation-section {\n        background: #f8f9fa;\n        border-radius: 8px;\n        padding: 20px;\n        margin-bottom: 20px;\n    }\n    \n    .evaluation-criteria {\n        display: grid;\n        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n        gap: 15px;\n        margin-bottom: 20px;\n    }\n    \n    .criterion-item {\n        background: #fff;\n        border: 1px solid #ddd;\n        border-radius: 6px;\n        padding: 15px;\n        text-align: center;\n    }\n    \n    .criterion-title {\n        font-weight: bold;\n        color: #333;\n        margin-bottom: 10px;\n        font-size: 14px;\n    }\n    \n    .score-input {\n        width: 60px;\n        padding: 8px;\n        border: 2px solid #ddd;\n        border-radius: 4px;\n        text-align: center;\n        font-size: 16px;\n        font-weight: bold;\n    }\n    \n    .score-input:focus {\n        border-color: #4ECDC4;\n        outline: none;\n    }\n    \n    .overall-formation-score {\n        background: linear-gradient(135deg, #4ECDC4, #44A08D);\n        color: white;\n        padding: 20px;\n        border-radius: 8px;\n        text-align: center;\n        margin: 20px 0;\n    }\n    \n    .overall-formation-score h3 {\n        margin: 0 0 10px 0;\n        font-size: 20px;\n    }\n    \n    .overall-formation-score-value {\n        font-size: 36px;\n        font-weight: bold;\n        margin: 10px 0;\n    }\n    \n    .formation-comments {\n        margin-top: 20px;\n    }\n    \n    .formation-comments textarea {\n        width: 100%;\n        min-height: 100px;\n        padding: 15px;\n        border: 2px solid #ddd;\n        border-radius: 8px;\n        font-size: 14px;\n        resize: vertical;\n        font-family: inherit;\n    }\n    \n    .formation-comments textarea:focus {\n        border-color: #4ECDC4;\n        outline: none;\n    }\n    \n    .submit-formation {\n        text-align: center;\n        margin-top: 20px;\n    }\n    \n    .submit-formation-btn {\n        background: linear-gradient(135deg, #FF6B6B, #4ECDC4);\n        color: white;\n        border: none;\n        padding: 15px 30px;\n        font-size: 16px;\n        font-weight: bold;\n        border-radius: 8px;\n        cursor: pointer;\n        transition: all 0.3s ease;\n    }\n    \n    .submit-formation-btn:hover {\n        transform: translateY(-2px);\n        box-shadow: 0 4px 8px rgba(0,0,0,0.2);\n    }\n    \n    .submit-formation-btn:disabled {\n        background: #ccc;\n        cursor: not-allowed;\n        transform: none;\n        box-shadow: none;\n    }\n    \n    /* ëª¨ë°”ì¼ ë°˜ì‘í˜• */\n    @media (max-width: 768px) {\n        .team-grid, .pattern-grid {\n            grid-template-columns: 1fr;\n        }\n        \n        .evaluation-criteria {\n            grid-template-columns: repeat(2, 1fr);\n        }\n    }\n</style>\n\n<!-- í¬ë©”ì´ì…˜ ì‹¬ì‚¬ ì¸í„°í˜ì´ìŠ¤ -->\n<div class=\"formation-container\">\n    <div class=\"formation-header\">\n        <h2>ğŸ­ í¬ë©”ì´ì…˜ ì‹¬ì‚¬</h2>\n        <p>íŒ€ì˜ í¬ë©”ì´ì…˜ íŒ¨í„´ê³¼ ì „ì²´ì ì¸ ì™„ì„±ë„ë¥¼ í‰ê°€í•´ì£¼ì„¸ìš”</p>\n    </div>\n    \n    <!-- íŒ€ ì„ íƒ -->\n    <div class=\"team-selection\">\n        <h3>íŒ€ ì„ íƒ</h3>\n        <div class=\"team-grid\" id=\"teamGrid\">\n            <?php \n            // íŒ€ ë°ì´í„° ìƒì„± (ì‹¤ì œë¡œëŠ” ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë¡œë“œ)\n            $teams = [];\n            for ($i = 1; $i <= 6; $i++) {\n                $teams[] = [\n                    'number' => $i,\n                    'members' => 'íŒ€ì› ' . ($i * 4) . 'ëª…'\n                ];\n            }\n            foreach ($teams as $team): \n            ?>\n                <div class=\"team-card\" data-team=\"<?= $team['number'] ?>\" onclick=\"selectTeam(<?= $team['number'] ?>)\">\n                    <div class=\"team-number\">íŒ€ <?= $team['number'] ?></div>\n                    <div class=\"team-members\"><?= $team['members'] ?></div>\n                </div>\n            <?php endforeach; ?>\n        </div>\n    </div>\n    \n    <!-- í¬ë©”ì´ì…˜ íŒ¨í„´ ì„ íƒ -->\n    <div class=\"pattern-selection\">\n        <h3>í¬ë©”ì´ì…˜ íŒ¨í„´</h3>\n        <div class=\"pattern-grid\" id=\"patternGrid\">\n            <div class=\"pattern-card\" data-pattern=\"line\" onclick=\"selectPattern('line')\">\n                <div class=\"pattern-icon\">ğŸ“</div>\n                <div class=\"pattern-name\">ë¼ì¸ í¬ë©”ì´ì…˜</div>\n                <div class=\"pattern-description\">ì¼ì§ì„  ë°°ì—´</div>\n            </div>\n            \n            <div class=\"pattern-card\" data-pattern=\"circle\" onclick=\"selectPattern('circle')\">\n                <div class=\"pattern-icon\">â­•</div>\n                <div class=\"pattern-name\">ì„œí´ í¬ë©”ì´ì…˜</div>\n                <div class=\"pattern-description\">ì›í˜• ë°°ì—´</div>\n            </div>\n            \n            <div class=\"pattern-card\" data-pattern=\"diamond\" onclick=\"selectPattern('diamond')\">\n                <div class=\"pattern-icon\">ğŸ’</div>\n                <div class=\"pattern-name\">ë‹¤ì´ì•„ëª¬ë“œ</div>\n                <div class=\"pattern-description\">ë§ˆë¦„ëª¨ ë°°ì—´</div>\n            </div>\n            \n            <div class=\"pattern-card\" data-pattern=\"triangle\" onclick=\"selectPattern('triangle')\">\n                <div class=\"pattern-icon\">ğŸ”º</div>\n                <div class=\"pattern-name\">íŠ¸ë¼ì´ì•µê¸€</div>\n                <div class=\"pattern-description\">ì‚¼ê°í˜• ë°°ì—´</div>\n            </div>\n            \n            <div class=\"pattern-card\" data-pattern=\"square\" onclick=\"selectPattern('square')\">\n                <div class=\"pattern-icon\">â¬œ</div>\n                <div class=\"pattern-name\">ìŠ¤í€˜ì–´</div>\n                <div class=\"pattern-description\">ì‚¬ê°í˜• ë°°ì—´</div>\n            </div>\n            \n            <div class=\"pattern-card\" data-pattern=\"free\" onclick=\"selectPattern('free')\">\n                <div class=\"pattern-icon\">ğŸ¨</div>\n                <div class=\"pattern-name\">ììœ  í¬ë©”ì´ì…˜</div>\n                <div class=\"pattern-description\">ì°½ì˜ì  ë°°ì—´</div>\n            </div>\n        </div>\n    </div>\n    \n    <!-- í‰ê°€ ì„¹ì…˜ -->\n    <div class=\"evaluation-section\">\n        <h3>ì„¸ë¶€ í‰ê°€</h3>\n        <div class=\"evaluation-criteria\">\n            <div class=\"criterion-item\">\n                <div class=\"criterion-title\">ì •í™•ì„±</div>\n                <input type=\"number\" class=\"score-input\" id=\"accuracyScore\" min=\"1\" max=\"10\" value=\"5\" onchange=\"updateFormationScore()\">\n                <div style=\"font-size: 12px; color: #666;\">1-10ì </div>\n            </div>\n            \n            <div class=\"criterion-item\">\n                <div class=\"criterion-title\">ë™ê¸°í™”</div>\n                <input type=\"number\" class=\"score-input\" id=\"synchronizationScore\" min=\"1\" max=\"10\" value=\"5\" onchange=\"updateFormationScore()\">\n                <div style=\"font-size: 12px; color: #666;\">1-10ì </div>\n            </div>\n            \n            <div class=\"criterion-item\">\n                <div class=\"criterion-title\">ì°½ì˜ì„±</div>\n                <input type=\"number\" class=\"score-input\" id=\"creativityScore\" min=\"1\" max=\"10\" value=\"5\" onchange=\"updateFormationScore()\">\n                <div style=\"font-size: 12px; color: #666;\">1-10ì </div>\n            </div>\n            \n            <div class=\"criterion-item\">\n                <div class=\"criterion-title\">ì™„ì„±ë„</div>\n                <input type=\"number\" class=\"score-input\" id=\"completionScore\" min=\"1\" max=\"10\" value=\"5\" onchange=\"updateFormationScore()\">\n                <div style=\"font-size: 12px; color: #666;\">1-10ì </div>\n            </div>\n            \n            <div class=\"criterion-item\">\n                <div class=\"criterion-title\">í‘œí˜„ë ¥</div>\n                <input type=\"number\" class=\"score-input\" id=\"expressionScore\" min=\"1\" max=\"10\" value=\"5\" onchange=\"updateFormationScore()\">\n                <div style=\"font-size: 12px; color: #666;\">1-10ì </div>\n            </div>\n            \n            <div class=\"criterion-item\">\n                <div class=\"criterion-title\">ìŒì•…ì„±</div>\n                <input type=\"number\" class=\"score-input\" id=\"musicalityScore\" min=\"1\" max=\"10\" value=\"5\" onchange=\"updateFormationScore()\">\n                <div style=\"font-size: 12px; color: #666;\">1-10ì </div>\n            </div>\n        </div>\n    </div>\n    \n    <!-- ì „ì²´ ì ìˆ˜ -->\n    <div class=\"overall-formation-score\">\n        <h3>ì¢…í•© ì ìˆ˜</h3>\n        <div class=\"overall-formation-score-value\" id=\"overallFormationScore\">30</div>\n        <div style=\"font-size: 14px; opacity: 0.9;\">ì •í™•ì„± + ë™ê¸°í™” + ì°½ì˜ì„± + ì™„ì„±ë„ + í‘œí˜„ë ¥ + ìŒì•…ì„±</div>\n    </div>\n    \n    <!-- ì½”ë©˜íŠ¸ -->\n    <div class=\"formation-comments\">\n        <h3>ì‹¬ì‚¬ ì½”ë©˜íŠ¸</h3>\n        <textarea id=\"formationComments\" placeholder=\"íŒ€ì˜ í¬ë©”ì´ì…˜ íŒ¨í„´, ë™ê¸°í™”, ì°½ì˜ì„± ë“±ì— ëŒ€í•œ í‰ê°€ë¥¼ ììœ ë¡­ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”...\"></textarea>\n    </div>\n    \n    <!-- ì œì¶œ ë²„íŠ¼ -->\n    <div class=\"submit-formation\">\n        <button type=\"button\" class=\"submit-formation-btn\" id=\"submitFormation\" onclick=\"submitFormationScore()\">\n            í¬ë©”ì´ì…˜ ì ìˆ˜ ì œì¶œ\n        </button>\n    </div>\n</div>\n\n<!-- í¬ë©”ì´ì…˜ ì „ìš© JavaScript -->\n<script>\nlet selectedTeam = null;\nlet selectedPattern = null;\nlet currentScores = {\n    accuracy: 5,\n    synchronization: 5,\n    creativity: 5,\n    completion: 5,\n    expression: 5,\n    musicality: 5\n};\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    initializeFormationSystem();\n});\n\nfunction initializeFormationSystem() {\n    updateFormationScore();\n}\n\nfunction selectTeam(teamNumber) {\n    // ì´ì „ ì„ íƒ í•´ì œ\n    document.querySelectorAll('.team-card').forEach(card => {\n        card.classList.remove('selected');\n    });\n    \n    // ìƒˆ ì„ íƒ\n    selectedTeam = teamNumber;\n    const teamCard = document.querySelector(`[data-team=\"${teamNumber}\"]`);\n    if (teamCard) {\n        teamCard.classList.add('selected');\n    }\n    \n    console.log('Selected team:', teamNumber);\n}\n\nfunction selectPattern(pattern) {\n    // ì´ì „ ì„ íƒ í•´ì œ\n    document.querySelectorAll('.pattern-card').forEach(card => {\n        card.classList.remove('selected');\n    });\n    \n    // ìƒˆ ì„ íƒ\n    selectedPattern = pattern;\n    const patternCard = document.querySelector(`[data-pattern=\"${pattern}\"]`);\n    if (patternCard) {\n        patternCard.classList.add('selected');\n    }\n    \n    console.log('Selected pattern:', pattern);\n}\n\nfunction updateFormationScore() {\n    // ì ìˆ˜ ì—…ë°ì´íŠ¸\n    currentScores.accuracy = parseInt(document.getElementById('accuracyScore').value) || 0;\n    currentScores.synchronization = parseInt(document.getElementById('synchronizationScore').value) || 0;\n    currentScores.creativity = parseInt(document.getElementById('creativityScore').value) || 0;\n    currentScores.completion = parseInt(document.getElementById('completionScore').value) || 0;\n    currentScores.expression = parseInt(document.getElementById('expressionScore').value) || 0;\n    currentScores.musicality = parseInt(document.getElementById('musicalityScore').value) || 0;\n    \n    // ì „ì²´ ì ìˆ˜ ê³„ì‚°\n    const total = Object.values(currentScores).reduce((sum, score) => sum + score, 0);\n    \n    document.getElementById('overallFormationScore').textContent = total;\n    \n    // ì ìˆ˜ì— ë”°ë¥¸ ìƒ‰ìƒ ë³€ê²½\n    const overallElement = document.querySelector('.overall-formation-score');\n    if (total >= 50) {\n        overallElement.style.background = 'linear-gradient(135deg, #4ECDC4, #44A08D)';\n    } else if (total >= 35) {\n        overallElement.style.background = 'linear-gradient(135deg, #FF9800, #F57C00)';\n    } else {\n        overallElement.style.background = 'linear-gradient(135deg, #F44336, #D32F2F)';\n    }\n}\n\nfunction submitFormationScore() {\n    if (!selectedTeam) {\n        alert('íŒ€ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');\n        return;\n    }\n    \n    if (!selectedPattern) {\n        alert('í¬ë©”ì´ì…˜ íŒ¨í„´ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');\n        return;\n    }\n    \n    const comments = document.getElementById('formationComments').value.trim();\n    const totalScore = Object.values(currentScores).reduce((sum, score) => sum + score, 0);\n    \n    // ë°ì´í„° ì¤€ë¹„\n    const formationData = {\n        team: selectedTeam,\n        pattern: selectedPattern,\n        scores: currentScores,\n        totalScore: totalScore,\n        comments: comments,\n        timestamp: new Date().toISOString()\n    };\n    \n    // FormData ìƒì„±\n    const formData = new FormData();\n    formData.append('comp_id', '<?= h($comp_id) ?>');\n    formData.append('event_no', '<?= h($event_no) ?>');\n    formData.append('type', 'formation');\n    formData.append('judge_id', '<?= h($judge_id) ?>');\n    formData.append('formation_data', JSON.stringify(formationData));\n    \n    // ì œì¶œ ë²„íŠ¼ ë¹„í™œì„±í™”\n    const submitBtn = document.getElementById('submitFormation');\n    submitBtn.disabled = true;\n    submitBtn.textContent = 'ì œì¶œ ì¤‘...';\n    \n    // ì„œë²„ë¡œ ì „ì†¡\n    fetch('scoring/save_scores.php', {\n        method: 'POST',\n        body: formData\n    })\n    .then(response => response.json())\n    .then(result => {\n        if (result.success) {\n            alert(`íŒ€ ${selectedTeam}ì˜ í¬ë©”ì´ì…˜ ì ìˆ˜ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.\\níŒ¨í„´: ${selectedPattern}\\nì¢…í•© ì ìˆ˜: ${totalScore}ì `);\n            \n            // ë‹¤ìŒ íŒ€ìœ¼ë¡œ ì´ë™í•˜ê±°ë‚˜ ì™„ë£Œ ì²˜ë¦¬\n            moveToNextTeam();\n        } else {\n            alert('ì œì¶œ ì‹¤íŒ¨: ' + (result.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));\n        }\n    })\n    .catch(error => {\n        console.error('Error:', error);\n        alert('ì œì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error);\n    })\n    .finally(() => {\n        submitBtn.disabled = false;\n        submitBtn.textContent = 'í¬ë©”ì´ì…˜ ì ìˆ˜ ì œì¶œ';\n    });\n}\n\nfunction moveToNextTeam() {\n    // í˜„ì¬ ì„ íƒëœ íŒ€ ì¹´ë“œ ìˆ¨ê¸°ê¸°\n    if (selectedTeam) {\n        const teamCard = document.querySelector(`[data-team=\"${selectedTeam}\"]`);\n        if (teamCard) {\n            teamCard.style.display = 'none';\n        }\n    }\n    \n    // ì„ íƒ í•´ì œ\n    selectedTeam = null;\n    selectedPattern = null;\n    document.querySelectorAll('.team-card, .pattern-card').forEach(card => {\n        card.classList.remove('selected');\n    });\n    \n    // ì ìˆ˜ ì´ˆê¸°í™”\n    resetFormationScores();\n    \n    // ì½”ë©˜íŠ¸ ì´ˆê¸°í™”\n    document.getElementById('formationComments').value = '';\n    \n    // ë‚¨ì€ íŒ€ì´ ìˆëŠ”ì§€ í™•ì¸\n    const remainingTeams = document.querySelectorAll('.team-card:not([style*=\"display: none\"])');\n    if (remainingTeams.length === 0) {\n        alert('ëª¨ë“  íŒ€ì˜ í¬ë©”ì´ì…˜ ì‹¬ì‚¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');\n        // ëŒ€ì‹œë³´ë“œë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸\n        setTimeout(() => {\n            window.location.href = 'scoring_dashboard.php?comp_id=<?= h($comp_id) ?>&lang=<?= h($lang) ?>';\n        }, 2000);\n    }\n}\n\nfunction resetFormationScores() {\n    currentScores = {\n        accuracy: 5,\n        synchronization: 5,\n        creativity: 5,\n        completion: 5,\n        expression: 5,\n        musicality: 5\n    };\n    \n    // ì ìˆ˜ ì…ë ¥ ì´ˆê¸°í™”\n    document.getElementById('accuracyScore').value = 5;\n    document.getElementById('synchronizationScore').value = 5;\n    document.getElementById('creativityScore').value = 5;\n    document.getElementById('completionScore').value = 5;\n    document.getElementById('expressionScore').value = 5;\n    document.getElementById('musicalityScore').value = 5;\n    \n    updateFormationScore();\n}\n</script>\n\n\n\n\n\n\n","size_bytes":18435},"comp/scoring/types/formation_simple.php":{"content":"<?php\n/**\n * ê°„ë‹¨í•œ í¬ë©”ì´ì…˜ ì‹¬ì‚¬ í…ŒìŠ¤íŠ¸\n */\n\necho \"<!-- DEBUG: formation_simple.php loaded successfully -->\";\necho \"<div style='background: yellow; padding: 10px; margin: 10px; border: 2px solid red;'>\";\necho \"<h3>DEBUG: formation_simple.php is working!</h3>\";\necho \"<p>Event: \" . htmlspecialchars($event_data['name'] ?? 'No event name') . \"</p>\";\necho \"<p>Players: \" . count($players) . \"</p>\";\necho \"<p>Dances: \" . implode(', ', $event_data['dances'] ?? []) . \"</p>\";\necho \"<p>Scoring Type: \" . htmlspecialchars($scoring_type ?? 'No scoring type') . \"</p>\";\necho \"</div>\";\n\n// ê°„ë‹¨í•œ í¬ë©”ì´ì…˜ ì‹¬ì‚¬ ì‹œìŠ¤í…œ UI\necho \"<div style='background: #f0f0f0; padding: 20px; margin: 10px; border: 2px solid #333;'>\";\necho \"<h2>í¬ë©”ì´ì…˜ ì‹¬ì‚¬ ì‹œìŠ¤í…œ (ê°„ë‹¨ ë²„ì „)</h2>\";\necho \"<p>ì´ë²¤íŠ¸: \" . htmlspecialchars($event_data['name'] ?? 'Unknown') . \"</p>\";\necho \"<p>ì„ ìˆ˜ ìˆ˜: \" . count($players) . \"ëª…</p>\";\necho \"<p>ëŒ„ìŠ¤: \" . implode(', ', $event_data['dances'] ?? []) . \"</p>\";\n\n// ì„ ìˆ˜ ëª©ë¡ í‘œì‹œ\necho \"<h3>ì„ ìˆ˜ ëª©ë¡:</h3>\";\necho \"<ul>\";\nforeach ($players as $player) {\n    echo \"<li>ì„ ìˆ˜ ë²ˆí˜¸: \" . htmlspecialchars($player) . \"</li>\";\n}\necho \"</ul>\";\n\n// í¬ë©”ì´ì…˜ íŠ¹ë³„ ì•ˆë‚´\necho \"<div style='background: #e8f5e8; padding: 15px; margin: 10px; border: 2px solid #4CAF50; border-radius: 5px;'>\";\necho \"<h3>ğŸ‘¥ í¬ë©”ì´ì…˜ ì‹¬ì‚¬ ì•ˆë‚´</h3>\";\necho \"<p>â€¢ í¬ë©”ì´ì…˜ì€ íŒ€ì˜ ì¼ì²´ê°ê³¼ ì¡°í™”ë¥¼ í‰ê°€í•©ë‹ˆë‹¤</p>\";\necho \"<p>â€¢ ì„ ë“¤ì˜ ì •í™•ì„±ê³¼ ë™ê¸°í™”ë¥¼ í‰ê°€í•©ë‹ˆë‹¤</p>\";\necho \"<p>â€¢ ì „ì²´ì ì¸ ì‹œê°ì  íš¨ê³¼ì™€ ì˜ˆìˆ ì„±ì„ í‰ê°€í•©ë‹ˆë‹¤</p>\";\necho \"<p>â€¢ íŒ€ì›Œí¬ì™€ ë¦¬ë”ì‹­ì„ ì¢…í•©ì ìœ¼ë¡œ í‰ê°€í•©ë‹ˆë‹¤</p>\";\necho \"</div>\";\n\necho \"</div>\";\n?>\n\n\n\n\n\n\n","size_bytes":1744},"comp/scoring/types/freestyle.php":{"content":"<?php\n/**\n * í”„ë¦¬ìŠ¤íƒ€ì¼ ì‹¬ì‚¬ ì‹œìŠ¤í…œ\n */\n\necho \"<!-- DEBUG: freestyle.php loaded successfully -->\";\necho \"<div style='background: yellow; padding: 10px; margin: 10px; border: 2px solid red;'>\";\necho \"<h3>DEBUG: freestyle.php is working!</h3>\";\necho \"<p>Event: \" . htmlspecialchars($event_data['name'] ?? 'No event name') . \"</p>\";\necho \"<p>Players: \" . count($players) . \"</p>\";\necho \"<p>Dances: \" . implode(', ', $event_data['dances'] ?? []) . \"</p>\";\necho \"<p>Scoring Type: \" . htmlspecialchars($scoring_type ?? 'No scoring type') . \"</p>\";\necho \"</div>\";\n\n// ê°„ë‹¨í•œ í”„ë¦¬ìŠ¤íƒ€ì¼ ì‹¬ì‚¬ ì‹œìŠ¤í…œ UI\necho \"<div style='background: #f0f0f0; padding: 20px; margin: 10px; border: 2px solid #333;'>\";\necho \"<h2>ğŸ­ í”„ë¦¬ìŠ¤íƒ€ì¼ ì‹¬ì‚¬ ì‹œìŠ¤í…œ</h2>\";\necho \"<p>ì´ë²¤íŠ¸: \" . htmlspecialchars($event_data['name'] ?? 'Unknown') . \"</p>\";\necho \"<p>ì„ ìˆ˜ ìˆ˜: \" . count($players) . \"ëª…</p>\";\necho \"<p>ëŒ„ìŠ¤: \" . implode(', ', $event_data['dances'] ?? []) . \"</p>\";\n\n// ì„ ìˆ˜ ëª©ë¡ í‘œì‹œ\necho \"<h3>ì„ ìˆ˜ ëª©ë¡:</h3>\";\necho \"<ul>\";\nforeach ($players as $player) {\n    echo \"<li>ì„ ìˆ˜ ë²ˆí˜¸: \" . htmlspecialchars($player) . \"</li>\";\n}\necho \"</ul>\";\n\n// í”„ë¦¬ìŠ¤íƒ€ì¼ íŠ¹ë³„ ì•ˆë‚´\necho \"<div style='background: #e8f4fd; padding: 15px; margin: 10px; border: 2px solid #2196F3; border-radius: 5px;'>\";\necho \"<h3>ğŸ­ í”„ë¦¬ìŠ¤íƒ€ì¼ ì‹¬ì‚¬ ì•ˆë‚´</h3>\";\necho \"<p>â€¢ í”„ë¦¬ìŠ¤íƒ€ì¼ì€ ì°½ì˜ì ì´ê³  ììœ ë¡œìš´ í‘œí˜„ì„ í‰ê°€í•©ë‹ˆë‹¤</p>\";\necho \"<p>â€¢ ìŒì•…ì— ë§ì¶° ì¦‰í¥ì ìœ¼ë¡œ ì¶¤ì„ ì¶”ëŠ” ëŠ¥ë ¥ì„ í‰ê°€í•©ë‹ˆë‹¤</p>\";\necho \"<p>â€¢ ê¸°ìˆ ì  ì™„ì„±ë„ì™€ ì˜ˆìˆ ì  í‘œí˜„ë ¥ì„ ì¢…í•©ì ìœ¼ë¡œ í‰ê°€í•©ë‹ˆë‹¤</p>\";\necho \"</div>\";\n\necho \"</div>\";\n?>","size_bytes":1689},"comp/scoring/types/multievent_final.php":{"content":"<?php\n/**\n * ë©€í‹°ì´ë²¤íŠ¸ ê²°ìŠ¹ì „ ì‹¬ì‚¬ ì‹œìŠ¤í…œ\n * í„°ì¹˜ ê¸°ë°˜ ìˆœìœ„ ì‹œìŠ¤í…œ\n */\n\n// ê³µí†µ íŒŒì¼ë“¤ì€ ì´ë¯¸ ë©”ì¸ì—ì„œ í¬í•¨ë¨\n// require_once __DIR__ . '/../shared/functions.php';\n// require_once __DIR__ . '/../shared/styles.php';\n// require_once __DIR__ . '/../shared/components.php';\n\n// ë³€ìˆ˜ë“¤ì´ ë©”ì¸ì—ì„œ ì „ë‹¬ë˜ì–´ì•¼ í•¨\n// $comp_id, $event_no, $event_data, $players, $dance_mapping, $saved_rankings, $is_final\n\n// ë©€í‹° ì´ë²¤íŠ¸ ê°œìˆ˜ ê°ì§€\n$event_count = count($event_data['dances'] ?? []);\n$layout_class = '';\n\n// ì´ë²¤íŠ¸ ê°œìˆ˜ì— ë”°ë¥¸ ë ˆì´ì•„ì›ƒ í´ë˜ìŠ¤ ê²°ì •\nswitch($event_count) {\n    case 2:\n        $layout_class = 'multievent-2';\n        break;\n    case 3:\n        $layout_class = 'multievent-3';\n        break;\n    case 4:\n        $layout_class = 'multievent-4';\n        break;\n    case 5:\n        $layout_class = 'multievent-5';\n        break;\n    case 6:\n        $layout_class = 'multievent-6';\n        break;\n    default:\n        $layout_class = 'multievent-default';\n        break;\n}\n\necho \"<!-- DEBUG: multievent_final.php loaded successfully -->\";\necho \"<div style='background: yellow; padding: 10px; margin: 10px; border: 2px solid red;'>\";\necho \"<h3>DEBUG: multievent_final.php is working!</h3>\";\necho \"<p>Event: \" . htmlspecialchars($event_data['name'] ?? 'No event name') . \"</p>\";\necho \"<p>Players: \" . count($players) . \"</p>\";\necho \"<p>Dances: \" . implode(', ', $event_data['dances'] ?? []) . \"</p>\";\necho \"<p>Event Count: \" . $event_count . \" (Layout: \" . $layout_class . \")</p>\";\necho \"</div>\";\n?>\n\n<!-- ë©€í‹°ì´ë²¤íŠ¸ ê²°ìŠ¹ì „ ì „ìš© ìŠ¤íƒ€ì¼ -->\n<style>\n    /* ë©€í‹° ì´ë²¤íŠ¸ ë ˆì´ì•„ì›ƒ ì»¨í…Œì´ë„ˆ */\n    .multievent-container {\n        display: grid;\n        gap: 10px;\n        margin-top: 10px;\n        background: #fff;\n        border: 2px solid #e0e0e0;\n        border-radius: 8px;\n        box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n        padding: 15px;\n        min-height: 400px;\n    }\n\n    /* 2ê°œ ì´ë²¤íŠ¸: ìƒí•˜ 2ë¶„í•  */\n    .multievent-2 .multievent-container {\n        grid-template-rows: 1fr 1fr;\n        grid-template-columns: 1fr;\n    }\n\n    /* 3ê°œ ì´ë²¤íŠ¸: ìƒë‹¨ 2ê°œ + í•˜ë‹¨ 1ê°œ */\n    .multievent-3 .multievent-container {\n        grid-template-rows: 1fr 1fr;\n        grid-template-columns: 1fr 1fr;\n    }\n    .multievent-3 .multievent-container .event-3 {\n        grid-column: 1 / -1;\n    }\n\n    /* 4ê°œ ì´ë²¤íŠ¸: 2x2 ê·¸ë¦¬ë“œ */\n    .multievent-4 .multievent-container {\n        grid-template-rows: 1fr 1fr;\n        grid-template-columns: 1fr 1fr;\n    }\n\n    /* 5ê°œ ì´ë²¤íŠ¸: 2x2 + í•˜ë‹¨ 1ê°œ */\n    .multievent-5 .multievent-container {\n        grid-template-rows: 1fr 1fr 1fr;\n        grid-template-columns: 1fr 1fr;\n    }\n    .multievent-5 .multievent-container .event-5 {\n        grid-column: 1 / -1;\n    }\n\n    /* 6ê°œ ì´ë²¤íŠ¸: 3x2 ê·¸ë¦¬ë“œ */\n    .multievent-6 .multievent-container {\n        grid-template-rows: 1fr 1fr 1fr;\n        grid-template-columns: 1fr 1fr;\n    }\n\n    /* ê°œë³„ ì´ë²¤íŠ¸ ë¸”ë¡ */\n    .event-block {\n        background: #f8f9fa;\n        border: 2px solid #ddd;\n        border-radius: 8px;\n        padding: 15px;\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        justify-content: center;\n        min-height: 150px;\n        position: relative;\n    }\n\n    .event-block h3 {\n        margin: 0 0 10px 0;\n        color: #333;\n        font-size: 18px;\n        font-weight: bold;\n        text-align: center;\n    }\n\n    .event-block .event-number {\n        position: absolute;\n        top: 10px;\n        left: 10px;\n        background: #007bff;\n        color: white;\n        padding: 5px 10px;\n        border-radius: 15px;\n        font-size: 12px;\n        font-weight: bold;\n    }\n\n    /* Final Round Styles */\n    .final-scoring-container {\n        display: flex;\n        gap: 15px;\n        margin-top: 10px;\n        background: #fff;\n        border: 2px solid #e0e0e0;\n        border-radius: 8px;\n        box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n        padding: 15px;\n    }\n    \n    .players-column, .ranking-column {\n        flex: 1;\n        background: #f8f9fa;\n        border: 1px solid #ddd;\n        border-radius: 6px;\n        padding: 10px;\n    }\n    \n    .players-column h3, .ranking-column h3 {\n        margin: 0 0 15px 0;\n        text-align: center;\n        color: #333;\n        font-size: 16px;\n        font-weight: bold;\n        padding: 8px;\n        background: #e9ecef;\n        border-radius: 4px;\n    }\n    \n    .player-item, .ranking-slot {\n        background: #fff;\n        border: 2px solid #ddd;\n        border-radius: 6px;\n        padding: 8px 12px;\n        margin: 5px 0;\n        cursor: pointer;\n        transition: all 0.3s ease;\n        text-align: center;\n        font-weight: bold;\n        font-size: 16px;\n        height: 60px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        position: relative;\n    }\n    \n    .player-item:hover {\n        border-color: #4CAF50;\n        background: #f1f8e9;\n        transform: translateY(-2px);\n        box-shadow: 0 4px 8px rgba(0,0,0,0.15);\n    }\n    \n    .player-item.selected {\n        border-color: #4CAF50;\n        background: linear-gradient(135deg, #e8f5e8, #c8e6c9);\n        transform: scale(1.05);\n        box-shadow: 0 6px 12px rgba(76, 175, 80, 0.3);\n    }\n    \n    .ranking-slot {\n        background: #f8f9fa;\n        border: 2px dashed #ccc;\n        color: #666;\n        font-style: italic;\n    }\n    \n    .ranking-slot.assigned {\n        background: #fff;\n        border: 2px solid #4CAF50;\n        color: #333;\n        font-style: normal;\n    }\n    \n    .ranking-slot:hover {\n        border-color: #4CAF50;\n        background: #f1f8e9;\n    }\n    \n    .ranking-slot.dragging {\n        opacity: 0.5;\n        transform: rotate(5deg);\n    }\n    \n    .ranking-slot.drag-over {\n        border-color: #ff9800;\n        background: #fff3e0;\n    }\n    \n    /* Rank labels */\n    .ranking-slot::before {\n        content: attr(data-rank) \"ìœ„\";\n        position: absolute;\n        left: -40px;\n        top: 50%;\n        transform: translateY(-50%);\n        font-size: 12px;\n        color: #666;\n        font-weight: bold;\n        white-space: nowrap;\n    }\n    \n    .ranking-column {\n        position: relative;\n    }\n    \n    .ranking-column::before {\n        content: \"\";\n        position: absolute;\n        left: -20px;\n        top: 0;\n        bottom: 0;\n        width: 1px;\n        background: #ddd;\n    }\n    \n    /* Dance Progress Header */\n    .dance-progress-header {\n        background: #f8f9fa;\n        border: 1px solid #ddd;\n        border-radius: 6px;\n        padding: 10px;\n        margin-bottom: 15px;\n        text-align: center;\n    }\n    \n    .dance-progress {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        gap: 10px;\n        margin-bottom: 10px;\n    }\n    \n    .dance-step {\n        padding: 8px 16px;\n        border-radius: 20px;\n        font-size: 14px;\n        font-weight: bold;\n        transition: all 0.3s ease;\n    }\n    \n    .dance-step.completed {\n        background: #4CAF50;\n        color: #fff;\n    }\n    \n    .dance-step.current {\n        background: #2196F3;\n        color: #fff;\n        transform: scale(1.1);\n    }\n    \n    .dance-step.pending {\n        background: #e0e0e0;\n        color: #666;\n    }\n    \n    .current-dance-display {\n        font-size: 18px;\n        font-weight: bold;\n        color: #333;\n        margin-bottom: 5px;\n    }\n    \n    /* Mobile responsive */\n    @media (max-width: 768px) {\n        .final-scoring-container {\n            flex-direction: row;\n            gap: 10px;\n            padding: 10px;\n        }\n        \n        .players-column, .ranking-column {\n            padding: 8px;\n        }\n        \n        .player-item, .ranking-slot {\n            height: 45px;\n            font-size: 14px;\n            padding: 6px 8px;\n            margin: 3px 0;\n        }\n        \n        .ranking-slot::before {\n            left: -35px;\n            font-size: 10px;\n        }\n        \n        .ranking-column::before {\n            left: -15px;\n        }\n        \n        .dance-step {\n            padding: 6px 12px;\n            font-size: 12px;\n        }\n        \n        .current-dance-display {\n            font-size: 16px;\n        }\n    }\n    \n    /* Tablet optimization */\n    @media (min-width: 769px) and (max-width: 1024px) {\n        .final-scoring-container {\n            padding: 12px;\n            gap: 12px;\n        }\n        \n        .players-column, .ranking-column {\n            padding: 8px;\n        }\n        \n        .player-item, .ranking-slot {\n            height: 50px;\n            font-size: 15px;\n            padding: 6px 10px;\n            margin: 4px 0;\n        }\n        \n        .ranking-slot::before {\n            left: -35px;\n            font-size: 11px;\n        }\n        \n        .ranking-column::before {\n            left: -18px;\n        }\n        \n        .dance-step {\n            padding: 7px 14px;\n            font-size: 13px;\n        }\n        \n        .current-dance-display {\n            font-size: 17px;\n        }\n    }\n</style>\n\n<!-- Dance Progress Header -->\n<div class=\"dance-progress-header\">\n    <div class=\"dance-progress\" id=\"danceProgress\">\n        <!-- Dance steps will be populated by JavaScript -->\n    </div>\n    <div class=\"current-dance-display\" id=\"currentDanceDisplay\">\n        í˜„ì¬ ì¢…ëª©: <?= h($event_data['dances'][0] ?? '') ?>\n    </div>\n</div>\n\n<!-- Final Round Touch-based Ranking System -->\n<div class=\"final-scoring-container\">\n    <div class=\"players-column\">\n        <h3>ì„ ìˆ˜ ëª©ë¡</h3>\n        <div id=\"playersList\">\n            <?php foreach ($players as $player_no): ?>\n                <div class=\"player-item\" \n                     data-player=\"<?=h($player_no)?>\" \n                     onclick=\"selectPlayer(<?=h($player_no)?>)\">\n                    <?=h($player_no)?>\n                </div>\n            <?php endforeach; ?>\n        </div>\n    </div>\n    \n    <div class=\"ranking-column\">\n        <h3>ìˆœìœ„</h3>\n        <div id=\"rankingList\">\n            <?php for ($i = 1; $i <= count($players); $i++): ?>\n                <div class=\"ranking-slot\" \n                     data-rank=\"<?=$i?>\" \n                     onclick=\"assignRank(<?=$i?>)\"\n                     onmousedown=\"handleMouseDown(event)\"\n                     onmouseup=\"handleMouseUp(event)\"\n                     ondblclick=\"swapWithNext(this)\"\n                     draggable=\"true\"\n                     ondragstart=\"dragStart(event)\"\n                     ondragover=\"dragOver(event)\"\n                     ondrop=\"drop(event)\"\n                     ondragend=\"dragEnd(event)\">\n                </div>\n            <?php endforeach; ?>\n        </div>\n    </div>\n</div>\n\n<!-- Final Round Navigation -->\n<div style=\"text-align: center; margin-top: 20px;\">\n    <button type=\"button\" id=\"nextFinalDance\" class=\"btn btn-primary\" style=\"display: none;\">\n        ë‹¤ìŒ ëŒ„ìŠ¤\n    </button>\n    <button type=\"button\" id=\"submitFinalDance\" class=\"btn btn-primary\">\n        <?= h($event_data['dances'][0] ?? '') ?> ìˆœìœ„ ì œì¶œ\n    </button>\n    <button type=\"button\" id=\"clearFinalScores\" class=\"btn btn-secondary\">\n        ì´ˆê¸°í™”\n    </button>\n</div>\n\n<!-- ë©€í‹°ì´ë²¤íŠ¸ ê²°ìŠ¹ì „ ì „ìš© JavaScript -->\n<script>\n// Final Round Variables\nlet selectedPlayer = null;\nlet playerRankings = {};\nlet currentDanceIndex = 0;\nlet totalDances = <?= count($event_data['dances']) ?>;\nlet finalDanceNames = <?= json_encode($event_data['dances']) ?>;\nlet finalCompletedDances = new Set();\nlet savedRankings = <?= json_encode($saved_rankings) ?>;\nlet currentJudgeId = '<?= h($_SESSION['scoring_judge_id'] ?? '') ?>';\nlet isDragging = false;\nlet dragStartTime = 0;\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    initializeFinalDanceSystem();\n    initializeTouchSystem();\n    setupFinalDanceNavigation();\n});\n\nfunction initializeFinalDanceSystem() {\n    // Set total dances\n    totalDances = finalDanceNames.length;\n    \n    // Populate dance progress\n    updateFinalDanceProgress();\n    \n    // Show first dance\n    showFinalDance(0);\n}\n\nfunction updateFinalDanceProgress() {\n    const progressContainer = document.getElementById('danceProgress');\n    if (!progressContainer) return;\n    \n    progressContainer.innerHTML = '';\n    \n    finalDanceNames.forEach((dance, index) => {\n        const step = document.createElement('div');\n        step.className = 'dance-step';\n        step.textContent = dance;\n        \n        if (index < currentDanceIndex) {\n            step.classList.add('completed');\n        } else if (index === currentDanceIndex) {\n            step.classList.add('current');\n        } else {\n            step.classList.add('pending');\n        }\n        \n        progressContainer.appendChild(step);\n    });\n}\n\nfunction showFinalDance(danceIndex) {\n    if (danceIndex < 0 || danceIndex >= totalDances) return;\n    \n    currentDanceIndex = danceIndex;\n    const currentDance = finalDanceNames[danceIndex];\n    \n    // Update progress\n    updateFinalDanceProgress();\n    \n    // Update current dance display\n    updateCurrentDanceDisplay();\n    \n    // Clear current scores\n    clearFinalScores();\n    \n    // Update navigation after DOM is ready\n    setTimeout(() => {\n        updateFinalDanceNav();\n    }, 50);\n    \n    // Restore saved rankings for current dance (after clearing)\n    setTimeout(() => {\n        restoreSavedRankings();\n    }, 100);\n}\n\nfunction updateCurrentDanceDisplay() {\n    const display = document.getElementById('currentDanceDisplay');\n    if (display) {\n        const currentDance = finalDanceNames[currentDanceIndex];\n        display.textContent = `í˜„ì¬ ì¢…ëª©: ${currentDance}`;\n    }\n}\n\nfunction setupFinalDanceNavigation() {\n    // Submit button\n    const submitBtn = document.getElementById('submitFinalDance');\n    if (submitBtn) {\n        submitBtn.addEventListener('click', submitFinalDance);\n    }\n    \n    // Next dance button\n    const nextBtn = document.getElementById('nextFinalDance');\n    if (nextBtn) {\n        nextBtn.addEventListener('click', () => {\n            if (currentDanceIndex < totalDances - 1) {\n                showFinalDance(currentDanceIndex + 1);\n            }\n        });\n    }\n}\n\nfunction submitFinalDance() {\n    const currentDance = finalDanceNames[currentDanceIndex];\n    const rankings = Object.entries(playerRankings).map(([player, rank]) => [player, rank]);\n    \n    if (rankings.length === 0) {\n        alert('ìˆœìœ„ë¥¼ ì§€ì •í•´ì£¼ì„¸ìš”.');\n        return;\n    }\n    \n    // Prepare data\n    const adjudicator_marks = {};\n    adjudicator_marks[currentJudgeId] = rankings;\n    \n    const formData = new FormData();\n    formData.append('comp_id', '<?= h($comp_id) ?>');\n    formData.append('event_no', '<?= h($event_no) ?>');\n    formData.append('type', 'final');\n    formData.append('is_final', '1');\n    formData.append('dance', currentDance);\n    formData.append('adjudicator_marks', JSON.stringify(adjudicator_marks));\n    \n    console.log('Sending adjudicator_marks:', adjudicator_marks);\n    \n    // Show loading state\n    const submitBtn = document.getElementById('submitFinalDance');\n    const originalText = submitBtn.textContent;\n    submitBtn.textContent = 'ì „ì†¡ ì¤‘...';\n    submitBtn.disabled = true;\n    \n    fetch('scoring/save_scores.php', {\n        method: 'POST',\n        body: formData\n    })\n    .then(response => response.json())\n    .then(result => {\n        if (result.success) {\n            // Mark this dance as completed\n            finalCompletedDances.add(currentDance);\n            \n            // Update saved rankings\n            savedRankings[currentDance] = rankings;\n            \n            // Show success message\n            alert(`${currentDance} ëŒ„ìŠ¤ ìˆœìœ„ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.`);\n            \n            // Update navigation\n            updateFinalDanceNav();\n            \n            // Check if all dances are completed\n            if (finalCompletedDances.size === totalDances) {\n                alert('ëª¨ë“  ëŒ„ìŠ¤ì˜ ìˆœìœ„ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');\n                // Redirect to dashboard or show completion message\n                setTimeout(() => {\n                    const compId = '<?= h($comp_id) ?>';\n                    const lang = '<?= h($lang) ?>';\n                    window.location.href = `scoring_dashboard.php?comp_id=${compId}&lang=${lang}`;\n                }, 2000);\n            } else {\n                // Move to next dance\n                if (currentDanceIndex < totalDances - 1) {\n                    showFinalDance(currentDanceIndex + 1);\n                }\n            }\n        } else {\n            alert('ì €ì¥ ì‹¤íŒ¨: ' + (result.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));\n        }\n    })\n    .catch(error => {\n        console.error('Error:', error);\n        alert('ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error);\n    })\n    .finally(() => {\n        submitBtn.textContent = originalText;\n        submitBtn.disabled = false;\n    });\n}\n\nfunction updateFinalDanceNav() {\n    const submitBtn = document.getElementById('submitFinalDance');\n    const nextBtn = document.getElementById('nextFinalDance');\n    \n    if (submitBtn) {\n        const currentDance = finalDanceNames[currentDanceIndex];\n        if (currentDanceIndex === totalDances - 1) {\n            submitBtn.textContent = 'ìµœì¢… ì €ì¥';\n        } else {\n            submitBtn.textContent = `${currentDance} ìˆœìœ„ ì œì¶œ`;\n        }\n    }\n    \n    if (nextBtn) {\n        nextBtn.style.display = currentDanceIndex < totalDances - 1 ? 'inline-block' : 'none';\n    }\n}\n\nfunction initializeTouchSystem() {\n    // Clear button\n    const clearBtn = document.getElementById('clearFinalScores');\n    if (clearBtn) {\n        clearBtn.addEventListener('click', clearFinalScoresWithConfirm);\n    }\n}\n\nfunction clearFinalScores() {\n    // Clear player selections\n    selectedPlayer = null;\n    playerRankings = {};\n    \n    // Reset UI\n    document.querySelectorAll('.player-item').forEach(item => {\n        item.classList.remove('selected');\n    });\n    \n    document.querySelectorAll('.ranking-slot').forEach(slot => {\n        slot.classList.remove('assigned');\n        slot.textContent = '';\n        slot.setAttribute('data-player', '');\n    });\n}\n\nfunction clearFinalScoresWithConfirm() {\n    if (confirm('í˜„ì¬ ëŒ„ìŠ¤ì˜ ëª¨ë“  ìˆœìœ„ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {\n        clearFinalScores();\n    }\n}\n\nfunction selectPlayer(playerNo) {\n    if (isDragging) return;\n    \n    selectedPlayer = playerNo;\n    \n    // Update UI\n    document.querySelectorAll('.player-item').forEach(item => {\n        item.classList.remove('selected');\n    });\n    \n    const playerItem = document.querySelector(`[data-player=\"${playerNo}\"]`);\n    if (playerItem) {\n        playerItem.classList.add('selected');\n    }\n}\n\nfunction assignRank(rank) {\n    if (isDragging) return;\n    \n    if (!selectedPlayer) {\n        alert('ë¨¼ì € ì„ ìˆ˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');\n        return;\n    }\n    \n    const rankSlot = document.querySelector(`[data-rank=\"${rank}\"]`);\n    if (!rankSlot) return;\n    \n    // If slot is already occupied, move that player back to players list\n    if (rankSlot.classList.contains('assigned')) {\n        const currentPlayer = rankSlot.getAttribute('data-player');\n        if (currentPlayer) {\n            // Remove from rankings\n            delete playerRankings[currentPlayer];\n            \n            // Update UI\n            const playerItem = document.querySelector(`[data-player=\"${currentPlayer}\"]`);\n            if (playerItem) {\n                playerItem.classList.remove('selected');\n            }\n        }\n    }\n    \n    // Assign new player to rank\n    playerRankings[selectedPlayer] = rank;\n    \n    // Update UI\n    rankSlot.classList.add('assigned');\n    rankSlot.textContent = selectedPlayer;\n    rankSlot.setAttribute('data-player', selectedPlayer);\n    \n    // Remove player from players list\n    const playerItem = document.querySelector(`[data-player=\"${selectedPlayer}\"]`);\n    if (playerItem) {\n        playerItem.style.display = 'none';\n    }\n    \n    // Clear selection\n    selectedPlayer = null;\n}\n\nfunction cancelRank(rank) {\n    const rankSlot = document.querySelector(`[data-rank=\"${rank}\"]`);\n    if (!rankSlot || !rankSlot.classList.contains('assigned')) return;\n    \n    const playerNo = rankSlot.getAttribute('data-player');\n    if (playerNo) {\n        // Remove from rankings\n        delete playerRankings[playerNo];\n        \n        // Update UI\n        rankSlot.classList.remove('assigned');\n        rankSlot.textContent = '';\n        rankSlot.setAttribute('data-player', '');\n        \n        // Show player in players list\n        const playerItem = document.querySelector(`[data-player=\"${playerNo}\"]`);\n        if (playerItem) {\n            playerItem.style.display = 'flex';\n        }\n    }\n}\n\n// Drag and Drop Functions\nfunction handleMouseDown(event) {\n    dragStartTime = Date.now();\n    isDragging = false;\n}\n\nfunction handleMouseUp(event) {\n    const dragDuration = Date.now() - dragStartTime;\n    if (dragDuration < 200) { // Short click, not drag\n        isDragging = false;\n    }\n}\n\nfunction dragStart(event) {\n    isDragging = true;\n    event.dataTransfer.effectAllowed = 'move';\n    event.dataTransfer.setData('text/html', event.target.outerHTML);\n    event.target.classList.add('dragging');\n}\n\nfunction dragOver(event) {\n    event.preventDefault();\n    event.dataTransfer.dropEffect = 'move';\n    event.target.classList.add('drag-over');\n}\n\nfunction drop(event) {\n    event.preventDefault();\n    event.target.classList.remove('drag-over');\n    \n    if (!isDragging) return;\n    \n    const draggedElement = event.target;\n    const draggedPlayer = draggedElement.getAttribute('data-player');\n    \n    if (draggedPlayer) {\n        // This is a ranking slot with a player\n        const targetRank = draggedElement.getAttribute('data-rank');\n        const sourceRank = Object.keys(playerRankings).find(player => playerRankings[player] == targetRank);\n        \n        if (sourceRank) {\n            // Swap the players\n            const tempRank = playerRankings[sourceRank];\n            playerRankings[sourceRank] = playerRankings[draggedPlayer];\n            playerRankings[draggedPlayer] = tempRank;\n            \n            // Update UI\n            updateRankingDisplay();\n        }\n    }\n}\n\nfunction dragEnd(event) {\n    event.target.classList.remove('dragging');\n    isDragging = false;\n}\n\nfunction updateRankingDisplay() {\n    // Clear all ranking slots\n    document.querySelectorAll('.ranking-slot').forEach(slot => {\n        slot.classList.remove('assigned');\n        slot.textContent = '';\n        slot.setAttribute('data-player', '');\n    });\n    \n    // Update with current rankings\n    Object.entries(playerRankings).forEach(([player, rank]) => {\n        const rankSlot = document.querySelector(`[data-rank=\"${rank}\"]`);\n        if (rankSlot) {\n            rankSlot.classList.add('assigned');\n            rankSlot.textContent = player;\n            rankSlot.setAttribute('data-player', player);\n        }\n    });\n}\n\n// Double-click swap function\nfunction swapWithNext(element) {\n    const currentRank = parseInt(element.getAttribute('data-rank'));\n    const nextRank = currentRank + 1;\n    const nextElement = document.querySelector(`[data-rank=\"${nextRank}\"]`);\n    \n    if (!nextElement) return;\n    \n    const currentPlayer = element.getAttribute('data-player');\n    const nextPlayer = nextElement.getAttribute('data-player');\n    \n    if (currentPlayer && nextPlayer) {\n        // Swap players\n        const tempRank = playerRankings[currentPlayer];\n        playerRankings[currentPlayer] = playerRankings[nextPlayer];\n        playerRankings[nextPlayer] = tempRank;\n        \n        // Update UI\n        updateRankingDisplay();\n    }\n}\n\nfunction restoreSavedRankings() {\n    const currentDance = finalDanceNames[currentDanceIndex];\n    \n    console.log('=== RESTORE SAVED RANKINGS DEBUG ===');\n    console.log('Current judge ID:', currentJudgeId);\n    console.log('Current dance:', currentDance);\n    console.log('Current dance index:', currentDanceIndex);\n    console.log('Available saved rankings:', savedRankings);\n    console.log('Final dance names:', finalDanceNames);\n    \n    if (savedRankings[currentDance]) {\n        const rankings = savedRankings[currentDance];\n        console.log('Found saved rankings for dance:', currentDance, rankings);\n        \n        // Restore rankings\n        rankings.forEach(([player, rank]) => {\n            playerRankings[player] = rank;\n            \n            // Update UI\n            const rankSlot = document.querySelector(`[data-rank=\"${rank}\"]`);\n            if (rankSlot) {\n                rankSlot.classList.add('assigned');\n                rankSlot.textContent = player;\n                rankSlot.setAttribute('data-player', player);\n            }\n            \n            // Hide player from players list\n            const playerItem = document.querySelector(`[data-player=\"${player}\"]`);\n            if (playerItem) {\n                playerItem.style.display = 'none';\n            }\n        });\n        \n        console.log('Restored rankings:', playerRankings);\n    } else {\n        console.log('No saved data for dance:', currentDance);\n    }\n}\n</script>\n\n<!-- ë©€í‹° ì´ë²¤íŠ¸ ë™ì  ë ˆì´ì•„ì›ƒ HTML -->\n<div class=\"<?= $layout_class ?>\">\n    <div class=\"multievent-container\">\n        <?php\n        $dances = $event_data['dances'] ?? [];\n        foreach($dances as $index => $dance) {\n            $event_number = $index + 1;\n            $event_class = ($event_count == 3 && $event_number == 3) ? 'event-3' : \n                          (($event_count == 5 && $event_number == 5) ? 'event-5' : '');\n            ?>\n            <div class=\"event-block <?= $event_class ?>\" data-event=\"<?= $event_number ?>\">\n                <div class=\"event-number\">#1-<?= $event_number ?></div>\n                <h3><?= htmlspecialchars($dance) ?></h3>\n                <div class=\"event-content\">\n                    <p>ì´ë²¤íŠ¸ <?= $event_number ?> ë‚´ìš©</p>\n                    <div class=\"scoring-area\">\n                        <!-- ì—¬ê¸°ì— ê° ì´ë²¤íŠ¸ë³„ ì±„ì  UIê°€ ë“¤ì–´ê°‘ë‹ˆë‹¤ -->\n                        <div class=\"players-list\">\n                            <?php foreach($players as $player): ?>\n                                <div class=\"player-item\" data-player=\"<?= htmlspecialchars($player) ?>\">\n                                    <?= htmlspecialchars($player) ?>\n                                </div>\n                            <?php endforeach; ?>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <?php\n        }\n        ?>\n    </div>\n</div>\n","size_bytes":26795},"comp/scoring/types/multievent_final_only.php":{"content":"<?php\n/**\n * ë©€í‹°ì´ë²¤íŠ¸ ê²°ìŠ¹ì „ ì‹œìŠ¤í…œ (ì¤€ê²°ìŠ¹ ì—†ìŒ)\n * ë°”ë¡œ ê²°ìŠ¹ì „ìœ¼ë¡œ ì§„í–‰ë˜ëŠ” ë©€í‹°ì´ë²¤íŠ¸\n */\n\n// ê³µí†µ íŒŒì¼ë“¤ í¬í•¨\nrequire_once __DIR__ . '/../shared/functions.php';\nrequire_once __DIR__ . '/../shared/styles.php';\nrequire_once __DIR__ . '/../shared/components.php';\n?>\n\n<!-- ë©€í‹°ì´ë²¤íŠ¸ ê²°ìŠ¹ì „ ì „ìš© ìŠ¤íƒ€ì¼ -->\n<style>\n    .multievent-final-container {\n        background: #fff;\n        border: 2px solid #e0e0e0;\n        border-radius: 8px;\n        box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n        padding: 20px;\n        margin-top: 10px;\n    }\n    \n    .multievent-header {\n        text-align: center;\n        margin-bottom: 20px;\n        padding: 15px;\n        background: linear-gradient(135deg, #667eea, #764ba2);\n        color: white;\n        border-radius: 8px;\n    }\n    \n    .multievent-header h2 {\n        margin: 0 0 10px 0;\n        font-size: 24px;\n    }\n    \n    .multievent-header p {\n        margin: 0;\n        opacity: 0.9;\n        font-size: 14px;\n    }\n    \n    .dance-progress-header {\n        background: #f8f9fa;\n        border: 1px solid #ddd;\n        border-radius: 6px;\n        padding: 15px;\n        margin-bottom: 20px;\n        text-align: center;\n    }\n    \n    .dance-progress {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        gap: 15px;\n        margin-bottom: 15px;\n        flex-wrap: wrap;\n    }\n    \n    .dance-step {\n        padding: 10px 20px;\n        border-radius: 25px;\n        font-size: 16px;\n        font-weight: bold;\n        transition: all 0.3s ease;\n        cursor: pointer;\n    }\n    \n    .dance-step.completed {\n        background: #4CAF50;\n        color: #fff;\n    }\n    \n    .dance-step.current {\n        background: #2196F3;\n        color: #fff;\n        transform: scale(1.1);\n        box-shadow: 0 4px 8px rgba(33, 150, 243, 0.3);\n    }\n    \n    .dance-step.pending {\n        background: #e0e0e0;\n        color: #666;\n    }\n    \n    .current-dance-display {\n        font-size: 20px;\n        font-weight: bold;\n        color: #333;\n        margin-bottom: 10px;\n    }\n    \n    .scoring-area {\n        display: flex;\n        gap: 20px;\n        margin-top: 20px;\n    }\n    \n    .players-column, .ranking-column {\n        flex: 1;\n        background: #f8f9fa;\n        border: 1px solid #ddd;\n        border-radius: 8px;\n        padding: 15px;\n    }\n    \n    .players-column h3, .ranking-column h3 {\n        margin: 0 0 15px 0;\n        text-align: center;\n        color: #333;\n        font-size: 18px;\n        font-weight: bold;\n        padding: 10px;\n        background: #e9ecef;\n        border-radius: 6px;\n    }\n    \n    .player-item, .ranking-slot {\n        background: #fff;\n        border: 2px solid #ddd;\n        border-radius: 8px;\n        padding: 12px;\n        margin: 8px 0;\n        cursor: pointer;\n        transition: all 0.3s ease;\n        text-align: center;\n        font-weight: bold;\n        font-size: 18px;\n        height: 60px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        position: relative;\n    }\n    \n    .player-item:hover {\n        border-color: #667eea;\n        background: #f1f8e9;\n        transform: translateY(-2px);\n        box-shadow: 0 4px 8px rgba(0,0,0,0.15);\n    }\n    \n    .player-item.selected {\n        border-color: #667eea;\n        background: linear-gradient(135deg, #e8f5e8, #c8e6c9);\n        transform: scale(1.05);\n        box-shadow: 0 6px 12px rgba(102, 126, 234, 0.3);\n    }\n    \n    .ranking-slot {\n        background: #f8f9fa;\n        border: 2px dashed #ccc;\n        color: #666;\n        font-style: italic;\n    }\n    \n    .ranking-slot.assigned {\n        background: #fff;\n        border: 2px solid #667eea;\n        color: #333;\n        font-style: normal;\n    }\n    \n    .ranking-slot:hover {\n        border-color: #667eea;\n        background: #f1f8e9;\n    }\n    \n    .ranking-slot.dragging {\n        opacity: 0.5;\n        transform: rotate(5deg);\n    }\n    \n    .ranking-slot.drag-over {\n        border-color: #ff9800;\n        background: #fff3e0;\n    }\n    \n    /* ìˆœìœ„ ë¼ë²¨ */\n    .ranking-slot::before {\n        content: attr(data-rank) \"ìœ„\";\n        position: absolute;\n        left: -50px;\n        top: 50%;\n        transform: translateY(-50%);\n        font-size: 14px;\n        color: #666;\n        font-weight: bold;\n        white-space: nowrap;\n    }\n    \n    .ranking-column {\n        position: relative;\n    }\n    \n    .ranking-column::before {\n        content: \"\";\n        position: absolute;\n        left: -25px;\n        top: 0;\n        bottom: 0;\n        width: 1px;\n        background: #ddd;\n    }\n    \n    .navigation-buttons {\n        text-align: center;\n        margin-top: 20px;\n        display: flex;\n        justify-content: center;\n        gap: 15px;\n        flex-wrap: wrap;\n    }\n    \n    .nav-btn {\n        padding: 12px 24px;\n        border: none;\n        border-radius: 8px;\n        cursor: pointer;\n        font-size: 16px;\n        font-weight: bold;\n        transition: all 0.3s ease;\n    }\n    \n    .nav-btn-primary {\n        background: linear-gradient(135deg, #667eea, #764ba2);\n        color: white;\n    }\n    \n    .nav-btn-primary:hover {\n        transform: translateY(-2px);\n        box-shadow: 0 4px 8px rgba(0,0,0,0.2);\n    }\n    \n    .nav-btn-secondary {\n        background: #6c757d;\n        color: white;\n    }\n    \n    .nav-btn-secondary:hover {\n        background: #5a6268;\n    }\n    \n    .nav-btn:disabled {\n        background: #ccc;\n        cursor: not-allowed;\n        transform: none;\n        box-shadow: none;\n    }\n    \n    /* ëª¨ë°”ì¼ ë°˜ì‘í˜• */\n    @media (max-width: 768px) {\n        .scoring-area {\n            flex-direction: column;\n            gap: 15px;\n        }\n        \n        .dance-progress {\n            gap: 10px;\n        }\n        \n        .dance-step {\n            padding: 8px 16px;\n            font-size: 14px;\n        }\n        \n        .player-item, .ranking-slot {\n            height: 50px;\n            font-size: 16px;\n            padding: 10px;\n        }\n        \n        .ranking-slot::before {\n            left: -40px;\n            font-size: 12px;\n        }\n        \n        .ranking-column::before {\n            left: -20px;\n        }\n        \n        .navigation-buttons {\n            flex-direction: column;\n            align-items: center;\n        }\n        \n        .nav-btn {\n            width: 100%;\n            max-width: 200px;\n        }\n    }\n</style>\n\n<!-- ë©€í‹°ì´ë²¤íŠ¸ ê²°ìŠ¹ì „ ì¸í„°í˜ì´ìŠ¤ -->\n<div class=\"multievent-final-container\">\n    <div class=\"multievent-header\">\n        <h2>ğŸ† ë©€í‹°ì´ë²¤íŠ¸ ê²°ìŠ¹ì „</h2>\n        <p>ì—¬ëŸ¬ ëŒ„ìŠ¤ì˜ ìˆœìœ„ë¥¼ ì¢…í•©í•˜ì—¬ ìµœì¢… ê²°ê³¼ë¥¼ ê²°ì •í•©ë‹ˆë‹¤</p>\n    </div>\n    \n    <!-- ëŒ„ìŠ¤ ì§„í–‰ ìƒí™© -->\n    <div class=\"dance-progress-header\">\n        <div class=\"dance-progress\" id=\"danceProgress\">\n            <!-- ëŒ„ìŠ¤ ë‹¨ê³„ë“¤ì´ JavaScriptë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->\n        </div>\n        <div class=\"current-dance-display\" id=\"currentDanceDisplay\">\n            í˜„ì¬ ì¢…ëª©: <?= h($event_data['dances'][0] ?? '') ?>\n        </div>\n    </div>\n    \n    <!-- ì±„ì  ì˜ì—­ -->\n    <div class=\"scoring-area\">\n        <div class=\"players-column\">\n            <h3>ì„ ìˆ˜ ëª©ë¡</h3>\n            <div id=\"playersList\">\n                <?php foreach ($players as $player_no): ?>\n                    <div class=\"player-item\" \n                         data-player=\"<?=h($player_no)?>\" \n                         onclick=\"selectPlayer(<?=h($player_no)?>)\">\n                        <?=h($player_no)?>\n                    </div>\n                <?php endforeach; ?>\n            </div>\n        </div>\n        \n        <div class=\"ranking-column\">\n            <h3>ìˆœìœ„</h3>\n            <div id=\"rankingList\">\n                <?php for ($i = 1; $i <= count($players); $i++): ?>\n                    <div class=\"ranking-slot\" \n                         data-rank=\"<?=$i?>\" \n                         onclick=\"assignRank(<?=$i?>)\"\n                         onmousedown=\"handleMouseDown(event)\"\n                         onmouseup=\"handleMouseUp(event)\"\n                         ondblclick=\"swapWithNext(this)\"\n                         draggable=\"true\"\n                         ondragstart=\"dragStart(event)\"\n                         ondragover=\"dragOver(event)\"\n                         ondrop=\"drop(event)\"\n                         ondragend=\"dragEnd(event)\">\n                    </div>\n                <?php endforeach; ?>\n            </div>\n        </div>\n    </div>\n    \n    <!-- ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ -->\n    <div class=\"navigation-buttons\">\n        <button type=\"button\" id=\"nextDance\" class=\"nav-btn nav-btn-primary\" style=\"display: none;\">\n            ë‹¤ìŒ ëŒ„ìŠ¤\n        </button>\n        <button type=\"button\" id=\"submitDance\" class=\"nav-btn nav-btn-primary\">\n            <?= h($event_data['dances'][0] ?? '') ?> ìˆœìœ„ ì œì¶œ\n        </button>\n        <button type=\"button\" id=\"clearScores\" class=\"nav-btn nav-btn-secondary\">\n            ì´ˆê¸°í™”\n        </button>\n    </div>\n</div>\n\n<!-- ë©€í‹°ì´ë²¤íŠ¸ ê²°ìŠ¹ì „ ì „ìš© JavaScript -->\n<script>\n// ë©€í‹°ì´ë²¤íŠ¸ ê²°ìŠ¹ì „ ë³€ìˆ˜ë“¤\nlet selectedPlayer = null;\nlet playerRankings = {};\nlet currentDanceIndex = 0;\nlet totalDances = <?= count($event_data['dances']) ?>;\nlet danceNames = <?= json_encode($event_data['dances']) ?>;\nlet completedDances = new Set();\nlet savedRankings = <?= json_encode($saved_rankings ?? []) ?>;\nlet currentJudgeId = '<?= h($judge_id) ?>';\nlet isDragging = false;\nlet dragStartTime = 0;\nlet draggedSlot = null;\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    initializeMultieventFinalSystem();\n    setupDragAndDrop();\n});\n\nfunction initializeMultieventFinalSystem() {\n    // ëŒ„ìŠ¤ ì§„í–‰ ìƒí™© ì—…ë°ì´íŠ¸\n    updateDanceProgress();\n    \n    // ì²« ë²ˆì§¸ ëŒ„ìŠ¤ í‘œì‹œ\n    showDance(0);\n    \n    // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •\n    setupEventListeners();\n}\n\nfunction updateDanceProgress() {\n    const progressContainer = document.getElementById('danceProgress');\n    if (!progressContainer) return;\n    \n    progressContainer.innerHTML = '';\n    \n    danceNames.forEach((dance, index) => {\n        const step = document.createElement('div');\n        step.className = 'dance-step';\n        step.textContent = dance;\n        \n        if (index < currentDanceIndex) {\n            step.classList.add('completed');\n        } else if (index === currentDanceIndex) {\n            step.classList.add('current');\n        } else {\n            step.classList.add('pending');\n        }\n        \n        // í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€\n        step.addEventListener('click', () => {\n            if (index <= currentDanceIndex || completedDances.has(dance)) {\n                showDance(index);\n            }\n        });\n        \n        progressContainer.appendChild(step);\n    });\n}\n\nfunction showDance(danceIndex) {\n    if (danceIndex < 0 || danceIndex >= totalDances) return;\n    \n    currentDanceIndex = danceIndex;\n    const currentDance = danceNames[danceIndex];\n    \n    // ì§„í–‰ ìƒí™© ì—…ë°ì´íŠ¸\n    updateDanceProgress();\n    \n    // í˜„ì¬ ëŒ„ìŠ¤ í‘œì‹œ ì—…ë°ì´íŠ¸\n    updateCurrentDanceDisplay();\n    \n    // ì ìˆ˜ ì´ˆê¸°í™”\n    clearScores();\n    \n    // ì €ì¥ëœ ìˆœìœ„ ë³µì›\n    setTimeout(() => {\n        restoreSavedRankings();\n    }, 100);\n    \n    // ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ì—…ë°ì´íŠ¸\n    updateNavigationButtons();\n}\n\nfunction updateCurrentDanceDisplay() {\n    const display = document.getElementById('currentDanceDisplay');\n    if (display) {\n        const currentDance = danceNames[currentDanceIndex];\n        display.textContent = `í˜„ì¬ ì¢…ëª©: ${currentDance}`;\n    }\n}\n\nfunction setupEventListeners() {\n    // ë‹¤ìŒ ëŒ„ìŠ¤ ë²„íŠ¼\n    document.getElementById('nextDance').addEventListener('click', () => {\n        if (currentDanceIndex < totalDances - 1) {\n            showDance(currentDanceIndex + 1);\n        }\n    });\n    \n    // ëŒ„ìŠ¤ ì œì¶œ ë²„íŠ¼\n    document.getElementById('submitDance').addEventListener('click', submitDance);\n    \n    // ì´ˆê¸°í™” ë²„íŠ¼\n    document.getElementById('clearScores').addEventListener('click', clearScoresWithConfirm);\n}\n\nfunction setupDragAndDrop() {\n    document.querySelectorAll('.ranking-slot').forEach(slot => {\n        slot.addEventListener('dragstart', dragStart);\n        slot.addEventListener('dragover', dragOver);\n        slot.addEventListener('drop', drop);\n        slot.addEventListener('dragend', dragEnd);\n        slot.addEventListener('mousedown', handleMouseDown);\n        slot.addEventListener('mouseup', handleMouseUp);\n    });\n}\n\nfunction selectPlayer(playerNo) {\n    if (isDragging) return;\n    \n    selectedPlayer = playerNo;\n    \n    // UI ì—…ë°ì´íŠ¸\n    document.querySelectorAll('.player-item').forEach(item => {\n        item.classList.remove('selected');\n    });\n    \n    const playerItem = document.querySelector(`[data-player=\"${playerNo}\"]`);\n    if (playerItem) {\n        playerItem.classList.add('selected');\n    }\n}\n\nfunction assignRank(rank) {\n    if (isDragging) return;\n    \n    if (!selectedPlayer) {\n        alert('ë¨¼ì € ì„ ìˆ˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');\n        return;\n    }\n    \n    const rankSlot = document.querySelector(`[data-rank=\"${rank}\"]`);\n    if (!rankSlot) return;\n    \n    // ê¸°ì¡´ í• ë‹¹ì´ ìˆë‹¤ë©´ í•´ì œ\n    if (rankSlot.classList.contains('assigned')) {\n        const currentPlayer = rankSlot.getAttribute('data-player');\n        if (currentPlayer) {\n            delete playerRankings[currentPlayer];\n            const playerItem = document.querySelector(`[data-player=\"${currentPlayer}\"]`);\n            if (playerItem) {\n                playerItem.classList.remove('selected');\n            }\n        }\n    }\n    \n    // ìƒˆ ì„ ìˆ˜ í• ë‹¹\n    playerRankings[selectedPlayer] = rank;\n    \n    // UI ì—…ë°ì´íŠ¸\n    rankSlot.classList.add('assigned');\n    rankSlot.textContent = selectedPlayer;\n    rankSlot.setAttribute('data-player', selectedPlayer);\n    \n    // ì„ ìˆ˜ ëª©ë¡ì—ì„œ ìˆ¨ê¸°ê¸°\n    const playerItem = document.querySelector(`[data-player=\"${selectedPlayer}\"]`);\n    if (playerItem) {\n        playerItem.style.display = 'none';\n    }\n    \n    // ì„ íƒ í•´ì œ\n    selectedPlayer = null;\n}\n\nfunction clearScores() {\n    selectedPlayer = null;\n    playerRankings = {};\n    \n    // UI ì´ˆê¸°í™”\n    document.querySelectorAll('.player-item').forEach(item => {\n        item.classList.remove('selected');\n        item.style.display = 'flex';\n    });\n    \n    document.querySelectorAll('.ranking-slot').forEach(slot => {\n        slot.classList.remove('assigned');\n        slot.textContent = '';\n        slot.setAttribute('data-player', '');\n    });\n}\n\nfunction clearScoresWithConfirm() {\n    if (confirm('í˜„ì¬ ëŒ„ìŠ¤ì˜ ëª¨ë“  ìˆœìœ„ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {\n        clearScores();\n    }\n}\n\nfunction restoreSavedRankings() {\n    const currentDance = danceNames[currentDanceIndex];\n    \n    if (savedRankings[currentDance]) {\n        const rankings = savedRankings[currentDance];\n        \n        rankings.forEach(([player, rank]) => {\n            playerRankings[player] = rank;\n            \n            const rankSlot = document.querySelector(`[data-rank=\"${rank}\"]`);\n            if (rankSlot) {\n                rankSlot.classList.add('assigned');\n                rankSlot.textContent = player;\n                rankSlot.setAttribute('data-player', player);\n            }\n            \n            const playerItem = document.querySelector(`[data-player=\"${player}\"]`);\n            if (playerItem) {\n                playerItem.style.display = 'none';\n            }\n        });\n    }\n}\n\nfunction submitDance() {\n    const currentDance = danceNames[currentDanceIndex];\n    const rankings = Object.entries(playerRankings).map(([player, rank]) => [player, rank]);\n    \n    if (rankings.length === 0) {\n        alert('ìˆœìœ„ë¥¼ ì§€ì •í•´ì£¼ì„¸ìš”.');\n        return;\n    }\n    \n    // ë°ì´í„° ì¤€ë¹„\n    const adjudicator_marks = {};\n    adjudicator_marks[currentJudgeId] = rankings;\n    \n    const formData = new FormData();\n    formData.append('comp_id', '<?= h($comp_id) ?>');\n    formData.append('event_no', '<?= h($event_no) ?>');\n    formData.append('type', 'final');\n    formData.append('is_final', '1');\n    formData.append('dance', currentDance);\n    formData.append('adjudicator_marks', JSON.stringify(adjudicator_marks));\n    \n    // ì œì¶œ ë²„íŠ¼ ë¹„í™œì„±í™”\n    const submitBtn = document.getElementById('submitDance');\n    const originalText = submitBtn.textContent;\n    submitBtn.textContent = 'ì „ì†¡ ì¤‘...';\n    submitBtn.disabled = true;\n    \n    // ì„œë²„ë¡œ ì „ì†¡\n    fetch('scoring/save_scores.php', {\n        method: 'POST',\n        body: formData\n    })\n    .then(response => response.json())\n    .then(result => {\n        if (result.success) {\n            // ì™„ë£Œëœ ëŒ„ìŠ¤ë¡œ í‘œì‹œ\n            completedDances.add(currentDance);\n            \n            // ì €ì¥ëœ ìˆœìœ„ ì—…ë°ì´íŠ¸\n            savedRankings[currentDance] = rankings;\n            \n            alert(`${currentDance} ëŒ„ìŠ¤ ìˆœìœ„ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.`);\n            \n            // ë„¤ë¹„ê²Œì´ì…˜ ì—…ë°ì´íŠ¸\n            updateNavigationButtons();\n            \n            // ë‹¤ìŒ ëŒ„ìŠ¤ë¡œ ì´ë™\n            if (currentDanceIndex < totalDances - 1) {\n                showDance(currentDanceIndex + 1);\n            } else {\n                alert('ëª¨ë“  ëŒ„ìŠ¤ì˜ ìˆœìœ„ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');\n            }\n        } else {\n            alert('ì €ì¥ ì‹¤íŒ¨: ' + (result.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));\n        }\n    })\n    .catch(error => {\n        console.error('Error:', error);\n        alert('ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error);\n    })\n    .finally(() => {\n        submitBtn.textContent = originalText;\n        submitBtn.disabled = false;\n    });\n}\n\nfunction updateNavigationButtons() {\n    const nextBtn = document.getElementById('nextDance');\n    const submitBtn = document.getElementById('submitDance');\n    \n    // ë‹¤ìŒ ëŒ„ìŠ¤ ë²„íŠ¼ í‘œì‹œ/ìˆ¨ê¹€\n    if (currentDanceIndex < totalDances - 1) {\n        nextBtn.style.display = 'inline-block';\n    } else {\n        nextBtn.style.display = 'none';\n    }\n    \n    // ì œì¶œ ë²„íŠ¼ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸\n    const currentDance = danceNames[currentDanceIndex];\n    if (currentDanceIndex === totalDances - 1) {\n        submitBtn.textContent = 'ìµœì¢… ì €ì¥';\n    } else {\n        submitBtn.textContent = `${currentDance} ìˆœìœ„ ì œì¶œ`;\n    }\n}\n\n// ë“œë˜ê·¸ ì•¤ ë“œë¡­ í•¨ìˆ˜ë“¤\nfunction handleMouseDown(event) {\n    dragStartTime = Date.now();\n    isDragging = false;\n}\n\nfunction handleMouseUp(event) {\n    const dragDuration = Date.now() - dragStartTime;\n    if (dragDuration < 200) {\n        isDragging = false;\n    }\n}\n\nfunction dragStart(event) {\n    isDragging = true;\n    draggedSlot = event.target;\n    draggedSlot.classList.add('dragging');\n    event.dataTransfer.effectAllowed = 'move';\n    event.dataTransfer.setData('text/html', draggedSlot.outerHTML);\n}\n\nfunction dragOver(event) {\n    event.preventDefault();\n    event.dataTransfer.dropEffect = 'move';\n    \n    if (event.target.classList.contains('ranking-slot')) {\n        event.target.classList.add('drag-over');\n    }\n}\n\nfunction drop(event) {\n    event.preventDefault();\n    \n    document.querySelectorAll('.ranking-slot').forEach(slot => {\n        slot.classList.remove('drag-over');\n    });\n    \n    if (event.target.classList.contains('ranking-slot') && draggedSlot !== event.target) {\n        swapRankings(draggedSlot, event.target);\n    }\n}\n\nfunction dragEnd(event) {\n    document.querySelectorAll('.ranking-slot').forEach(slot => {\n        slot.classList.remove('dragging', 'drag-over');\n    });\n    draggedSlot = null;\n    isDragging = false;\n}\n\nfunction swapRankings(slot1, slot2) {\n    const player1 = slot1.getAttribute('data-player');\n    const player2 = slot2.getAttribute('data-player');\n    const rank1 = slot1.dataset.rank;\n    const rank2 = slot2.dataset.rank;\n    \n    // UI ì—…ë°ì´íŠ¸\n    slot1.textContent = player2 || '';\n    slot2.textContent = player1 || '';\n    slot1.setAttribute('data-player', player2 || '');\n    slot2.setAttribute('data-player', player1 || '');\n    \n    // í´ë˜ìŠ¤ ì—…ë°ì´íŠ¸\n    slot1.classList.toggle('assigned', !!player2);\n    slot2.classList.toggle('assigned', !!player1);\n    \n    // ë°ì´í„° ì—…ë°ì´íŠ¸\n    if (player1) {\n        playerRankings[player1] = rank2;\n    } else {\n        delete playerRankings[player1];\n    }\n    \n    if (player2) {\n        playerRankings[player2] = rank1;\n    } else {\n        delete playerRankings[player2];\n    }\n}\n\nfunction swapWithNext(element) {\n    const currentRank = parseInt(element.dataset.rank);\n    const nextRank = currentRank + 1;\n    const nextElement = document.querySelector(`[data-rank=\"${nextRank}\"]`);\n    \n    if (nextElement) {\n        swapRankings(element, nextElement);\n    }\n}\n</script>\n\n\n\n\n\n\n","size_bytes":20897},"comp/scoring/types/multievent_final_only_simple.php":{"content":"<?php\n/**\n * ê°„ë‹¨í•œ ë©€í‹°ì´ë²¤íŠ¸ ê²°ìŠ¹ì „(ì¤€ê²°ìŠ¹ ì—†ìŒ) ì‹¬ì‚¬ í…ŒìŠ¤íŠ¸\n */\n\necho \"<!-- DEBUG: multievent_final_only_simple.php loaded successfully -->\";\necho \"<div style='background: yellow; padding: 10px; margin: 10px; border: 2px solid red;'>\";\necho \"<h3>DEBUG: multievent_final_only_simple.php is working!</h3>\";\necho \"<p>Event: \" . htmlspecialchars($event_data['name'] ?? 'No event name') . \"</p>\";\necho \"<p>Players: \" . count($players) . \"</p>\";\necho \"<p>Dances: \" . implode(', ', $event_data['dances'] ?? []) . \"</p>\";\necho \"<p>Scoring Type: \" . htmlspecialchars($scoring_type ?? 'No scoring type') . \"</p>\";\necho \"</div>\";\n\n// ê°„ë‹¨í•œ ë©€í‹°ì´ë²¤íŠ¸ ê²°ìŠ¹ì „ ì‹¬ì‚¬ ì‹œìŠ¤í…œ UI\necho \"<div style='background: #f0f0f0; padding: 20px; margin: 10px; border: 2px solid #333;'>\";\necho \"<h2>ë©€í‹°ì´ë²¤íŠ¸ ê²°ìŠ¹ì „ ì‹¬ì‚¬ ì‹œìŠ¤í…œ (ê°„ë‹¨ ë²„ì „)</h2>\";\necho \"<p>ì´ë²¤íŠ¸: \" . htmlspecialchars($event_data['name'] ?? 'Unknown') . \"</p>\";\necho \"<p>ì„ ìˆ˜ ìˆ˜: \" . count($players) . \"ëª…</p>\";\necho \"<p>ëŒ„ìŠ¤: \" . implode(', ', $event_data['dances'] ?? []) . \"</p>\";\n\n// ì„ ìˆ˜ ëª©ë¡ í‘œì‹œ\necho \"<h3>ì„ ìˆ˜ ëª©ë¡:</h3>\";\necho \"<ul>\";\nforeach ($players as $player) {\n    echo \"<li>ì„ ìˆ˜ ë²ˆí˜¸: \" . htmlspecialchars($player) . \"</li>\";\n}\necho \"</ul>\";\n\n// ë©€í‹°ì´ë²¤íŠ¸ ê²°ìŠ¹ì „ íŠ¹ë³„ ì•ˆë‚´\necho \"<div style='background: #fff3e0; padding: 15px; margin: 10px; border: 2px solid #FF9800; border-radius: 5px;'>\";\necho \"<h3>ğŸ† ë©€í‹°ì´ë²¤íŠ¸ ê²°ìŠ¹ì „ ì•ˆë‚´</h3>\";\necho \"<p>â€¢ ì¤€ê²°ìŠ¹ ì—†ì´ ë°”ë¡œ ê²°ìŠ¹ì „ìœ¼ë¡œ ì§„í–‰ë©ë‹ˆë‹¤</p>\";\necho \"<p>â€¢ ëª¨ë“  ëŒ„ìŠ¤ë¥¼ í•œ ë²ˆì— í‰ê°€í•©ë‹ˆë‹¤</p>\";\necho \"<p>â€¢ ì¢…í•©ì ì¸ ì‹¤ë ¥ê³¼ ì¼ê´€ì„±ì„ í‰ê°€í•©ë‹ˆë‹¤</p>\";\necho \"<p>â€¢ ìµœì¢… ìˆœìœ„ë¥¼ ì§ì ‘ ê²°ì •í•©ë‹ˆë‹¤</p>\";\necho \"</div>\";\n\necho \"</div>\";\n?>\n\n\n\n\n\n\n","size_bytes":1802},"comp/scoring/types/multievent_final_simple.php":{"content":"<?php\n/**\n * ê°„ë‹¨í•œ ë©€í‹°ì´ë²¤íŠ¸ ê²°ìŠ¹ì „ í…ŒìŠ¤íŠ¸\n */\n\necho \"<!-- DEBUG: multievent_final_simple.php loaded successfully -->\";\necho \"<div style='background: yellow; padding: 10px; margin: 10px; border: 2px solid red;'>\";\necho \"<h3>DEBUG: multievent_final_simple.php is working!</h3>\";\necho \"<p>Event: \" . htmlspecialchars($event_data['name'] ?? 'No event name') . \"</p>\";\necho \"<p>Players: \" . count($players) . \"</p>\";\necho \"<p>Dances: \" . implode(', ', $event_data['dances'] ?? []) . \"</p>\";\necho \"<p>Scoring Type: \" . htmlspecialchars($scoring_type ?? 'No scoring type') . \"</p>\";\necho \"</div>\";\n\n// ê°„ë‹¨í•œ ì‹¬ì‚¬ ì‹œìŠ¤í…œ UI\necho \"<div style='background: #f0f0f0; padding: 20px; margin: 10px; border: 2px solid #333;'>\";\necho \"<h2>ì‹¬ì‚¬ ì‹œìŠ¤í…œ (ê°„ë‹¨ ë²„ì „)</h2>\";\necho \"<p>ì´ë²¤íŠ¸: \" . htmlspecialchars($event_data['name'] ?? 'Unknown') . \"</p>\";\necho \"<p>ì„ ìˆ˜ ìˆ˜: \" . count($players) . \"ëª…</p>\";\necho \"<p>ëŒ„ìŠ¤: \" . implode(', ', $event_data['dances'] ?? []) . \"</p>\";\n\n// ì„ ìˆ˜ ëª©ë¡ í‘œì‹œ\necho \"<h3>ì„ ìˆ˜ ëª©ë¡:</h3>\";\necho \"<ul>\";\nforeach ($players as $player) {\n    echo \"<li>ì„ ìˆ˜ ë²ˆí˜¸: \" . htmlspecialchars($player) . \"</li>\";\n}\necho \"</ul>\";\n\necho \"</div>\";\n?>\n\n\n\n\n\n\n","size_bytes":1214},"comp/scoring/types/multievent_preliminary.php":{"content":"<?php\n/**\n * ë©€í‹°ì´ë²¤íŠ¸ ì˜ˆì„ /ì¤€ê²°ìŠ¹ ì‹¬ì‚¬ ì‹œìŠ¤í…œ\n * Instagram ìŠ¤íƒ€ì¼ ëŒ„ìŠ¤ë³„ ì±„ì  ì‹œìŠ¤í…œ\n */\n\n// ê³µí†µ íŒŒì¼ë“¤ í¬í•¨\nrequire_once __DIR__ . '/../shared/functions.php';\nrequire_once __DIR__ . '/../shared/styles.php';\nrequire_once __DIR__ . '/../shared/components.php';\n\n// ë³€ìˆ˜ë“¤ì´ ë©”ì¸ì—ì„œ ì „ë‹¬ë˜ì–´ì•¼ í•¨\n// $comp_id, $event_no, $event_data, $players, $dance_mapping, $recall_count, $hits_data, $existing_selections, $saved_scores\n\n// ë³€ìˆ˜ í™•ì¸ ë° ê¸°ë³¸ê°’ ì„¤ì •\n$recall_count = $recall_count ?? 0;\n$hits_data = $hits_data ?? null;\n$existing_selections = $existing_selections ?? [];\n$dance_mapping = $dance_mapping ?? [];\n?>\n\n<!-- ë©€í‹°ì´ë²¤íŠ¸ ì˜ˆì„ /ì¤€ê²°ìŠ¹ ì „ìš© ìŠ¤íƒ€ì¼ -->\n<style>\n    /* Instagram Style Dance Container */\n    .dance-container { \n        position: relative; \n        overflow: hidden; \n    }\n    \n    .dance-progress {\n        display: flex;\n        align-items: center;\n        margin-bottom: 20px;\n        padding: 0 20px;\n    }\n    \n    .progress-bar {\n        flex: 1;\n        height: 6px;\n        background: #e0e0e0;\n        border-radius: 3px;\n        margin-right: 15px;\n        overflow: hidden;\n    }\n    \n    .progress-fill {\n        height: 100%;\n        background: linear-gradient(90deg, #4CAF50, #2e7d32);\n        border-radius: 3px;\n        transition: width 0.3s ease;\n    }\n    \n    .progress-text {\n        font-size: 14px;\n        font-weight: bold;\n        color: #666;\n        white-space: nowrap;\n    }\n    \n    .dance-slider {\n        display: flex;\n        transition: transform 0.3s ease;\n    }\n    \n    .dance-page {\n        min-width: 100%;\n        padding: 0 20px;\n        box-sizing: border-box;\n    }\n    \n    .dance-header { \n        background:#4CAF50; \n        color:#fff; \n        padding:10px; \n        border-radius:6px; \n        margin-bottom:15px; \n        text-align:center;\n    }\n    \n    .dance-header h3 { \n        margin:0 0 5px 0; \n        font-size:16px;\n    }\n    \n    .dance-header p { \n        margin:0; \n        font-size:12px; \n        opacity:0.9;\n    }\n    \n    /* Heat section styles */\n    .heat-section { \n        margin-bottom:15px; \n        padding:10px; \n        background:#fff; \n        border-radius:6px; \n        border:1px solid #ddd;\n    }\n    \n    .heat-section h4 { \n        margin:0 0 10px 0; \n        color:#333; \n        font-size:14px; \n        text-align:center;\n    }\n    \n    /* Players grid styles - Mobile optimized */\n    .players-grid { \n        display:grid; \n        grid-template-columns:repeat(auto-fill, minmax(60px, 1fr)); \n        gap:4px; \n        margin-bottom:15px;\n    }\n    \n    .player-card { \n        background:#fff; \n        border:2px solid #ddd; \n        border-radius:6px; \n        padding:6px 2px; \n        text-align:center; \n        cursor:pointer; \n        transition:all 0.3s ease;\n        position:relative;\n        min-height:50px;\n        display:flex;\n        flex-direction:column;\n        justify-content:center;\n        align-items:center;\n        user-select: none;\n        -webkit-user-select: none;\n        -moz-user-select: none;\n        -ms-user-select: none;\n    }\n    \n    .player-card:hover { \n        border-color:#4CAF50; \n        transform:translateY(-2px); \n        box-shadow:0 4px 8px rgba(0,0,0,0.15);\n    }\n    \n    .player-card.selected { \n        border-color:#4CAF50; \n        background:linear-gradient(135deg, #e8f5e8, #c8e6c9);\n        transform:scale(1.05);\n        box-shadow:0 6px 12px rgba(76, 175, 80, 0.3);\n    }\n    \n    .player-number { \n        font-size:24px; \n        font-weight:900; \n        color:#333;\n        margin:0;\n        line-height:1;\n    }\n    \n    .player-card.selected .player-number {\n        color:#2e7d32;\n    }\n    \n    .recall-checkbox { \n        display:none; /* Hide checkbox, use card click instead */\n    }\n    \n    /* Recall status - Large and clear */\n    .recall-status { \n        text-align:center; \n        padding:15px; \n        background:#f0f0f0; \n        border-radius:8px; \n        font-weight:bold; \n        color:#333;\n        font-size:16px;\n        margin:15px 0;\n        border:2px solid #ddd;\n    }\n    \n    .recall-status.complete { \n        background:linear-gradient(135deg, #d4edda, #c3e6cb); \n        color:#155724; \n        border:3px solid #28a745;\n        animation:pulse 2s infinite;\n    }\n    \n    .recall-status.over { \n        background:linear-gradient(135deg, #f8d7da, #f5c6cb); \n        color:#721c24; \n        border:3px solid #dc3545;\n    }\n    \n    .recall-status .selected-count {\n        font-size:24px;\n        font-weight:900;\n    }\n    \n    @keyframes pulse {\n        0% { transform: scale(1); }\n        50% { transform: scale(1.02); }\n        100% { transform: scale(1); }\n    }\n    \n    /* Fixed Progress Bar for Mobile */\n    .fixed-progress {\n        position: fixed;\n        top: 0;\n        left: 0;\n        right: 0;\n        background: linear-gradient(135deg, #ff9800, #ff5722);\n        color: white;\n        padding: 12px 20px;\n        text-align: center;\n        font-size: 18px;\n        font-weight: bold;\n        z-index: 1000;\n        box-shadow: 0 2px 10px rgba(0,0,0,0.3);\n        transform: translateY(-100%);\n        transition: transform 0.3s ease;\n    }\n    \n    .fixed-progress.show {\n        transform: translateY(0);\n    }\n    \n    .fixed-progress.complete {\n        background: linear-gradient(135deg, #4CAF50, #2e7d32);\n    }\n    \n    .fixed-progress.over {\n        background: linear-gradient(135deg, #f44336, #d32f2f);\n    }\n    \n    /* Add top padding to body when progress bar is shown */\n    body.progress-bar-visible {\n        padding-top: 60px;\n    }\n    \n    /* Mobile responsive */\n    @media (max-width: 768px) {\n        .players-grid { \n            grid-template-columns:repeat(auto-fill, minmax(50px, 1fr)); \n            gap:4px;\n            margin-bottom:10px;\n        }\n        \n        .player-card { \n            padding:4px 2px;\n            min-height:45px;\n            border-width:2px;\n        }\n        \n        .player-number { \n            font-size:20px;\n        }\n        \n        .dance-header h3 { \n            font-size:14px;\n        }\n        \n        .dance-header p {\n            font-size:12px;\n        }\n        \n        .recall-status {\n            padding:15px;\n            font-size:16px;\n            margin:15px 0;\n        }\n        \n        .recall-status .selected-count {\n            font-size:20px;\n        }\n    }\n    \n    @media (max-width: 480px) {\n        .players-grid { \n            grid-template-columns:repeat(auto-fill, minmax(55px, 1fr)); \n            gap:5px;\n        }\n        \n        .player-card { \n            padding:5px 2px;\n            min-height:45px;\n        }\n        \n        .player-number { \n            font-size:22px;\n        }\n        \n        .recall-status {\n            padding:12px;\n            font-size:14px;\n        }\n        \n        .recall-status .selected-count {\n            font-size:18px;\n        }\n    }\n</style>\n\n<!-- ìƒë‹¨ í—¤ë” -->\n<div class=\"scoring-container\">\n    <div class=\"event-info\" style=\"display:flex; justify-content:space-between; align-items:center; margin-bottom:15px; padding:15px; background:#f8f9fa; border-radius:8px; box-shadow:0 2px 4px rgba(0,0,0,0.1);\">\n        <div style=\"flex:1;\">\n            <h1 style=\"margin:0 0 5px 0; color:#333; font-size:20px; font-weight:bold;\"><?=h($event_data['name'])?></h1>\n            <div style=\"display:flex; gap:20px; font-size:14px; color:#666;\">\n                <span><strong>ì´ë²¤íŠ¸:</strong> #<?=h($event_data['no'])?></span>\n                <span><strong>ë¼ìš´ë“œ:</strong> <?=h($event_data['round'])?></span>\n                <span><strong>ì¢…ëª©:</strong> <?=h(implode(', ', array_map(function($d) use ($dance_mapping) { return getDanceName($d, $dance_mapping); }, $event_data['dances'])))?></span>\n            </div>\n        </div>\n        <div style=\"text-align:right;\">\n            <div style=\"font-size:16px; font-weight:bold; color:#003399; margin-bottom:5px;\">\n                ì‹¬ì‚¬ìœ„ì›: <?=h($_SESSION['scoring_judge_name'] ?? 'Unknown')?>\n            </div>\n            <div style=\"font-size:12px; color:#666;\">\n                ID: <?=h($_SESSION['scoring_judge_id'] ?? 'Unknown')?>\n            </div>\n        </div>\n    </div>\n    \n    <!-- ê³ ì • ì§„í–‰ë¥  ë°” -->\n    <?php renderFixedProgressBar($recall_count, $is_final, $event_no); ?>\n\n    <!-- Instagram Style Dance by Dance System -->\n<div class=\"dance-container\">\n    <div class=\"dance-progress\">\n        <div class=\"progress-bar\">\n            <div class=\"progress-fill\" style=\"width: 0%\"></div>\n        </div>\n        <div class=\"progress-text\">\n            <span class=\"current-dance\">1</span> / <?= count($event_data['dances']) ?>\n        </div>\n    </div>\n    \n    <div class=\"dance-slider\" id=\"danceSlider\">\n        <?php foreach ($event_data['dances'] as $dance_index => $dance): ?>\n            <?php \n            $dance_display = isset($dance_mapping[$dance]) ? $dance_mapping[$dance] : $dance;\n            ?>\n            <div class=\"dance-page\" data-dance=\"<?=h($dance)?>\" data-dance-index=\"<?=$dance_index?>\">\n                <div class=\"dance-header\">\n                    <h3><?=h($dance_display)?></h3>\n                    <p>ì´ <?=count($players)?>ëª… ì¤‘ <?= $recall_count ?>ëª… ì„ íƒ</p>\n                </div>\n                \n                <?php if ($hits_data && !empty($hits_data)): ?>\n                    <!-- Heat-based display -->\n                    <?php foreach ($hits_data as $heat_no => $heat_players): ?>\n                        <div class=\"heat-section\">\n                            <h4>íˆíŠ¸ <?= $heat_no ?></h4>\n                            <div class=\"players-grid\">\n                        <?php foreach ($heat_players as $player_no): ?>\n                            <div class=\"player-card\" data-player=\"<?=h($player_no)?>\" onclick=\"togglePlayerSelection(this)\">\n                                <div class=\"player-number\"><?=h($player_no)?></div>\n                                <input type=\"checkbox\" \n                                       name=\"recall_marks[<?=h($dance)?>][<?=h($player_no)?>]\" \n                                       class=\"recall-checkbox\"\n                                       data-dance=\"<?=h($dance)?>\"\n                                       data-player=\"<?=h($player_no)?>\">\n                            </div>\n                        <?php endforeach; ?>\n                            </div>\n                        </div>\n                    <?php endforeach; ?>\n                <?php else: ?>\n                    <!-- No heats - all players together -->\n                    <div class=\"players-grid\">\n                        <?php foreach ($players as $player_no): ?>\n                            <div class=\"player-card\" data-player=\"<?=h($player_no)?>\" onclick=\"togglePlayerSelection(this)\">\n                                <div class=\"player-number\"><?=h($player_no)?></div>\n                                <input type=\"checkbox\" \n                                       name=\"recall_marks[<?=h($dance)?>][<?=h($player_no)?>]\" \n                                       class=\"recall-checkbox\"\n                                       data-dance=\"<?=h($dance)?>\"\n                                       data-player=\"<?=h($player_no)?>\">\n                            </div>\n                        <?php endforeach; ?>\n                    </div>\n                <?php endif; ?>\n                \n                <div class=\"recall-status\">\n                    <div style=\"font-size:20px; margin-bottom:5px;\">ğŸ“Š Recall ì§„í–‰ ìƒí™©</div>\n                    <div style=\"font-size:28px; font-weight:900; color:#2e7d32;\">\n                        <span class=\"selected-count\">0</span> / <?= $recall_count ?>ëª…\n                    </div>\n                    <div style=\"font-size:14px; margin-top:5px; opacity:0.8;\">\n                        <?= $recall_count ?>ëª…ì„ ì„ íƒí•˜ë©´ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤\n                    </div>\n                </div>\n                \n                <div class=\"dance-submit-section\" style=\"text-align:center; margin-top:20px; display:none;\">\n                    <button type=\"button\" \n                            class=\"dance-submit-btn\" \n                            data-dance=\"<?=h($dance)?>\"\n                            style=\"background:#4CAF50; color:#fff; border:none; padding:15px 30px; font-size:16px; font-weight:bold; border-radius:8px; cursor:pointer;\">\n                        <?=h($dance_display)?> ì „ì†¡\n                    </button>\n                </div>\n            </div>\n        <?php endforeach; ?>\n    </div>\n    \n    <div class=\"dance-navigation\" style=\"text-align:center; margin-top:20px;\">\n        <button type=\"button\" id=\"prevDance\" style=\"background:#666; color:#fff; border:none; padding:10px 20px; margin:0 10px; border-radius:5px; cursor:pointer; display:none;\">ì´ì „</button>\n        <button type=\"button\" id=\"nextDance\" style=\"background:#2196F3; color:#fff; border:none; padding:10px 20px; margin:0 10px; border-radius:5px; cursor:pointer; display:none;\">ë‹¤ìŒ</button>\n    </div>\n</div>\n\n<!-- í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->\n<?php renderBottomNavigation($comp_id, $lang); ?>\n\n<!-- ë©€í‹°ì´ë²¤íŠ¸ ì˜ˆì„ /ì¤€ê²°ìŠ¹ ì „ìš© JavaScript -->\n<script>\n// Instagram Style Dance System\nlet currentDanceIndex = 0;\nlet totalDances = 0;\nlet completedDances = new Set();\nlet existingSelections = <?= json_encode($existing_selections) ?>;\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    const firstInput = document.querySelector('.place-input');\n    if (firstInput) {\n        firstInput.focus();\n    }\n    \n    // Initialize dance system\n    const danceSlider = document.getElementById('danceSlider');\n    if (danceSlider) {\n        initializeDanceSystem();\n    }\n    \n    // Setup fixed action buttons\n    setupFixedButtons();\n});\n\nfunction setupFixedButtons() {\n    // Dashboard button\n    const dashboardBtn = document.getElementById('dashboardBtn');\n    if (dashboardBtn) {\n        dashboardBtn.addEventListener('click', function() {\n            const compId = '<?= h($comp_id) ?>';\n            const lang = '<?= h($lang) ?>';\n            window.location.href = `scoring_dashboard.php?comp_id=${compId}&lang=${lang}`;\n        });\n    }\n    \n    // Refresh button\n    const refreshBtn = document.getElementById('refreshBtn');\n    if (refreshBtn) {\n        refreshBtn.addEventListener('click', function() {\n            if (confirm('í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì‹œê² ìŠµë‹ˆê¹Œ? í˜„ì¬ ì‘ì—… ì¤‘ì¸ ë‚´ìš©ì´ ì €ì¥ë˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.')) {\n                window.location.reload();\n            }\n        });\n    }\n}\n\nfunction loadExistingSelections() {\n    // Load existing selections for all dances\n    Object.keys(existingSelections).forEach(dance => {\n        const dancePage = document.querySelector(`[data-dance=\"${dance}\"]`);\n        if (!dancePage) return;\n        \n        const selectedPlayers = existingSelections[dance];\n        selectedPlayers.forEach(playerNo => {\n            const checkbox = dancePage.querySelector(`input[data-player=\"${playerNo}\"]`);\n            if (checkbox) {\n                checkbox.checked = true;\n                const card = checkbox.closest('.player-card');\n                if (card) {\n                    card.classList.add('selected');\n                }\n            }\n        });\n        \n        // Mark as completed if selections exist\n        if (selectedPlayers.length > 0) {\n            completedDances.add(dance);\n        }\n    });\n}\n\nfunction initializeDanceSystem() {\n    console.log('Initializing dance system');\n    \n    const dancePages = document.querySelectorAll('.dance-page');\n    totalDances = dancePages.length;\n    \n    console.log('Found dance pages:', totalDances);\n    \n    if (totalDances === 0) {\n        console.log('No dance pages found');\n        return;\n    }\n    \n    // Load existing selections for all dances\n    loadExistingSelections();\n    \n    // Show first dance page\n    showDancePage(0);\n    \n    // Setup event listeners\n    setupDanceEventListeners();\n    // setupPlayerCardEvents(); // ì œê±° - onclick ì†ì„± ì‚¬ìš©\n    updateProgress();\n    \n    // Initialize top recall status\n    updateTopRecallStatus();\n}\n\n// setupBasicPlayerCardEvents í•¨ìˆ˜ ì œê±° - onclick ì†ì„± ì‚¬ìš©\n\n// setupPlayerCardEvents í•¨ìˆ˜ ì œê±° - onclick ì†ì„± ì‚¬ìš©\n\nfunction showDancePage(index) {\n    const danceSlider = document.getElementById('danceSlider');\n    const dancePages = document.querySelectorAll('.dance-page');\n    \n    if (index < 0 || index >= totalDances) return;\n    \n    currentDanceIndex = index;\n    danceSlider.style.transform = `translateX(-${index * 100}%)`;\n    \n    // Update progress\n    updateProgress();\n    \n    // Update navigation buttons\n    updateNavigationButtons();\n    \n    // Reset touch events for current page\n    resetTouchEvents();\n    \n    // Restore dance page state if going back to a completed dance\n    const currentPage = document.querySelector('.dance-page[data-dance-index=\"' + currentDanceIndex + '\"]');\n    if (currentPage) {\n        const dance = currentPage.dataset.dance;\n        const isCompleted = completedDances.has(dance);\n        \n        if (isCompleted) {\n            // Restore the page to editable state\n            restoreDancePageState(currentPage, dance);\n        } else {\n            // Load existing selections for this dance if not completed\n            loadExistingSelectionsForDance(currentPage, dance);\n        }\n    }\n    \n    // Update recall status for current page\n    updateTopRecallStatus();\n}\n\nfunction setupDanceEventListeners() {\n    // Navigation buttons\n    document.getElementById('prevDance')?.addEventListener('click', () => {\n        if (currentDanceIndex > 0) {\n            showDancePage(currentDanceIndex - 1);\n        }\n    });\n    \n    document.getElementById('nextDance')?.addEventListener('click', () => {\n        if (currentDanceIndex < totalDances - 1) {\n            showDancePage(currentDanceIndex + 1);\n        }\n    });\n    \n    // Dance submit buttons\n    document.querySelectorAll('.dance-submit-btn').forEach(btn => {\n        btn.addEventListener('click', function() {\n            const dance = this.dataset.dance;\n            submitDance(dance);\n        });\n    });\n    \n    // Touch/swipe events\n    let startX = 0;\n    let startY = 0;\n    let isSwipe = false;\n    \n    const danceSlider = document.getElementById('danceSlider');\n    \n    danceSlider.addEventListener('touchstart', function(e) {\n        startX = e.touches[0].clientX;\n        startY = e.touches[0].clientY;\n        isSwipe = false;\n    });\n    \n    danceSlider.addEventListener('touchmove', function(e) {\n        if (!startX || !startY) return;\n        \n        const currentX = e.touches[0].clientX;\n        const currentY = e.touches[0].clientY;\n        const diffX = startX - currentX;\n        const diffY = startY - currentY;\n        \n        // Determine if this is a horizontal swipe\n        if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 50) {\n            isSwipe = true;\n            e.preventDefault();\n        }\n    });\n    \n    danceSlider.addEventListener('touchend', function(e) {\n        if (!isSwipe || !startX || !startY) return;\n        \n        const endX = e.changedTouches[0].clientX;\n        const diffX = startX - endX;\n        \n        if (Math.abs(diffX) > 100) {\n            if (diffX > 0 && currentDanceIndex < totalDances - 1) {\n                // Swipe left - next dance\n                showDancePage(currentDanceIndex + 1);\n            } else if (diffX < 0 && currentDanceIndex > 0) {\n                // Swipe right - previous dance\n                showDancePage(currentDanceIndex - 1);\n            }\n        }\n        \n        startX = 0;\n        startY = 0;\n        isSwipe = false;\n    });\n}\n\nfunction resetTouchEvents() {\n    // Remove existing event listeners and re-add them\n    const playerCards = document.querySelectorAll('.player-card');\n    playerCards.forEach(card => {\n        // Remove old listeners by cloning the element\n        const newCard = card.cloneNode(true);\n        card.parentNode.replaceChild(newCard, card);\n        \n        // Add new listeners\n        setupPlayerCardEvents(newCard);\n    });\n}\n\nfunction setupPlayerCardEvents(card) {\n    let touchStartTime = 0;\n    let touchStartPos = { x: 0, y: 0 };\n    \n    // Click event\n    card.addEventListener('click', function(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        togglePlayerSelection(this);\n    });\n    \n    // Touch start\n    card.addEventListener('touchstart', function(e) {\n        touchStartTime = Date.now();\n        const touch = e.touches[0];\n        touchStartPos = { x: touch.clientX, y: touch.clientY };\n    });\n    \n    // Touch end\n    card.addEventListener('touchend', function(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        \n        const touchEndTime = Date.now();\n        const touchDuration = touchEndTime - touchStartTime;\n        \n        // Only trigger if it's a quick tap (less than 500ms)\n        if (touchDuration < 500) {\n            togglePlayerSelection(this);\n        }\n    });\n    \n    // Prevent context menu on long press\n    card.addEventListener('contextmenu', function(e) {\n        e.preventDefault();\n    });\n}\n\nfunction updateProgress() {\n    const progressFill = document.querySelector('.progress-fill');\n    const currentDanceSpan = document.querySelector('.current-dance');\n    \n    if (progressFill) {\n        const progress = ((currentDanceIndex + 1) / totalDances) * 100;\n        progressFill.style.width = progress + '%';\n    }\n    \n    if (currentDanceSpan) {\n        currentDanceSpan.textContent = currentDanceIndex + 1;\n    }\n}\n\nfunction restoreDancePageState(page, dance) {\n    // Remove from completed dances to allow re-editing\n    completedDances.delete(dance);\n    \n    // Restore the recall status section\n    const statusDiv = page.querySelector('.recall-status');\n    if (statusDiv) {\n        statusDiv.innerHTML = `\n            <div style=\"font-size:20px; margin-bottom:5px;\">ğŸ“Š Recall ì§„í–‰ ìƒí™©</div>\n            <div style=\"font-size:28px; font-weight:900; color:#2e7d32;\">\n                <span class=\"selected-count\">0</span> / <?= $recall_count ?>ëª…\n            </div>\n            <div style=\"font-size:14px; margin-top:5px; opacity:0.8;\">\n                <?= $recall_count ?>ëª…ì„ ì„ íƒí•˜ë©´ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤\n            </div>\n        `;\n    }\n    \n    // Show submit section (will be hidden/shown based on selection count)\n    const submitSection = page.querySelector('.dance-submit-section');\n    if (submitSection) {\n        submitSection.style.display = 'none';\n    }\n    \n    // Load existing selections for this dance\n    if (existingSelections[dance]) {\n        const selectedPlayers = existingSelections[dance];\n        selectedPlayers.forEach(playerNo => {\n            const checkbox = page.querySelector(`input[data-player=\"${playerNo}\"]`);\n            if (checkbox) {\n                checkbox.checked = true;\n                const card = checkbox.closest('.player-card');\n                if (card) {\n                    card.classList.add('selected');\n                }\n            }\n        });\n    } else {\n        // No existing selections, clear all\n        const checkboxes = page.querySelectorAll('.recall-checkbox');\n        checkboxes.forEach(checkbox => {\n            checkbox.checked = false;\n        });\n        \n        // Update player card states\n        const playerCards = page.querySelectorAll('.player-card');\n        playerCards.forEach(card => {\n            card.classList.remove('selected');\n        });\n    }\n}\n\nfunction updateNavigationButtons() {\n    const prevBtn = document.getElementById('prevDance');\n    const nextBtn = document.getElementById('nextDance');\n    \n    if (prevBtn) {\n        prevBtn.style.display = currentDanceIndex > 0 ? 'inline-block' : 'none';\n    }\n    \n    if (nextBtn) {\n        // Show next button if there are more dances AND current dance is completed\n        const currentDance = document.querySelector('.dance-page[data-dance-index=\"' + currentDanceIndex + '\"]');\n        const isCurrentDanceCompleted = currentDance && completedDances.has(currentDance.dataset.dance);\n        \n        if (currentDanceIndex < totalDances - 1 && isCurrentDanceCompleted) {\n            nextBtn.style.display = 'inline-block';\n            nextBtn.disabled = false;\n            nextBtn.style.opacity = '1';\n            nextBtn.style.cursor = 'pointer';\n        } else {\n            nextBtn.style.display = 'none';\n        }\n    }\n}\n\nfunction submitDance(dance) {\n    const currentPage = document.querySelector(`[data-dance=\"${dance}\"]`);\n    const checkboxes = currentPage.querySelectorAll('.recall-checkbox:checked');\n    const recallCount = <?= json_encode(intval($recall_count)) ?>;\n    \n    if (checkboxes.length !== recallCount) {\n        alert(`${recallCount}ëª…ì„ ì •í™•íˆ ì„ íƒí•´ì£¼ì„¸ìš”.`);\n        return;\n    }\n    \n    // Collect selected players for this dance\n    const selectedPlayers = Array.from(checkboxes).map(cb => cb.dataset.player);\n    \n    // Prepare data for this dance only\n    const recallMarks = {};\n    recallMarks[dance] = selectedPlayers;\n    \n    const data = {\n        comp_id: <?= json_encode($comp_id) ?>,\n        event_no: <?= json_encode($event_no) ?>,\n        type: 'recall',\n        recall_marks: recallMarks\n    };\n    \n    // Show loading state\n    const submitBtn = currentPage.querySelector('.dance-submit-btn');\n    const originalText = submitBtn.textContent;\n    submitBtn.textContent = 'ì „ì†¡ ì¤‘...';\n    submitBtn.disabled = true;\n    \n    fetch('scoring/save_scores.php', {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(data)\n    })\n    .then(response => response.json())\n    .then(result => {\n        if (result.success) {\n            // Mark this dance as completed\n            completedDances.add(dance);\n            \n            // Update existing selections\n            existingSelections[dance] = selectedPlayers;\n            \n            // Hide submit button and show completion message\n            submitBtn.style.display = 'none';\n            const statusDiv = currentPage.querySelector('.recall-status');\n            statusDiv.innerHTML = `\n                <div style=\"font-size:20px; margin-bottom:5px;\">âœ… ì™„ë£Œ</div>\n                <div style=\"font-size:18px; font-weight:bold; color:#4CAF50;\">\n                    ${recallCount}ëª… ì„ íƒ ì™„ë£Œ\n                </div>\n                <div style=\"font-size:14px; margin-top:5px; opacity:0.8;\">\n                    ë‹¤ìŒ ëŒ„ìŠ¤ë¡œ ì§„í–‰í•˜ì„¸ìš”\n                </div>\n            `;\n            \n            // Enable next dance button if available\n            updateNavigationButtons();\n            \n            // Show completion message\n            if (currentDanceIndex < totalDances - 1) {\n                setTimeout(() => {\n                    alert(`${dance} ëŒ„ìŠ¤ ì±„ì ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ëŒ„ìŠ¤ë¡œ ì§„í–‰í•˜ì„¸ìš”.`);\n                }, 1000);\n            } else {\n                // All dances completed\n                setTimeout(() => {\n                    alert('ëª¨ë“  ëŒ„ìŠ¤ ì±„ì ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');\n                }, 1000);\n            }\n        } else {\n            alert('ì „ì†¡ ì‹¤íŒ¨: ' + (result.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));\n            submitBtn.textContent = originalText;\n            submitBtn.disabled = false;\n        }\n    })\n    .catch(error => {\n        console.error('Error:', error);\n        alert('ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error);\n        submitBtn.textContent = originalText;\n        submitBtn.disabled = false;\n    });\n}\n\n// Recall system event handlers\ndocument.addEventListener('DOMContentLoaded', function() {\n    console.log('DOM loaded, setting up event handlers');\n    \n    // Initialize dance system first\n    const danceSlider = document.getElementById('danceSlider');\n    if (danceSlider) {\n        initializeDanceSystem();\n    }\n    \n    // Setup fixed action buttons\n    setupFixedButtons();\n    \n    console.log('Event handlers setup complete');\n});\n\nfunction togglePlayerSelection(card) {\n    console.log('togglePlayerSelection called for card:', card);\n    const checkbox = card.querySelector('.recall-checkbox');\n    if (!checkbox) {\n        console.error('No checkbox found in card:', card);\n        return;\n    }\n    \n    console.log('Checkbox before toggle:', checkbox.checked);\n    checkbox.checked = !checkbox.checked;\n    console.log('Checkbox after toggle:', checkbox.checked);\n    \n    updatePlayerCardState(card);\n    updateRecallStatus();\n    updateTopRecallStatus();\n    \n    // ë””ë²„ê·¸: í˜„ì¬ ì„ íƒëœ ì„ ìˆ˜ ìˆ˜ í™•ì¸\n    const selectedCount = document.querySelectorAll('.recall-checkbox:checked').length;\n    console.log('Total selected players:', selectedCount);\n}\n\nfunction updatePlayerCardState(card) {\n    console.log('updatePlayerCardState called for card:', card);\n    const checkbox = card.querySelector('.recall-checkbox');\n    if (!checkbox) {\n        console.error('No checkbox found in card for updatePlayerCardState:', card);\n        return;\n    }\n    \n    if (checkbox.checked) {\n        card.classList.add('selected');\n        console.log('Card marked as selected');\n    } else {\n        card.classList.remove('selected');\n        console.log('Card marked as unselected');\n    }\n}\n\nfunction updateTopRecallStatus() {\n    // Get all checked checkboxes from all pages\n    const allCheckboxes = document.querySelectorAll('.recall-checkbox:checked');\n    const selectedCount = allCheckboxes.length;\n    const recallCount = <?= json_encode(intval($recall_count)) ?>;\n    \n    // Update top recall progress display\n    const topRecallProgress = document.getElementById('recallProgress');\n    if (topRecallProgress) {\n        topRecallProgress.textContent = selectedCount;\n        \n        // Update color based on progress\n        if (selectedCount === recallCount) {\n            topRecallProgress.style.color = '#4CAF50';\n            topRecallProgress.style.fontWeight = 'bold';\n        } else if (selectedCount > recallCount) {\n            topRecallProgress.style.color = '#f44336';\n            topRecallProgress.style.fontWeight = 'bold';\n        } else {\n            topRecallProgress.style.color = '#ff9800';\n            topRecallProgress.style.fontWeight = 'normal';\n        }\n    }\n    \n    // Update fixed progress bar\n    const fixedRecallCount = document.getElementById('fixedRecallCount');\n    if (fixedRecallCount) {\n        fixedRecallCount.textContent = selectedCount;\n    }\n    \n    // Update submit button state for current dance page\n    const currentPage = document.querySelector('.dance-page[data-dance-index=\"' + currentDanceIndex + '\"]');\n    if (currentPage) {\n        const submitSection = currentPage.querySelector('.dance-submit-section');\n        const submitBtn = currentPage.querySelector('.dance-submit-btn');\n        \n        if (submitSection && submitBtn) {\n            // Show/hide submit section based on selection count\n            if (selectedCount === recallCount) {\n                submitSection.style.display = 'block';\n                submitBtn.disabled = false;\n                submitBtn.style.opacity = '1';\n                submitBtn.style.cursor = 'pointer';\n            } else {\n                submitSection.style.display = 'none';\n                submitBtn.disabled = true;\n                submitBtn.style.opacity = '0.5';\n                submitBtn.style.cursor = 'not-allowed';\n            }\n        }\n    }\n}\n\nfunction updateRecallStatus() {\n    console.log('updateRecallStatus called, currentDanceIndex:', currentDanceIndex);\n    const currentPage = document.querySelector('.dance-page[data-dance-index=\"' + currentDanceIndex + '\"]');\n    \n    console.log('Current page found:', currentPage);\n    \n    if (!currentPage) {\n        console.log('No current page found, using fallback');\n        // Fallback: get all checked checkboxes from all pages\n        const allCheckboxes = document.querySelectorAll('.recall-checkbox:checked');\n        const selectedCount = allCheckboxes.length;\n        const recallCount = <?= json_encode(intval($recall_count)) ?>;\n        \n        console.log('Fallback - selectedCount:', selectedCount, 'recallCount:', recallCount);\n        \n        // Update top recall progress display\n        const topRecallProgress = document.getElementById('recallProgress');\n        if (topRecallProgress) {\n            topRecallProgress.textContent = selectedCount;\n            \n            // Update color based on progress\n            if (selectedCount === recallCount) {\n                topRecallProgress.style.color = '#4CAF50';\n                topRecallProgress.style.fontWeight = 'bold';\n            } else if (selectedCount > recallCount) {\n                topRecallProgress.style.color = '#f44336';\n                topRecallProgress.style.fontWeight = 'bold';\n            } else {\n                topRecallProgress.style.color = '#ff9800';\n                topRecallProgress.style.fontWeight = 'normal';\n            }\n        }\n        return;\n    }\n    \n    const checkboxes = currentPage.querySelectorAll('.recall-checkbox:checked');\n    const selectedCount = checkboxes.length;\n    const recallCount = <?= json_encode(intval($recall_count)) ?>;\n    \n    console.log('Current page - selectedCount:', selectedCount, 'recallCount:', recallCount);\n    \n    // Top recall progress is handled by updateTopRecallStatus function\n    \n    // Update fixed progress bar\n    const fixedProgress = document.getElementById('fixedProgress');\n    console.log('Fixed progress bar found:', fixedProgress);\n    if (fixedProgress) {\n        const progressText = fixedProgress.querySelector('#fixedRecallCount');\n        console.log('Progress text element found:', progressText);\n        if (progressText) {\n            progressText.textContent = selectedCount;\n            console.log('Updated progress text to:', selectedCount);\n        }\n        \n        // Update progress bar styling\n        fixedProgress.classList.remove('complete', 'over');\n        if (selectedCount === recallCount) {\n            fixedProgress.classList.add('complete');\n        } else if (selectedCount > recallCount) {\n            fixedProgress.classList.add('over');\n        }\n    }\n    \n    // Update current page status\n    const statusDiv = currentPage.querySelector('.recall-status');\n    console.log('Status div found:', statusDiv);\n    const countSpan = statusDiv ? statusDiv.querySelector('.selected-count') : null;\n    console.log('Count span found:', countSpan);\n    const submitSection = currentPage.querySelector('.dance-submit-section');\n    console.log('Submit section found:', submitSection);\n    \n    if (countSpan) {\n        countSpan.textContent = selectedCount;\n        console.log('Updated count span to:', selectedCount);\n    }\n    \n    // Update status styling\n    statusDiv.classList.remove('complete', 'over');\n    if (selectedCount === recallCount) {\n        statusDiv.classList.add('complete');\n        if (submitSection) submitSection.style.display = 'block';\n    } else if (selectedCount > recallCount) {\n        statusDiv.classList.add('over');\n        if (submitSection) submitSection.style.display = 'none';\n    } else {\n        if (submitSection) submitSection.style.display = 'none';\n    }\n}\n\nfunction initializeFixedProgress() {\n    const fixedProgress = document.getElementById('fixedProgress');\n    if (!fixedProgress) return;\n    \n    let isScrolling = false;\n    let scrollTimeout;\n    \n    // Show progress bar when scrolling down\n    window.addEventListener('scroll', function() {\n        if (!isScrolling) {\n            fixedProgress.classList.add('show');\n            document.body.classList.add('progress-bar-visible');\n        }\n        \n        isScrolling = true;\n        clearTimeout(scrollTimeout);\n        \n        scrollTimeout = setTimeout(function() {\n            isScrolling = false;\n            // Hide progress bar after scrolling stops (only if no selections)\n            const totalSelected = document.querySelectorAll('.recall-checkbox:checked').length;\n            if (totalSelected === 0) {\n                fixedProgress.classList.remove('show');\n                document.body.classList.remove('progress-bar-visible');\n            }\n        }, 1000);\n    });\n    \n    // Touch events for mobile\n    document.addEventListener('touchstart', function() {\n        fixedProgress.classList.add('show');\n        document.body.classList.add('progress-bar-visible');\n    });\n}\n\nfunction loadExistingSelectionsForDance(page, dance) {\n    // Load existing selections for a specific dance\n    if (existingSelections[dance]) {\n        const selectedPlayers = existingSelections[dance];\n        selectedPlayers.forEach(playerNo => {\n            const checkbox = page.querySelector(`input[data-player=\"${playerNo}\"]`);\n            if (checkbox) {\n                checkbox.checked = true;\n                const card = checkbox.closest('.player-card');\n                if (card) {\n                    card.classList.add('selected');\n                }\n            }\n        });\n    }\n}\n</script>\n","size_bytes":37321},"lang/Language.php":{"content":"<?php\nclass Language {\n    private static $instance = null;\n    private $currentLang = 'ko';\n    private $translations = [];\n    private $availableLanguages = [\n        'ko' => ['name' => 'í•œêµ­ì–´', 'flag' => 'ğŸ‡°ğŸ‡·'],\n        'en' => ['name' => 'English', 'flag' => 'ğŸ‡ºğŸ‡¸'],\n        'ja' => ['name' => 'æ—¥æœ¬èª', 'flag' => 'ğŸ‡¯ğŸ‡µ'],\n        'zh' => ['name' => 'ä¸­æ–‡', 'flag' => 'ğŸ‡¨ğŸ‡³'],\n        'ru' => ['name' => 'Ğ ÑƒÑÑĞºĞ¸Ğ¹', 'flag' => 'ğŸ‡·ğŸ‡º']\n    ];\n\n    private function __construct() {\n        $this->detectLanguage();\n        $this->loadTranslations();\n    }\n\n    public static function getInstance() {\n        if (self::$instance === null) {\n            self::$instance = new self();\n        }\n        return self::$instance;\n    }\n\n    private function detectLanguage() {\n        // URL íŒŒë¼ë¯¸í„°ì—ì„œ ì–¸ì–´ í™•ì¸\n        if (isset($_GET['lang']) && array_key_exists($_GET['lang'], $this->availableLanguages)) {\n            $this->currentLang = $_GET['lang'];\n            $_SESSION['lang'] = $this->currentLang;\n            return;\n        }\n\n        // ì„¸ì…˜ì—ì„œ ì–¸ì–´ í™•ì¸\n        if (isset($_SESSION['lang']) && array_key_exists($_SESSION['lang'], $this->availableLanguages)) {\n            $this->currentLang = $_SESSION['lang'];\n            return;\n        }\n\n        // ë¸Œë¼ìš°ì € ì–¸ì–´ ê°ì§€\n        if (isset($_SERVER['HTTP_ACCEPT_LANGUAGE'])) {\n            $browserLang = substr($_SERVER['HTTP_ACCEPT_LANGUAGE'], 0, 2);\n            if (array_key_exists($browserLang, $this->availableLanguages)) {\n                $this->currentLang = $browserLang;\n                $_SESSION['lang'] = $this->currentLang;\n                return;\n            }\n        }\n\n        // ê¸°ë³¸ê°’: í•œêµ­ì–´\n        $this->currentLang = 'ko';\n        $_SESSION['lang'] = $this->currentLang;\n    }\n\n    private function loadTranslations() {\n        $langFile = __DIR__ . '/' . $this->currentLang . '.php';\n        if (file_exists($langFile)) {\n            $this->translations = require $langFile;\n        } else {\n            // í´ë°±ìœ¼ë¡œ í•œêµ­ì–´ ë¡œë“œ\n            $this->translations = require __DIR__ . '/ko.php';\n        }\n    }\n\n    public function get($key, $default = null) {\n        return $this->translations[$key] ?? $default ?? $key;\n    }\n\n    public function getCurrentLang() {\n        return $this->currentLang;\n    }\n\n    public function getAvailableLanguages() {\n        return $this->availableLanguages;\n    }\n\n    public function getLangName($code = null) {\n        $code = $code ?? $this->currentLang;\n        return $this->availableLanguages[$code]['name'] ?? $code;\n    }\n\n    public function getLangFlag($code = null) {\n        $code = $code ?? $this->currentLang;\n        return $this->availableLanguages[$code]['flag'] ?? '';\n    }\n\n    public function getLanguageUrl($langCode) {\n        $currentUrl = $_SERVER['REQUEST_URI'];\n        $urlParts = parse_url($currentUrl);\n        $params = [];\n        \n        // ê¸°ì¡´ lang íŒŒë¼ë¯¸í„° ì œê±°\n        if (isset($urlParts['query'])) {\n            parse_str($urlParts['query'], $params);\n        }\n        \n        $params['lang'] = $langCode;\n        $queryString = http_build_query($params);\n\n        $path = $urlParts['path'] ?? '/';\n        return $path . '?' . $queryString;\n    }\n\n    public function formatDate($timestamp, $format = null) {\n        $format = $format ?? $this->get('date_format', 'Y-m-d');\n        return date($format, is_string($timestamp) ? strtotime($timestamp) : $timestamp);\n    }\n}\n\n// í—¬í¼ í•¨ìˆ˜\nfunction t($key, $default = null) {\n    return Language::getInstance()->get($key, $default);\n}\n\nfunction lang() {\n    return Language::getInstance();\n}\n?>","size_bytes":3700},"lang/en.php":{"content":"<?php\n// English translations\nreturn [\n    // Navigation\n    'nav_dashboard' => 'Dashboard',\n    'nav_competitions' => 'Competitions',\n    'nav_results' => 'Results',\n    'nav_management' => 'Management',\n    'nav_notices' => 'Notices',\n    \n    // Header\n    'site_title' => 'DanceOffice - International DanceSport Competition Management System',\n    'hero_title' => 'DanceOffice',\n    'hero_subtitle' => 'International DanceSport Competition Management System',\n    'hero_description' => 'Professional judging platform for global dance competitions',\n    \n    // Statistics\n    'stat_total_competitions' => 'Total Competitions',\n    'stat_upcoming_events' => 'Upcoming Events',\n    'stat_completed' => 'Completed',\n    \n    // Widget titles\n    'widget_upcoming_competitions' => 'Upcoming Competitions',\n    'widget_recent_results' => 'Recent Results',\n    'widget_announcements' => 'Announcements',\n    'widget_schedule' => 'Schedule',\n    \n    // Actions\n    'action_view_all' => 'View All',\n    'action_manage' => 'Manage',\n    'action_edit' => 'Edit',\n    'action_new_competition' => 'New Competition',\n    'action_view_results' => 'View Results',\n    'action_settings' => 'Settings',\n    \n    // Status\n    'status_upcoming' => 'Upcoming',\n    'status_completed' => 'Completed',\n    'status_ongoing' => 'Ongoing',\n    \n    // Messages\n    'no_upcoming_competitions' => 'No upcoming competitions scheduled',\n    'no_recent_competitions' => 'No recent competitions',\n    'no_notices' => 'No announcements registered',\n    'no_schedule' => 'No competition schedule registered',\n    \n    // Date/time\n    'date_format' => 'M d, Y',\n    'datetime_format' => 'M d, Y H:i',\n    \n    // Language selection\n    'language' => 'Language',\n    'select_language' => 'Select Language',\n    \n    // Admin page\n    'admin_title' => 'Admin Panel',\n    'admin_subtitle' => 'DanceOffice Management System',\n    'admin_login' => 'Administrator Login',\n    'admin_password' => 'Administrator Password',\n    'admin_login_btn' => 'Login',\n    'admin_password_placeholder' => 'Enter password',\n    \n    // Admin navigation\n    'admin_nav_home' => 'Back to Main',\n    'admin_nav_results' => 'Competition Results',\n    'admin_nav_competitions' => 'Competition Management',\n    'admin_nav_judging' => 'Freestyle Competition Judging',\n    \n    // Notice management\n    'notice_management' => 'Announcement Management',\n    'current_notice' => 'Current registered announcement:',\n    'notice_content' => 'Announcement Content',\n    'notice_placeholder' => 'Enter announcement content',\n    'notice_save' => 'Save Announcement',\n    'notice_delete' => 'Delete Announcement',\n    'notice_delete_confirm' => 'Delete this announcement?',\n    \n    // Schedule management\n    'schedule_management' => 'Competition Schedule Management',\n    'current_schedule' => 'Current registered competition schedule:',\n    'schedule_content' => 'Competition Schedule Content',\n    'schedule_placeholder' => 'Enter competition schedule',\n    'schedule_save' => 'Save Schedule',\n    'schedule_delete' => 'Delete Schedule',\n    'schedule_delete_confirm' => 'Delete this schedule?',\n    \n    // Banner management\n    'banner_management' => 'Advertisement Banner Management',\n    'banner_top' => 'Top',\n    'banner_bottom' => 'Bottom',\n    'banner_left' => 'Left',\n    'banner_right' => 'Right',\n    'banner_main' => 'Main',\n    'banner_recommended_size' => 'Recommended',\n    'banner_upload' => 'Image Upload',\n    'banner_link' => 'Banner Link (URL)',\n    'banner_link_placeholder' => 'Enter banner link',\n    'banner_upload_save' => 'Upload/Save Link',\n    'banner_image_delete' => 'Delete Image',\n    'banner_link_delete' => 'Delete Link',\n    'banner_view_link' => 'Visit Link',\n    'banner_current_link' => 'Current link:',\n    'banner_delete_image_confirm' => 'Delete this image?',\n    'banner_delete_link_confirm' => 'Delete this link file?',\n    \n    // Banner descriptions\n    'banner_top_desc' => 'Top horizontal banner (visible on PC/mobile)',\n    'banner_bottom_desc' => 'Bottom horizontal banner (visible on PC/mobile)',\n    'banner_left_desc' => 'Left vertical banner (PC screen only)',\n    'banner_right_desc' => 'Right vertical banner (PC screen only)',\n    'banner_main_desc' => 'Main/event area (variable size)',\n    \n    // Common\n    'or' => 'or',\n    'total' => 'Total',\n    'pinned' => 'Pinned',\n    'updated' => 'Updated',\n    'error' => 'Error',\n    'delete' => 'Delete',\n    'edit' => 'Edit',\n    'save_changes' => 'Save Changes',\n    'cancel' => 'Cancel',\n    'optional' => 'Optional',\n    \n    // Notice Management\n    'notice_title' => 'Title',\n    'notice_title_placeholder' => 'Enter notice title',\n    'notice_content_placeholder' => 'Enter notice content',\n    'notice_image' => 'Image',\n    'notice_image_help' => 'Only JPG, PNG, GIF, WebP files allowed (Max 5MB)',\n    'notice_pin' => 'Pin to Top',\n    'notice_unpin' => 'Unpin',\n    'notice_create' => 'Create Notice',\n    'create_notice' => 'Create New Notice',\n    'existing_notices' => 'Existing Notices',\n    'edit_notice' => 'Edit Notice',\n    'current_image' => 'Current Image',\n    'no_current_image' => 'No current image',\n    'notice_delete_confirm' => 'Are you sure you want to delete this notice?',\n    'view_all_notices' => 'View All Notices',\n];","size_bytes":5298},"lang/ja.php":{"content":"<?php\n// æ—¥æœ¬èªç¿»è¨³\nreturn [\n    // ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³\n    'nav_dashboard' => 'ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰',\n    'nav_competitions' => 'å¤§ä¼š',\n    'nav_results' => 'çµæœ',\n    'nav_management' => 'ç®¡ç†',\n    'nav_notices' => 'ãŠçŸ¥ã‚‰ã›',\n    \n    // ãƒ˜ãƒƒãƒ€ãƒ¼\n    'site_title' => 'DanceOffice - å›½éš›ãƒ€ãƒ³ã‚¹ã‚¹ãƒãƒ¼ãƒ„å¤§ä¼šç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ',\n    'hero_title' => 'DanceOffice',\n    'hero_subtitle' => 'å›½éš›ãƒ€ãƒ³ã‚¹ã‚¹ãƒãƒ¼ãƒ„å¤§ä¼šç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ',\n    'hero_description' => 'ä¸–ç•Œã®ãƒ€ãƒ³ã‚¹å¤§ä¼šã®ãŸã‚ã®ãƒ—ãƒ­å¯©æŸ»ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ',\n    \n    // çµ±è¨ˆ\n    'stat_total_competitions' => 'ç·å¤§ä¼šæ•°',\n    'stat_upcoming_events' => 'äºˆå®šã‚¤ãƒ™ãƒ³ãƒˆ',\n    'stat_completed' => 'å®Œäº†æ¸ˆã¿',\n    \n    // ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã‚¿ã‚¤ãƒˆãƒ«\n    'widget_upcoming_competitions' => 'äºˆå®šå¤§ä¼š',\n    'widget_recent_results' => 'æœ€è¿‘ã®çµæœ',\n    'widget_announcements' => 'ãŠçŸ¥ã‚‰ã›',\n    'widget_schedule' => 'ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«',\n    \n    // ã‚¢ã‚¯ã‚·ãƒ§ãƒ³\n    'action_view_all' => 'ã™ã¹ã¦è¡¨ç¤º',\n    'action_manage' => 'ç®¡ç†',\n    'action_edit' => 'ç·¨é›†',\n    'action_new_competition' => 'æ–°ã—ã„å¤§ä¼š',\n    'action_view_results' => 'çµæœã‚’è¦‹ã‚‹',\n    'action_settings' => 'è¨­å®š',\n    \n    // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹\n    'status_upcoming' => 'äºˆå®š',\n    'status_completed' => 'å®Œäº†',\n    'status_ongoing' => 'é€²è¡Œä¸­',\n    \n    // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸\n    'no_upcoming_competitions' => 'äºˆå®šã•ã‚Œã¦ã„ã‚‹å¤§ä¼šã¯ã‚ã‚Šã¾ã›ã‚“',\n    'no_recent_competitions' => 'æœ€è¿‘ã®å¤§ä¼šã¯ã‚ã‚Šã¾ã›ã‚“',\n    'no_notices' => 'ç™»éŒ²ã•ã‚ŒãŸãŠçŸ¥ã‚‰ã›ã¯ã‚ã‚Šã¾ã›ã‚“',\n    'no_schedule' => 'ç™»éŒ²ã•ã‚ŒãŸå¤§ä¼šã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ã‚ã‚Šã¾ã›ã‚“',\n    \n    // æ—¥ä»˜/æ™‚é–“\n    'date_format' => 'Yå¹´mæœˆdæ—¥',\n    'datetime_format' => 'Yå¹´mæœˆdæ—¥ H:i',\n    \n    // è¨€èªé¸æŠ\n    'language' => 'è¨€èª',\n    'select_language' => 'è¨€èªé¸æŠ',\n    \n    // ç®¡ç†è€…ãƒšãƒ¼ã‚¸\n    'admin_title' => 'ç®¡ç†è€…ãƒšãƒ¼ã‚¸',\n    'admin_subtitle' => 'DanceOfficeç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ',\n    'admin_login' => 'ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³',\n    'admin_password' => 'ç®¡ç†è€…ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰',\n    'admin_login_btn' => 'ãƒ­ã‚°ã‚¤ãƒ³',\n    'admin_password_placeholder' => 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„',\n    \n    // ç®¡ç†ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³\n    'admin_nav_home' => 'ãƒ¡ã‚¤ãƒ³ã«æˆ»ã‚‹',\n    'admin_nav_results' => 'ç«¶æŠ€çµæœ',\n    'admin_nav_competitions' => 'å¤§ä¼šç®¡ç†',\n    'admin_nav_judging' => 'ãƒ•ãƒªãƒ¼ã‚¹ã‚¿ã‚¤ãƒ«å¤§ä¼šæ¡ç‚¹',\n    \n    // ãŠçŸ¥ã‚‰ã›ç®¡ç†\n    'notice_management' => 'ãŠçŸ¥ã‚‰ã›ç®¡ç†',\n    'current_notice' => 'ç¾åœ¨ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ãŠçŸ¥ã‚‰ã›:',\n    'notice_content' => 'ãŠçŸ¥ã‚‰ã›å†…å®¹',\n    'notice_placeholder' => 'ãŠçŸ¥ã‚‰ã›å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„',\n    'notice_save' => 'ãŠçŸ¥ã‚‰ã›ä¿å­˜',\n    'notice_delete' => 'ãŠçŸ¥ã‚‰ã›å‰Šé™¤',\n    'notice_delete_confirm' => 'ãŠçŸ¥ã‚‰ã›ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ',\n    \n    // ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç®¡ç†\n    'schedule_management' => 'å¤§ä¼šã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç®¡ç†',\n    'current_schedule' => 'ç¾åœ¨ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹å¤§ä¼šã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«:',\n    'schedule_content' => 'å¤§ä¼šã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å†…å®¹',\n    'schedule_placeholder' => 'å¤§ä¼šã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„',\n    'schedule_save' => 'ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ä¿å­˜',\n    'schedule_delete' => 'ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å‰Šé™¤',\n    'schedule_delete_confirm' => 'ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ',\n    \n    // ãƒãƒŠãƒ¼ç®¡ç†\n    'banner_management' => 'åºƒå‘ŠãƒãƒŠãƒ¼ç®¡ç†',\n    'banner_top' => 'ä¸Šéƒ¨',\n    'banner_bottom' => 'ä¸‹éƒ¨',\n    'banner_left' => 'å·¦å´',\n    'banner_right' => 'å³å´',\n    'banner_main' => 'ãƒ¡ã‚¤ãƒ³',\n    'banner_recommended_size' => 'æ¨å¥¨',\n    'banner_upload' => 'ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰',\n    'banner_link' => 'ãƒãƒŠãƒ¼ãƒªãƒ³ã‚¯ (URL)',\n    'banner_link_placeholder' => 'ãƒãƒŠãƒ¼ãƒªãƒ³ã‚¯ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„',\n    'banner_upload_save' => 'ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰/ãƒªãƒ³ã‚¯ä¿å­˜',\n    'banner_image_delete' => 'ç”»åƒå‰Šé™¤',\n    'banner_link_delete' => 'ãƒªãƒ³ã‚¯å‰Šé™¤',\n    'banner_view_link' => 'ãƒªãƒ³ã‚¯ã‚’é–‹ã',\n    'banner_current_link' => 'ç¾åœ¨ã®ãƒªãƒ³ã‚¯:',\n    'banner_delete_image_confirm' => 'ç”»åƒã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ',\n    'banner_delete_link_confirm' => 'ãƒªãƒ³ã‚¯ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ',\n    \n    // ãƒãƒŠãƒ¼èª¬æ˜\n    'banner_top_desc' => 'ä¸Šéƒ¨æ¨ªãƒãƒŠãƒ¼ï¼ˆPC/ãƒ¢ãƒã‚¤ãƒ«ä¸¡æ–¹è¡¨ç¤ºï¼‰',\n    'banner_bottom_desc' => 'ä¸‹éƒ¨æ¨ªãƒãƒŠãƒ¼ï¼ˆPC/ãƒ¢ãƒã‚¤ãƒ«ä¸¡æ–¹è¡¨ç¤ºï¼‰',\n    'banner_left_desc' => 'å·¦å´ç¸¦ãƒãƒŠãƒ¼ï¼ˆPCç”»é¢ã®ã¿è¡¨ç¤ºï¼‰',\n    'banner_right_desc' => 'å³å´ç¸¦ãƒãƒŠãƒ¼ï¼ˆPCç”»é¢ã®ã¿è¡¨ç¤ºï¼‰',\n    'banner_main_desc' => 'ãƒ¡ã‚¤ãƒ³/ã‚¤ãƒ™ãƒ³ãƒˆã‚¨ãƒªã‚¢ï¼ˆå¯å¤‰ã‚µã‚¤ã‚ºï¼‰',\n    \n    // å…±é€š\n    'or' => 'ã¾ãŸã¯',\n    'total' => 'åˆè¨ˆ',\n    'pinned' => 'å›ºå®š',\n    'updated' => 'æ›´æ–°',\n    'error' => 'ã‚¨ãƒ©ãƒ¼',\n    'delete' => 'å‰Šé™¤',\n    'edit' => 'ç·¨é›†',\n    'save_changes' => 'å¤‰æ›´ã‚’ä¿å­˜',\n    'cancel' => 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«',\n    'optional' => 'ã‚ªãƒ—ã‚·ãƒ§ãƒ³',\n    \n    // ãŠçŸ¥ã‚‰ã›ç®¡ç†\n    'notice_title' => 'ã‚¿ã‚¤ãƒˆãƒ«',\n    'notice_title_placeholder' => 'ãŠçŸ¥ã‚‰ã›ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›',\n    'notice_content_placeholder' => 'ãŠçŸ¥ã‚‰ã›ã®å†…å®¹ã‚’å…¥åŠ›',\n    'notice_image' => 'ç”»åƒ',\n    'notice_image_help' => 'JPGã€PNGã€GIFã€WebPãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿å¯èƒ½ï¼ˆæœ€å¤§5MBï¼‰',\n    'notice_pin' => 'ãƒˆãƒƒãƒ—ã«å›ºå®š',\n    'notice_unpin' => 'å›ºå®šè§£é™¤',\n    'notice_create' => 'ãŠçŸ¥ã‚‰ã›ä½œæˆ',\n    'create_notice' => 'æ–°ã—ã„ãŠçŸ¥ã‚‰ã›ã‚’ä½œæˆ',\n    'existing_notices' => 'æ—¢å­˜ã®ãŠçŸ¥ã‚‰ã›',\n    'edit_notice' => 'ãŠçŸ¥ã‚‰ã›ç·¨é›†',\n    'current_image' => 'ç¾åœ¨ã®ç”»åƒ',\n    'no_current_image' => 'ç¾åœ¨ã®ç”»åƒãŒã‚ã‚Šã¾ã›ã‚“',\n    'notice_delete_confirm' => 'ã“ã®ãŠçŸ¥ã‚‰ã›ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ',\n    'view_all_notices' => 'ã™ã¹ã¦ã®ãŠçŸ¥ã‚‰ã›ã‚’è¡¨ç¤º',\n];","size_bytes":5924},"lang/ko.php":{"content":"<?php\n// í•œêµ­ì–´ ë²ˆì—­\nreturn [\n    // ë„¤ë¹„ê²Œì´ì…˜\n    'nav_dashboard' => 'ëŒ€ì‹œë³´ë“œ',\n    'nav_competitions' => 'ëŒ€íšŒ',\n    'nav_results' => 'ê²°ê³¼',\n    'nav_management' => 'ê´€ë¦¬',\n    'nav_notices' => 'ê³µì§€ì‚¬í•­',\n    \n    // í—¤ë”\n    'site_title' => 'DanceOffice - êµ­ì œ ëŒ„ìŠ¤ìŠ¤í¬ì¸  ëŒ€íšŒ ê´€ë¦¬ ì‹œìŠ¤í…œ',\n    'hero_title' => 'DanceOffice',\n    'hero_subtitle' => 'êµ­ì œ ëŒ„ìŠ¤ìŠ¤í¬ì¸  ëŒ€íšŒ ê´€ë¦¬ ì‹œìŠ¤í…œ',\n    'hero_description' => 'ì „ ì„¸ê³„ ëŒ„ìŠ¤ ëŒ€íšŒë¥¼ ìœ„í•œ ì „ë¬¸ ì±„ì  í”Œë«í¼',\n    \n    // í†µê³„\n    'stat_total_competitions' => 'ì´ ëŒ€íšŒ ìˆ˜',\n    'stat_upcoming_events' => 'ì˜ˆì •ëœ ì´ë²¤íŠ¸',\n    'stat_completed' => 'ì™„ë£Œë¨',\n    \n    // ìœ„ì ¯ ì œëª©\n    'widget_upcoming_competitions' => 'ì˜ˆì •ëœ ëŒ€íšŒ',\n    'widget_recent_results' => 'ìµœê·¼ ê²°ê³¼',\n    'widget_announcements' => 'ê³µì§€ì‚¬í•­',\n    'widget_schedule' => 'ì¼ì •',\n    \n    // ì•¡ì…˜\n    'action_view_all' => 'ì „ì²´ ë³´ê¸°',\n    'action_manage' => 'ê´€ë¦¬',\n    'action_edit' => 'í¸ì§‘',\n    'action_new_competition' => 'ìƒˆ ëŒ€íšŒ',\n    'action_view_results' => 'ê²°ê³¼ ë³´ê¸°',\n    'action_settings' => 'ì„¤ì •',\n    \n    // ìƒíƒœ\n    'status_upcoming' => 'ì˜ˆì •ë¨',\n    'status_completed' => 'ì™„ë£Œë¨',\n    'status_ongoing' => 'ì§„í–‰ ì¤‘',\n    \n    // ë©”ì‹œì§€\n    'no_upcoming_competitions' => 'ì˜ˆì •ëœ ëŒ€íšŒê°€ ì—†ìŠµë‹ˆë‹¤',\n    'no_recent_competitions' => 'ìµœê·¼ ëŒ€íšŒê°€ ì—†ìŠµë‹ˆë‹¤',\n    'no_notices' => 'ë“±ë¡ëœ ê³µì§€ê°€ ì—†ìŠµë‹ˆë‹¤',\n    'no_schedule' => 'ë“±ë¡ëœ ëŒ€íšŒì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤',\n    \n    // ë‚ ì§œ/ì‹œê°„\n    'date_format' => 'Yë…„ mì›” dì¼',\n    'datetime_format' => 'Yë…„ mì›” dì¼ H:i',\n    \n    // ì–¸ì–´ ì„ íƒ\n    'language' => 'ì–¸ì–´',\n    'select_language' => 'ì–¸ì–´ ì„ íƒ',\n    \n    // ê´€ë¦¬ í˜ì´ì§€\n    'admin_title' => 'ê´€ë¦¬ì í˜ì´ì§€',\n    'admin_subtitle' => 'DanceOffice ê´€ë¦¬ ì‹œìŠ¤í…œ',\n    'admin_login' => 'ê´€ë¦¬ì ë¡œê·¸ì¸',\n    'admin_password' => 'ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸',\n    'admin_login_btn' => 'ë¡œê·¸ì¸',\n    'admin_password_placeholder' => 'ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”',\n    \n    // ê´€ë¦¬ ë©”ë‰´\n    'admin_nav_home' => 'ë©”ì¸ìœ¼ë¡œ',\n    'admin_nav_results' => 'ê²½ê¸° ê²°ê³¼',\n    'admin_nav_competitions' => 'ëŒ€íšŒ ê´€ë¦¬',\n    'admin_nav_judging' => 'í”„ë¦¬ìŠ¤íƒ€ì¼ ëŒ€íšŒ ì±„ì ',\n    \n    // ê³µì§€ì‚¬í•­ ê´€ë¦¬\n    'notice_management' => 'ê³µì§€ì‚¬í•­ ê´€ë¦¬',\n    'current_notice' => 'í˜„ì¬ ë“±ë¡ëœ ê³µì§€ì‚¬í•­:',\n    'notice_content' => 'ê³µì§€ì‚¬í•­ ë‚´ìš©',\n    'notice_placeholder' => 'ê³µì§€ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”',\n    'notice_save' => 'ê³µì§€ ì €ì¥',\n    'notice_delete' => 'ê³µì§€ì‚¬í•­ ì‚­ì œ',\n    'notice_delete_confirm' => 'ê³µì§€ì‚¬í•­ì„ ì‚­ì œí• ê¹Œìš”?',\n    \n    // ì¼ì • ê´€ë¦¬\n    'schedule_management' => 'ëŒ€íšŒ ì¼ì • ê´€ë¦¬',\n    'current_schedule' => 'í˜„ì¬ ë“±ë¡ëœ ëŒ€íšŒ ì¼ì •:',\n    'schedule_content' => 'ëŒ€íšŒ ì¼ì • ë‚´ìš©',\n    'schedule_placeholder' => 'ëŒ€íšŒ ì¼ì •ì„ ì…ë ¥í•˜ì„¸ìš”',\n    'schedule_save' => 'ì¼ì • ì €ì¥',\n    'schedule_delete' => 'ëŒ€íšŒì¼ì • ì‚­ì œ',\n    'schedule_delete_confirm' => 'ëŒ€íšŒì¼ì •ì„ ì‚­ì œí• ê¹Œìš”?',\n    \n    // ê´‘ê³  ë°°ë„ˆ ê´€ë¦¬\n    'banner_management' => 'ê´‘ê³  ë°°ë„ˆ ê´€ë¦¬',\n    'banner_top' => 'ìƒë‹¨',\n    'banner_bottom' => 'í•˜ë‹¨',\n    'banner_left' => 'ì¢Œì¸¡',\n    'banner_right' => 'ìš°ì¸¡',\n    'banner_main' => 'ë©”ì¸',\n    'banner_recommended_size' => 'ê¶Œì¥',\n    'banner_upload' => 'ì´ë¯¸ì§€ ì—…ë¡œë“œ',\n    'banner_link' => 'ë°°ë„ˆ ë§í¬ (URL)',\n    'banner_link_placeholder' => 'ë°°ë„ˆ ë§í¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”',\n    'banner_upload_save' => 'ì—…ë¡œë“œ/ë§í¬ ì €ì¥',\n    'banner_image_delete' => 'ì´ë¯¸ì§€ ì‚­ì œ',\n    'banner_link_delete' => 'ë§í¬ ì‚­ì œ',\n    'banner_view_link' => 'ë§í¬ë¡œ ì´ë™',\n    'banner_current_link' => 'í˜„ì¬ ë§í¬:',\n    'banner_delete_image_confirm' => 'ì´ë¯¸ì§€ë¥¼ ì‚­ì œí• ê¹Œìš”?',\n    'banner_delete_link_confirm' => 'ë§í¬ íŒŒì¼ì„ ì‚­ì œí• ê¹Œìš”?',\n    \n    // ë°°ë„ˆ ì„¤ëª…\n    'banner_top_desc' => 'ìƒë‹¨ ê°€ë¡œ ë°°ë„ˆ (PC/ëª¨ë°”ì¼ ëª¨ë‘ ë…¸ì¶œ)',\n    'banner_bottom_desc' => 'í•˜ë‹¨ ê°€ë¡œ ë°°ë„ˆ (PC/ëª¨ë°”ì¼ ëª¨ë‘ ë…¸ì¶œ)', \n    'banner_left_desc' => 'ì¢Œì¸¡ ì„¸ë¡œ ë°°ë„ˆ (PC í™”ë©´ë§Œ ë…¸ì¶œ)',\n    'banner_right_desc' => 'ìš°ì¸¡ ì„¸ë¡œ ë°°ë„ˆ (PC í™”ë©´ë§Œ ë…¸ì¶œ)',\n    'banner_main_desc' => 'ë©”ì¸/ì´ë²¤íŠ¸ ì˜ì—­ (í¬ê¸° ê°€ë³€)',\n    \n    // ê³µí†µ\n    'or' => 'ë˜ëŠ”',\n    'total' => 'ì „ì²´',\n    'pinned' => 'ê³ ì •',\n    'updated' => 'ìˆ˜ì •ë¨',\n    'error' => 'ì˜¤ë¥˜',\n    'delete' => 'ì‚­ì œ',\n    'edit' => 'í¸ì§‘',\n    'save_changes' => 'ë³€ê²½ì‚¬í•­ ì €ì¥',\n    'cancel' => 'ì·¨ì†Œ',\n    'optional' => 'ì„ íƒì‚¬í•­',\n    \n    // ê³µì§€ì‚¬í•­ ê´€ë¦¬\n    'notice_title' => 'ì œëª©',\n    'notice_title_placeholder' => 'ê³µì§€ì‚¬í•­ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”',\n    'notice_content_placeholder' => 'ê³µì§€ì‚¬í•­ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”',\n    'notice_image' => 'ì´ë¯¸ì§€',\n    'notice_image_help' => 'JPG, PNG, GIF, WebP íŒŒì¼ë§Œ ê°€ëŠ¥ (ìµœëŒ€ 5MB)',\n    'notice_pin' => 'ìƒë‹¨ ê³ ì •',\n    'notice_unpin' => 'ê³ ì • í•´ì œ',\n    'notice_create' => 'ê³µì§€ì‚¬í•­ ì‘ì„±',\n    'create_notice' => 'ìƒˆ ê³µì§€ì‚¬í•­ ì‘ì„±',\n    'existing_notices' => 'ê¸°ì¡´ ê³µì§€ì‚¬í•­',\n    'edit_notice' => 'ê³µì§€ì‚¬í•­ í¸ì§‘',\n    'current_image' => 'í˜„ì¬ ì´ë¯¸ì§€',\n    'no_current_image' => 'í˜„ì¬ ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤',\n    'notice_delete_confirm' => 'ì´ ê³µì§€ì‚¬í•­ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?',\n    'view_all_notices' => 'ëª¨ë“  ê³µì§€ì‚¬í•­ ë³´ê¸°',\n];","size_bytes":5514},"lang/ru.php":{"content":"<?php\n// Ğ ÑƒÑÑĞºĞ¸Ğ¹ Ğ¿ĞµÑ€ĞµĞ²Ğ¾Ğ´\nreturn [\n    // ĞĞ°Ğ²Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ\n    'nav_dashboard' => 'ĞŸĞ°Ğ½ĞµĞ»ÑŒ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ',\n    'nav_competitions' => 'Ğ¡Ğ¾Ñ€ĞµĞ²Ğ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ',\n    'nav_results' => 'Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹',\n    'nav_management' => 'Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ',\n    'nav_notices' => 'ĞĞ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ñ',\n    \n    // Ğ—Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ¾Ğº\n    'site_title' => 'DanceOffice - ĞœĞµĞ¶Ğ´ÑƒĞ½Ğ°Ñ€Ğ¾Ğ´Ğ½Ğ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ñ‚Ğ°Ğ½Ñ†ĞµĞ²Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¼Ğ¸ ÑĞ¾Ñ€ĞµĞ²Ğ½Ğ¾Ğ²Ğ°Ğ½Ğ¸ÑĞ¼Ğ¸',\n    'hero_title' => 'DanceOffice',\n    'hero_subtitle' => 'ĞœĞµĞ¶Ğ´ÑƒĞ½Ğ°Ñ€Ğ¾Ğ´Ğ½Ğ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ñ‚Ğ°Ğ½Ñ†ĞµĞ²Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¼Ğ¸ ÑĞ¾Ñ€ĞµĞ²Ğ½Ğ¾Ğ²Ğ°Ğ½Ğ¸ÑĞ¼Ğ¸',\n    'hero_description' => 'ĞŸÑ€Ğ¾Ñ„ĞµÑÑĞ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼Ğ° Ğ´Ğ»Ñ ÑÑƒĞ´ĞµĞ¹ÑÑ‚Ğ²Ğ° Ñ‚Ğ°Ğ½Ñ†ĞµĞ²Ğ°Ğ»ÑŒĞ½Ñ‹Ñ… ÑĞ¾Ñ€ĞµĞ²Ğ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹ Ğ¿Ğ¾ Ğ²ÑĞµĞ¼Ñƒ Ğ¼Ğ¸Ñ€Ñƒ',\n    \n    // Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°\n    'stat_total_competitions' => 'Ğ’ÑĞµĞ³Ğ¾ ÑĞ¾Ñ€ĞµĞ²Ğ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹',\n    'stat_upcoming_events' => 'ĞŸÑ€ĞµĞ´ÑÑ‚Ğ¾ÑÑ‰Ğ¸Ğµ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ',\n    'stat_completed' => 'Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¾',\n    \n    // Ğ—Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞ¸ Ğ²Ğ¸Ğ´Ğ¶ĞµÑ‚Ğ¾Ğ²\n    'widget_upcoming_competitions' => 'ĞŸÑ€ĞµĞ´ÑÑ‚Ğ¾ÑÑ‰Ğ¸Ğµ ÑĞ¾Ñ€ĞµĞ²Ğ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ',\n    'widget_recent_results' => 'ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹',\n    'widget_announcements' => 'ĞĞ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ñ',\n    'widget_schedule' => 'Ğ Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ',\n    \n    // Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ\n    'action_view_all' => 'ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ğ²ÑĞµ',\n    'action_manage' => 'Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ',\n    'action_edit' => 'Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ',\n    'action_new_competition' => 'ĞĞ¾Ğ²Ğ¾Ğµ ÑĞ¾Ñ€ĞµĞ²Ğ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ',\n    'action_view_results' => 'ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹',\n    'action_settings' => 'ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸',\n    \n    // Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ\n    'status_upcoming' => 'ĞŸÑ€ĞµĞ´ÑÑ‚Ğ¾ÑÑ‰Ğ¸Ğ¹',\n    'status_completed' => 'Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½',\n    'status_ongoing' => 'Ğ’ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞµ',\n    \n    // Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ\n    'no_upcoming_competitions' => 'ĞĞµÑ‚ Ğ·Ğ°Ğ¿Ğ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ñ… ÑĞ¾Ñ€ĞµĞ²Ğ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹',\n    'no_recent_competitions' => 'ĞĞµÑ‚ Ğ½ĞµĞ´Ğ°Ğ²Ğ½Ğ¸Ñ… ÑĞ¾Ñ€ĞµĞ²Ğ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹',\n    'no_notices' => 'ĞĞµÑ‚ Ğ·Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ğ¹',\n    'no_schedule' => 'ĞĞµÑ‚ Ğ·Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ñ ÑĞ¾Ñ€ĞµĞ²Ğ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹',\n    \n    // Ğ”Ğ°Ñ‚Ğ°/Ğ²Ñ€ĞµĞ¼Ñ\n    'date_format' => 'd.m.Y',\n    'datetime_format' => 'd.m.Y H:i',\n    \n    // Ğ’Ñ‹Ğ±Ğ¾Ñ€ ÑĞ·Ñ‹ĞºĞ°\n    'language' => 'Ğ¯Ğ·Ñ‹Ğº',\n    'select_language' => 'Ğ’Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ ÑĞ·Ñ‹Ğº',\n    \n    // Ğ¡Ñ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ°\n    'admin_title' => 'ĞŸĞ°Ğ½ĞµĞ»ÑŒ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ°',\n    'admin_subtitle' => 'Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ DanceOffice',\n    'admin_login' => 'Ğ’Ñ…Ğ¾Ğ´ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ°',\n    'admin_password' => 'ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ°',\n    'admin_login_btn' => 'Ğ’Ğ¾Ğ¹Ñ‚Ğ¸',\n    'admin_password_placeholder' => 'Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ',\n    \n    // ĞĞ°Ğ²Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ°\n    'admin_nav_home' => 'Ğ’ĞµÑ€Ğ½ÑƒÑ‚ÑŒÑÑ Ğ½Ğ° Ğ³Ğ»Ğ°Ğ²Ğ½ÑƒÑ',\n    'admin_nav_results' => 'Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ ÑĞ¾Ñ€ĞµĞ²Ğ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹',\n    'admin_nav_competitions' => 'Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑĞ¾Ñ€ĞµĞ²Ğ½Ğ¾Ğ²Ğ°Ğ½Ğ¸ÑĞ¼Ğ¸',\n    'admin_nav_judging' => 'ĞÑ†ĞµĞ½ĞºĞ° Ñ„Ñ€Ğ¸ÑÑ‚Ğ°Ğ¹Ğ» ÑĞ¾Ñ€ĞµĞ²Ğ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹',\n    \n    // Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸ÑĞ¼Ğ¸\n    'notice_management' => 'Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸ÑĞ¼Ğ¸',\n    'current_notice' => 'Ğ¢ĞµĞºÑƒÑ‰ĞµĞµ Ğ·Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğµ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ğµ:',\n    'notice_content' => 'Ğ¡Ğ¾Ğ´ĞµÑ€Ğ¶Ğ°Ğ½Ğ¸Ğµ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ñ',\n    'notice_placeholder' => 'Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ğ½Ğ¸Ğµ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ñ',\n    'notice_save' => 'Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ğµ',\n    'notice_delete' => 'Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ğµ',\n    'notice_delete_confirm' => 'Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ¾ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ğµ?',\n    \n    // Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸ĞµĞ¼\n    'schedule_management' => 'Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸ĞµĞ¼ ÑĞ¾Ñ€ĞµĞ²Ğ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹',\n    'current_schedule' => 'Ğ¢ĞµĞºÑƒÑ‰ĞµĞµ Ğ·Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğµ Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ:',\n    'schedule_content' => 'Ğ¡Ğ¾Ğ´ĞµÑ€Ğ¶Ğ°Ğ½Ğ¸Ğµ Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ñ',\n    'schedule_placeholder' => 'Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ ÑĞ¾Ñ€ĞµĞ²Ğ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹',\n    'schedule_save' => 'Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ',\n    'schedule_delete' => 'Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ',\n    'schedule_delete_confirm' => 'Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ¾ Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ?',\n    \n    // Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ±Ğ°Ğ½Ğ½ĞµÑ€Ğ°Ğ¼Ğ¸\n    'banner_management' => 'Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ€ĞµĞºĞ»Ğ°Ğ¼Ğ½Ñ‹Ğ¼Ğ¸ Ğ±Ğ°Ğ½Ğ½ĞµÑ€Ğ°Ğ¼Ğ¸',\n    'banner_top' => 'Ğ’Ğ²ĞµÑ€Ñ…Ñƒ',\n    'banner_bottom' => 'Ğ’Ğ½Ğ¸Ğ·Ñƒ',\n    'banner_left' => 'Ğ¡Ğ»ĞµĞ²Ğ°',\n    'banner_right' => 'Ğ¡Ğ¿Ñ€Ğ°Ğ²Ğ°',\n    'banner_main' => 'ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹',\n    'banner_recommended_size' => 'Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµĞ¼Ñ‹Ğ¹',\n    'banner_upload' => 'Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ',\n    'banner_link' => 'Ğ¡ÑÑ‹Ğ»ĞºĞ° Ğ±Ğ°Ğ½Ğ½ĞµÑ€Ğ° (URL)',\n    'banner_link_placeholder' => 'Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ ÑÑÑ‹Ğ»ĞºÑƒ Ğ±Ğ°Ğ½Ğ½ĞµÑ€Ğ°',\n    'banner_upload_save' => 'Ğ—Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚ÑŒ/Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ ÑÑÑ‹Ğ»ĞºÑƒ',\n    'banner_image_delete' => 'Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ',\n    'banner_link_delete' => 'Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ ÑÑÑ‹Ğ»ĞºÑƒ',\n    'banner_view_link' => 'ĞŸĞµÑ€ĞµĞ¹Ñ‚Ğ¸ Ğ¿Ğ¾ ÑÑÑ‹Ğ»ĞºĞµ',\n    'banner_current_link' => 'Ğ¢ĞµĞºÑƒÑ‰Ğ°Ñ ÑÑÑ‹Ğ»ĞºĞ°:',\n    'banner_delete_image_confirm' => 'Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ¾ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ?',\n    'banner_delete_link_confirm' => 'Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ¾Ñ‚ Ñ„Ğ°Ğ¹Ğ» ÑÑÑ‹Ğ»ĞºĞ¸?',\n    \n    // ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ñ Ğ±Ğ°Ğ½Ğ½ĞµÑ€Ğ¾Ğ²\n    'banner_top_desc' => 'Ğ’ĞµÑ€Ñ…Ğ½Ğ¸Ğ¹ Ğ³Ğ¾Ñ€Ğ¸Ğ·Ğ¾Ğ½Ñ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ±Ğ°Ğ½Ğ½ĞµÑ€ (Ğ²Ğ¸Ğ´Ğ¸Ğ¼Ñ‹Ğ¹ Ğ½Ğ° ĞŸĞš/Ğ¼Ğ¾Ğ±Ğ¸Ğ»ÑŒĞ½Ñ‹Ñ…)',\n    'banner_bottom_desc' => 'ĞĞ¸Ğ¶Ğ½Ğ¸Ğ¹ Ğ³Ğ¾Ñ€Ğ¸Ğ·Ğ¾Ğ½Ñ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ±Ğ°Ğ½Ğ½ĞµÑ€ (Ğ²Ğ¸Ğ´Ğ¸Ğ¼Ñ‹Ğ¹ Ğ½Ğ° ĞŸĞš/Ğ¼Ğ¾Ğ±Ğ¸Ğ»ÑŒĞ½Ñ‹Ñ…)',\n    'banner_left_desc' => 'Ğ›ĞµĞ²Ñ‹Ğ¹ Ğ²ĞµÑ€Ñ‚Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ±Ğ°Ğ½Ğ½ĞµÑ€ (Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ĞŸĞš ÑĞºÑ€Ğ°Ğ½)',\n    'banner_right_desc' => 'ĞŸÑ€Ğ°Ğ²Ñ‹Ğ¹ Ğ²ĞµÑ€Ñ‚Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ±Ğ°Ğ½Ğ½ĞµÑ€ (Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ĞŸĞš ÑĞºÑ€Ğ°Ğ½)',\n    'banner_main_desc' => 'ĞÑĞ½Ğ¾Ğ²Ğ½Ğ°Ñ/ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹Ğ½Ğ°Ñ Ğ¾Ğ±Ğ»Ğ°ÑÑ‚ÑŒ (Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğ¹ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€)',\n    \n    // ĞĞ±Ñ‰Ğ¸Ğµ\n    'or' => 'Ğ¸Ğ»Ğ¸',\n    'total' => 'Ğ’ÑĞµĞ³Ğ¾',\n    'pinned' => 'Ğ—Ğ°ĞºÑ€ĞµĞ¿Ğ»ĞµĞ½Ğ¾',\n    'updated' => 'ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¾',\n    'error' => 'ĞÑˆĞ¸Ğ±ĞºĞ°',\n    'delete' => 'Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ',\n    'edit' => 'Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ',\n    'save_changes' => 'Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ',\n    'cancel' => 'ĞÑ‚Ğ¼ĞµĞ½Ğ°',\n    'optional' => 'ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾',\n    \n    // Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸ÑĞ¼Ğ¸\n    'notice_title' => 'Ğ—Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ¾Ğº',\n    'notice_title_placeholder' => 'Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ¾Ğº Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ñ',\n    'notice_content_placeholder' => 'Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ğ½Ğ¸Ğµ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ñ',\n    'notice_image' => 'Ğ˜Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ',\n    'notice_image_help' => 'Ğ Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ñ‹ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ„Ğ°Ğ¹Ğ»Ñ‹ JPG, PNG, GIF, WebP (Ğ¼Ğ°ĞºÑ. 5ĞœĞ‘)',\n    'notice_pin' => 'Ğ—Ğ°ĞºÑ€ĞµĞ¿Ğ¸Ñ‚ÑŒ Ğ²Ğ²ĞµÑ€Ñ…Ñƒ',\n    'notice_unpin' => 'ĞÑ‚ĞºÑ€ĞµĞ¿Ğ¸Ñ‚ÑŒ',\n    'notice_create' => 'Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ğµ',\n    'create_notice' => 'Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ğ¾Ğµ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ğµ',\n    'existing_notices' => 'Ğ¡ÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğµ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ñ',\n    'edit_notice' => 'Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ğµ',\n    'current_image' => 'Ğ¢ĞµĞºÑƒÑ‰ĞµĞµ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ',\n    'no_current_image' => 'ĞĞµÑ‚ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ³Ğ¾ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ',\n    'notice_delete_confirm' => 'Ğ’Ñ‹ ÑƒĞ²ĞµÑ€ĞµĞ½Ñ‹, Ñ‡Ñ‚Ğ¾ Ñ…Ğ¾Ñ‚Ğ¸Ñ‚Ğµ ÑƒĞ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ¾ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ğµ?',\n    'view_all_notices' => 'ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ğ²ÑĞµ Ğ¾Ğ±ÑŠÑĞ²Ğ»ĞµĞ½Ğ¸Ñ',\n];","size_bytes":7949},"lang/zh.php":{"content":"<?php\n// ä¸­æ–‡ç¿»è¯‘\nreturn [\n    // å¯¼èˆª\n    'nav_dashboard' => 'ä»ªè¡¨æ¿',\n    'nav_competitions' => 'æ¯”èµ›',\n    'nav_results' => 'ç»“æœ',\n    'nav_management' => 'ç®¡ç†',\n    'nav_notices' => 'å…¬å‘Š',\n    \n    // æ ‡é¢˜\n    'site_title' => 'DanceOffice - å›½é™…ä½“è‚²èˆè¹ˆæ¯”èµ›ç®¡ç†ç³»ç»Ÿ',\n    'hero_title' => 'DanceOffice',\n    'hero_subtitle' => 'å›½é™…ä½“è‚²èˆè¹ˆæ¯”èµ›ç®¡ç†ç³»ç»Ÿ',\n    'hero_description' => 'å…¨çƒèˆè¹ˆæ¯”èµ›ä¸“ä¸šè¯„å®¡å¹³å°',\n    \n    // ç»Ÿè®¡\n    'stat_total_competitions' => 'æ¯”èµ›æ€»æ•°',\n    'stat_upcoming_events' => 'å³å°†ä¸¾è¡Œ',\n    'stat_completed' => 'å·²å®Œæˆ',\n    \n    // å°éƒ¨ä»¶æ ‡é¢˜\n    'widget_upcoming_competitions' => 'å³å°†ä¸¾è¡Œçš„æ¯”èµ›',\n    'widget_recent_results' => 'æœ€è¿‘ç»“æœ',\n    'widget_announcements' => 'å…¬å‘Š',\n    'widget_schedule' => 'æ—¥ç¨‹',\n    \n    // æ“ä½œ\n    'action_view_all' => 'æŸ¥çœ‹å…¨éƒ¨',\n    'action_manage' => 'ç®¡ç†',\n    'action_edit' => 'ç¼–è¾‘',\n    'action_new_competition' => 'æ–°å»ºæ¯”èµ›',\n    'action_view_results' => 'æŸ¥çœ‹ç»“æœ',\n    'action_settings' => 'è®¾ç½®',\n    \n    // çŠ¶æ€\n    'status_upcoming' => 'å³å°†ä¸¾è¡Œ',\n    'status_completed' => 'å·²å®Œæˆ',\n    'status_ongoing' => 'è¿›è¡Œä¸­',\n    \n    // æ¶ˆæ¯\n    'no_upcoming_competitions' => 'æ²¡æœ‰å³å°†ä¸¾è¡Œçš„æ¯”èµ›',\n    'no_recent_competitions' => 'æ²¡æœ‰æœ€è¿‘çš„æ¯”èµ›',\n    'no_notices' => 'æ²¡æœ‰æ³¨å†Œçš„å…¬å‘Š',\n    'no_schedule' => 'æ²¡æœ‰æ³¨å†Œçš„æ¯”èµ›æ—¥ç¨‹',\n    \n    // æ—¥æœŸ/æ—¶é—´\n    'date_format' => 'Yå¹´mæœˆdæ—¥',\n    'datetime_format' => 'Yå¹´mæœˆdæ—¥ H:i',\n    \n    // è¯­è¨€é€‰æ‹©\n    'language' => 'è¯­è¨€',\n    'select_language' => 'é€‰æ‹©è¯­è¨€',\n    \n    // ç®¡ç†å‘˜é¡µé¢\n    'admin_title' => 'ç®¡ç†å‘˜é¢æ¿',\n    'admin_subtitle' => 'DanceOfficeç®¡ç†ç³»ç»Ÿ',\n    'admin_login' => 'ç®¡ç†å‘˜ç™»å½•',\n    'admin_password' => 'ç®¡ç†å‘˜å¯†ç ',\n    'admin_login_btn' => 'ç™»å½•',\n    'admin_password_placeholder' => 'è¯·è¾“å…¥å¯†ç ',\n    \n    // ç®¡ç†å¯¼èˆª\n    'admin_nav_home' => 'è¿”å›ä¸»é¡µ',\n    'admin_nav_results' => 'æ¯”èµ›ç»“æœ',\n    'admin_nav_competitions' => 'æ¯”èµ›ç®¡ç†',\n    'admin_nav_judging' => 'è‡ªç”±å¼æ¯”èµ›è¯„åˆ†',\n    \n    // å…¬å‘Šç®¡ç†\n    'notice_management' => 'å…¬å‘Šç®¡ç†',\n    'current_notice' => 'å½“å‰æ³¨å†Œçš„å…¬å‘Š:',\n    'notice_content' => 'å…¬å‘Šå†…å®¹',\n    'notice_placeholder' => 'è¯·è¾“å…¥å…¬å‘Šå†…å®¹',\n    'notice_save' => 'ä¿å­˜å…¬å‘Š',\n    'notice_delete' => 'åˆ é™¤å…¬å‘Š',\n    'notice_delete_confirm' => 'åˆ é™¤æ­¤å…¬å‘Šå—ï¼Ÿ',\n    \n    // æ—¥ç¨‹ç®¡ç†\n    'schedule_management' => 'æ¯”èµ›æ—¥ç¨‹ç®¡ç†',\n    'current_schedule' => 'å½“å‰æ³¨å†Œçš„æ¯”èµ›æ—¥ç¨‹:',\n    'schedule_content' => 'æ¯”èµ›æ—¥ç¨‹å†…å®¹',\n    'schedule_placeholder' => 'è¯·è¾“å…¥æ¯”èµ›æ—¥ç¨‹',\n    'schedule_save' => 'ä¿å­˜æ—¥ç¨‹',\n    'schedule_delete' => 'åˆ é™¤æ—¥ç¨‹',\n    'schedule_delete_confirm' => 'åˆ é™¤æ­¤æ—¥ç¨‹å—ï¼Ÿ',\n    \n    // æ¨ªå¹…ç®¡ç†\n    'banner_management' => 'å¹¿å‘Šæ¨ªå¹…ç®¡ç†',\n    'banner_top' => 'é¡¶éƒ¨',\n    'banner_bottom' => 'åº•éƒ¨',\n    'banner_left' => 'å·¦ä¾§',\n    'banner_right' => 'å³ä¾§',\n    'banner_main' => 'ä¸»è¦',\n    'banner_recommended_size' => 'æ¨è',\n    'banner_upload' => 'å›¾ç‰‡ä¸Šä¼ ',\n    'banner_link' => 'æ¨ªå¹…é“¾æ¥ (URL)',\n    'banner_link_placeholder' => 'è¯·è¾“å…¥æ¨ªå¹…é“¾æ¥',\n    'banner_upload_save' => 'ä¸Šä¼ /ä¿å­˜é“¾æ¥',\n    'banner_image_delete' => 'åˆ é™¤å›¾ç‰‡',\n    'banner_link_delete' => 'åˆ é™¤é“¾æ¥',\n    'banner_view_link' => 'è®¿é—®é“¾æ¥',\n    'banner_current_link' => 'å½“å‰é“¾æ¥:',\n    'banner_delete_image_confirm' => 'åˆ é™¤æ­¤å›¾ç‰‡å—ï¼Ÿ',\n    'banner_delete_link_confirm' => 'åˆ é™¤æ­¤é“¾æ¥æ–‡ä»¶å—ï¼Ÿ',\n    \n    // æ¨ªå¹…è¯´æ˜\n    'banner_top_desc' => 'é¡¶éƒ¨æ¨ªå‘æ¨ªå¹…ï¼ˆPC/ç§»åŠ¨è®¾å¤‡å¯è§ï¼‰',\n    'banner_bottom_desc' => 'åº•éƒ¨æ¨ªå‘æ¨ªå¹…ï¼ˆPC/ç§»åŠ¨è®¾å¤‡å¯è§ï¼‰',\n    'banner_left_desc' => 'å·¦ä¾§å‚ç›´æ¨ªå¹…ï¼ˆä»…PCå±å¹•å¯è§ï¼‰',\n    'banner_right_desc' => 'å³ä¾§å‚ç›´æ¨ªå¹…ï¼ˆä»…PCå±å¹•å¯è§ï¼‰',\n    'banner_main_desc' => 'ä¸»è¦/æ´»åŠ¨åŒºåŸŸï¼ˆå¯å˜å¤§å°ï¼‰',\n    \n    // å…¬å…±\n    'or' => 'æˆ–',\n    'total' => 'æ€»è®¡',\n    'pinned' => 'ç½®é¡¶',\n    'updated' => 'å·²æ›´æ–°',\n    'error' => 'é”™è¯¯',\n    'delete' => 'åˆ é™¤',\n    'edit' => 'ç¼–è¾‘',\n    'save_changes' => 'ä¿å­˜æ›´æ”¹',\n    'cancel' => 'å–æ¶ˆ',\n    'optional' => 'å¯é€‰',\n    \n    // å…¬å‘Šç®¡ç†\n    'notice_title' => 'æ ‡é¢˜',\n    'notice_title_placeholder' => 'è¯·è¾“å…¥å…¬å‘Šæ ‡é¢˜',\n    'notice_content_placeholder' => 'è¯·è¾“å…¥å…¬å‘Šå†…å®¹',\n    'notice_image' => 'å›¾ç‰‡',\n    'notice_image_help' => 'ä»…å…è®¸JPGã€PNGã€GIFã€WebPæ–‡ä»¶ï¼ˆæœ€å¤§5MBï¼‰',\n    'notice_pin' => 'ç½®é¡¶',\n    'notice_unpin' => 'å–æ¶ˆç½®é¡¶',\n    'notice_create' => 'åˆ›å»ºå…¬å‘Š',\n    'create_notice' => 'åˆ›å»ºæ–°å…¬å‘Š',\n    'existing_notices' => 'ç°æœ‰å…¬å‘Š',\n    'edit_notice' => 'ç¼–è¾‘å…¬å‘Š',\n    'current_image' => 'å½“å‰å›¾ç‰‡',\n    'no_current_image' => 'å½“å‰æ²¡æœ‰å›¾ç‰‡',\n    'notice_delete_confirm' => 'ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå…¬å‘Šå—ï¼Ÿ',\n    'view_all_notices' => 'æŸ¥çœ‹æ‰€æœ‰å…¬å‘Š',\n];","size_bytes":5048},"replit.md":{"content":"# Overview\n\nDanceOffice is a comprehensive dance sport competition management system that integrates with DanceScore to provide seamless tournament organization and result presentation. The system serves as a unified platform for managing competitions, displaying real-time results, and providing intuitive navigation for participants and spectators.\n\n# User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n# System Architecture\n\n## Frontend Architecture\nThe system uses a responsive web design with distinct layouts for desktop and mobile:\n- **Desktop Layout**: Three-column structure with left navigation, main content area, and right sidebar for advertisements\n- **Mobile Layout**: Header navigation, main content, and bottom navigation bar\n- **CSS Framework**: Custom CSS using Grid and Flexbox for responsive design\n- **Typography**: Google Fonts (Noto Sans KR) for Korean language support\n- **Icons**: Material Symbols for consistent iconography\n\n## Backend Architecture\n- **Server Technology**: PHP 7.4+ with file-based data storage\n- **Data Storage**: JSON files for competition data and text files for configuration\n- **Session Management**: PHP sessions for user state management\n- **File Processing**: Automated synchronization with DanceScore results\n\n## Competition Management System\n- **Scheduler System**: Unified scheduler that integrates both DanceScore and internal system results\n- **Competition States**: Automatic state management (upcoming, ongoing, completed)\n- **Result Integration**: Real-time monitoring and processing of DanceScore output files\n- **Content Management**: JSON-based flexible competition information storage\n\n## Real-time Result Monitoring\n- **File Watcher**: Continuous monitoring of DanceScore result directories (C:\\dancescore\\Web)\n- **Result Processing**: Automatic combination of summary and detailed result files\n- **Live Display**: Full-screen monitoring system with 30-second auto-refresh\n- **Event Control**: Real-time event status and result announcement control\n\n## Data Processing Pipeline\n- **Text Processing**: Regular expression-based content replacement for Korean localization\n- **File Synchronization**: Automated copying and conversion from DanceScore to web directory\n- **Content Filtering**: Removal of copyrighted content and branding elements\n- **Link Management**: Dynamic URL rewriting for proper navigation\n\n## User Interface Components\n- **Card-based Design**: Modern card layout for competition listings\n- **Timeline View**: Chronological display of competition history\n- **Weekly Status**: Clear distinction between past, current, and upcoming week competitions\n- **Responsive Tables**: Mobile-optimized result display tables\n\n# External Dependencies\n\n## DanceScore Integration\n- **Primary Dependency**: DanceScore competition management software\n- **File Locations**: C:\\dancescore\\Web for results, C:\\dancescore\\Recall for recall data\n- **File Formats**: HTML files with numeric naming convention (e.g., 1.html, 1-d.html)\n- **Synchronization**: Real-time file monitoring and processing\n\n## Web Technologies\n- **Google Fonts API**: For Noto Sans KR and Material Symbols\n- **Frontend Libraries**: No external JavaScript frameworks (vanilla JS approach)\n- **Image Processing**: PIL (Python Imaging Library) for logo generation\n\n## File System Dependencies\n- **Network Drive**: Y: drive mapping for shared file access\n- **Directory Structure**: Specific folder organization for results, assets, and data\n- **File Permissions**: Read/write access to competition directories\n\n## Development Tools\n- **Python Scripts**: For logo generation and file synchronization\n- **Batch Scripts**: Windows automation for monitoring processes\n- **Text Processing**: Regular expressions for content localization\n\n## Server Requirements\n- **Web Server**: Apache or IIS with PHP support\n- **File System**: Windows-based file paths and drive mappings\n- **Network Access**: Shared drive connectivity for DanceScore integration","size_bytes":3998},"competition.php":{"content":"<?php\nsession_start();\n\n// ë‹¤êµ­ì–´ ì‹œìŠ¤í…œ ë¡œë“œ\nrequire_once __DIR__ . '/lang/Language.php';\n$lang = Language::getInstance();\n\n// ëŒ€íšŒ ìŠ¤ì¼€ì¤„ëŸ¬ ë¡œë“œ\nrequire_once __DIR__ . '/data/scheduler.php';\n$scheduler = new CompetitionScheduler();\n\n// URLì—ì„œ ëŒ€íšŒ ID ê°€ì ¸ì˜¤ê¸°\n$comp_id = $_GET['id'] ?? '';\n$page = $_GET['page'] ?? 'main';\n\nif (!$comp_id) {\n    header('Location: /');\n    exit;\n}\n\n// ëŒ€íšŒ ì •ë³´ ê°€ì ¸ì˜¤ê¸°\n$competition = $scheduler->getCompetitionById($comp_id);\nif (!$competition) {\n    header('Location: /');\n    exit;\n}\n\n// ëŒ€íšŒë³„ ê¸°ëŠ¥ í•¨ìˆ˜ë“¤\nfunction getCompetitionNotices($comp_data_path) {\n    if (!$comp_data_path) return [];\n    \n    $notices_file = $comp_data_path . '/notices.json';\n    if (file_exists($notices_file)) {\n        return json_decode(file_get_contents($notices_file), true) ?: [];\n    }\n    return [];\n}\n\nfunction getCompetitionSchedule($comp_data_path) {\n    if (!$comp_data_path) return [];\n    \n    $schedule_file = $comp_data_path . '/schedule.json';\n    if (file_exists($schedule_file)) {\n        return json_decode(file_get_contents($schedule_file), true) ?: [];\n    }\n    return [];\n}\n\nfunction getCompetitionResults($comp_data_path) {\n    if (!$comp_data_path) return [];\n    \n    $results_file = $comp_data_path . '/results.json';\n    if (file_exists($results_file)) {\n        return json_decode(file_get_contents($results_file), true) ?: [];\n    }\n    return [];\n}\n\n// ëŒ€íšŒ ë°ì´í„° ë””ë ‰í† ë¦¬ ê²½ë¡œ\n$comp_data_path = isset($competition['comp_data_path']) ? $competition['comp_data_path'] : null;\n\n// í˜ì´ì§€ë³„ ë°ì´í„° ë¡œë“œ\n$notices = getCompetitionNotices($comp_data_path);\n$schedule = getCompetitionSchedule($comp_data_path);\n$results = getCompetitionResults($comp_data_path);\n\n?>\n<!DOCTYPE html>\n<html lang=\"<?= $lang->getCurrentLang() ?>\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title><?= htmlspecialchars($competition['title']) ?> | DanceOffice</title>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0\" rel=\"stylesheet\">\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        body {\n            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\n            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);\n            color: #e2e8f0;\n            min-height: 100vh;\n        }\n\n        .container {\n            max-width: 1200px;\n            margin: 0 auto;\n            padding: 20px;\n        }\n\n        /* ìƒë‹¨ í—¤ë” */\n        .comp-header {\n            background: rgba(30, 41, 59, 0.8);\n            backdrop-filter: blur(20px);\n            border: 1px solid rgba(59, 130, 246, 0.2);\n            border-radius: 20px;\n            padding: 32px;\n            margin-bottom: 32px;\n            text-align: center;\n            position: relative;\n            overflow: hidden;\n        }\n\n        .comp-header::before {\n            content: '';\n            position: absolute;\n            top: 0;\n            left: 0;\n            right: 0;\n            bottom: 0;\n            background: radial-gradient(circle at 30% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%);\n            pointer-events: none;\n        }\n\n        .comp-header-content {\n            position: relative;\n            z-index: 2;\n        }\n\n        .comp-title {\n            font-size: 32px;\n            font-weight: 700;\n            color: #f1f5f9;\n            margin-bottom: 16px;\n        }\n\n        .comp-info {\n            display: flex;\n            justify-content: center;\n            gap: 32px;\n            margin-top: 24px;\n            flex-wrap: wrap;\n        }\n\n        .comp-info-item {\n            display: flex;\n            align-items: center;\n            gap: 8px;\n            color: #94a3b8;\n            font-size: 14px;\n        }\n\n        .comp-info-item .material-symbols-rounded {\n            color: #3b82f6;\n            font-size: 20px;\n        }\n\n        /* ë„¤ë¹„ê²Œì´ì…˜ íƒ­ */\n        .comp-nav {\n            background: rgba(30, 41, 59, 0.6);\n            border: 1px solid rgba(59, 130, 246, 0.2);\n            border-radius: 16px;\n            padding: 8px;\n            margin-bottom: 32px;\n            display: flex;\n            gap: 8px;\n            overflow-x: auto;\n        }\n\n        .comp-nav-item {\n            padding: 12px 24px;\n            border-radius: 12px;\n            text-decoration: none;\n            color: #94a3b8;\n            font-weight: 500;\n            transition: all 0.3s ease;\n            white-space: nowrap;\n            display: flex;\n            align-items: center;\n            gap: 8px;\n        }\n\n        .comp-nav-item:hover {\n            background: rgba(59, 130, 246, 0.1);\n            color: #3b82f6;\n        }\n\n        .comp-nav-item.active {\n            background: #3b82f6;\n            color: white;\n        }\n\n        /* ì»¨í…ì¸  ì„¹ì…˜ */\n        .comp-content {\n            background: rgba(30, 41, 59, 0.6);\n            backdrop-filter: blur(20px);\n            border: 1px solid rgba(59, 130, 246, 0.2);\n            border-radius: 20px;\n            padding: 32px;\n            min-height: 400px;\n        }\n\n        .section-title {\n            font-size: 24px;\n            font-weight: 600;\n            color: #f1f5f9;\n            margin-bottom: 24px;\n            display: flex;\n            align-items: center;\n            gap: 12px;\n        }\n\n        .section-title .material-symbols-rounded {\n            color: #3b82f6;\n            font-size: 28px;\n        }\n\n        /* ëŒ€íšŒ ê°œìš” ìŠ¤íƒ€ì¼ */\n        .comp-overview {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n            gap: 24px;\n        }\n\n        .overview-card {\n            background: rgba(15, 23, 42, 0.6);\n            border: 1px solid rgba(59, 130, 246, 0.1);\n            border-radius: 16px;\n            padding: 24px;\n        }\n\n        .overview-card h3 {\n            color: #3b82f6;\n            font-size: 18px;\n            margin-bottom: 16px;\n            display: flex;\n            align-items: center;\n            gap: 8px;\n        }\n\n        .overview-card p {\n            color: #94a3b8;\n            line-height: 1.6;\n        }\n\n        /* ê³µì§€ì‚¬í•­/ì¼ì • ëª©ë¡ ìŠ¤íƒ€ì¼ */\n        .item-list {\n            space-y: 16px;\n        }\n\n        .item-card {\n            background: rgba(15, 23, 42, 0.6);\n            border: 1px solid rgba(59, 130, 246, 0.1);\n            border-radius: 16px;\n            padding: 20px;\n            margin-bottom: 16px;\n        }\n\n        .item-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 12px;\n        }\n\n        .item-title {\n            font-size: 16px;\n            font-weight: 600;\n            color: #f1f5f9;\n        }\n\n        .item-date {\n            font-size: 12px;\n            color: #64748b;\n            background: rgba(59, 130, 246, 0.1);\n            padding: 4px 12px;\n            border-radius: 12px;\n        }\n\n        .item-content {\n            color: #94a3b8;\n            line-height: 1.6;\n        }\n\n        /* ë¹ˆ ìƒíƒœ */\n        .empty-state {\n            text-align: center;\n            padding: 60px 20px;\n            color: #64748b;\n        }\n\n        .empty-state .material-symbols-rounded {\n            font-size: 48px;\n            margin-bottom: 16px;\n            opacity: 0.5;\n        }\n\n        /* ë°± ë²„íŠ¼ */\n        .back-btn {\n            display: inline-flex;\n            align-items: center;\n            gap: 8px;\n            padding: 12px 24px;\n            background: rgba(59, 130, 246, 0.1);\n            color: #3b82f6;\n            text-decoration: none;\n            border-radius: 12px;\n            margin-bottom: 24px;\n            transition: all 0.3s ease;\n        }\n\n        .back-btn:hover {\n            background: rgba(59, 130, 246, 0.2);\n        }\n\n        /* ëª¨ë°”ì¼ ëŒ€ì‘ */\n        @media (max-width: 768px) {\n            .container {\n                padding: 16px;\n            }\n\n            .comp-title {\n                font-size: 24px;\n            }\n\n            .comp-info {\n                flex-direction: column;\n                gap: 16px;\n                align-items: center;\n            }\n\n            .comp-nav {\n                flex-direction: column;\n                gap: 4px;\n            }\n\n            .comp-content {\n                padding: 24px 20px;\n            }\n\n            .comp-overview {\n                grid-template-columns: 1fr;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <!-- ë°± ë²„íŠ¼ -->\n        <a href=\"/\" class=\"back-btn\">\n            <span class=\"material-symbols-rounded\">arrow_back</span>\n            <?= t('nav_dashboard') ?>\n        </a>\n\n        <!-- ëŒ€íšŒ í—¤ë” -->\n        <div class=\"comp-header\">\n            <div class=\"comp-header-content\">\n                <h1 class=\"comp-title\"><?= htmlspecialchars($competition['title']) ?></h1>\n                \n                <div class=\"comp-info\">\n                    <div class=\"comp-info-item\">\n                        <span class=\"material-symbols-rounded\">schedule</span>\n                        <?= $lang->formatDate($competition['date']) ?>\n                    </div>\n                    <div class=\"comp-info-item\">\n                        <span class=\"material-symbols-rounded\">location_on</span>\n                        <?= htmlspecialchars($competition['location']) ?>\n                    </div>\n                    <div class=\"comp-info-item\">\n                        <span class=\"material-symbols-rounded\">group</span>\n                        <?= htmlspecialchars($competition['host']) ?>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <!-- ë„¤ë¹„ê²Œì´ì…˜ íƒ­ -->\n        <nav class=\"comp-nav\">\n            <a href=\"?id=<?= $comp_id ?>&page=main\" class=\"comp-nav-item <?= $page === 'main' ? 'active' : '' ?>\">\n                <span class=\"material-symbols-rounded\">home</span>\n                ê°œìš”\n            </a>\n            <a href=\"?id=<?= $comp_id ?>&page=schedule\" class=\"comp-nav-item <?= $page === 'schedule' ? 'active' : '' ?>\">\n                <span class=\"material-symbols-rounded\">schedule</span>\n                ì‹œê°„í‘œ\n            </a>\n            <a href=\"?id=<?= $comp_id ?>&page=notices\" class=\"comp-nav-item <?= $page === 'notices' ? 'active' : '' ?>\">\n                <span class=\"material-symbols-rounded\">campaign</span>\n                ê³µì§€ì‚¬í•­\n            </a>\n            <a href=\"?id=<?= $comp_id ?>&page=results\" class=\"comp-nav-item <?= $page === 'results' ? 'active' : '' ?>\">\n                <span class=\"material-symbols-rounded\">trophy</span>\n                ì¢…í•©ê²°ê³¼\n            </a>\n            <a href=\"?id=<?= $comp_id ?>&page=live\" class=\"comp-nav-item <?= $page === 'live' ? 'active' : '' ?>\">\n                <span class=\"material-symbols-rounded\">live_tv</span>\n                ì‹¤ì‹œê°„ ê²°ê³¼\n            </a>\n        </nav>\n\n        <!-- ì»¨í…ì¸  -->\n        <div class=\"comp-content\">\n            <?php if ($page === 'main'): ?>\n                <!-- ëŒ€íšŒ ê°œìš” -->\n                <h2 class=\"section-title\">\n                    <span class=\"material-symbols-rounded\">info</span>\n                    ëŒ€íšŒ ê°œìš”\n                </h2>\n                \n                <div class=\"comp-overview\">\n                    <div class=\"overview-card\">\n                        <h3>\n                            <span class=\"material-symbols-rounded\">event</span>\n                            ëŒ€íšŒ ì •ë³´\n                        </h3>\n                        <p><strong>ëŒ€íšŒëª…:</strong> <?= htmlspecialchars($competition['title']) ?></p>\n                        <p><strong>ê°œìµœì¼:</strong> <?= $lang->formatDate($competition['date']) ?></p>\n                        <p><strong>ì¥ì†Œ:</strong> <?= htmlspecialchars($competition['location']) ?></p>\n                        <p><strong>ì£¼ìµœ:</strong> <?= htmlspecialchars($competition['host']) ?></p>\n                        <p><strong>ìƒíƒœ:</strong> \n                            <span style=\"color: <?= $competition['status'] === 'upcoming' ? '#22c55e' : ($competition['status'] === 'ongoing' ? '#f59e0b' : '#64748b') ?>\">\n                                <?= t('status_' . $competition['status']) ?>\n                            </span>\n                        </p>\n                    </div>\n                    \n                    <div class=\"overview-card\">\n                        <h3>\n                            <span class=\"material-symbols-rounded\">analytics</span>\n                            ëŒ€íšŒ í˜„í™©\n                        </h3>\n                        <p><strong>ê³µì§€ì‚¬í•­:</strong> <?= count($notices) ?>ê±´</p>\n                        <p><strong>ê²½ê¸°ì¼ì •:</strong> <?= count($schedule) ?>ê°œ ì¢…ëª©</p>\n                        <p><strong>ê²°ê³¼:</strong> <?= count($results) ?>ê°œ ì¢…ëª© ì™„ë£Œ</p>\n                        <p><strong>ìƒì„±ì¼:</strong> <?= isset($competition['created_at']) ? date('Y-m-d', strtotime($competition['created_at'])) : 'ì •ë³´ì—†ìŒ' ?></p>\n                    </div>\n                </div>\n\n            <?php elseif ($page === 'schedule'): ?>\n                <!-- ì‹œê°„í‘œ -->\n                <h2 class=\"section-title\">\n                    <span class=\"material-symbols-rounded\">schedule</span>\n                    ëŒ€íšŒ ì‹œê°„í‘œ\n                </h2>\n                \n                <?php if (empty($schedule)): ?>\n                    <div class=\"empty-state\">\n                        <div class=\"material-symbols-rounded\">schedule</div>\n                        <h3>ì‹œê°„í‘œê°€ ì•„ì§ ë“±ë¡ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤</h3>\n                        <p>ëŒ€íšŒ ì‹œê°„í‘œëŠ” ëŒ€íšŒ ê´€ë¦¬ìê°€ ë“±ë¡í•  ì˜ˆì •ì…ë‹ˆë‹¤.</p>\n                    </div>\n                <?php else: ?>\n                    <div class=\"item-list\">\n                        <?php foreach ($schedule as $item): ?>\n                            <div class=\"item-card\">\n                                <div class=\"item-header\">\n                                    <h3 class=\"item-title\"><?= htmlspecialchars($item['title'] ?? 'ê²½ê¸° ì¢…ëª©') ?></h3>\n                                    <span class=\"item-date\"><?= htmlspecialchars($item['time'] ?? '') ?></span>\n                                </div>\n                                <div class=\"item-content\">\n                                    <?= htmlspecialchars($item['description'] ?? '') ?>\n                                </div>\n                            </div>\n                        <?php endforeach; ?>\n                    </div>\n                <?php endif; ?>\n\n            <?php elseif ($page === 'notices'): ?>\n                <!-- ê³µì§€ì‚¬í•­ -->\n                <h2 class=\"section-title\">\n                    <span class=\"material-symbols-rounded\">campaign</span>\n                    ê³µì§€ì‚¬í•­\n                </h2>\n                \n                <?php if (empty($notices)): ?>\n                    <div class=\"empty-state\">\n                        <div class=\"material-symbols-rounded\">campaign</div>\n                        <h3>ê³µì§€ì‚¬í•­ì´ ì•„ì§ ë“±ë¡ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤</h3>\n                        <p>ì¤‘ìš”í•œ ê³µì§€ì‚¬í•­ì´ ìˆì„ ë•Œ ì´ê³³ì— í‘œì‹œë©ë‹ˆë‹¤.</p>\n                    </div>\n                <?php else: ?>\n                    <div class=\"item-list\">\n                        <?php foreach ($notices as $notice): ?>\n                            <div class=\"item-card\">\n                                <div class=\"item-header\">\n                                    <h3 class=\"item-title\"><?= htmlspecialchars($notice['title'] ?? 'ê³µì§€') ?></h3>\n                                    <span class=\"item-date\"><?= isset($notice['date']) ? date('Y-m-d', strtotime($notice['date'])) : '' ?></span>\n                                </div>\n                                <div class=\"item-content\">\n                                    <?= nl2br(htmlspecialchars($notice['content'] ?? '')) ?>\n                                </div>\n                            </div>\n                        <?php endforeach; ?>\n                    </div>\n                <?php endif; ?>\n\n            <?php elseif ($page === 'results'): ?>\n                <!-- ì¢…í•©ê²°ê³¼ -->\n                <h2 class=\"section-title\">\n                    <span class=\"material-symbols-rounded\">trophy</span>\n                    ì¢…í•©ê²°ê³¼\n                </h2>\n                \n                <?php if (empty($results)): ?>\n                    <div class=\"empty-state\">\n                        <div class=\"material-symbols-rounded\">trophy</div>\n                        <h3>ê²°ê³¼ê°€ ì•„ì§ ë°œí‘œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤</h3>\n                        <p>ëŒ€íšŒ ì¢…ë£Œ í›„ ê²°ê³¼ê°€ ì´ê³³ì— í‘œì‹œë©ë‹ˆë‹¤.</p>\n                    </div>\n                <?php else: ?>\n                    <div class=\"item-list\">\n                        <?php foreach ($results as $result): ?>\n                            <div class=\"item-card\">\n                                <div class=\"item-header\">\n                                    <h3 class=\"item-title\"><?= htmlspecialchars($result['category'] ?? 'ê²½ê¸° ì¢…ëª©') ?></h3>\n                                    <span class=\"item-date\">ê²°ê³¼ ë°œí‘œ</span>\n                                </div>\n                                <div class=\"item-content\">\n                                    <?= htmlspecialchars($result['summary'] ?? '') ?>\n                                </div>\n                            </div>\n                        <?php endforeach; ?>\n                    </div>\n                <?php endif; ?>\n\n            <?php elseif ($page === 'live'): ?>\n                <!-- ì‹¤ì‹œê°„ ê²°ê³¼ -->\n                <h2 class=\"section-title\">\n                    <span class=\"material-symbols-rounded\">live_tv</span>\n                    ì‹¤ì‹œê°„ ê²°ê³¼\n                </h2>\n                \n                <div class=\"empty-state\">\n                    <div class=\"material-symbols-rounded\">live_tv</div>\n                    <h3>ì‹¤ì‹œê°„ ê²°ê³¼ ì„œë¹„ìŠ¤ ì¤€ë¹„ ì¤‘</h3>\n                    <p>ëŒ€íšŒ ì§„í–‰ ì¤‘ ì‹¤ì‹œê°„ìœ¼ë¡œ ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n                </div>\n\n            <?php endif; ?>\n        </div>\n    </div>\n</body>\n</html>","size_bytes":18649},"competitions.php":{"content":"<?php\nsession_start();\n\n// ë‹¤êµ­ì–´ ì‹œìŠ¤í…œ ë¡œë“œ\nrequire_once __DIR__ . '/lang/Language.php';\n$lang = Language::getInstance();\n\n// ëŒ€íšŒ ìŠ¤ì¼€ì¤„ëŸ¬ ë¡œë“œ\nrequire_once __DIR__ . '/data/scheduler.php';\n$scheduler = new CompetitionScheduler();\n\n// êµ­ê°€ ì´ë¦„ ë§¤í•‘ (ì „ì—­ í•¨ìˆ˜ë¡œ ì´ë™)\nif (!function_exists('getCountryName')) {\n    function getCountryName($code) {\n    $countries = [\n        'KR' => 'ëŒ€í•œë¯¼êµ­',\n        'CN' => 'ì¤‘êµ­',\n        'JP' => 'ì¼ë³¸',\n        'US' => 'ë¯¸êµ­',\n        'DE' => 'ë…ì¼',\n        'UK' => 'ì˜êµ­',\n        'FR' => 'í”„ë‘ìŠ¤',\n        'IT' => 'ì´íƒˆë¦¬ì•„',\n        'RU' => 'ëŸ¬ì‹œì•„',\n        'AU' => 'í˜¸ì£¼',\n        'CA' => 'ìºë‚˜ë‹¤',\n        'SG' => 'ì‹±ê°€í¬ë¥´',\n        'HK' => 'í™ì½©',\n        'TW' => 'ëŒ€ë§Œ',\n        'TH' => 'íƒœêµ­',\n        'MY' => 'ë§ë ˆì´ì‹œì•„',\n        'VN' => 'ë² íŠ¸ë‚¨',\n        'ID' => 'ì¸ë„ë„¤ì‹œì•„',\n        'PH' => 'í•„ë¦¬í•€',\n        'IN' => 'ì¸ë„',\n        'BR' => 'ë¸Œë¼ì§ˆ',\n        'AR' => 'ì•„ë¥´í—¨í‹°ë‚˜',\n        'MX' => 'ë©•ì‹œì½”',\n        'ES' => 'ìŠ¤í˜ì¸',\n        'NL' => 'ë„¤ëœë€ë“œ',\n        'BE' => 'ë²¨ê¸°ì—',\n        'CH' => 'ìŠ¤ìœ„ìŠ¤',\n        'AT' => 'ì˜¤ìŠ¤íŠ¸ë¦¬ì•„',\n        'SE' => 'ìŠ¤ì›¨ë´',\n        'NO' => 'ë…¸ë¥´ì›¨ì´',\n        'DK' => 'ë´ë§ˆí¬',\n        'FI' => 'í•€ë€ë“œ',\n        'PL' => 'í´ë€ë“œ',\n        'CZ' => 'ì²´ì½”',\n        'OTHER' => 'ê¸°íƒ€'\n    ];\n    return $countries[$code] ?? $code;\n    }\n}\n\n// ëª¨ë“  ëŒ€íšŒ ê°€ì ¸ì˜¤ê¸°\n$all_competitions = $scheduler->getAllCompetitions();\n\n// í•„í„°ë§\n$selected_country = $_GET['country'] ?? '';\nif ($selected_country) {\n    $all_competitions = array_filter($all_competitions, function($comp) use ($selected_country) {\n        return ($comp['country'] ?? 'KR') === $selected_country;\n    });\n}\n\n// ì‚¬ìš© ê°€ëŠ¥í•œ êµ­ê°€ ëª©ë¡ ìƒì„±\n$available_countries = [];\n$temp_competitions = $scheduler->getAllCompetitions();\nforeach ($temp_competitions as $comp) {\n    $country = $comp['country'] ?? 'KR';\n    if (!in_array($country, $available_countries)) {\n        $available_countries[] = $country;\n    }\n}\nsort($available_countries);\n\n// ìƒíƒœë³„ ë¶„ë¥˜\n$upcoming = [];\n$ongoing = [];\n$completed = [];\n\nforeach ($all_competitions as $comp) {\n    switch ($comp['status']) {\n        case 'upcoming':\n            $upcoming[] = $comp;\n            break;\n        case 'ongoing':\n            $ongoing[] = $comp;\n            break;\n        case 'completed':\n            $completed[] = $comp;\n            break;\n    }\n}\n\n?>\n<!DOCTYPE html>\n<html lang=\"<?= $lang->getCurrentLang() ?>\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title><?= t('nav_competitions') ?> | DanceOffice</title>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0\" rel=\"stylesheet\">\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        body {\n            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\n            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);\n            color: #e2e8f0;\n            min-height: 100vh;\n        }\n\n        .container {\n            max-width: 1200px;\n            margin: 0 auto;\n            padding: 20px;\n        }\n\n        /* ìƒë‹¨ í—¤ë” */\n        .page-header {\n            background: rgba(30, 41, 59, 0.8);\n            backdrop-filter: blur(20px);\n            border: 1px solid rgba(59, 130, 246, 0.2);\n            border-radius: 20px;\n            padding: 32px;\n            margin-bottom: 32px;\n            text-align: center;\n            position: relative;\n            overflow: hidden;\n        }\n\n        .page-header::before {\n            content: '';\n            position: absolute;\n            top: 0;\n            left: 0;\n            right: 0;\n            bottom: 0;\n            background: radial-gradient(circle at 30% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%);\n            pointer-events: none;\n        }\n\n        .page-header-content {\n            position: relative;\n            z-index: 2;\n        }\n\n        .page-title {\n            font-size: 32px;\n            font-weight: 700;\n            color: #f1f5f9;\n            margin-bottom: 16px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 12px;\n        }\n\n        .page-title .material-symbols-rounded {\n            color: #3b82f6;\n            font-size: 36px;\n        }\n\n        .page-subtitle {\n            color: #94a3b8;\n            font-size: 16px;\n        }\n\n        /* ë°± ë²„íŠ¼ */\n        .back-btn {\n            display: inline-flex;\n            align-items: center;\n            gap: 8px;\n            padding: 12px 24px;\n            background: rgba(59, 130, 246, 0.1);\n            color: #3b82f6;\n            text-decoration: none;\n            border-radius: 12px;\n            margin-bottom: 24px;\n            transition: all 0.3s ease;\n        }\n\n        .back-btn:hover {\n            background: rgba(59, 130, 246, 0.2);\n        }\n\n        /* ëŒ€íšŒ ì„¹ì…˜ */\n        .competition-section {\n            margin-bottom: 40px;\n        }\n\n        .section-header {\n            display: flex;\n            align-items: center;\n            gap: 12px;\n            margin-bottom: 24px;\n        }\n\n        .section-title {\n            font-size: 24px;\n            font-weight: 600;\n            color: #f1f5f9;\n        }\n\n        .section-title .material-symbols-rounded {\n            color: #3b82f6;\n            font-size: 28px;\n        }\n\n        .section-count {\n            background: rgba(59, 130, 246, 0.2);\n            color: #3b82f6;\n            padding: 4px 12px;\n            border-radius: 12px;\n            font-size: 14px;\n            font-weight: 500;\n        }\n\n        /* ëŒ€íšŒ ê·¸ë¦¬ë“œ */\n        .competitions-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fill, minmax(360px, 1fr));\n            gap: 24px;\n        }\n\n        .competition-card {\n            background: rgba(30, 41, 59, 0.6);\n            backdrop-filter: blur(20px);\n            border: 1px solid rgba(59, 130, 246, 0.2);\n            border-radius: 16px;\n            padding: 24px;\n            transition: all 0.3s ease;\n            text-decoration: none;\n            color: inherit;\n            display: block;\n        }\n\n        .competition-card:hover {\n            border-color: rgba(59, 130, 246, 0.4);\n            transform: translateY(-4px);\n            box-shadow: 0 8px 32px rgba(59, 130, 246, 0.1);\n        }\n\n        .card-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: flex-start;\n            margin-bottom: 16px;\n        }\n\n        .card-title {\n            font-size: 18px;\n            font-weight: 600;\n            color: #f1f5f9;\n            margin-bottom: 8px;\n        }\n\n        .card-status {\n            padding: 6px 12px;\n            border-radius: 20px;\n            font-size: 12px;\n            font-weight: 500;\n            white-space: nowrap;\n        }\n\n        .status-upcoming {\n            background: rgba(34, 197, 94, 0.2);\n            color: #22c55e;\n        }\n\n        .status-ongoing {\n            background: rgba(245, 158, 11, 0.2);\n            color: #f59e0b;\n        }\n\n        .status-completed {\n            background: rgba(100, 116, 139, 0.2);\n            color: #64748b;\n        }\n\n        .card-info {\n            space-y: 12px;\n        }\n\n        .info-item {\n            display: flex;\n            align-items: center;\n            gap: 8px;\n            color: #94a3b8;\n            margin-bottom: 8px;\n        }\n\n        .info-item .material-symbols-rounded {\n            color: #3b82f6;\n            font-size: 18px;\n        }\n\n        .card-description {\n            color: #64748b;\n            font-size: 14px;\n            margin-top: 12px;\n            line-height: 1.5;\n        }\n\n        /* ë¹ˆ ìƒíƒœ */\n        .empty-section {\n            text-align: center;\n            padding: 60px 20px;\n            background: rgba(30, 41, 59, 0.3);\n            border: 1px solid rgba(59, 130, 246, 0.1);\n            border-radius: 16px;\n            color: #64748b;\n        }\n\n        .empty-section .material-symbols-rounded {\n            font-size: 48px;\n            margin-bottom: 16px;\n            opacity: 0.5;\n        }\n\n        .empty-section h3 {\n            margin-bottom: 8px;\n        }\n\n        /* í•„í„°ë§ ì„¹ì…˜ */\n        .filter-section {\n            background: rgba(30, 41, 59, 0.6);\n            backdrop-filter: blur(20px);\n            border: 1px solid rgba(59, 130, 246, 0.2);\n            border-radius: 16px;\n            padding: 24px;\n            margin-bottom: 32px;\n        }\n\n        .filter-form {\n            display: flex;\n            align-items: center;\n            gap: 20px;\n            flex-wrap: wrap;\n        }\n\n        .filter-group {\n            display: flex;\n            align-items: center;\n            gap: 12px;\n        }\n\n        .filter-group label {\n            display: flex;\n            align-items: center;\n            gap: 8px;\n            font-weight: 500;\n            color: #f1f5f9;\n        }\n\n        .filter-group label .material-symbols-rounded {\n            color: #3b82f6;\n            font-size: 20px;\n        }\n\n        .filter-group select {\n            background: rgba(15, 23, 42, 0.8);\n            border: 1px solid rgba(59, 130, 246, 0.3);\n            border-radius: 8px;\n            color: #e2e8f0;\n            padding: 8px 16px;\n            font-size: 14px;\n            outline: none;\n            transition: all 0.3s ease;\n        }\n\n        .filter-group select:focus {\n            border-color: #3b82f6;\n            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n        }\n\n        .clear-filter {\n            display: flex;\n            align-items: center;\n            gap: 6px;\n            padding: 8px 16px;\n            background: rgba(239, 68, 68, 0.1);\n            color: #ef4444;\n            text-decoration: none;\n            border-radius: 8px;\n            font-size: 14px;\n            transition: all 0.3s ease;\n        }\n\n        .clear-filter:hover {\n            background: rgba(239, 68, 68, 0.2);\n        }\n\n        .clear-filter .material-symbols-rounded {\n            font-size: 18px;\n        }\n\n        /* êµ­ê°€ í‘œì‹œ */\n        .country-flag {\n            display: inline-flex;\n            align-items: center;\n            gap: 6px;\n            background: rgba(59, 130, 246, 0.1);\n            color: #3b82f6;\n            padding: 4px 8px;\n            border-radius: 12px;\n            font-size: 12px;\n            font-weight: 500;\n        }\n\n        .country-flag .material-symbols-rounded {\n            font-size: 16px;\n        }\n\n        /* ëª¨ë°”ì¼ ëŒ€ì‘ */\n        @media (max-width: 768px) {\n            .container {\n                padding: 16px;\n            }\n\n            .page-title {\n                font-size: 24px;\n            }\n\n            .competitions-grid {\n                grid-template-columns: 1fr;\n                gap: 16px;\n            }\n\n            .competition-card {\n                padding: 20px;\n            }\n\n            .section-title {\n                font-size: 20px;\n            }\n\n            .filter-form {\n                flex-direction: column;\n                align-items: stretch;\n                gap: 16px;\n            }\n\n            .filter-group {\n                justify-content: space-between;\n            }\n\n            .filter-group select {\n                flex: 1;\n                min-width: 0;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <!-- ë°± ë²„íŠ¼ -->\n        <a href=\"/\" class=\"back-btn\">\n            <span class=\"material-symbols-rounded\">arrow_back</span>\n            <?= t('nav_dashboard') ?>\n        </a>\n\n        <!-- í˜ì´ì§€ í—¤ë” -->\n        <div class=\"page-header\">\n            <div class=\"page-header-content\">\n                <h1 class=\"page-title\">\n                    <span class=\"material-symbols-rounded\">event</span>\n                    <?= t('nav_competitions') ?>\n                </h1>\n                <p class=\"page-subtitle\">\n                    ëŒ„ìŠ¤ìŠ¤í¬ì¸  ëŒ€íšŒ ì¼ì •ê³¼ ê²°ê³¼ë¥¼ í™•ì¸í•˜ì„¸ìš”\n                </p>\n            </div>\n        </div>\n\n        <!-- í•„í„°ë§ -->\n        <div class=\"filter-section\">\n            <form method=\"get\" class=\"filter-form\">\n                <div class=\"filter-group\">\n                    <label for=\"country\">\n                        <span class=\"material-symbols-rounded\">flag</span>\n                        ê°œìµœêµ­ê°€\n                    </label>\n                    <select id=\"country\" name=\"country\" onchange=\"this.form.submit()\">\n                        <option value=\"\">ëª¨ë“  êµ­ê°€</option>\n                        <?php foreach ($available_countries as $country_code): ?>\n                            <option value=\"<?= $country_code ?>\" <?= $selected_country === $country_code ? 'selected' : '' ?>>\n                                <?= getCountryName($country_code) ?>\n                            </option>\n                        <?php endforeach; ?>\n                    </select>\n                </div>\n                <?php if ($selected_country): ?>\n                    <a href=\"competitions.php\" class=\"clear-filter\">\n                        <span class=\"material-symbols-rounded\">clear</span>\n                        í•„í„° ì´ˆê¸°í™”\n                    </a>\n                <?php endif; ?>\n            </form>\n        </div>\n\n        <!-- ì§„í–‰ ì˜ˆì • ëŒ€íšŒ -->\n        <?php if (!empty($upcoming)): ?>\n        <div class=\"competition-section\">\n            <div class=\"section-header\">\n                <h2 class=\"section-title\">\n                    <span class=\"material-symbols-rounded\">upcoming</span>\n                    <?= t('status_upcoming') ?> <?= t('nav_competitions') ?>\n                </h2>\n                <span class=\"section-count\"><?= count($upcoming) ?>ê°œ</span>\n            </div>\n            <div class=\"competitions-grid\">\n                <?php foreach ($upcoming as $comp): ?>\n                <a href=\"/competition.php?id=<?= urlencode($comp['id']) ?>\" class=\"competition-card\">\n                    <div class=\"card-header\">\n                        <div>\n                            <h3 class=\"card-title\"><?= htmlspecialchars($comp['title'] ?? $comp['name']) ?></h3>\n                        </div>\n                        <span class=\"card-status status-upcoming\"><?= t('status_upcoming') ?></span>\n                    </div>\n                    <div class=\"card-info\">\n                        <div class=\"info-item\">\n                            <span class=\"material-symbols-rounded\">schedule</span>\n                            <?= $lang->formatDate($comp['date']) ?>\n                        </div>\n                        <div class=\"info-item\">\n                            <span class=\"material-symbols-rounded\">location_on</span>\n                            <?= htmlspecialchars($comp['location'] ?? $comp['place']) ?>\n                        </div>\n                        <div class=\"info-item\">\n                            <span class=\"material-symbols-rounded\">group</span>\n                            <?= htmlspecialchars($comp['host']) ?>\n                        </div>\n                        <div class=\"info-item\">\n                            <span class=\"country-flag\">\n                                <span class=\"material-symbols-rounded\">flag</span>\n                                <?= getCountryName($comp['country'] ?? 'KR') ?>\n                            </span>\n                        </div>\n                    </div>\n                    <?php if (!empty($comp['description'])): ?>\n                    <div class=\"card-description\">\n                        <?= htmlspecialchars($comp['description']) ?>\n                    </div>\n                    <?php endif; ?>\n                </a>\n                <?php endforeach; ?>\n            </div>\n        </div>\n        <?php endif; ?>\n\n        <!-- ì§„í–‰ ì¤‘ì¸ ëŒ€íšŒ -->\n        <?php if (!empty($ongoing)): ?>\n        <div class=\"competition-section\">\n            <div class=\"section-header\">\n                <h2 class=\"section-title\">\n                    <span class=\"material-symbols-rounded\">live_tv</span>\n                    <?= t('status_ongoing') ?> <?= t('nav_competitions') ?>\n                </h2>\n                <span class=\"section-count\"><?= count($ongoing) ?>ê°œ</span>\n            </div>\n            <div class=\"competitions-grid\">\n                <?php foreach ($ongoing as $comp): ?>\n                <a href=\"/competition.php?id=<?= urlencode($comp['id']) ?>\" class=\"competition-card\">\n                    <div class=\"card-header\">\n                        <div>\n                            <h3 class=\"card-title\"><?= htmlspecialchars($comp['title'] ?? $comp['name']) ?></h3>\n                        </div>\n                        <span class=\"card-status status-ongoing\"><?= t('status_ongoing') ?></span>\n                    </div>\n                    <div class=\"card-info\">\n                        <div class=\"info-item\">\n                            <span class=\"material-symbols-rounded\">schedule</span>\n                            <?= $lang->formatDate($comp['date']) ?>\n                        </div>\n                        <div class=\"info-item\">\n                            <span class=\"material-symbols-rounded\">location_on</span>\n                            <?= htmlspecialchars($comp['location'] ?? $comp['place']) ?>\n                        </div>\n                        <div class=\"info-item\">\n                            <span class=\"material-symbols-rounded\">group</span>\n                            <?= htmlspecialchars($comp['host']) ?>\n                        </div>\n                        <div class=\"info-item\">\n                            <span class=\"country-flag\">\n                                <span class=\"material-symbols-rounded\">flag</span>\n                                <?= getCountryName($comp['country'] ?? 'KR') ?>\n                            </span>\n                        </div>\n                    </div>\n                    <?php if (!empty($comp['description'])): ?>\n                    <div class=\"card-description\">\n                        <?= htmlspecialchars($comp['description']) ?>\n                    </div>\n                    <?php endif; ?>\n                </a>\n                <?php endforeach; ?>\n            </div>\n        </div>\n        <?php endif; ?>\n\n        <!-- ì™„ë£Œëœ ëŒ€íšŒ -->\n        <?php if (!empty($completed)): ?>\n        <div class=\"competition-section\">\n            <div class=\"section-header\">\n                <h2 class=\"section-title\">\n                    <span class=\"material-symbols-rounded\">trophy</span>\n                    <?= t('status_completed') ?> <?= t('nav_competitions') ?>\n                </h2>\n                <span class=\"section-count\"><?= count($completed) ?>ê°œ</span>\n            </div>\n            <div class=\"competitions-grid\">\n                <?php foreach ($completed as $comp): ?>\n                <a href=\"/competition.php?id=<?= urlencode($comp['id']) ?>\" class=\"competition-card\">\n                    <div class=\"card-header\">\n                        <div>\n                            <h3 class=\"card-title\"><?= htmlspecialchars($comp['title'] ?? $comp['name']) ?></h3>\n                        </div>\n                        <span class=\"card-status status-completed\"><?= t('status_completed') ?></span>\n                    </div>\n                    <div class=\"card-info\">\n                        <div class=\"info-item\">\n                            <span class=\"material-symbols-rounded\">schedule</span>\n                            <?= $lang->formatDate($comp['date']) ?>\n                        </div>\n                        <div class=\"info-item\">\n                            <span class=\"material-symbols-rounded\">location_on</span>\n                            <?= htmlspecialchars($comp['location'] ?? $comp['place']) ?>\n                        </div>\n                        <div class=\"info-item\">\n                            <span class=\"material-symbols-rounded\">group</span>\n                            <?= htmlspecialchars($comp['host']) ?>\n                        </div>\n                        <div class=\"info-item\">\n                            <span class=\"country-flag\">\n                                <span class=\"material-symbols-rounded\">flag</span>\n                                <?= getCountryName($comp['country'] ?? 'KR') ?>\n                            </span>\n                        </div>\n                    </div>\n                    <?php if (!empty($comp['description'])): ?>\n                    <div class=\"card-description\">\n                        <?= htmlspecialchars($comp['description']) ?>\n                    </div>\n                    <?php endif; ?>\n                </a>\n                <?php endforeach; ?>\n            </div>\n        </div>\n        <?php endif; ?>\n\n        <!-- ëŒ€íšŒê°€ ì—†ëŠ” ê²½ìš° -->\n        <?php if (empty($upcoming) && empty($ongoing) && empty($completed)): ?>\n        <div class=\"empty-section\">\n            <div class=\"material-symbols-rounded\">event_busy</div>\n            <h3>ë“±ë¡ëœ ëŒ€íšŒê°€ ì—†ìŠµë‹ˆë‹¤</h3>\n            <p>ì•„ì§ ë“±ë¡ëœ ëŒ€íšŒê°€ ì—†ìŠµë‹ˆë‹¤. ìƒˆë¡œìš´ ëŒ€íšŒê°€ ë“±ë¡ë˜ë©´ ì´ê³³ì— í‘œì‹œë©ë‹ˆë‹¤.</p>\n        </div>\n        <?php endif; ?>\n    </div>\n</body>\n</html>","size_bytes":21754},"results.php":{"content":"<?php\nsession_start();\n\n// ë‹¤êµ­ì–´ ì‹œìŠ¤í…œ ë¡œë“œ\nrequire_once __DIR__ . '/lang/Language.php';\n$lang = Language::getInstance();\n\n// ëŒ€íšŒ ìŠ¤ì¼€ì¤„ëŸ¬ ë¡œë“œ\nrequire_once __DIR__ . '/data/scheduler.php';\n$scheduler = new CompetitionScheduler();\n\n// êµ­ê°€ ì´ë¦„ ë§¤í•‘\nfunction getCountryName($code) {\n    $countries = [\n        'KR' => 'ëŒ€í•œë¯¼êµ­',\n        'CN' => 'ì¤‘êµ­',\n        'JP' => 'ì¼ë³¸',\n        'US' => 'ë¯¸êµ­',\n        'DE' => 'ë…ì¼',\n        'UK' => 'ì˜êµ­',\n        'FR' => 'í”„ë‘ìŠ¤',\n        'IT' => 'ì´íƒˆë¦¬ì•„',\n        'RU' => 'ëŸ¬ì‹œì•„',\n        'AU' => 'í˜¸ì£¼',\n        'CA' => 'ìºë‚˜ë‹¤',\n        'SG' => 'ì‹±ê°€í¬ë¥´',\n        'HK' => 'í™ì½©',\n        'TW' => 'ëŒ€ë§Œ',\n        'TH' => 'íƒœêµ­',\n        'MY' => 'ë§ë ˆì´ì‹œì•„',\n        'VN' => 'ë² íŠ¸ë‚¨',\n        'ID' => 'ì¸ë„ë„¤ì‹œì•„',\n        'PH' => 'í•„ë¦¬í•€',\n        'IN' => 'ì¸ë„',\n        'BR' => 'ë¸Œë¼ì§ˆ',\n        'AR' => 'ì•„ë¥´í—¨í‹°ë‚˜',\n        'MX' => 'ë©•ì‹œì½”',\n        'ES' => 'ìŠ¤í˜ì¸',\n        'NL' => 'ë„¤ëœë€ë“œ',\n        'BE' => 'ë²¨ê¸°ì—',\n        'CH' => 'ìŠ¤ìœ„ìŠ¤',\n        'AT' => 'ì˜¤ìŠ¤íŠ¸ë¦¬ì•„',\n        'SE' => 'ìŠ¤ì›¨ë´',\n        'NO' => 'ë…¸ë¥´ì›¨ì´',\n        'DK' => 'ë´ë§ˆí¬',\n        'FI' => 'í•€ë€ë“œ',\n        'PL' => 'í´ë€ë“œ',\n        'CZ' => 'ì²´ì½”',\n        'OTHER' => 'ê¸°íƒ€'\n    ];\n    return $countries[$code] ?? $code;\n}\n\n// ì™„ë£Œëœ ëŒ€íšŒë“¤ë§Œ ê°€ì ¸ì™€ì„œ ìµœì‹ ìˆœìœ¼ë¡œ ì •ë ¬\n$all_competitions = $scheduler->getAllCompetitions();\n$completed_competitions = array_filter($all_competitions, function($comp) {\n    return $comp['status'] === 'completed';\n});\n\n// ë‚ ì§œ ê¸°ì¤€ìœ¼ë¡œ ìµœì‹ ìˆœ ì •ë ¬\nusort($completed_competitions, function($a, $b) {\n    return strtotime($b['date']) - strtotime($a['date']);\n});\n\n// íŠ¹ì • ëŒ€íšŒì˜ ê²°ê³¼ ë³´ê¸°\n$view_comp_id = $_GET['comp_id'] ?? '';\n$selected_competition = null;\nif ($view_comp_id) {\n    foreach ($completed_competitions as $comp) {\n        if ($comp['id'] === $view_comp_id) {\n            $selected_competition = $comp;\n            break;\n        }\n    }\n}\n\n// ê²°ê³¼ ë°ì´í„° ë¡œë“œ í•¨ìˆ˜\nfunction getCompetitionResults($comp_data_path) {\n    if (!$comp_data_path) return [];\n    \n    $results_file = $comp_data_path . '/results.json';\n    if (file_exists($results_file)) {\n        return json_decode(file_get_contents($results_file), true) ?: [];\n    }\n    return [];\n}\n\n$competition_results = [];\nif ($selected_competition && isset($selected_competition['comp_data_path'])) {\n    $competition_results = getCompetitionResults($selected_competition['comp_data_path']);\n}\n\n?>\n<!DOCTYPE html>\n<html lang=\"<?= $lang->getCurrentLang() ?>\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title><?= $selected_competition ? htmlspecialchars($selected_competition['title']) . ' - ' : '' ?><?= t('nav_results') ?> | DanceOffice</title>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap\" rel=\"stylesheet\">\n    <link href=\"https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0\" rel=\"stylesheet\">\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        body {\n            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\n            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);\n            color: #e2e8f0;\n            min-height: 100vh;\n        }\n\n        .container {\n            max-width: 1200px;\n            margin: 0 auto;\n            padding: 20px;\n        }\n\n        /* ìƒë‹¨ í—¤ë” */\n        .page-header {\n            background: rgba(30, 41, 59, 0.8);\n            backdrop-filter: blur(20px);\n            border: 1px solid rgba(59, 130, 246, 0.2);\n            border-radius: 20px;\n            padding: 32px;\n            margin-bottom: 32px;\n            text-align: center;\n            position: relative;\n            overflow: hidden;\n        }\n\n        .page-header::before {\n            content: '';\n            position: absolute;\n            top: 0;\n            left: 0;\n            right: 0;\n            bottom: 0;\n            background: radial-gradient(circle at 30% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%);\n            pointer-events: none;\n        }\n\n        .page-header-content {\n            position: relative;\n            z-index: 2;\n        }\n\n        .page-title {\n            font-size: 32px;\n            font-weight: 700;\n            color: #f1f5f9;\n            margin-bottom: 16px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 12px;\n        }\n\n        .page-title .material-symbols-rounded {\n            color: #3b82f6;\n            font-size: 36px;\n        }\n\n        .page-subtitle {\n            color: #94a3b8;\n            font-size: 16px;\n        }\n\n        /* ë°± ë²„íŠ¼ */\n        .back-btn {\n            display: inline-flex;\n            align-items: center;\n            gap: 8px;\n            padding: 12px 24px;\n            background: rgba(59, 130, 246, 0.1);\n            color: #3b82f6;\n            text-decoration: none;\n            border-radius: 12px;\n            margin-bottom: 24px;\n            transition: all 0.3s ease;\n        }\n\n        .back-btn:hover {\n            background: rgba(59, 130, 246, 0.2);\n        }\n\n        /* ëŒ€íšŒ ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */\n        .competitions-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fill, minmax(360px, 1fr));\n            gap: 24px;\n            margin-bottom: 32px;\n        }\n\n        .competition-card {\n            background: rgba(30, 41, 59, 0.6);\n            backdrop-filter: blur(20px);\n            border: 1px solid rgba(59, 130, 246, 0.2);\n            border-radius: 16px;\n            padding: 24px;\n            transition: all 0.3s ease;\n            text-decoration: none;\n            color: inherit;\n            display: block;\n        }\n\n        .competition-card:hover {\n            border-color: rgba(59, 130, 246, 0.4);\n            transform: translateY(-4px);\n            box-shadow: 0 8px 32px rgba(59, 130, 246, 0.1);\n        }\n\n        .card-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: flex-start;\n            margin-bottom: 16px;\n        }\n\n        .card-title {\n            font-size: 18px;\n            font-weight: 600;\n            color: #f1f5f9;\n            margin-bottom: 8px;\n        }\n\n        .card-date {\n            color: #64748b;\n            font-size: 14px;\n            background: rgba(100, 116, 139, 0.2);\n            padding: 4px 12px;\n            border-radius: 12px;\n        }\n\n        .card-info {\n            space-y: 12px;\n        }\n\n        .info-item {\n            display: flex;\n            align-items: center;\n            gap: 8px;\n            color: #94a3b8;\n            margin-bottom: 8px;\n            font-size: 14px;\n        }\n\n        .info-item .material-symbols-rounded {\n            color: #3b82f6;\n            font-size: 18px;\n        }\n\n        .country-flag {\n            display: inline-flex;\n            align-items: center;\n            gap: 6px;\n            background: rgba(59, 130, 246, 0.1);\n            color: #3b82f6;\n            padding: 4px 8px;\n            border-radius: 12px;\n            font-size: 12px;\n            font-weight: 500;\n        }\n\n        .country-flag .material-symbols-rounded {\n            font-size: 16px;\n        }\n\n        /* ê²°ê³¼ ìƒì„¸ ë³´ê¸° */\n        .results-detail {\n            background: rgba(30, 41, 59, 0.6);\n            backdrop-filter: blur(20px);\n            border: 1px solid rgba(59, 130, 246, 0.2);\n            border-radius: 20px;\n            padding: 32px;\n        }\n\n        .competition-info {\n            background: rgba(15, 23, 42, 0.6);\n            border: 1px solid rgba(59, 130, 246, 0.1);\n            border-radius: 16px;\n            padding: 24px;\n            margin-bottom: 32px;\n        }\n\n        .competition-info h2 {\n            color: #f1f5f9;\n            font-size: 24px;\n            margin-bottom: 16px;\n            display: flex;\n            align-items: center;\n            gap: 12px;\n        }\n\n        .competition-info h2 .material-symbols-rounded {\n            color: #3b82f6;\n            font-size: 28px;\n        }\n\n        .info-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n            gap: 16px;\n        }\n\n        .results-section {\n            margin-top: 32px;\n        }\n\n        .section-title {\n            font-size: 24px;\n            font-weight: 600;\n            color: #f1f5f9;\n            margin-bottom: 24px;\n            display: flex;\n            align-items: center;\n            gap: 12px;\n        }\n\n        .section-title .material-symbols-rounded {\n            color: #3b82f6;\n            font-size: 28px;\n        }\n\n        .result-item {\n            background: rgba(15, 23, 42, 0.6);\n            border: 1px solid rgba(59, 130, 246, 0.1);\n            border-radius: 16px;\n            padding: 20px;\n            margin-bottom: 16px;\n        }\n\n        .result-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 12px;\n        }\n\n        .result-title {\n            font-size: 16px;\n            font-weight: 600;\n            color: #f1f5f9;\n        }\n\n        .result-content {\n            color: #94a3b8;\n            line-height: 1.6;\n        }\n\n        /* ë¹ˆ ìƒíƒœ */\n        .empty-state {\n            text-align: center;\n            padding: 60px 20px;\n            color: #64748b;\n        }\n\n        .empty-state .material-symbols-rounded {\n            font-size: 48px;\n            margin-bottom: 16px;\n            opacity: 0.5;\n        }\n\n        .empty-state h3 {\n            margin-bottom: 8px;\n        }\n\n        /* ëª¨ë°”ì¼ ëŒ€ì‘ */\n        @media (max-width: 768px) {\n            .container {\n                padding: 16px;\n            }\n\n            .page-title {\n                font-size: 24px;\n            }\n\n            .competitions-grid {\n                grid-template-columns: 1fr;\n                gap: 16px;\n            }\n\n            .competition-card {\n                padding: 20px;\n            }\n\n            .results-detail {\n                padding: 24px 20px;\n            }\n\n            .info-grid {\n                grid-template-columns: 1fr;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <!-- ë°± ë²„íŠ¼ -->\n        <a href=\"/\" class=\"back-btn\">\n            <span class=\"material-symbols-rounded\">arrow_back</span>\n            <?= t('nav_dashboard') ?>\n        </a>\n\n        <?php if ($selected_competition): ?>\n        <!-- íŠ¹ì • ëŒ€íšŒ ê²°ê³¼ ìƒì„¸ ë³´ê¸° -->\n        <div class=\"page-header\">\n            <div class=\"page-header-content\">\n                <h1 class=\"page-title\">\n                    <span class=\"material-symbols-rounded\">trophy</span>\n                    <?= htmlspecialchars($selected_competition['title']) ?> ê²°ê³¼\n                </h1>\n                <p class=\"page-subtitle\">\n                    <?= $lang->formatDate($selected_competition['date']) ?> ê°œìµœ\n                </p>\n            </div>\n        </div>\n\n        <div class=\"results-detail\">\n            <!-- ëŒ€íšŒ ì •ë³´ -->\n            <div class=\"competition-info\">\n                <h2>\n                    <span class=\"material-symbols-rounded\">info</span>\n                    ëŒ€íšŒ ì •ë³´\n                </h2>\n                <div class=\"info-grid\">\n                    <div class=\"info-item\">\n                        <span class=\"material-symbols-rounded\">event</span>\n                        <strong>ëŒ€íšŒëª…:</strong> <?= htmlspecialchars($selected_competition['title']) ?>\n                    </div>\n                    <div class=\"info-item\">\n                        <span class=\"material-symbols-rounded\">schedule</span>\n                        <strong>ê°œìµœì¼:</strong> <?= $lang->formatDate($selected_competition['date']) ?>\n                    </div>\n                    <div class=\"info-item\">\n                        <span class=\"material-symbols-rounded\">location_on</span>\n                        <strong>ì¥ì†Œ:</strong> <?= htmlspecialchars($selected_competition['location']) ?>\n                    </div>\n                    <div class=\"info-item\">\n                        <span class=\"material-symbols-rounded\">group</span>\n                        <strong>ì£¼ìµœ:</strong> <?= htmlspecialchars($selected_competition['host']) ?>\n                    </div>\n                    <div class=\"info-item\">\n                        <span class=\"country-flag\">\n                            <span class=\"material-symbols-rounded\">flag</span>\n                            <?= getCountryName($selected_competition['country'] ?? 'KR') ?>\n                        </span>\n                    </div>\n                </div>\n            </div>\n\n            <!-- ì¢…í•© ê²°ê³¼ -->\n            <div class=\"results-section\">\n                <h2 class=\"section-title\">\n                    <span class=\"material-symbols-rounded\">military_tech</span>\n                    ì¢…í•© ê²°ê³¼\n                </h2>\n\n                <?php if (empty($competition_results)): ?>\n                    <div class=\"empty-state\">\n                        <div class=\"material-symbols-rounded\">trophy</div>\n                        <h3>ê²°ê³¼ê°€ ì•„ì§ ë°œí‘œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤</h3>\n                        <p>ëŒ€íšŒ ê²°ê³¼ê°€ ì§‘ê³„ë˜ë©´ ì´ê³³ì— í‘œì‹œë©ë‹ˆë‹¤.</p>\n                    </div>\n                <?php else: ?>\n                    <?php foreach ($competition_results as $result): ?>\n                        <div class=\"result-item\">\n                            <div class=\"result-header\">\n                                <h3 class=\"result-title\"><?= htmlspecialchars($result['category'] ?? 'ê²½ê¸° ì¢…ëª©') ?></h3>\n                            </div>\n                            <div class=\"result-content\">\n                                <?= nl2br(htmlspecialchars($result['summary'] ?? $result['content'] ?? '')) ?>\n                            </div>\n                        </div>\n                    <?php endforeach; ?>\n                <?php endif; ?>\n            </div>\n\n            <!-- ëŒ€íšŒ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸° -->\n            <div style=\"text-align: center; margin-top: 32px;\">\n                <a href=\"/results.php\" class=\"back-btn\">\n                    <span class=\"material-symbols-rounded\">list</span>\n                    ëŒ€íšŒ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°\n                </a>\n            </div>\n        </div>\n\n        <?php else: ?>\n        <!-- ëŒ€íšŒ ëª©ë¡ ë³´ê¸° -->\n        <div class=\"page-header\">\n            <div class=\"page-header-content\">\n                <h1 class=\"page-title\">\n                    <span class=\"material-symbols-rounded\">trophy</span>\n                    <?= t('nav_results') ?>\n                </h1>\n                <p class=\"page-subtitle\">\n                    ì™„ë£Œëœ ëŒ€íšŒì˜ ì¢…í•© ê²°ê³¼ë¥¼ í™•ì¸í•˜ì„¸ìš”\n                </p>\n            </div>\n        </div>\n\n        <?php if (empty($completed_competitions)): ?>\n            <div class=\"empty-state\">\n                <div class=\"material-symbols-rounded\">trophy</div>\n                <h3>ì™„ë£Œëœ ëŒ€íšŒê°€ ì—†ìŠµë‹ˆë‹¤</h3>\n                <p>ëŒ€íšŒê°€ ì™„ë£Œë˜ë©´ ì´ê³³ì— ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤.</p>\n            </div>\n        <?php else: ?>\n            <div class=\"competitions-grid\">\n                <?php foreach ($completed_competitions as $comp): ?>\n                <a href=\"results.php?comp_id=<?= urlencode($comp['id']) ?>\" class=\"competition-card\">\n                    <div class=\"card-header\">\n                        <div>\n                            <h3 class=\"card-title\"><?= htmlspecialchars($comp['title'] ?? $comp['name']) ?></h3>\n                        </div>\n                        <span class=\"card-date\"><?= date('Y.m.d', strtotime($comp['date'])) ?></span>\n                    </div>\n                    <div class=\"card-info\">\n                        <div class=\"info-item\">\n                            <span class=\"material-symbols-rounded\">location_on</span>\n                            <?= htmlspecialchars($comp['location'] ?? $comp['place']) ?>\n                        </div>\n                        <div class=\"info-item\">\n                            <span class=\"material-symbols-rounded\">group</span>\n                            <?= htmlspecialchars($comp['host']) ?>\n                        </div>\n                        <div class=\"info-item\">\n                            <span class=\"country-flag\">\n                                <span class=\"material-symbols-rounded\">flag</span>\n                                <?= getCountryName($comp['country'] ?? 'KR') ?>\n                            </span>\n                        </div>\n                    </div>\n                </a>\n                <?php endforeach; ?>\n            </div>\n        <?php endif; ?>\n\n        <?php endif; ?>\n    </div>\n</body>\n</html>","size_bytes":17219},"data/NoticeManager.php":{"content":"<?php\nclass NoticeManager {\n    private $pdo;\n    \n    public function __construct() {\n        $this->connect();\n    }\n    \n    private function connect() {\n        // ë¨¼ì € PDO PostgreSQL ë“œë¼ì´ë²„ê°€ ì‚¬ìš© ê°€ëŠ¥í•œì§€ í™•ì¸\n        if (!extension_loaded('pdo_pgsql')) {\n            throw new Exception('PDO PostgreSQL extension not loaded');\n        }\n        \n        // í™˜ê²½ ë³€ìˆ˜ì—ì„œ DATABASE_URL ê°€ì ¸ì˜¤ê¸°\n        $database_url = $_ENV['DATABASE_URL'] ?? getenv('DATABASE_URL');\n        if (!$database_url) {\n            // ê°œë³„ í™˜ê²½ ë³€ìˆ˜ë¡œ DSN êµ¬ì„± ì‹œë„\n            $host = $_ENV['PGHOST'] ?? getenv('PGHOST');\n            $port = $_ENV['PGPORT'] ?? getenv('PGPORT') ?? '5432';\n            $dbname = $_ENV['PGDATABASE'] ?? getenv('PGDATABASE');\n            $user = $_ENV['PGUSER'] ?? getenv('PGUSER');\n            $password = $_ENV['PGPASSWORD'] ?? getenv('PGPASSWORD');\n            \n            if ($host && $dbname && $user && $password) {\n                $database_url = \"pgsql:host={$host};port={$port};dbname={$dbname};user={$user};password={$password}\";\n            } else {\n                throw new Exception('DATABASE_URL or individual PostgreSQL environment variables not set');\n            }\n        }\n        \n        try {\n            // PDO ì˜µì…˜ ì„¤ì •\n            $options = [\n                PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,\n                PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC,\n                PDO::ATTR_EMULATE_PREPARES => false,\n                PDO::ATTR_STRINGIFY_FETCHES => false\n            ];\n            \n            $this->pdo = new PDO($database_url, null, null, $options);\n            \n            // ì—°ê²° í…ŒìŠ¤íŠ¸\n            $this->pdo->query('SELECT 1');\n            \n        } catch (PDOException $e) {\n            throw new Exception('Database connection failed: ' . $e->getMessage());\n        }\n    }\n    \n    /**\n     * ê³µì§€ì‚¬í•­ ìƒì„±\n     */\n    public function createNotice($title, $content, $imagePath = null, $isPinned = false) {\n        $sql = \"INSERT INTO notices (title, content, image_path, is_pinned, created_at, updated_at) \n                VALUES (:title, :content, :image_path, :is_pinned, NOW(), NOW())\";\n        \n        $stmt = $this->pdo->prepare($sql);\n        $stmt->execute([\n            ':title' => $title,\n            ':content' => $content,\n            ':image_path' => $imagePath,\n            ':is_pinned' => $isPinned\n        ]);\n        \n        return $this->pdo->lastInsertId();\n    }\n    \n    /**\n     * ëª¨ë“  ê³µì§€ì‚¬í•­ ì¡°íšŒ (ê³ ì •ê¸€ ìš°ì„ , ìµœì‹ ìˆœ)\n     */\n    public function getAllNotices($limit = null) {\n        $sql = \"SELECT * FROM notices ORDER BY is_pinned DESC, created_at DESC\";\n        if ($limit) {\n            $sql .= \" LIMIT :limit\";\n        }\n        \n        $stmt = $this->pdo->prepare($sql);\n        if ($limit) {\n            $stmt->bindValue(':limit', $limit, PDO::PARAM_INT);\n        }\n        $stmt->execute();\n        \n        return $stmt->fetchAll();\n    }\n    \n    /**\n     * ê³ ì •ëœ ê³µì§€ì‚¬í•­ë§Œ ì¡°íšŒ\n     */\n    public function getPinnedNotices() {\n        $sql = \"SELECT * FROM notices WHERE is_pinned = true ORDER BY created_at DESC\";\n        $stmt = $this->pdo->prepare($sql);\n        $stmt->execute();\n        \n        return $stmt->fetchAll();\n    }\n    \n    /**\n     * ìµœì‹  ê³µì§€ì‚¬í•­ ì¡°íšŒ (ë©”ì¸ í˜ì´ì§€ìš©)\n     */\n    public function getRecentNotices($limit = 5) {\n        $sql = \"SELECT * FROM notices ORDER BY is_pinned DESC, created_at DESC LIMIT :limit\";\n        $stmt = $this->pdo->prepare($sql);\n        $stmt->bindValue(':limit', $limit, PDO::PARAM_INT);\n        $stmt->execute();\n        \n        return $stmt->fetchAll();\n    }\n    \n    /**\n     * íŠ¹ì • ê³µì§€ì‚¬í•­ ì¡°íšŒ\n     */\n    public function getNoticeById($id) {\n        $sql = \"SELECT * FROM notices WHERE id = :id\";\n        $stmt = $this->pdo->prepare($sql);\n        $stmt->execute([':id' => $id]);\n        \n        return $stmt->fetch();\n    }\n    \n    /**\n     * ê³µì§€ì‚¬í•­ ìˆ˜ì •\n     */\n    public function updateNotice($id, $title, $content, $imagePath = null, $isPinned = false) {\n        $sql = \"UPDATE notices SET title = :title, content = :content, image_path = :image_path, \n                is_pinned = :is_pinned, updated_at = NOW() WHERE id = :id\";\n        \n        $stmt = $this->pdo->prepare($sql);\n        return $stmt->execute([\n            ':id' => $id,\n            ':title' => $title,\n            ':content' => $content,\n            ':image_path' => $imagePath,\n            ':is_pinned' => $isPinned\n        ]);\n    }\n    \n    /**\n     * ê³µì§€ì‚¬í•­ ì‚­ì œ\n     */\n    public function deleteNotice($id) {\n        // ì´ë¯¸ì§€ íŒŒì¼ë„ í•¨ê»˜ ì‚­ì œ\n        $notice = $this->getNoticeById($id);\n        if ($notice && $notice['image_path']) {\n            $imagePath = __DIR__ . '/../' . $notice['image_path'];\n            if (file_exists($imagePath)) {\n                unlink($imagePath);\n            }\n        }\n        \n        $sql = \"DELETE FROM notices WHERE id = :id\";\n        $stmt = $this->pdo->prepare($sql);\n        return $stmt->execute([':id' => $id]);\n    }\n    \n    /**\n     * ê³ ì • ìƒíƒœ í† ê¸€\n     */\n    public function togglePin($id) {\n        $sql = \"UPDATE notices SET is_pinned = NOT is_pinned, updated_at = NOW() WHERE id = :id\";\n        $stmt = $this->pdo->prepare($sql);\n        return $stmt->execute([':id' => $id]);\n    }\n    \n    /**\n     * ì´ë¯¸ì§€ ì—…ë¡œë“œ ì²˜ë¦¬\n     */\n    public function uploadImage($file) {\n        $uploadDir = __DIR__ . '/../uploads/notices/';\n        if (!is_dir($uploadDir)) {\n            mkdir($uploadDir, 0755, true);\n        }\n        \n        $allowedTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp'];\n        if (!in_array($file['type'], $allowedTypes)) {\n            throw new Exception('í—ˆìš©ë˜ì§€ ì•ŠëŠ” íŒŒì¼ í˜•ì‹ì…ë‹ˆë‹¤. (JPG, PNG, GIF, WebPë§Œ ê°€ëŠ¥)');\n        }\n        \n        $maxSize = 5 * 1024 * 1024; // 5MB\n        if ($file['size'] > $maxSize) {\n            throw new Exception('íŒŒì¼ í¬ê¸°ê°€ ë„ˆë¬´ í½ë‹ˆë‹¤. (ìµœëŒ€ 5MB)');\n        }\n        \n        $extension = pathinfo($file['name'], PATHINFO_EXTENSION);\n        $filename = uniqid('notice_') . '.' . $extension;\n        $uploadPath = $uploadDir . $filename;\n        \n        if (!move_uploaded_file($file['tmp_name'], $uploadPath)) {\n            throw new Exception('íŒŒì¼ ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n        }\n        \n        return 'uploads/notices/' . $filename;\n    }\n    \n    /**\n     * ê³µì§€ì‚¬í•­ í†µê³„\n     */\n    public function getNoticeStats() {\n        $sql = \"SELECT \n                    COUNT(*) as total,\n                    COUNT(CASE WHEN is_pinned = true THEN 1 END) as pinned,\n                    COUNT(CASE WHEN created_at >= NOW() - INTERVAL '7 days' THEN 1 END) as recent\n                FROM notices\";\n        \n        $stmt = $this->pdo->prepare($sql);\n        $stmt->execute();\n        \n        return $stmt->fetch();\n    }\n}\n?>","size_bytes":7014},"test-pdo.php":{"content":"<?php\necho \"<h2>PDO Test</h2>\";\n\necho \"<h3>Available PDO Drivers:</h3>\";\nprint_r(PDO::getAvailableDrivers());\n\necho \"<h3>Extension Check:</h3>\";\necho \"PDO extension loaded: \" . (extension_loaded('pdo') ? 'âœ“ Yes' : 'âœ— No') . \"<br>\";\necho \"PDO_PGSQL extension loaded: \" . (extension_loaded('pdo_pgsql') ? 'âœ“ Yes' : 'âœ— No') . \"<br>\";\n\necho \"<h3>Environment Variables:</h3>\";\necho \"DATABASE_URL: \" . ($_ENV['DATABASE_URL'] ?? getenv('DATABASE_URL') ?? 'Not set') . \"<br>\";\n\nif (extension_loaded('pdo_pgsql')) {\n    echo \"<h3>Testing PostgreSQL Connection:</h3>\";\n    try {\n        $database_url = $_ENV['DATABASE_URL'] ?? getenv('DATABASE_URL');\n        if (!$database_url) {\n            echo \"DATABASE_URL not set\";\n        } else {\n            $pdo = new PDO($database_url);\n            $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\n            echo \"âœ“ PostgreSQL connection successful!\";\n        }\n    } catch (PDOException $e) {\n        echo \"âœ— Connection failed: \" . $e->getMessage();\n    }\n} else {\n    echo \"PDO_PGSQL extension not loaded\";\n}\n?>","size_bytes":1077},"comp/push_timetable.php":{"content":"<?php\n/**\n * íƒ€ì„í…Œì´ë¸” ë°ì´í„°ë¥¼ ë©”ì¸ ì‹œìŠ¤í…œìœ¼ë¡œ í‘¸ì‹œí•˜ëŠ” API\n */\n\nheader('Content-Type: application/json');\nerror_reporting(E_ALL);\nini_set('display_errors', 1);\n\nsession_start();\nrequire_once 'auth.php';\n\n// ê¶Œí•œ í™•ì¸\nif (!isset($_SESSION['user']) || !hasPermission($_SESSION['user'], 'create_comp')) {\n    echo json_encode(['success' => false, 'message' => 'ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.']);\n    exit;\n}\n\n$comp_id = $_POST['comp_id'] ?? '';\nif (!$comp_id || !preg_match('/^\\d{8}-\\d+$/', $comp_id)) {\n    echo json_encode(['success' => false, 'message' => 'ìœ íš¨í•˜ì§€ ì•Šì€ ëŒ€íšŒ IDì…ë‹ˆë‹¤.']);\n    exit;\n}\n\ntry {\n    $data_dir = __DIR__ . \"/data/$comp_id\";\n    $info_file = \"$data_dir/info.json\";\n    $runorder_file = \"$data_dir/RunOrder_Tablet.txt\";\n    $special_events_file = \"$data_dir/special_events.json\";\n    \n    // ëŒ€íšŒ ì •ë³´ í™•ì¸\n    if (!file_exists($info_file)) {\n        throw new Exception('ëŒ€íšŒ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');\n    }\n    \n    $info = json_decode(file_get_contents($info_file), true);\n    if (!$info) {\n        throw new Exception('ëŒ€íšŒ ì •ë³´ë¥¼ ì½ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');\n    }\n    \n    // íƒ€ì„í…Œì´ë¸” ë°ì´í„° ì²˜ë¦¬\n    $timetable_data = [];\n    $events = [];\n    \n    // RunOrderì—ì„œ ì´ë²¤íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸°\n    if (file_exists($runorder_file)) {\n        $lines = file($runorder_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n        foreach ($lines as $line) {\n            if (preg_match('/^bom/', $line)) continue;\n            \n            $cols = array_map('trim', explode(',', $line));\n            if (count($cols) < 14) continue;\n            \n            $events[] = [\n                'no' => $cols[0] ?? '',\n                'desc' => $cols[1] ?? '',\n                'roundtype' => $cols[2] ?? '',\n                'roundnum' => $cols[3] ?? '',\n                'dances' => array_filter(array_slice($cols, 6, 5)), // 6~10ë²ˆì§¸ ì»¬ëŸ¼\n                'extra_time' => isset($cols[14]) && !empty($cols[14]) ? intval($cols[14]) : 0\n            ];\n        }\n    }\n    \n    // íŠ¹ë³„ ì´ë²¤íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸°\n    $special_events = [];\n    if (file_exists($special_events_file)) {\n        $special_events = json_decode(file_get_contents($special_events_file), true) ?? [];\n    }\n    \n    // íƒ€ì„í…Œì´ë¸” ë°ì´í„° êµ¬ì„±\n    $timetable_data = [\n        'comp_id' => $comp_id,\n        'competition_info' => $info,\n        'events' => $events,\n        'special_events' => $special_events,\n        'generated_at' => date('Y-m-d H:i:s'),\n        'generated_by' => $_SESSION['user']['username']\n    ];\n    \n    // ë©”ì¸ ì‹œìŠ¤í…œ íƒ€ì„í…Œì´ë¸” ë””ë ‰í† ë¦¬ì— ì €ì¥\n    $main_timetable_dir = __DIR__ . '/../data/timetables';\n    if (!is_dir($main_timetable_dir)) {\n        mkdir($main_timetable_dir, 0755, true);\n    }\n    \n    $timetable_file = \"$main_timetable_dir/timetable_$comp_id.json\";\n    $result = file_put_contents($timetable_file, json_encode($timetable_data, JSON_PRETTY_PRINT | JSON_UNESCAPED_UNICODE));\n    \n    if ($result === false) {\n        throw new Exception('íƒ€ì„í…Œì´ë¸” ë°ì´í„° ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n    }\n    \n    // ë©”ì¸ ì‹œìŠ¤í…œì˜ competitions.json ì—…ë°ì´íŠ¸\n    $competitions_file = __DIR__ . '/../data/competitions.json';\n    $competitions = [];\n    \n    if (file_exists($competitions_file)) {\n        $competitions = json_decode(file_get_contents($competitions_file), true) ?? [];\n    }\n    \n    // ê¸°ì¡´ ëŒ€íšŒ ì •ë³´ ì°¾ê¸°\n    $competition_updated = false;\n    foreach ($competitions as &$competition) {\n        if (isset($competition['our_system_id']) && $competition['our_system_id'] === $comp_id) {\n            $competition['timetable_updated_at'] = date('Y-m-d H:i:s');\n            $competition['timetable_file'] = \"timetables/timetable_$comp_id.json\";\n            $competition['has_timetable'] = true;\n            $competition_updated = true;\n            break;\n        }\n    }\n    \n    // ìƒˆë¡œìš´ ëŒ€íšŒë¼ë©´ ì¶”ê°€\n    if (!$competition_updated) {\n        $competitions[] = [\n            'id' => 'comp_' . $comp_id,\n            'name' => $info['title'],\n            'title' => $info['title'],\n            'subtitle' => '',\n            'date' => $info['date'],\n            'location' => $info['place'],\n            'place' => $info['place'],\n            'host' => $info['host'],\n            'country' => $info['country'] ?? 'KR',\n            'status' => (strtotime($info['date']) < time()) ? 'completed' : 'upcoming',\n            'our_system_id' => $comp_id,\n            'timetable_file' => \"timetables/timetable_$comp_id.json\",\n            'timetable_updated_at' => date('Y-m-d H:i:s'),\n            'has_timetable' => true,\n            'created_at' => date('Y-m-d H:i:s', $info['created']),\n            'updated_at' => date('Y-m-d H:i:s')\n        ];\n    }\n    \n    // competitions.json ì €ì¥\n    file_put_contents($competitions_file, json_encode($competitions, JSON_PRETTY_PRINT | JSON_UNESCAPED_UNICODE));\n    \n    echo json_encode([\n        'success' => true,\n        'message' => 'íƒ€ì„í…Œì´ë¸”ì´ ì„±ê³µì ìœ¼ë¡œ ëŒ€íšŒ ëŒ€ì‰¬ë³´ë“œì— í‘¸ì‹œë˜ì—ˆìŠµë‹ˆë‹¤.',\n        'data' => [\n            'comp_id' => $comp_id,\n            'competition_title' => $info['title'],\n            'events_count' => count($events),\n            'special_events_count' => count($special_events),\n            'timetable_file' => $timetable_file,\n            'pushed_at' => date('Y-m-d H:i:s')\n        ]\n    ]);\n    \n} catch (Exception $e) {\n    echo json_encode([\n        'success' => false,\n        'message' => 'íƒ€ì„í…Œì´ë¸” í‘¸ì‹œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' . $e->getMessage()\n    ]);\n}\n?>","size_bytes":5642},"comp/create_results_folder.php":{"content":"<?php\nheader('Content-Type: application/json; charset=utf-8');\n\n// POST ë°ì´í„° ë°›ê¸°\n$input = json_decode(file_get_contents('php://input'), true);\n$comp_id = $input['comp_id'] ?? '';\n$event_no = $input['event_no'] ?? '';\n$event_name = $input['event_name'] ?? '';\n$aggregation_data = $input['aggregation_data'] ?? [];\n\nif (empty($comp_id) || empty($event_no)) {\n    echo json_encode(['success' => false, 'message' => 'í•„ìˆ˜ íŒŒë¼ë¯¸í„°ê°€ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤.'], JSON_UNESCAPED_UNICODE);\n    exit;\n}\n\n// ëŒ€íšŒ ë°ì´í„° ë””ë ‰í† ë¦¬\n$data_dir = __DIR__ . \"/data/$comp_id\";\n\n// ì›¹ ì ‘ê·¼ ê°€ëŠ¥í•œ results_reports í´ë” ìƒì„±\n$web_root = dirname(__DIR__);\n$results_reports_dir = \"$web_root/results_reports/$comp_id\";\nif (!is_dir($results_reports_dir)) {\n    if (!mkdir($results_reports_dir, 0755, true)) {\n        echo json_encode(['success' => false, 'message' => 'Results reports í´ë” ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.'], JSON_UNESCAPED_UNICODE);\n        exit;\n    }\n}\n\n// ì´ë²¤íŠ¸ë³„ í´ë” ìƒì„±\n$event_results_dir = \"$results_reports_dir/Event_$event_no\";\nif (!is_dir($event_results_dir)) {\n    if (!mkdir($event_results_dir, 0755, true)) {\n        echo json_encode(['success' => false, 'message' => 'Event í´ë” ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.'], JSON_UNESCAPED_UNICODE);\n        exit;\n    }\n}\n\ntry {\n    // 1. ìƒì„¸ ë¦¬í¬íŠ¸ ìƒì„±\n    $detailed_report = generateDetailedReport($comp_id, $event_no, $event_name, $aggregation_data, $data_dir);\n    $detailed_report_path = \"$event_results_dir/detailed_report_$event_no.html\";\n    file_put_contents($detailed_report_path, $detailed_report);\n    \n    // 2. ë¦¬ì½œ ë¦¬í¬íŠ¸ ìƒì„±\n    $recall_report = generateRecallReport($comp_id, $event_no, $event_name, $aggregation_data, $data_dir);\n    $recall_report_path = \"$event_results_dir/recall_report_$event_no.html\";\n    file_put_contents($recall_report_path, $recall_report);\n    \n    // 3. ì»´ë°”ì¸ ë¦¬í¬íŠ¸ ìƒì„±\n    $combined_report = generateCombinedReport($comp_id, $event_no, $event_name, $aggregation_data, $data_dir);\n    $combined_report_path = \"$event_results_dir/combined_report_$event_no.html\";\n    file_put_contents($combined_report_path, $combined_report);\n    \n    // 4. ë©”íƒ€ë°ì´í„° ì €ì¥\n    $metadata = [\n        'event_no' => $event_no,\n        'event_name' => $event_name,\n        'generated_at' => date('Y-m-d H:i:s'),\n        'files' => [\n            'detailed_report' => \"detailed_report_$event_no.html\",\n            'recall_report' => \"recall_report_$event_no.html\",\n            'combined_report' => \"combined_report_$event_no.html\"\n        ]\n    ];\n    $metadata_path = \"$event_results_dir/metadata.json\";\n    file_put_contents($metadata_path, json_encode($metadata, JSON_UNESCAPED_UNICODE | JSON_PRETTY_PRINT));\n    \n    echo json_encode([\n        'success' => true,\n        'message' => 'ê²°ê³¼ íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.',\n        'files' => $metadata['files'],\n        'results_dir' => $event_results_dir\n    ], JSON_UNESCAPED_UNICODE);\n    \n} catch (Exception $e) {\n    echo json_encode([\n        'success' => false,\n        'message' => 'ê²°ê³¼ íŒŒì¼ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' . $e->getMessage()\n    ], JSON_UNESCAPED_UNICODE);\n}\n\nfunction generateDetailedReport($comp_id, $event_no, $event_name, $aggregation_data, $data_dir) {\n    // ëŒ€íšŒ ì •ë³´ ë¡œë“œ\n    $comp_info = json_decode(file_get_contents(\"$data_dir/info.json\"), true);\n    \n    // ì„ ìˆ˜ ì •ë³´ ë¡œë“œ\n    $players_file = \"$data_dir/players.txt\";\n    $all_players = [];\n    if (file_exists($players_file)) {\n        $lines = file($players_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n        foreach ($lines as $line) {\n            if (preg_match('/^bom/', $line)) continue;\n            $cols = array_map('trim', explode(',', $line));\n            if (count($cols) >= 3) {\n                $all_players[$cols[0]] = [\n                    'male' => $cols[1],\n                    'female' => $cols[2]\n                ];\n            }\n        }\n    }\n    \n    // ê²°ê³¼ íŒŒì¼ ë¡œë“œ\n    $result_file = \"$data_dir/players_hits_$event_no.json\";\n    $final_rankings = [];\n    if (file_exists($result_file)) {\n        $result_data = json_decode(file_get_contents($result_file), true);\n        if ($result_data) {\n            foreach ($result_data as $rank => $players) {\n                foreach ($players as $player_no) {\n                    $final_rankings[] = [\n                        'rank' => $rank,\n                        'player_no' => $player_no,\n                        'player_name' => isset($all_players[$player_no]) ? \n                            $all_players[$player_no]['male'] . ' / ' . $all_players[$player_no]['female'] : \n                            \"ì„ ìˆ˜ $player_no\"\n                    ];\n                }\n            }\n        }\n    }\n    \n    // ì‹¤ì œ ì±„ì  ë°ì´í„° ë¡œë“œ (.adj íŒŒì¼ë“¤)\n    $scoring_data = loadScoringData($data_dir, $event_no);\n    \n    // ëŒ„ìŠ¤ ì´ë¦„ ë¡œë“œ\n    $dance_names = [];\n    $dance_file = \"$data_dir/DanceName.txt\";\n    if (file_exists($dance_file)) {\n        $dance_lines = file($dance_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n        foreach ($dance_lines as $line) {\n            $parts = explode(',', $line);\n            if (count($parts) >= 2) {\n                $dance_names[trim($parts[0])] = trim($parts[1]);\n            }\n        }\n    }\n    \n    // ì‹¬ì‚¬ìœ„ì› ì •ë³´ ë¡œë“œ\n    $adjudicators = [];\n    $adj_file = \"$data_dir/adjudicators.txt\";\n    if (file_exists($adj_file)) {\n        $adj_lines = file($adj_file, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);\n        foreach ($adj_lines as $line) {\n            $parts = explode(',', $line);\n            if (count($parts) >= 2) {\n                $adjudicators[trim($parts[0])] = trim($parts[1]);\n            }\n        }\n    }\n    \n    // ëª¨ë“  ì„ ìˆ˜ ë²ˆí˜¸ ìˆ˜ì§‘ (ë©´ì œì ì œì™¸)\n    $all_player_numbers = [];\n    foreach ($scoring_data as $dance => $players) {\n        foreach ($players as $player_no => $scores) {\n            if (!in_array($player_no, $all_player_numbers)) {\n                // ë©´ì œì í™•ì¸\n                $is_exempted = false;\n                foreach ($final_rankings as $ranking) {\n                    if ($ranking['player_no'] == $player_no && $ranking['rank'] == 1) {\n                        $is_exempted = true;\n                        break;\n                    }\n                }\n                \n                // ë©´ì œìê°€ ì•„ë‹Œ ê²½ìš°ë§Œ ì¶”ê°€\n                if (!$is_exempted) {\n                    $all_player_numbers[] = $player_no;\n                }\n            }\n        }\n    }\n    sort($all_player_numbers);\n    \n    // HTML ìƒì„±\n    $html = '<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>' . htmlspecialchars($event_name) . ' - ìƒì„¸ ë¦¬í¬íŠ¸</title>\n    <style>\n        * { margin: 0; padding: 0; box-sizing: border-box; }\n        body { \n            font-family: \"Segoe UI\", Tahoma, Geneva, Verdana, sans-serif; \n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            min-height: 100vh;\n            color: #333;\n        }\n        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }\n        .header { \n            text-align: center; color: white; margin-bottom: 30px; \n            background: rgba(255,255,255,0.1); padding: 30px; border-radius: 15px;\n        }\n        .header h1 { font-size: 2.5em; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }\n        .header p { font-size: 1.2em; opacity: 0.9; }\n        .report-section { \n            background: white; border-radius: 15px; padding: 25px; margin-bottom: 20px; \n            box-shadow: 0 10px 30px rgba(0,0,0,0.2);\n        }\n        .report-section h2 { \n            color: #667eea; margin-bottom: 20px; font-size: 1.5em; \n            border-bottom: 3px solid #667eea; padding-bottom: 10px;\n        }\n        table { \n            width: 100%; border-collapse: collapse; margin-top: 15px; \n            background: white; border-radius: 8px; overflow: hidden;\n        }\n        th, td { \n            padding: 8px; text-align: center; border: 1px solid #e0e0e0; \n            font-size: 12px;\n        }\n        th { \n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); \n            color: white; font-weight: bold;\n        }\n        tr:nth-child(even) { background: #f8f9fa; }\n        tr:hover { background: #e3f2fd; }\n        .player-name { text-align: left; font-weight: 500; }\n        .rank-1 { background: linear-gradient(135deg, #ffd700, #ffed4e); color: #333; font-weight: bold; }\n        .rank-2 { background: linear-gradient(135deg, #c0c0c0, #e8e8e8); color: #333; font-weight: bold; }\n        .rank-3 { background: linear-gradient(135deg, #cd7f32, #daa520); color: white; font-weight: bold; }\n        .print-btn { \n            position: fixed; top: 20px; right: 20px; z-index: 1000;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white; border: none; padding: 12px 25px; border-radius: 25px;\n            cursor: pointer; font-size: 14px; font-weight: bold;\n            box-shadow: 0 4px 15px rgba(0,0,0,0.2); transition: all 0.3s ease;\n        }\n        .print-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(0,0,0,0.3); }\n        @media print {\n            .print-btn { display: none; }\n            body { background: white; }\n            .header { background: #f8f9fa; color: #333; }\n        }\n    </style>\n</head>\n<body>\n    <button class=\"print-btn\" onclick=\"window.print()\">ğŸ–¨ï¸ ì¸ì‡„</button>\n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>' . htmlspecialchars($comp_info['name'] ?? 'ëŒ€íšŒ') . '</h1>\n            <p>' . htmlspecialchars($event_name) . ' - ìƒì„¸ ë¦¬í¬íŠ¸</p>\n            <p>ìƒì„±ì¼: ' . date('Y-m-d H:i:s') . '</p>\n        </div>';\n    \n    // ê° ëŒ„ìŠ¤ë³„ ì±„ì  í…Œì´ë¸” ìƒì„±\n    $dance_names_map = [\n        '6' => 'Cha Cha Cha',\n        '7' => 'Samba', \n        '8' => 'Rumba',\n        '9' => 'Jive'\n    ];\n    \n    foreach (['6', '7', '8', '9'] as $dance) {\n        $dance_name = $dance_names_map[$dance];\n        $html .= '\n        <div class=\"report-section\">\n            <h2>' . $dance_name . '</h2>\n            <table>\n                <thead>\n                    <tr>\n                        <th>Tag</th>\n                        <th>Competitor Name(s)</th>';\n        \n        // ì‹¬ì‚¬ìœ„ì› ì»¬ëŸ¼ ìƒì„± (12-24)\n        for ($i = 12; $i <= 24; $i++) {\n            $html .= '<th>' . $i . '</th>';\n        }\n        \n        $html .= '\n                        <th>Mark</th>\n                    </tr>\n                </thead>\n                <tbody>';\n        \n        // ê° ì„ ìˆ˜ë³„ í–‰ ìƒì„±\n        foreach ($all_player_numbers as $player_no) {\n            $player_name = isset($all_players[$player_no]) ? \n                $all_players[$player_no]['male'] . ' / ' . $all_players[$player_no]['female'] : \n                \"ì„ ìˆ˜ $player_no\";\n            \n            // ë©´ì œ ì„ ìˆ˜ í™•ì¸\n            $is_exempted = false;\n            foreach ($final_rankings as $ranking) {\n                if ($ranking['player_no'] == $player_no && $ranking['rank'] == 1) {\n                    $is_exempted = true;\n                    break;\n                }\n            }\n            \n            $html .= '\n                    <tr>\n                        <td>' . $player_no . '</td>\n                        <td class=\"player-name\">' . htmlspecialchars($player_name) . ($is_exempted ? ' â­' : '') . '</td>';\n            \n            // ê° ì‹¬ì‚¬ìœ„ì›ì˜ ì ìˆ˜\n            $total_recall = 0;\n            for ($i = 12; $i <= 24; $i++) {\n                $recall = isset($scoring_data[$dance][$player_no][$i]) ? \n                    $scoring_data[$dance][$player_no][$i] : '0';\n                $html .= '<td>' . $recall . '</td>';\n                if ($recall == '1') $total_recall++;\n            }\n            \n            // Mark ì»¬ëŸ¼ (ë©´ì œ ë˜ëŠ” ì´ ë¦¬ì½œ ìˆ˜)\n            $mark = $is_exempted ? 'ë©´ì œ' : $total_recall;\n            $html .= '<td>' . $mark . '</td>\n                    </tr>';\n        }\n        \n        $html .= '\n                </tbody>\n            </table>\n        </div>';\n    }\n    \n    // ì‹¬ì‚¬ìœ„ì› ì •ë³´ ì„¹ì…˜\n    $html .= '\n        <div class=\"report-section\">\n            <h2>Adjudicators</h2>\n            <div style=\"display: flex; flex-wrap: wrap; gap: 10px;\">';\n    \n    // ì‹¬ì‚¬ìœ„ì› ì½”ë“œ ë§¤í•‘ (12-24 -> A-M)\n    $judge_mapping = [\n        12 => 'A', 13 => 'B', 14 => 'C', 15 => 'D', 16 => 'E',\n        17 => 'F', 18 => 'G', 19 => 'H', 20 => 'I', 21 => 'J',\n        22 => 'K', 23 => 'L', 24 => 'M'\n    ];\n    \n    // ì‹¤ì œ ì‹¬ì‚¬ìœ„ì› ë²ˆí˜¸ ë§¤í•‘\n    $actual_judge_nums = [\n        12 => '5', 13 => '9', 14 => '7', 15 => '10', 16 => '2',\n        17 => '4', 18 => '3', 19 => '6', 20 => '11', 21 => '8',\n        22 => '12', 23 => '1', 24 => '13'\n    ];\n    \n    for ($i = 12; $i <= 24; $i++) {\n        $judge_code = $judge_mapping[$i];\n        $actual_judge_num = $actual_judge_nums[$i];\n        $html .= '<span style=\"background: #f0f0f0; padding: 5px 10px; border-radius: 5px; margin: 2px;\">' . \n                 $judge_code . '. ' . $actual_judge_num . '</span>';\n    }\n    \n    $html .= '\n            </div>\n        </div>\n    </div>\n</body>\n</html>';\n    \n    return $html;\n}\n\nfunction generateRecallReport($comp_id, $event_no, $event_name, $aggregation_data, $data_dir) {\n    return generateDetailedReport($comp_id, $event_no, $event_name, $aggregation_data, $data_dir);\n}\n\nfunction generateCombinedReport($comp_id, $event_no, $event_name, $aggregation_data, $data_dir) {\n    return generateDetailedReport($comp_id, $event_no, $event_name, $aggregation_data, $data_dir);\n}\n\n// ì‹¤ì œ ì±„ì  ë°ì´í„°ë¥¼ ë¡œë“œí•˜ëŠ” í•¨ìˆ˜\nfunction loadScoringData($data_dir, $event_no) {\n    $scoring_data = [];\n    \n    // ì´ë²¤íŠ¸ì˜ ëŒ„ìŠ¤ë“¤ í™•ì¸ (6, 7, 8, 9 = Cha Cha Cha, Samba, Rumba, Jive)\n    $dances = ['6', '7', '8', '9'];\n    \n    foreach ($dances as $dance) {\n        $scoring_data[$dance] = [];\n        \n        // ê° ì‹¬ì‚¬ìœ„ì›ì˜ ì±„ì  ë°ì´í„° ë¡œë“œ (12-24)\n        for ($judge_num = 12; $judge_num <= 24; $judge_num++) {\n            $adj_file = \"$data_dir/{$event_no}_{$dance}_{$judge_num}.adj\";\n            \n            if (file_exists($adj_file)) {\n                $content = file_get_contents($adj_file);\n                $lines = array_filter(array_map('trim', explode(\"\\n\", $content)));\n                \n                foreach ($lines as $line) {\n                    // .adj íŒŒì¼ í˜•ì‹: ê° ì¤„ì— ì„ ìˆ˜ ë²ˆí˜¸ë§Œ ìˆìŒ (ë¦¬ì½œëœ ì„ ìˆ˜)\n                    $player_number = trim($line, '\"');\n                    if (!empty($player_number)) {\n                        $scoring_data[$dance][$player_number][$judge_num] = '1'; // ë¦¬ì½œë¨\n                    }\n                }\n            }\n        }\n    }\n    \n    return $scoring_data;\n}\n?>\n","size_bytes":15069}},"version":1}